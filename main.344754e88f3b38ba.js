"use strict";var rq=Object.defineProperty,iq=Object.defineProperties,sq=Object.getOwnPropertyDescriptors,mF=Object.getOwnPropertySymbols,oq=Object.prototype.hasOwnProperty,aq=Object.prototype.propertyIsEnumerable,_F=(nt,be,F)=>be in nt?rq(nt,be,{enumerable:!0,configurable:!0,writable:!0,value:F}):nt[be]=F,yF=(nt,be)=>{for(var F in be||(be={}))oq.call(be,F)&&_F(nt,F,be[F]);if(mF)for(var F of mF(be))aq.call(be,F)&&_F(nt,F,be[F]);return nt},vF=(nt,be)=>iq(nt,sq(be));(self.webpackChunkrest_mgmt_ui=self.webpackChunkrest_mgmt_ui||[]).push([[179],{2011:(nt,be,F)=>{F.d(be,{Dh:()=>le,GT:()=>ye,cc:()=>Pe,hO:()=>qe,on:()=>G,pX:()=>ce,xv:()=>we});var f=F(5e3),j=F(127),P=F(5813);nt=F.hmd(nt);const ae=["ngOnDestroy"],ce=(Te,Ze,We,Fe={})=>new Proxy(Te,{get:(Me,De)=>We.runOutsideAngular(()=>{var ze;if(Te[De])return(null===(ze=null==Fe?void 0:Fe.spy)||void 0===ze?void 0:ze.get)&&Fe.spy.get(De,Te[De]),Te[De];if(ae.indexOf(De)>-1)return()=>{};const re=Ze.toPromise().then(ge=>{const Ce=ge&&ge[De];return"function"==typeof Ce?Ce.bind(ge):Ce&&Ce.then?Ce.then(J=>We.run(()=>J)):We.run(()=>Ce)});return new Proxy(()=>{},{get:(ge,Ce)=>re[Ce],apply:(ge,Ce,J)=>re.then(ie=>{var oe;const ve=ie&&ie(...J);return(null===(oe=null==Fe?void 0:Fe.spy)||void 0===oe?void 0:oe.apply)&&Fe.spy.apply(De,J,ve),ve})})})}),ye=(Te,Ze)=>{Ze.forEach(We=>{Object.getOwnPropertyNames(We.prototype||We).forEach(Fe=>{Object.defineProperty(Te.prototype,Fe,Object.getOwnPropertyDescriptor(We.prototype||We,Fe))})})};class me{constructor(Ze){return Ze}}const le=new f.OlP("angularfire2.app.options"),we=new f.OlP("angularfire2.app.name");function G(Te,Ze,We){const Me="object"==typeof We&&We||{};Me.name=Me.name||"string"==typeof We&&We||"[DEFAULT]";const ze=j.Z.apps.filter(re=>re&&re.name===Me.name)[0]||Ze.runOutsideAngular(()=>j.Z.initializeApp(Te,Me));try{JSON.stringify(Te)!==JSON.stringify(ze.options)&&q("error",`${ze.name} Firebase App already initialized with different options${nt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(re){}return new me(ze)}const q=(Te,...Ze)=>{(0,f.X6Q)()&&"undefined"!=typeof console&&console[Te](...Ze)},se={provide:me,useFactory:G,deps:[le,f.R0b,[new f.FiY,we]]};let qe=(()=>{class Te{constructor(We){j.Z.registerVersion("angularfire",P.q4.full,"core"),j.Z.registerVersion("angularfire",P.q4.full,"app-compat"),j.Z.registerVersion("angular",f.q4F.full,We.toString())}static initializeApp(We,Fe){return{ngModule:Te,providers:[{provide:le,useValue:We},{provide:we,useValue:Fe}]}}}return Te.\u0275fac=function(We){return new(We||Te)(f.LFG(f.Lbi))},Te.\u0275mod=f.oAB({type:Te}),Te.\u0275inj=f.cJS({providers:[se]}),Te})();function Pe(Te,Ze,We,Fe,Me){const[,De,ze]=globalThis.\u0275AngularfireInstanceCache.find(re=>re[0]===Te)||[];if(De)return function Ve(Te,Ze){try{return Te.toString()===Ze.toString()}catch(We){return Te===Ze}}(Me,ze)||(_e("error",`${Ze} was already initialized on the ${We} Firebase App with different settings.${Ge?" You may need to reload as Firebase is not HMR aware.":""}`),_e("warn",{is:Me,was:ze})),De;{const re=Fe();return globalThis.\u0275AngularfireInstanceCache.push([Te,re,Me]),re}}const Ge=!!nt.hot,_e=(Te,...Ze)=>{(0,f.X6Q)()&&"undefined"!=typeof console&&console[Te](...Ze)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(nt,be,F)=>{F.d(be,{q4:()=>uy,iC:()=>il,fc:()=>ic,HU:()=>rl,vb:()=>tu,JM:()=>ha});var f=F(5e3),j=F(5867),P=F(5861),ae=F(9681),ce=F(2090),ye=F(4859),me=F(1877),le=F(8766);const we="@firebase/installations",G="0.5.12",se=`w:${G}`,qe="FIS_v2",Ze=new ce.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function We(b){return b instanceof ce.ZR&&b.code.includes("request-failed")}function Fe({projectId:b}){return`https://firebaseinstallations.googleapis.com/v1/projects/${b}/installations`}function Me(b){return{token:b.token,requestStatus:2,expiresIn:ie(b.expiresIn),creationTime:Date.now()}}function De(b,T){return ze.apply(this,arguments)}function ze(){return(ze=(0,P.Z)(function*(b,T){const U=(yield T.json()).error;return Ze.create("request-failed",{requestName:b,serverCode:U.code,serverMessage:U.message,serverStatus:U.status})})).apply(this,arguments)}function re({apiKey:b}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b})}function ge(b,{refreshToken:T}){const R=re(b);return R.append("Authorization",function oe(b){return`${qe} ${b}`}(T)),R}function Ce(b){return J.apply(this,arguments)}function J(){return(J=(0,P.Z)(function*(b){const T=yield b();return T.status>=500&&T.status<600?b():T})).apply(this,arguments)}function ie(b){return Number(b.replace("s","000"))}function ve(b,T){return de.apply(this,arguments)}function de(){return(de=(0,P.Z)(function*({appConfig:b,heartbeatServiceProvider:T},{fid:R}){const U=Fe(b),X=re(b),ue=T.getImmediate({optional:!0});if(ue){const Dt=yield ue.getHeartbeatsHeader();Dt&&X.append("x-firebase-client",Dt)}const Xe={method:"POST",headers:X,body:JSON.stringify({fid:R,authVersion:qe,appId:b.appId,sdkVersion:se})},yt=yield Ce(()=>fetch(U,Xe));if(yt.ok){const Dt=yield yt.json();return{fid:Dt.fid||R,registrationStatus:2,refreshToken:Dt.refreshToken,authToken:Me(Dt.authToken)}}throw yield De("Create Installation",yt)})).apply(this,arguments)}function Ue(b){return new Promise(T=>{setTimeout(T,b)})}const Qt=/^[cdef][\w-]{21}$/;function Ye(){try{const b=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(b),b[0]=112+b[0]%16;const R=function pn(b){return function _t(b){return btoa(String.fromCharCode(...b)).replace(/\+/g,"-").replace(/\//g,"_")}(b).substr(0,22)}(b);return Qt.test(R)?R:""}catch(b){return""}}function On(b){return`${b.appName}!${b.appId}`}const gn=new Map;function nn(b,T){const R=On(b);Dn(R,T),function Mi(b,T){const R=function Rn(){return!Fr&&"BroadcastChannel"in self&&(Fr=new BroadcastChannel("[Firebase] FID Change"),Fr.onmessage=b=>{Dn(b.data.key,b.data.fid)}),Fr}();R&&R.postMessage({key:b,fid:T}),function ls(){0===gn.size&&Fr&&(Fr.close(),Fr=null)}()}(R,T)}function Dn(b,T){const R=gn.get(b);if(R)for(const U of R)U(T)}let Fr=null;const kn="firebase-installations-store";let Gi=null;function vt(){return Gi||(Gi=(0,le.X3)("firebase-installations-database",1,{upgrade:(b,T)=>{0===T&&b.createObjectStore(kn)}})),Gi}function Lr(b,T){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,P.Z)(function*(b,T){const R=On(b),X=(yield vt()).transaction(kn,"readwrite"),ue=X.objectStore(kn),Ne=yield ue.get(R);return yield ue.put(T,R),yield X.done,(!Ne||Ne.fid!==T.fid)&&nn(b,T.fid),T})).apply(this,arguments)}function un(b){return ir.apply(this,arguments)}function ir(){return(ir=(0,P.Z)(function*(b){const T=On(b),U=(yield vt()).transaction(kn,"readwrite");yield U.objectStore(kn).delete(T),yield U.done})).apply(this,arguments)}function Vr(b,T){return sr.apply(this,arguments)}function sr(){return(sr=(0,P.Z)(function*(b,T){const R=On(b),X=(yield vt()).transaction(kn,"readwrite"),ue=X.objectStore(kn),Ne=yield ue.get(R),Xe=T(Ne);return void 0===Xe?yield ue.delete(R):yield ue.put(Xe,R),yield X.done,Xe&&(!Ne||Ne.fid!==Xe.fid)&&nn(b,Xe.fid),Xe})).apply(this,arguments)}function Sn(b){return or.apply(this,arguments)}function or(){return(or=(0,P.Z)(function*(b){let T;const R=yield Vr(b.appConfig,U=>{const X=cs(U),ue=Ht(b,X);return T=ue.registrationPromise,ue.installationEntry});return""===R.fid?{installationEntry:yield T}:{installationEntry:R,registrationPromise:T}})).apply(this,arguments)}function cs(b){return Pi(b||{fid:Ye(),registrationStatus:0})}function Ht(b,T){if(0===T.registrationStatus){if(!navigator.onLine)return{installationEntry:T,registrationPromise:Promise.reject(Ze.create("app-offline"))};const R={fid:T.fid,registrationStatus:1,registrationTime:Date.now()},U=function gt(b,T){return rt.apply(this,arguments)}(b,R);return{installationEntry:R,registrationPromise:U}}return 1===T.registrationStatus?{installationEntry:T,registrationPromise:vi(b)}:{installationEntry:T}}function rt(){return(rt=(0,P.Z)(function*(b,T){try{const R=yield ve(b,T);return Lr(b.appConfig,R)}catch(R){throw We(R)&&409===R.customData.serverCode?yield un(b.appConfig):yield Lr(b.appConfig,{fid:T.fid,registrationStatus:0}),R}})).apply(this,arguments)}function vi(b){return wi.apply(this,arguments)}function wi(){return(wi=(0,P.Z)(function*(b){let T=yield $t(b.appConfig);for(;1===T.registrationStatus;)yield Ue(100),T=yield $t(b.appConfig);if(0===T.registrationStatus){const{installationEntry:R,registrationPromise:U}=yield Sn(b);return U||R}return T})).apply(this,arguments)}function $t(b){return Vr(b,T=>{if(!T)throw Ze.create("installation-not-found");return Pi(T)})}function Pi(b){return function Fn(b){return 1===b.registrationStatus&&b.registrationTime+1e4<Date.now()}(b)?{fid:b.fid,registrationStatus:0}:b}function yn(b,T){return mt.apply(this,arguments)}function mt(){return(mt=(0,P.Z)(function*({appConfig:b,heartbeatServiceProvider:T},R){const U=zr(b,R),X=ge(b,R),ue=T.getImmediate({optional:!0});if(ue){const Dt=yield ue.getHeartbeatsHeader();Dt&&X.append("x-firebase-client",Dt)}const Xe={method:"POST",headers:X,body:JSON.stringify({installation:{sdkVersion:se,appId:b.appId}})},yt=yield Ce(()=>fetch(U,Xe));if(yt.ok)return Me(yield yt.json());throw yield De("Generate Auth Token",yt)})).apply(this,arguments)}function zr(b,{fid:T}){return`${Fe(b)}/${T}/authTokens:generate`}function z(b){return H.apply(this,arguments)}function H(){return(H=(0,P.Z)(function*(b,T=!1){let R;const U=yield Vr(b.appConfig,ue=>{if(!bt(ue))throw Ze.create("not-registered");const Ne=ue.authToken;if(!T&&rn(Ne))return ue;if(1===Ne.requestStatus)return R=B(b,T),ue;{if(!navigator.onLine)throw Ze.create("app-offline");const Xe=ar(ue);return R=Re(b,Xe),Xe}});return R?yield R:U.authToken})).apply(this,arguments)}function B(b,T){return $.apply(this,arguments)}function $(){return($=(0,P.Z)(function*(b,T){let R=yield Z(b.appConfig);for(;1===R.authToken.requestStatus;)yield Ue(100),R=yield Z(b.appConfig);const U=R.authToken;return 0===U.requestStatus?z(b,T):U})).apply(this,arguments)}function Z(b){return Vr(b,T=>{if(!bt(T))throw Ze.create("not-registered");return function ee(b){return 1===b.requestStatus&&b.requestTime+1e4<Date.now()}(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}function Re(b,T){return $e.apply(this,arguments)}function $e(){return($e=(0,P.Z)(function*(b,T){try{const R=yield yn(b,T),U=Object.assign(Object.assign({},T),{authToken:R});return yield Lr(b.appConfig,U),R}catch(R){if(!We(R)||401!==R.customData.serverCode&&404!==R.customData.serverCode){const U=Object.assign(Object.assign({},T),{authToken:{requestStatus:0}});yield Lr(b.appConfig,U)}else yield un(b.appConfig);throw R}})).apply(this,arguments)}function bt(b){return void 0!==b&&2===b.registrationStatus}function rn(b){return 2===b.requestStatus&&!function Xt(b){const T=Date.now();return T<b.creationTime||b.creationTime+b.expiresIn<T+36e5}(b)}function ar(b){const T={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},b),{authToken:T})}function Y(){return(Y=(0,P.Z)(function*(b){const T=b,{installationEntry:R,registrationPromise:U}=yield Sn(T);return U?U.catch(console.error):z(T).catch(console.error),R.fid})).apply(this,arguments)}function Je(){return(Je=(0,P.Z)(function*(b,T=!1){const R=b;return yield ht(R),(yield z(R,T)).token})).apply(this,arguments)}function ht(b){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,P.Z)(function*(b){const{registrationPromise:T}=yield Sn(b);T&&(yield T)})).apply(this,arguments)}function Fa(b){return Ze.create("missing-app-config-values",{valueName:b})}const ai="installations",kt=b=>{const T=b.getProvider("app").getImmediate(),R=function _r(b){if(!b||!b.options)throw Fa("App Configuration");if(!b.name)throw Fa("App Name");const T=["projectId","apiKey","appId"];for(const R of T)if(!b.options[R])throw Fa(R);return{appName:b.name,projectId:b.options.projectId,apiKey:b.options.apiKey,appId:b.options.appId}}(T);return{app:T,appConfig:R,heartbeatServiceProvider:(0,ae._getProvider)(T,"heartbeat"),_delete:()=>Promise.resolve()}},vn=b=>{const T=b.getProvider("app").getImmediate(),R=(0,ae._getProvider)(T,ai).getImmediate();return{getId:()=>function Q(b){return Y.apply(this,arguments)}(R),getToken:X=>function Se(b){return Je.apply(this,arguments)}(R,X)}};(function Zr(){(0,ae._registerComponent)(new ye.wA(ai,kt,"PUBLIC")),(0,ae._registerComponent)(new ye.wA("installations-internal",vn,"PRIVATE"))})(),(0,ae.registerVersion)(we,G),(0,ae.registerVersion)(we,G,"esm2017");const ds="@firebase/remote-config",Ln=new ce.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class ad{constructor(T,R,U,X){this.client=T,this.storage=R,this.storageCache=U,this.logger=X}isCachedDataFresh(T,R){if(!R)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const U=Date.now()-R,X=U<=T;return this.logger.debug(`Config fetch cache check. Cache age millis: ${U}. Cache max age millis (minimumFetchIntervalMillis setting): ${T}. Is cache hit: ${X}.`),X}fetch(T){var R=this;return(0,P.Z)(function*(){const[U,X]=yield Promise.all([R.storage.getLastSuccessfulFetchTimestampMillis(),R.storage.getLastSuccessfulFetchResponse()]);if(X&&R.isCachedDataFresh(T.cacheMaxAgeMillis,U))return X;T.eTag=X&&X.eTag;const ue=yield R.client.fetch(T),Ne=[R.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===ue.status&&Ne.push(R.storage.setLastSuccessfulFetchResponse(ue)),yield Promise.all(Ne),ue})()}}function Uu(b=navigator){return b.languages&&b.languages[0]||b.language}class Jn{constructor(T,R,U,X,ue,Ne){this.firebaseInstallations=T,this.sdkVersion=R,this.namespace=U,this.projectId=X,this.apiKey=ue,this.appId=Ne}fetch(T){var R=this;return(0,P.Z)(function*(){var U,X,ue;const[Ne,Xe]=yield Promise.all([R.firebaseInstallations.getId(),R.firebaseInstallations.getToken()]),Dt=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${R.projectId}/namespaces/${R.namespace}:fetch?key=${R.apiKey}`,xt={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":T.eTag||"*"},ot={sdk_version:R.sdkVersion,app_instance_id:Ne,app_instance_id_token:Xe,app_id:R.appId,language_code:Uu()},Bn={method:"POST",headers:xt,body:JSON.stringify(ot)},cr=fetch(Dt,Bn),Ro=new Promise((Ss,Li)=>{T.signal.addEventListener(()=>{const As=new Error("The operation was aborted.");As.name="AbortError",Li(As)})});let ro;try{yield Promise.race([cr,Ro]),ro=yield cr}catch(Ss){let Li="fetch-client-network";throw"AbortError"===(null===(U=Ss)||void 0===U?void 0:U.name)&&(Li="fetch-timeout"),Ln.create(Li,{originalErrorMessage:null===(X=Ss)||void 0===X?void 0:X.message})}let Xi=ro.status;const pa=ro.headers.get("ETag")||void 0;let Ts,ga;if(200===ro.status){let Ss;try{Ss=yield ro.json()}catch(Li){throw Ln.create("fetch-client-parse",{originalErrorMessage:null===(ue=Li)||void 0===ue?void 0:ue.message})}Ts=Ss.entries,ga=Ss.state}if("INSTANCE_STATE_UNSPECIFIED"===ga?Xi=500:"NO_CHANGE"===ga?Xi=304:("NO_TEMPLATE"===ga||"EMPTY_CONFIG"===ga)&&(Ts={}),304!==Xi&&200!==Xi)throw Ln.create("fetch-status",{httpStatus:Xi});return{status:Xi,eTag:pa,config:Ts}})()}}class fs{constructor(T,R){this.client=T,this.storage=R}fetch(T){var R=this;return(0,P.Z)(function*(){const U=(yield R.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return R.attemptFetch(T,U)})()}attemptFetch(T,{throttleEndTimeMillis:R,backoffCount:U}){var X=this;return(0,P.Z)(function*(){yield function ud(b,T){return new Promise((R,U)=>{const X=Math.max(T-Date.now(),0),ue=setTimeout(R,X);b.addEventListener(()=>{clearTimeout(ue),U(Ln.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}(T.signal,R);try{const ue=yield X.client.fetch(T);return yield X.storage.deleteThrottleMetadata(),ue}catch(ue){if(!function dg(b){if(!(b instanceof ce.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}(ue))throw ue;const Ne={throttleEndTimeMillis:Date.now()+(0,ce.$s)(U),backoffCount:U+1};return yield X.storage.setThrottleMetadata(Ne),X.attemptFetch(T,Ne)}})()}}class fg{constructor(T,R,U,X,ue){this.app=T,this._client=R,this._storageCache=U,this._storage=X,this._logger=ue,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function La(b,T){var R;const U=b.target.error||void 0;return Ln.create(T,{originalErrorMessage:U&&(null===(R=U)||void 0===R?void 0:R.message)})}const Ko="app_namespace_store";class dd{constructor(T,R,U,X=function gg(){return new Promise((b,T)=>{var R;try{const U=indexedDB.open("firebase_remote_config",1);U.onerror=X=>{T(La(X,"storage-open"))},U.onsuccess=X=>{b(X.target.result)},U.onupgradeneeded=X=>{0===X.oldVersion&&X.target.result.createObjectStore(Ko,{keyPath:"compositeKey"})}}catch(U){T(Ln.create("storage-open",{originalErrorMessage:null===(R=U)||void 0===R?void 0:R.message}))}})}()){this.appId=T,this.appName=R,this.namespace=U,this.openDbPromise=X}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(T){return this.set("last_fetch_status",T)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(T){return this.set("last_successful_fetch_timestamp_millis",T)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(T){return this.set("last_successful_fetch_response",T)}getActiveConfig(){return this.get("active_config")}setActiveConfig(T){return this.set("active_config",T)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(T){return this.set("active_config_etag",T)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(T){return this.set("throttle_metadata",T)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(T){var R=this;return(0,P.Z)(function*(){const U=yield R.openDbPromise;return new Promise((X,ue)=>{var Ne;const yt=U.transaction([Ko],"readonly").objectStore(Ko),Dt=R.createCompositeKey(T);try{const xt=yt.get(Dt);xt.onerror=ot=>{ue(La(ot,"storage-get"))},xt.onsuccess=ot=>{const Bn=ot.target.result;X(Bn?Bn.value:void 0)}}catch(xt){ue(Ln.create("storage-get",{originalErrorMessage:null===(Ne=xt)||void 0===Ne?void 0:Ne.message}))}})})()}set(T,R){var U=this;return(0,P.Z)(function*(){const X=yield U.openDbPromise;return new Promise((ue,Ne)=>{var Xe;const Dt=X.transaction([Ko],"readwrite").objectStore(Ko),xt=U.createCompositeKey(T);try{const ot=Dt.put({compositeKey:xt,value:R});ot.onerror=Bn=>{Ne(La(Bn,"storage-set"))},ot.onsuccess=()=>{ue()}}catch(ot){Ne(Ln.create("storage-set",{originalErrorMessage:null===(Xe=ot)||void 0===Xe?void 0:Xe.message}))}})})()}delete(T){var R=this;return(0,P.Z)(function*(){const U=yield R.openDbPromise;return new Promise((X,ue)=>{var Ne;const yt=U.transaction([Ko],"readwrite").objectStore(Ko),Dt=R.createCompositeKey(T);try{const xt=yt.delete(Dt);xt.onerror=ot=>{ue(La(ot,"storage-delete"))},xt.onsuccess=()=>{X()}}catch(xt){ue(Ln.create("storage-delete",{originalErrorMessage:null===(Ne=xt)||void 0===Ne?void 0:Ne.message}))}})})()}createCompositeKey(T){return[this.appId,this.appName,this.namespace,T].join()}}class Yo{constructor(T){this.storage=T}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var T=this;return(0,P.Z)(function*(){const R=T.storage.getLastFetchStatus(),U=T.storage.getLastSuccessfulFetchTimestampMillis(),X=T.storage.getActiveConfig(),ue=yield R;ue&&(T.lastFetchStatus=ue);const Ne=yield U;Ne&&(T.lastSuccessfulFetchTimestampMillis=Ne);const Xe=yield X;Xe&&(T.activeConfig=Xe)})()}setLastFetchStatus(T){return this.lastFetchStatus=T,this.storage.setLastFetchStatus(T)}setLastSuccessfulFetchTimestampMillis(T){return this.lastSuccessfulFetchTimestampMillis=T,this.storage.setLastSuccessfulFetchTimestampMillis(T)}setActiveConfig(T){return this.activeConfig=T,this.storage.setActiveConfig(T)}}function oy(){return Va.apply(this,arguments)}function Va(){return(Va=(0,P.Z)(function*(){if(!(0,ce.hl)())return!1;try{return yield(0,ce.eu)()}catch(b){return!1}})).apply(this,arguments)}!function mg(){(0,ae._registerComponent)(new ye.wA("remote-config",function b(T,{instanceIdentifier:R}){const U=T.getProvider("app").getImmediate(),X=T.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw Ln.create("registration-window");if(!(0,ce.hl)())throw Ln.create("indexed-db-unavailable");const{projectId:ue,apiKey:Ne,appId:Xe}=U.options;if(!ue)throw Ln.create("registration-project-id");if(!Ne)throw Ln.create("registration-api-key");if(!Xe)throw Ln.create("registration-app-id");const yt=new dd(Xe,U.name,R=R||"firebase"),Dt=new Yo(yt),xt=new me.Yd(ds);xt.logLevel=me.in.ERROR;const ot=new Jn(X,ae.SDK_VERSION,R,ue,Ne,Xe),Bn=new fs(ot,yt),cr=new ad(Bn,yt,Dt,xt),Ro=new fg(U,cr,Dt,yt,xt);return function mn(b){const T=(0,ce.m9)(b);T._initializePromise||(T._initializePromise=T._storageCache.loadFromStorage().then(()=>{T._isInitializationComplete=!0}))}(Ro),Ro},"PUBLIC").setMultipleInstances(!0)),(0,ae.registerVersion)(ds,"0.3.11"),(0,ae.registerVersion)(ds,"0.3.11","esm2017")}();const Gs="/firebase-messaging-sw.js",Ci="/firebase-cloud-messaging-push-scope",Qo="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Ba="google.c.a.c_id",cf="google.c.a.c_l",_g="google.c.a.ts",qs="google.c.a.e";var gs=(()=>{return(b=gs||(gs={})).PUSH_RECEIVED="push-received",b.NOTIFICATION_CLICKED="notification-clicked",gs;var b})();function ki(b){const T=new Uint8Array(b);return btoa(String.fromCharCode(...T)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function fd(b){const R=(b+"=".repeat((4-b.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),U=atob(R),X=new Uint8Array(U.length);for(let ue=0;ue<U.length;++ue)X[ue]=U.charCodeAt(ue);return X}const Br="fcm_token_details_db",pd="fcm_token_object_Store";function gd(b){return Bu.apply(this,arguments)}function Bu(){return Bu=(0,P.Z)(function*(b){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(ue=>ue.name).includes(Br))return null;let T=null;return(yield(0,le.X3)(Br,5,{upgrade:(U=(0,P.Z)(function*(X,ue,Ne,Xe){var yt;if(ue<2||!X.objectStoreNames.contains(pd))return;const Dt=Xe.objectStore(pd),xt=yield Dt.index("fcmSenderId").get(b);if(yield Dt.clear(),xt)if(2===ue){const ot=xt;if(!ot.auth||!ot.p256dh||!ot.endpoint)return;T={token:ot.fcmToken,createTime:null!==(yt=ot.createTime)&&void 0!==yt?yt:Date.now(),subscriptionOptions:{auth:ot.auth,p256dh:ot.p256dh,endpoint:ot.endpoint,swScope:ot.swScope,vapidKey:"string"==typeof ot.vapidKey?ot.vapidKey:ki(ot.vapidKey)}}}else if(3===ue){const ot=xt;T={token:ot.fcmToken,createTime:ot.createTime,subscriptionOptions:{auth:ki(ot.auth),p256dh:ki(ot.p256dh),endpoint:ot.endpoint,swScope:ot.swScope,vapidKey:ki(ot.vapidKey)}}}else if(4===ue){const ot=xt;T={token:ot.fcmToken,createTime:ot.createTime,subscriptionOptions:{auth:ki(ot.auth),p256dh:ki(ot.p256dh),endpoint:ot.endpoint,swScope:ot.swScope,vapidKey:ki(ot.vapidKey)}}}}),function(ue,Ne,Xe,yt){return U.apply(this,arguments)})})).close(),yield(0,le.Lj)(Br),yield(0,le.Lj)("fcm_vapid_details_db"),yield(0,le.Lj)("undefined"),ju(T)?T:null;var U}),Bu.apply(this,arguments)}function ju(b){if(!b||!b.subscriptionOptions)return!1;const{subscriptionOptions:T}=b;return"number"==typeof b.createTime&&b.createTime>0&&"string"==typeof b.token&&b.token.length>0&&"string"==typeof T.auth&&T.auth.length>0&&"string"==typeof T.p256dh&&T.p256dh.length>0&&"string"==typeof T.endpoint&&T.endpoint.length>0&&"string"==typeof T.swScope&&T.swScope.length>0&&"string"==typeof T.vapidKey&&T.vapidKey.length>0}const ms="firebase-messaging-store";let $l=null;function wn(){return $l||($l=(0,le.X3)("firebase-messaging-database",1,{upgrade:(b,T)=>{0===T&&b.createObjectStore(ms)}})),$l}function ja(b){return Ws.apply(this,arguments)}function Ws(){return(Ws=(0,P.Z)(function*(b){const T=yr(b),U=yield(yield wn()).transaction(ms).objectStore(ms).get(T);if(U)return U;{const X=yield gd(b.appConfig.senderId);if(X)return yield _n(b,X),X}})).apply(this,arguments)}function _n(b,T){return $u.apply(this,arguments)}function $u(){return($u=(0,P.Z)(function*(b,T){const R=yr(b),X=(yield wn()).transaction(ms,"readwrite");return yield X.objectStore(ms).put(T,R),yield X.done,T})).apply(this,arguments)}function Ha(b){return vo.apply(this,arguments)}function vo(){return(vo=(0,P.Z)(function*(b){const T=yr(b),U=(yield wn()).transaction(ms,"readwrite");yield U.objectStore(ms).delete(T),yield U.done})).apply(this,arguments)}function yr({appConfig:b}){return b.appId}const Vn=new ce.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function _s(b,T){return vr.apply(this,arguments)}function vr(){return(vr=(0,P.Z)(function*(b,T){var R;const U=yield Zs(b),X=wo(T),ue={method:"POST",headers:U,body:JSON.stringify(X)};let Ne;try{Ne=yield(yield fetch(zs(b.appConfig),ue)).json()}catch(Xe){throw Vn.create("token-subscribe-failed",{errorInfo:null===(R=Xe)||void 0===R?void 0:R.toString()})}if(Ne.error)throw Vn.create("token-subscribe-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw Vn.create("token-subscribe-no-token");return Ne.token})).apply(this,arguments)}function Jo(b,T){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,P.Z)(function*(b,T){var R;const U=yield Zs(b),X=wo(T.subscriptionOptions),ue={method:"PATCH",headers:U,body:JSON.stringify(X)};let Ne;try{Ne=yield(yield fetch(`${zs(b.appConfig)}/${T.token}`,ue)).json()}catch(Xe){throw Vn.create("token-update-failed",{errorInfo:null===(R=Xe)||void 0===R?void 0:R.toString()})}if(Ne.error)throw Vn.create("token-update-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw Vn.create("token-update-no-token");return Ne.token})).apply(this,arguments)}function Gl(b,T){return ui.apply(this,arguments)}function ui(){return(ui=(0,P.Z)(function*(b,T){var R;const X={method:"DELETE",headers:yield Zs(b)};try{const Ne=yield(yield fetch(`${zs(b.appConfig)}/${T}`,X)).json();if(Ne.error)throw Vn.create("token-unsubscribe-failed",{errorInfo:Ne.error.message})}catch(ue){throw Vn.create("token-unsubscribe-failed",{errorInfo:null===(R=ue)||void 0===R?void 0:R.toString()})}})).apply(this,arguments)}function zs({projectId:b}){return`https://fcmregistrations.googleapis.com/v1/projects/${b}/registrations`}function Zs(b){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,P.Z)(function*({appConfig:b,installations:T}){const R=yield T.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b.apiKey,"x-goog-firebase-installations-auth":`FIS ${R}`})})).apply(this,arguments)}function wo({p256dh:b,auth:T,endpoint:R,vapidKey:U}){const X={web:{endpoint:R,auth:T,p256dh:b}};return U!==Qo&&(X.web.applicationPubKey=U),X}const qu=6048e5;function md(b){return $a.apply(this,arguments)}function $a(){return($a=(0,P.Z)(function*(b){const T=yield Wu(b.swRegistration,b.vapidKey),R={vapidKey:b.vapidKey,swScope:b.swRegistration.scope,endpoint:T.endpoint,auth:ki(T.getKey("auth")),p256dh:ki(T.getKey("p256dh"))},U=yield ja(b.firebaseDependencies);if(U){if(yd(U.subscriptionOptions,R))return Date.now()>=U.createTime+qu?df(b,{token:U.token,createTime:Date.now(),subscriptionOptions:R}):U.token;try{yield Gl(b.firebaseDependencies,U.token)}catch(X){console.warn(X)}return ke(b.firebaseDependencies,R)}return ke(b.firebaseDependencies,R)})).apply(this,arguments)}function _d(b){return Xo.apply(this,arguments)}function Xo(){return(Xo=(0,P.Z)(function*(b){const T=yield ja(b.firebaseDependencies);T&&(yield Gl(b.firebaseDependencies,T.token),yield Ha(b.firebaseDependencies));const R=yield b.swRegistration.pushManager.getSubscription();return!R||R.unsubscribe()})).apply(this,arguments)}function df(b,T){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,P.Z)(function*(b,T){try{const R=yield Jo(b.firebaseDependencies,T),U=Object.assign(Object.assign({},T),{token:R,createTime:Date.now()});return yield _n(b.firebaseDependencies,U),R}catch(R){throw yield _d(b),R}})).apply(this,arguments)}function ke(b,T){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,P.Z)(function*(b,T){const U={token:yield _s(b,T),createTime:Date.now(),subscriptionOptions:T};return yield _n(b,U),U.token})).apply(this,arguments)}function Wu(b,T){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,P.Z)(function*(b,T){return(yield b.pushManager.getSubscription())||b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:fd(T)})})).apply(this,arguments)}function yd(b,T){return T.vapidKey===b.vapidKey&&T.endpoint===b.endpoint&&T.auth===b.auth&&T.p256dh===b.p256dh}function ys(b){const T={from:b.from,collapseKey:b.collapse_key,messageId:b.fcmMessageId};return function zi(b,T){if(!T.notification)return;b.notification={};const R=T.notification.title;R&&(b.notification.title=R);const U=T.notification.body;U&&(b.notification.body=U);const X=T.notification.image;X&&(b.notification.image=X)}(T,b),function ql(b,T){!T.data||(b.data=T.data)}(T,b),function Ga(b,T){var R,U,X,ue,Ne;if(!T.fcmOptions&&!(null===(R=T.notification)||void 0===R?void 0:R.click_action))return;b.fcmOptions={};const Xe=null!==(X=null===(U=T.fcmOptions)||void 0===U?void 0:U.link)&&void 0!==X?X:null===(ue=T.notification)||void 0===ue?void 0:ue.click_action;Xe&&(b.fcmOptions.link=Xe);const yt=null===(Ne=T.fcmOptions)||void 0===Ne?void 0:Ne.analytics_label;yt&&(b.fcmOptions.analyticsLabel=yt)}(T,b),T}function hf(b){return"object"==typeof b&&!!b&&Ba in b}function vd(b,T){const R=[];for(let U=0;U<b.length;U++)R.push(b.charAt(U)),U<T.length&&R.push(T.charAt(U));return R.join("")}function Eo(b){return Vn.create("missing-app-config-values",{valueName:b})}vd("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),vd("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class wr{constructor(T,R,U){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const X=function wd(b){if(!b||!b.options)throw Eo("App Configuration Object");if(!b.name)throw Eo("App Name");const T=["projectId","apiKey","appId","messagingSenderId"],{options:R}=b;for(const U of T)if(!R[U])throw Eo(U);return{appName:b.name,projectId:R.projectId,apiKey:R.apiKey,appId:R.appId,senderId:R.messagingSenderId}}(T);this.firebaseDependencies={app:T,appConfig:X,installations:R,analyticsProvider:U}}_delete(){return Promise.resolve()}}function Zi(b){return ea.apply(this,arguments)}function ea(){return(ea=(0,P.Z)(function*(b){var T;try{b.swRegistration=yield navigator.serviceWorker.register(Gs,{scope:Ci}),b.swRegistration.update().catch(()=>{})}catch(R){throw Vn.create("failed-service-worker-registration",{browserErrorMessage:null===(T=R)||void 0===T?void 0:T.message})}})).apply(this,arguments)}function ta(b,T){return li.apply(this,arguments)}function li(){return(li=(0,P.Z)(function*(b,T){if(!T&&!b.swRegistration&&(yield Zi(b)),T||!b.swRegistration){if(!(T instanceof ServiceWorkerRegistration))throw Vn.create("invalid-sw-registration");b.swRegistration=T}})).apply(this,arguments)}function ff(b,T){return na.apply(this,arguments)}function na(){return(na=(0,P.Z)(function*(b,T){T?b.vapidKey=T:b.vapidKey||(b.vapidKey=Qo)})).apply(this,arguments)}function qa(){return(qa=(0,P.Z)(function*(b,T){if(!navigator)throw Vn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Vn.create("permission-blocked");return yield ff(b,null==T?void 0:T.vapidKey),yield ta(b,null==T?void 0:T.serviceWorkerRegistration),md(b)})).apply(this,arguments)}function Wl(b,T,R){return ra.apply(this,arguments)}function ra(){return(ra=(0,P.Z)(function*(b,T,R){const U=Id(T);(yield b.firebaseDependencies.analyticsProvider.get()).logEvent(U,{message_id:R[Ba],message_name:R[cf],message_time:R[_g],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Id(b){switch(b){case gs.NOTIFICATION_CLICKED:return"notification_open";case gs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function zl(){return(zl=(0,P.Z)(function*(b,T){const R=T.data;if(!R.isFirebaseMessaging)return;b.onMessageHandler&&R.messageType===gs.PUSH_RECEIVED&&("function"==typeof b.onMessageHandler?b.onMessageHandler(ys(R)):b.onMessageHandler.next(ys(R)));const U=R.data;hf(U)&&"1"===U[qs]&&(yield Wl(b,R.messageType,U))})).apply(this,arguments)}const Wa="@firebase/messaging",Io=b=>{const T=new wr(b.getProvider("app").getImmediate(),b.getProvider("installations-internal").getImmediate(),b.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",R=>function Cd(b,T){return zl.apply(this,arguments)}(T,R)),T},bd=b=>{const T=b.getProvider("messaging").getImmediate();return{getToken:U=>function Ed(b,T){return qa.apply(this,arguments)}(T,U)}};function zu(){return ci.apply(this,arguments)}function ci(){return(ci=(0,P.Z)(function*(){try{yield(0,ce.eu)()}catch(b){return!1}return"undefined"!=typeof window&&(0,ce.hl)()&&(0,ce.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function pf(){(0,ae._registerComponent)(new ye.wA("messaging",Io,"PUBLIC")),(0,ae._registerComponent)(new ye.wA("messaging-internal",bd,"PRIVATE")),(0,ae.registerVersion)(Wa,"0.9.16"),(0,ae.registerVersion)(Wa,"0.9.16","esm2017")}();const Dd="analytics",yg="firebase_id",Za="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ka="https://www.googletagmanager.com/gtag/js",ur=new me.Yd("@firebase/analytics");function Sd(b){return Promise.all(b.map(T=>T.catch(R=>R)))}function vg(b,T){const R=document.createElement("script");R.src=`${Ka}?l=${b}&id=${T}`,R.async=!0,document.head.appendChild(R)}function ia(b,T,R,U,X,ue){return Ad.apply(this,arguments)}function Ad(){return(Ad=(0,P.Z)(function*(b,T,R,U,X,ue){const Ne=U[X];try{if(Ne)yield T[Ne];else{const yt=(yield Sd(R)).find(Dt=>Dt.measurementId===X);yt&&(yield T[yt.appId])}}catch(Xe){ur.error(Xe)}b("config",X,ue)})).apply(this,arguments)}function Kl(b,T,R,U,X){return bo.apply(this,arguments)}function bo(){return(bo=(0,P.Z)(function*(b,T,R,U,X){try{let ue=[];if(X&&X.send_to){let Ne=X.send_to;Array.isArray(Ne)||(Ne=[Ne]);const Xe=yield Sd(R);for(const yt of Ne){const Dt=Xe.find(ot=>ot.measurementId===yt),xt=Dt&&T[Dt.appId];if(!xt){ue=[];break}ue.push(xt)}}0===ue.length&&(ue=Object.values(T)),yield Promise.all(ue),b("event",U,X||{})}catch(ue){ur.error(ue)}})).apply(this,arguments)}function En(){const b=window.document.getElementsByTagName("script");for(const T of Object.values(b))if(T.src&&T.src.includes(Ka))return T;return null}const di=new ce.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),sa=new class Jl{constructor(T={},R=1e3){this.throttleMetadata=T,this.intervalMillis=R}getThrottleMetadata(T){return this.throttleMetadata[T]}setThrottleMetadata(T,R){this.throttleMetadata[T]=R}deleteThrottleMetadata(T){delete this.throttleMetadata[T]}};function oa(b){return new Headers({Accept:"application/json","x-goog-api-key":b})}function aa(b){return sn.apply(this,arguments)}function sn(){return(sn=(0,P.Z)(function*(b){var T;const{appId:R,apiKey:U}=b,X={method:"GET",headers:oa(U)},ue=Za.replace("{app-id}",R),Ne=yield fetch(ue,X);if(200!==Ne.status&&304!==Ne.status){let Xe="";try{const yt=yield Ne.json();(null===(T=yt.error)||void 0===T?void 0:T.message)&&(Xe=yt.error.message)}catch(yt){}throw di.create("config-fetch-failed",{httpStatus:Ne.status,responseMessage:Xe})}return Ne.json()})).apply(this,arguments)}function er(b){return wt.apply(this,arguments)}function wt(){return(wt=(0,P.Z)(function*(b,T=sa,R){const{appId:U,apiKey:X,measurementId:ue}=b.options;if(!U)throw di.create("no-app-id");if(!X){if(ue)return{measurementId:ue,appId:U};throw di.create("no-api-key")}const Ne=T.getThrottleMetadata(U)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Xe=new ec;return setTimeout((0,P.Z)(function*(){Xe.abort()}),void 0!==R?R:6e4),Ku({appId:U,apiKey:X,measurementId:ue},Ne,Xe,T)})).apply(this,arguments)}function Ku(b,T,R){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,P.Z)(function*(b,{throttleEndTimeMillis:T,backoffCount:R},U,X=sa){var ue,Ne;const{appId:Xe,measurementId:yt}=b;try{yield _f(U,T)}catch(Dt){if(yt)return ur.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${yt} provided in the "measurementId" field in the local Firebase config. [${null===(ue=Dt)||void 0===ue?void 0:ue.message}]`),{appId:Xe,measurementId:yt};throw Dt}try{const Dt=yield aa(b);return X.deleteThrottleMetadata(Xe),Dt}catch(Dt){const xt=Dt;if(!Xl(xt)){if(X.deleteThrottleMetadata(Xe),yt)return ur.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${yt} provided in the "measurementId" field in the local Firebase config. [${null==xt?void 0:xt.message}]`),{appId:Xe,measurementId:yt};throw Dt}const ot=503===Number(null===(Ne=null==xt?void 0:xt.customData)||void 0===Ne?void 0:Ne.httpStatus)?(0,ce.$s)(R,X.intervalMillis,30):(0,ce.$s)(R,X.intervalMillis),Bn={throttleEndTimeMillis:Date.now()+ot,backoffCount:R+1};return X.setThrottleMetadata(Xe,Bn),ur.debug(`Calling attemptFetch again in ${ot} millis`),Ku(b,Bn,U,X)}})).apply(this,arguments)}function _f(b,T){return new Promise((R,U)=>{const X=Math.max(T-Date.now(),0),ue=setTimeout(R,X);b.addEventListener(()=>{clearTimeout(ue),U(di.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}function Xl(b){if(!(b instanceof ce.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}class ec{constructor(){this.listeners=[]}addEventListener(T){this.listeners.push(T)}abort(){this.listeners.forEach(T=>T())}}let Yu,Wn;function Er(){return(Er=(0,P.Z)(function*(b,T,R,U,X){if(X&&X.global)b("event",R,U);else{const ue=yield T;b("event",R,Object.assign(Object.assign({},U),{send_to:ue}))}})).apply(this,arguments)}function bs(b){Wn=b}function Rd(b){Yu=b}function ua(){return Ds.apply(this,arguments)}function Ds(){return(Ds=(0,P.Z)(function*(){var b;if(!(0,ce.hl)())return ur.warn(di.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ce.eu)()}catch(T){return ur.warn(di.create("indexeddb-unavailable",{errorInfo:null===(b=T)||void 0===b?void 0:b.toString()}).message),!1}return!0})).apply(this,arguments)}function Ya(){return(Ya=(0,P.Z)(function*(b,T,R,U,X,ue,Ne){var Xe;const yt=er(b);yt.then(cr=>{R[cr.measurementId]=cr.appId,b.options.measurementId&&cr.measurementId!==b.options.measurementId&&ur.warn(`The measurement ID in the local Firebase config (${b.options.measurementId}) does not match the measurement ID fetched from the server (${cr.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(cr=>ur.error(cr)),T.push(yt);const Dt=ua().then(cr=>{if(cr)return U.getId()}),[xt,ot]=yield Promise.all([yt,Dt]);En()||vg(ue,xt.measurementId),Wn&&(X("consent","default",Wn),bs(void 0)),X("js",new Date);const Bn=null!==(Xe=null==Ne?void 0:Ne.config)&&void 0!==Xe?Xe:{};return Bn.origin="firebase",Bn.update=!0,null!=ot&&(Bn[yg]=ot),X("config",xt.measurementId,Bn),Yu&&(X("set",Yu),Rd(void 0)),xt.measurementId})).apply(this,arguments)}class tc{constructor(T){this.app=T}_delete(){return delete Ir[this.app.options.appId],Promise.resolve()}}let Ir={},Ju=[];const la={};let Xs,lr,Js="dataLayer",Qa=!1;function rc(b,T,R){!function ca(){const b=[];if((0,ce.ru)()&&b.push("This is a browser extension environment."),(0,ce.zI)()||b.push("Cookies are not available."),b.length>0){const T=b.map((U,X)=>`(${X+1}) ${U}`).join(" "),R=di.create("invalid-analytics-context",{errorInfo:T});ur.warn(R.message)}}();const U=b.options.appId;if(!U)throw di.create("no-app-id");if(!b.options.apiKey){if(!b.options.measurementId)throw di.create("no-api-key");ur.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${b.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ir[U])throw di.create("already-exists",{id:U});if(!Qa){!function ws(b){let T=[];Array.isArray(window[b])?T=window[b]:window[b]=T}(Js);const{wrappedGtag:ue,gtagCore:Ne}=function wg(b,T,R,U,X){let ue=function(...Ne){window[U].push(arguments)};return window[X]&&"function"==typeof window[X]&&(ue=window[X]),window[X]=function Yl(b,T,R,U){function ue(){return(ue=(0,P.Z)(function*(Ne,Xe,yt){try{"event"===Ne?yield Kl(b,T,R,Xe,yt):"config"===Ne?yield ia(b,T,R,U,Xe,yt):"consent"===Ne?b("consent","update",yt):b("set",Xe)}catch(Dt){ur.error(Dt)}})).apply(this,arguments)}return function X(Ne,Xe,yt){return ue.apply(this,arguments)}}(ue,b,T,R),{gtagCore:ue,wrappedGtag:window[X]}}(Ir,Ju,la,Js,"gtag");lr=ue,Xs=Ne,Qa=!0}return Ir[U]=function Md(b,T,R,U,X,ue,Ne){return Ya.apply(this,arguments)}(b,Ju,la,T,Xs,Js,R),new tc(b)}function Nd(){return Xu.apply(this,arguments)}function Xu(){return(Xu=(0,P.Z)(function*(){if((0,ce.ru)()||!(0,ce.zI)()||!(0,ce.hl)())return!1;try{return yield(0,ce.eu)()}catch(b){return!1}})).apply(this,arguments)}const Mn="@firebase/analytics";!function Un(){(0,ae._registerComponent)(new ye.wA(Dd,(T,{options:R})=>rc(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),R),"PUBLIC")),(0,ae._registerComponent)(new ye.wA("analytics-internal",function b(T){try{const R=T.getProvider(Dd).getImmediate();return{logEvent:(U,X,ue)=>function eo(b,T,R,U){b=(0,ce.m9)(b),function Ki(b,T,R,U,X){return Er.apply(this,arguments)}(lr,Ir[b.app.options.appId],T,R,U).catch(X=>ur.error(X))}(R,U,X,ue)}}catch(R){throw di.create("interop-component-reg-failed",{reason:R})}},"PRIVATE")),(0,ae.registerVersion)(Mn,"0.8.0"),(0,ae.registerVersion)(Mn,"0.8.0","esm2017")}();var Ef=F(4408),Yr=F(7565);const Ja=new class Qr extends Yr.v{}(class Od extends Ef.o{constructor(T,R){super(T,R),this.scheduler=T,this.work=R}schedule(T,R=0){return R>0?super.schedule(T,R):(this.delay=R,this.state=T,this.scheduler.flush(this),this)}execute(T,R){return R>0||this.closed?super.execute(T,R):this._execute(T,R)}requestAsyncId(T,R,U=0){return null!=U&&U>0||null==U&&this.delay>0?super.requestAsyncId(T,R,U):T.flush(this)}});var to=F(4986),no=F(8505),da=F(5363),If=F(9468);const uy=new f.GfV("7.4.1"),Cf="__angularfire_symbol__analyticsIsSupportedValue",Xa="__angularfire_symbol__analyticsIsSupported",Hr="__angularfire_symbol__remoteConfigIsSupportedValue",el="__angularfire_symbol__remoteConfigIsSupported",Ao="__angularfire_symbol__messagingIsSupportedValue",tl="__angularfire_symbol__messagingIsSupported";function ha(b,T,R){if(T){if(1===T.length)return T[0];const ue=T.filter(Ne=>Ne.app===R);if(1===ue.length)return ue[0]}return R.container.getProvider(b).getImmediate({optional:!0})}globalThis[Xa]||(globalThis[Xa]=Nd().then(b=>globalThis[Cf]=b).catch(()=>globalThis[Cf]=!1)),globalThis[tl]||(globalThis[tl]=zu().then(b=>globalThis[Ao]=b).catch(()=>globalThis[Ao]=!1)),globalThis[el]||(globalThis[el]=oy().then(b=>globalThis[Hr]=b).catch(()=>globalThis[Hr]=!1));const tu=(b,T)=>{const R=T?[T]:(0,j.C6)(),U=[];return R.forEach(X=>{X.container.getProvider(b).instances.forEach(Ne=>{U.includes(Ne)||U.push(Ne)})}),U};function Jr(){}class xo{constructor(T,R=Ja){this.zone=T,this.delegate=R}now(){return this.delegate.now()}schedule(T,R,U){const X=this.zone;return this.delegate.schedule(function(Ne){X.runGuarded(()=>{T.apply(this,[Ne])})},R,U)}}class nl{constructor(T){this.zone=T,this.task=null}call(T,R){const U=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Jr,{},Jr,Jr)),R.pipe((0,no.b)({next:U,complete:U,error:U})).subscribe(T).add(U)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let rl=(()=>{class b{constructor(R){this.ngZone=R,this.outsideAngular=R.runOutsideAngular(()=>new xo(Zone.current)),this.insideAngular=R.run(()=>new xo(Zone.current,to.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return b.\u0275fac=function(R){return new(R||b)(f.LFG(f.R0b))},b.\u0275prov=f.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})();function Ar(){const b=globalThis.\u0275AngularFireScheduler;if(!b)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return b}function ic(b){return b.pipe((0,da.Q)(Ar().outsideAngular))}function il(b){return Ar(),function Ld(b){return function(R){return(R=R.lift(new nl(b.ngZone))).pipe((0,If.R)(b.outsideAngular),(0,da.Q)(b.insideAngular))}}(Ar())(b)}},8554:(nt,be,F)=>{F.d(be,{$:()=>zs,A:()=>q,B:()=>Pe,G:()=>vn,H:()=>dn,J:()=>fs,L:()=>rn,M:()=>Va,N:()=>Ua,P:()=>to,Q:()=>Ba,R:()=>wf,T:()=>cf,U:()=>Qo,V:()=>gs,W:()=>ki,X:()=>gd,Y:()=>Gu,Z:()=>_s,_:()=>Jo,a:()=>Zu,a0:()=>md,a1:()=>_d,a2:()=>df,a3:()=>ke,a4:()=>Wu,a5:()=>yd,a6:()=>zi,a7:()=>ql,a8:()=>hf,a9:()=>vd,aA:()=>cr,aB:()=>yt,aC:()=>ic,aD:()=>Ji,aE:()=>je,aI:()=>oa,aL:()=>qs,aa:()=>Zi,ab:()=>ta,ac:()=>ff,af:()=>Wl,ag:()=>Id,ah:()=>Cd,ak:()=>ms,al:()=>Zl,an:()=>Ka,ao:()=>Ad,ap:()=>Gn,aq:()=>Ce,ar:()=>Ut,as:()=>ht,at:()=>We,au:()=>jd,av:()=>pa,aw:()=>Fe,ax:()=>re,ay:()=>ie,az:()=>Xt,b:()=>di,c:()=>Ao,d:()=>bg,e:()=>eu,f:()=>Ld,g:()=>U,h:()=>b,i:()=>Ds,j:()=>Ne,k:()=>xg,l:()=>Fi,m:()=>my,o:()=>le,r:()=>Ef,s:()=>Cg,u:()=>Ja});var f=F(5861),j=F(2090),P=F(9681),ae=F(655),ce=F(1877),ye=F(4859);const le={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},q={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Pe=function se(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ve=function qe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ge=new j.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Te=new ce.Yd("@firebase/auth");function Ze(w,...g){Te.logLevel<=ce.in.ERROR&&Te.error(`Auth (${P.SDK_VERSION}): ${w}`,...g)}function We(w,...g){throw ze(w,...g)}function Fe(w,...g){return ze(w,...g)}function Me(w,g,_){const I=Object.assign(Object.assign({},Ve()),{[g]:_});return new j.LL("auth","Firebase",I).create(g,{appName:w.name})}function De(w,g,_){if(!(g instanceof _))throw _.name!==g.constructor.name&&We(w,"argument-error"),Me(w,"argument-error",`Type of ${g.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ze(w,...g){if("string"!=typeof w){const _=g[0],I=[...g.slice(1)];return I[0]&&(I[0].appName=w.name),w._errorFactory.create(_,...I)}return Ge.create(w,...g)}function re(w,g,..._){if(!w)throw ze(g,..._)}function ge(w){const g="INTERNAL ASSERTION FAILED: "+w;throw Ze(g),new Error(g)}function Ce(w,g){w||ge(g)}const J=new Map;function ie(w){Ce(w instanceof Function,"Expected a class definition");let g=J.get(w);return g?(Ce(g instanceof w,"Instance stored in cache mismatched with class"),g):(g=new w,J.set(w,g),g)}function de(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function Ue(){return"http:"===_t()||"https:"===_t()}function _t(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class Ye{constructor(g,_){this.shortDelay=g,this.longDelay=_,Ce(_>g,"Short delay should be less than long delay!"),this.isMobile=(0,j.uI)()||(0,j.b$)()}get(){return function Qt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Ue()||(0,j.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function pn(w,g){Ce(w.emulator,"Emulator should always be set here");const{url:_}=w.emulator;return g?`${_}${g.startsWith("/")?g.slice(1):g}`:_}class On{static initialize(g,_,I){this.fetchImpl=g,_&&(this.headersImpl=_),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ge("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ge("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ge("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},nn=new Ye(3e4,6e4);function Vt(w,g){return w.tenantId&&!g.tenantId?Object.assign(Object.assign({},g),{tenantId:w.tenantId}):g}function Jt(w,g,_,I){return Dn.apply(this,arguments)}function Dn(){return(Dn=(0,f.Z)(function*(w,g,_,I,x={}){return Mi(w,x,(0,f.Z)(function*(){let k={},ne={};I&&("GET"===g?ne=I:k={body:JSON.stringify(I)});const xe=(0,j.xO)(Object.assign({key:w.config.apiKey},ne)).slice(1),tt=yield w._getAdditionalHeaders();return tt["Content-Type"]="application/json",w.languageCode&&(tt["X-Firebase-Locale"]=w.languageCode),On.fetch()(yi(w,w.config.apiHost,_,xe),Object.assign({method:g,headers:tt,referrerPolicy:"no-referrer"},k))}))})).apply(this,arguments)}function Mi(w,g,_){return Fr.apply(this,arguments)}function Fr(){return(Fr=(0,f.Z)(function*(w,g,_){w._canInitEmulator=!1;const I=Object.assign(Object.assign({},gn),g);try{const x=new Ni(w),k=yield Promise.race([_(),x.promise]);x.clearNetworkTimeout();const ne=yield k.json();if("needConfirmation"in ne)throw kn(w,"account-exists-with-different-credential",ne);if(k.ok&&!("errorMessage"in ne))return ne;{const xe=k.ok?ne.errorMessage:ne.error.message,[tt,Et]=xe.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===tt)throw kn(w,"credential-already-in-use",ne);if("EMAIL_EXISTS"===tt)throw kn(w,"email-already-in-use",ne);if("USER_DISABLED"===tt)throw kn(w,"user-disabled",ne);const qt=I[tt]||tt.toLowerCase().replace(/[_\s]+/g,"-");if(Et)throw Me(w,qt,Et);We(w,qt)}}catch(x){if(x instanceof j.ZR)throw x;We(w,"network-request-failed")}})).apply(this,arguments)}function Rn(w,g,_,I){return ls.apply(this,arguments)}function ls(){return(ls=(0,f.Z)(function*(w,g,_,I,x={}){const k=yield Jt(w,g,_,I,x);return"mfaPendingCredential"in k&&We(w,"multi-factor-auth-required",{_serverResponse:k}),k})).apply(this,arguments)}function yi(w,g,_,I){const x=`${g}${_}?${I}`;return w.config.emulator?pn(w.config,x):`${w.config.apiScheme}://${x}`}class Ni{constructor(g){this.auth=g,this.timer=null,this.promise=new Promise((_,I)=>{this.timer=setTimeout(()=>I(Fe(this.auth,"network-request-failed")),nn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function kn(w,g,_){const I={appName:w.name};_.email&&(I.email=_.email),_.phoneNumber&&(I.phoneNumber=_.phoneNumber);const x=Fe(w,g,I);return x.customData._tokenResponse=_,x}function vt(){return(vt=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:delete",g)})).apply(this,arguments)}function Lr(w,g){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function un(w,g){return ir.apply(this,arguments)}function ir(){return(ir=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:lookup",g)})).apply(this,arguments)}function Vr(w){if(w)try{const g=new Date(Number(w));if(!isNaN(g.getTime()))return g.toUTCString()}catch(g){}}function or(){return(or=(0,f.Z)(function*(w,g=!1){const _=(0,j.m9)(w),I=yield _.getIdToken(g),x=Ht(I);re(x&&x.exp&&x.auth_time&&x.iat,_.auth,"internal-error");const k="object"==typeof x.firebase?x.firebase:void 0,ne=null==k?void 0:k.sign_in_provider;return{claims:x,token:I,authTime:Vr(cs(x.auth_time)),issuedAtTime:Vr(cs(x.iat)),expirationTime:Vr(cs(x.exp)),signInProvider:ne||null,signInSecondFactor:(null==k?void 0:k.sign_in_second_factor)||null}})).apply(this,arguments)}function cs(w){return 1e3*Number(w)}function Ht(w){var g;const[_,I,x]=w.split(".");if(void 0===_||void 0===I||void 0===x)return Ze("JWT malformed, contained fewer than 3 sections"),null;try{const k=(0,j.tV)(I);return k?JSON.parse(k):(Ze("Failed to decode base64 JWT payload"),null)}catch(k){return Ze("Caught error parsing JWT payload as JSON",null===(g=k)||void 0===g?void 0:g.toString()),null}}function rt(w,g){return vi.apply(this,arguments)}function vi(){return(vi=(0,f.Z)(function*(w,g,_=!1){if(_)return g;try{return yield g}catch(I){throw I instanceof j.ZR&&wi(I)&&w.auth.currentUser===w&&(yield w.auth.signOut()),I}})).apply(this,arguments)}function wi({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}class $t{constructor(g){this.user=g,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(g){var _;if(g){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const x=(null!==(_=this.user.stsTokenManager.expirationTime)&&void 0!==_?_:0)-Date.now()-3e5;return Math.max(0,x)}}schedule(g=!1){var _=this;if(!this.isRunning)return;const I=this.getInterval(g);this.timerId=setTimeout((0,f.Z)(function*(){yield _.iteration()}),I)}iteration(){var g=this;return(0,f.Z)(function*(){var _;try{yield g.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===(null===(_=I)||void 0===_?void 0:_.code)&&g.schedule(!0))}g.schedule()})()}}class Pi{constructor(g,_){this.createdAt=g,this.lastLoginAt=_,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vr(this.lastLoginAt),this.creationTime=Vr(this.createdAt)}_copy(g){this.createdAt=g.createdAt,this.lastLoginAt=g.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Fn(w){return yn.apply(this,arguments)}function yn(){return(yn=(0,f.Z)(function*(w){var g;const _=w.auth,I=yield w.getIdToken(),x=yield rt(w,un(_,{idToken:I}));re(null==x?void 0:x.users.length,_,"internal-error");const k=x.users[0];w._notifyReloadListener(k);const ne=(null===(g=k.providerUserInfo)||void 0===g?void 0:g.length)?H(k.providerUserInfo):[],xe=z(w.providerData,ne),qt=!!w.isAnonymous&&!(w.email&&k.passwordHash||(null==xe?void 0:xe.length)),zn={uid:k.localId,displayName:k.displayName||null,photoURL:k.photoUrl||null,email:k.email||null,emailVerified:k.emailVerified||!1,phoneNumber:k.phoneNumber||null,tenantId:k.tenantId||null,providerData:xe,metadata:new Pi(k.createdAt,k.lastLoginAt),isAnonymous:qt};Object.assign(w,zn)})).apply(this,arguments)}function zr(){return(zr=(0,f.Z)(function*(w){const g=(0,j.m9)(w);yield Fn(g),yield g.auth._persistUserIfCurrent(g),g.auth._notifyListenersIfCurrent(g)})).apply(this,arguments)}function z(w,g){return[...w.filter(I=>!g.some(x=>x.providerId===I.providerId)),...g]}function H(w){return w.map(g=>{var{providerId:_}=g,I=(0,ae._T)(g,["providerId"]);return{providerId:_,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}function $(){return($=(0,f.Z)(function*(w,g){const _=yield Mi(w,{},(0,f.Z)(function*(){const I=(0,j.xO)({grant_type:"refresh_token",refresh_token:g}).slice(1),{tokenApiHost:x,apiKey:k}=w.config,ne=yi(w,x,"/v1/token",`key=${k}`),xe=yield w._getAdditionalHeaders();return xe["Content-Type"]="application/x-www-form-urlencoded",On.fetch()(ne,{method:"POST",headers:xe,body:I})}));return{accessToken:_.access_token,expiresIn:_.expires_in,refreshToken:_.refresh_token}})).apply(this,arguments)}class Z{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(g){re(g.idToken,"internal-error"),re(void 0!==g.idToken,"internal-error"),re(void 0!==g.refreshToken,"internal-error");const _="expiresIn"in g&&void 0!==g.expiresIn?Number(g.expiresIn):function gt(w){const g=Ht(w);return re(g,"internal-error"),re(void 0!==g.exp,"internal-error"),re(void 0!==g.iat,"internal-error"),Number(g.exp)-Number(g.iat)}(g.idToken);this.updateTokensAndExpiration(g.idToken,g.refreshToken,_)}getToken(g,_=!1){var I=this;return(0,f.Z)(function*(){return re(!I.accessToken||I.refreshToken,g,"user-token-expired"),_||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(g,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(g,_){var I=this;return(0,f.Z)(function*(){const{accessToken:x,refreshToken:k,expiresIn:ne}=yield function B(w,g){return $.apply(this,arguments)}(g,_);I.updateTokensAndExpiration(x,k,Number(ne))})()}updateTokensAndExpiration(g,_,I){this.refreshToken=_||null,this.accessToken=g||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(g,_){const{refreshToken:I,accessToken:x,expirationTime:k}=_,ne=new Z;return I&&(re("string"==typeof I,"internal-error",{appName:g}),ne.refreshToken=I),x&&(re("string"==typeof x,"internal-error",{appName:g}),ne.accessToken=x),k&&(re("number"==typeof k,"internal-error",{appName:g}),ne.expirationTime=k),ne}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(g){this.accessToken=g.accessToken,this.refreshToken=g.refreshToken,this.expirationTime=g.expirationTime}_clone(){return Object.assign(new Z,this.toJSON())}_performRefresh(){return ge("not implemented")}}function Re(w,g){re("string"==typeof w||void 0===w,"internal-error",{appName:g})}class $e{constructor(g){var{uid:_,auth:I,stsTokenManager:x}=g,k=(0,ae._T)(g,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $t(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=_,this.auth=I,this.stsTokenManager=x,this.accessToken=x.accessToken,this.displayName=k.displayName||null,this.email=k.email||null,this.emailVerified=k.emailVerified||!1,this.phoneNumber=k.phoneNumber||null,this.photoURL=k.photoURL||null,this.isAnonymous=k.isAnonymous||!1,this.tenantId=k.tenantId||null,this.providerData=k.providerData?[...k.providerData]:[],this.metadata=new Pi(k.createdAt||void 0,k.lastLoginAt||void 0)}getIdToken(g){var _=this;return(0,f.Z)(function*(){const I=yield rt(_,_.stsTokenManager.getToken(_.auth,g));return re(I,_.auth,"internal-error"),_.accessToken!==I&&(_.accessToken=I,yield _.auth._persistUserIfCurrent(_),_.auth._notifyListenersIfCurrent(_)),I})()}getIdTokenResult(g){return function Sn(w){return or.apply(this,arguments)}(this,g)}reload(){return function mt(w){return zr.apply(this,arguments)}(this)}_assign(g){this!==g&&(re(this.uid===g.uid,this.auth,"internal-error"),this.displayName=g.displayName,this.photoURL=g.photoURL,this.email=g.email,this.emailVerified=g.emailVerified,this.phoneNumber=g.phoneNumber,this.isAnonymous=g.isAnonymous,this.tenantId=g.tenantId,this.providerData=g.providerData.map(_=>Object.assign({},_)),this.metadata._copy(g.metadata),this.stsTokenManager._assign(g.stsTokenManager))}_clone(g){return new $e(Object.assign(Object.assign({},this),{auth:g,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(g){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=g,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(g){this.reloadListener?this.reloadListener(g):this.reloadUserInfo=g}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(g,_=!1){var I=this;return(0,f.Z)(function*(){let x=!1;g.idToken&&g.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(g),x=!0),_&&(yield Fn(I)),yield I.auth._persistUserIfCurrent(I),x&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var g=this;return(0,f.Z)(function*(){const _=yield g.getIdToken();return yield rt(g,function Gi(w,g){return vt.apply(this,arguments)}(g.auth,{idToken:_})),g.stsTokenManager.clearRefreshToken(),g.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(g=>Object.assign({},g)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(g,_){var I,x,k,ne,xe,tt,Et,qt;const zn=null!==(I=_.displayName)&&void 0!==I?I:void 0,bi=null!==(x=_.email)&&void 0!==x?x:void 0,xs=null!==(k=_.phoneNumber)&&void 0!==k?k:void 0,ou=null!==(ne=_.photoURL)&&void 0!==ne?ne:void 0,wy=null!==(xe=_.tenantId)&&void 0!==xe?xe:void 0,Af=null!==(tt=_._redirectEventId)&&void 0!==tt?tt:void 0,No=null!==(Et=_.createdAt)&&void 0!==Et?Et:void 0,Pg=null!==(qt=_.lastLoginAt)&&void 0!==qt?qt:void 0,{uid:Hd,emailVerified:Og,isAnonymous:xf,providerData:$d,stsTokenManager:uc}=_;re(Hd&&uc,g,"internal-error");const lc=Z.fromJSON(this.name,uc);re("string"==typeof Hd,g,"internal-error"),Re(zn,g.name),Re(bi,g.name),re("boolean"==typeof Og,g,"internal-error"),re("boolean"==typeof xf,g,"internal-error"),Re(xs,g.name),Re(ou,g.name),Re(wy,g.name),Re(Af,g.name),Re(No,g.name),Re(Pg,g.name);const ol=new $e({uid:Hd,auth:g,email:bi,emailVerified:Og,displayName:zn,isAnonymous:xf,photoURL:ou,phoneNumber:xs,tenantId:wy,stsTokenManager:lc,createdAt:No,lastLoginAt:Pg});return $d&&Array.isArray($d)&&(ol.providerData=$d.map(Ey=>Object.assign({},Ey))),Af&&(ol._redirectEventId=Af),ol}static _fromIdTokenResponse(g,_,I=!1){return(0,f.Z)(function*(){const x=new Z;x.updateFromServerResponse(_);const k=new $e({uid:_.localId,auth:g,stsTokenManager:x,isAnonymous:I});return yield Fn(k),k})()}}const rn=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(_,I){var x=this;return(0,f.Z)(function*(){x.storage[_]=I})()}_get(_){var I=this;return(0,f.Z)(function*(){const x=I.storage[_];return void 0===x?null:x})()}_remove(_){var I=this;return(0,f.Z)(function*(){delete I.storage[_]})()}_addListener(_,I){}_removeListener(_,I){}}return w.type="NONE",w})();function Xt(w,g,_){return`firebase:${w}:${g}:${_}`}class ar{constructor(g,_,I){this.persistence=g,this.auth=_,this.userKey=I;const{config:x,name:k}=this.auth;this.fullUserKey=Xt(this.userKey,x.apiKey,k),this.fullPersistenceKey=Xt("persistence",x.apiKey,k),this.boundEventHandler=_._onStorageEvent.bind(_),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(g){return this.persistence._set(this.fullUserKey,g.toJSON())}getCurrentUser(){var g=this;return(0,f.Z)(function*(){const _=yield g.persistence._get(g.fullUserKey);return _?$e._fromJSON(g.auth,_):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(g){var _=this;return(0,f.Z)(function*(){if(_.persistence===g)return;const I=yield _.getCurrentUser();return yield _.removeCurrentUser(),_.persistence=g,I?_.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(g,_,I="authUser"){return(0,f.Z)(function*(){if(!_.length)return new ar(ie(rn),g,I);const x=(yield Promise.all(_.map(function(){var Et=(0,f.Z)(function*(qt){if(yield qt._isAvailable())return qt});return function(qt){return Et.apply(this,arguments)}}()))).filter(Et=>Et);let k=x[0]||ie(rn);const ne=Xt(I,g.config.apiKey,g.name);let xe=null;for(const Et of _)try{const qt=yield Et._get(ne);if(qt){const zn=$e._fromJSON(g,qt);Et!==k&&(xe=zn),k=Et;break}}catch(qt){}const tt=x.filter(Et=>Et._shouldAllowMigration);return k._shouldAllowMigration&&tt.length?(k=tt[0],xe&&(yield k._set(ne,xe.toJSON())),yield Promise.all(_.map(function(){var Et=(0,f.Z)(function*(qt){if(qt!==k)try{yield qt._remove(ne)}catch(zn){}});return function(qt){return Et.apply(this,arguments)}}())),new ar(k,g,I)):new ar(k,g,I)})()}}function ee(w){const g=w.toLowerCase();if(g.includes("opera/")||g.includes("opr/")||g.includes("opios/"))return"Opera";if(Je(g))return"IEMobile";if(g.includes("msie")||g.includes("trident/"))return"IE";if(g.includes("edge/"))return"Edge";if(Q(g))return"Firefox";if(g.includes("silk/"))return"Silk";if(Tt(g))return"Blackberry";if(zt(g))return"Webos";if(Y(g))return"Safari";if((g.includes("chrome/")||Se(g))&&!g.includes("edge/"))return"Chrome";if(ht(g))return"Android";{const I=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==I?void 0:I.length))return I[1]}return"Other"}function Q(w=(0,j.z$)()){return/firefox\//i.test(w)}function Y(w=(0,j.z$)()){const g=w.toLowerCase();return g.includes("safari/")&&!g.includes("chrome/")&&!g.includes("crios/")&&!g.includes("android")}function Se(w=(0,j.z$)()){return/crios\//i.test(w)}function Je(w=(0,j.z$)()){return/iemobile/i.test(w)}function ht(w=(0,j.z$)()){return/android/i.test(w)}function Tt(w=(0,j.z$)()){return/blackberry/i.test(w)}function zt(w=(0,j.z$)()){return/webos/i.test(w)}function Ut(w=(0,j.z$)()){return/iphone|ipad|ipod/i.test(w)||/macintosh/i.test(w)&&/mobile/i.test(w)}function Gn(w=(0,j.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}function Ur(w=(0,j.z$)()){return Ut(w)||ht(w)||zt(w)||Tt(w)||/windows phone/i.test(w)||Je(w)}function _r(w,g=[]){let _;switch(w){case"Browser":_=ee((0,j.z$)());break;case"Worker":_=`${ee((0,j.z$)())}-${w}`;break;default:_=w}const I=g.length?g.join(","):"FirebaseCore-web";return`${_}/JsCore/${P.SDK_VERSION}/${I}`}class Fa{constructor(g){this.auth=g,this.queue=[]}pushCallback(g,_){const I=k=>new Promise((ne,xe)=>{try{ne(g(k))}catch(tt){xe(tt)}});I.onAbort=_,this.queue.push(I);const x=this.queue.length-1;return()=>{this.queue[x]=()=>Promise.resolve()}}runMiddleware(g){var _=this;return(0,f.Z)(function*(){var I;if(_.auth.currentUser===g)return;const x=[];try{for(const k of _.queue)yield k(g),k.onAbort&&x.push(k.onAbort)}catch(k){x.reverse();for(const ne of x)try{ne()}catch(xe){}throw _.auth._errorFactory.create("login-blocked",{originalMessage:null===(I=k)||void 0===I?void 0:I.message})}})()}}class ai{constructor(g,_,I){this.app=g,this.heartbeatServiceProvider=_,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kt(this),this.idTokenSubscription=new kt(this),this.beforeStateQueue=new Fa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ge,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=g.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(g,_){var I=this;return _&&(this._popupRedirectResolver=ie(_)),this._initializationPromise=this.queue((0,f.Z)(function*(){var x,k;if(!I._deleted&&(I.persistenceManager=yield ar.create(I,g),!I._deleted)){if(null===(x=I._popupRedirectResolver)||void 0===x?void 0:x._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch(ne){}yield I.initializeCurrentUser(_),I.lastNotifiedUid=(null===(k=I.currentUser)||void 0===k?void 0:k.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var g=this;return(0,f.Z)(function*(){if(g._deleted)return;const _=yield g.assertedPersistence.getCurrentUser();if(g.currentUser||_){if(g.currentUser&&_&&g.currentUser.uid===_.uid)return g._currentUser._assign(_),void(yield g.currentUser.getIdToken());yield g._updateCurrentUser(_,!0)}})()}initializeCurrentUser(g){var _=this;return(0,f.Z)(function*(){var I;const x=yield _.assertedPersistence.getCurrentUser();let k=x,ne=!1;if(g&&_.config.authDomain){yield _.getOrInitRedirectPersistenceManager();const xe=null===(I=_.redirectUser)||void 0===I?void 0:I._redirectEventId,tt=null==k?void 0:k._redirectEventId,Et=yield _.tryRedirectSignIn(g);(!xe||xe===tt)&&(null==Et?void 0:Et.user)&&(k=Et.user,ne=!0)}if(!k)return _.directlySetCurrentUser(null);if(!k._redirectEventId){if(ne)try{yield _.beforeStateQueue.runMiddleware(k)}catch(xe){k=x,_._popupRedirectResolver._overrideRedirectResult(_,()=>Promise.reject(xe))}return k?_.reloadAndSetCurrentUserOrClear(k):_.directlySetCurrentUser(null)}return re(_._popupRedirectResolver,_,"argument-error"),yield _.getOrInitRedirectPersistenceManager(),_.redirectUser&&_.redirectUser._redirectEventId===k._redirectEventId?_.directlySetCurrentUser(k):_.reloadAndSetCurrentUserOrClear(k)})()}tryRedirectSignIn(g){var _=this;return(0,f.Z)(function*(){let I=null;try{I=yield _._popupRedirectResolver._completeRedirectFn(_,g,!0)}catch(x){yield _._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(g){var _=this;return(0,f.Z)(function*(){var I;try{yield Fn(g)}catch(x){if("auth/network-request-failed"!==(null===(I=x)||void 0===I?void 0:I.code))return _.directlySetCurrentUser(null)}return _.directlySetCurrentUser(g)})()}useDeviceLanguage(){this.languageCode=function Lt(){if("undefined"==typeof navigator)return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var g=this;return(0,f.Z)(function*(){g._deleted=!0})()}updateCurrentUser(g){var _=this;return(0,f.Z)(function*(){const I=g?(0,j.m9)(g):null;return I&&re(I.auth.config.apiKey===_.config.apiKey,_,"invalid-user-token"),_._updateCurrentUser(I&&I._clone(_))})()}_updateCurrentUser(g,_=!1){var I=this;return(0,f.Z)(function*(){if(!I._deleted)return g&&re(I.tenantId===g.tenantId,I,"tenant-id-mismatch"),_||(yield I.beforeStateQueue.runMiddleware(g)),I.queue((0,f.Z)(function*(){yield I.directlySetCurrentUser(g),I.notifyAuthListeners()}))})()}signOut(){var g=this;return(0,f.Z)(function*(){return yield g.beforeStateQueue.runMiddleware(null),(g.redirectPersistenceManager||g._popupRedirectResolver)&&(yield g._setRedirectUser(null)),g._updateCurrentUser(null,!0)})()}setPersistence(g){var _=this;return this.queue((0,f.Z)(function*(){yield _.assertedPersistence.setPersistence(ie(g))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(g){this._errorFactory=new j.LL("auth","Firebase",g())}onAuthStateChanged(g,_,I){return this.registerStateListener(this.authStateSubscription,g,_,I)}beforeAuthStateChanged(g,_){return this.beforeStateQueue.pushCallback(g,_)}onIdTokenChanged(g,_,I){return this.registerStateListener(this.idTokenSubscription,g,_,I)}toJSON(){var g;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(g=this._currentUser)||void 0===g?void 0:g.toJSON()}}_setRedirectUser(g,_){var I=this;return(0,f.Z)(function*(){const x=yield I.getOrInitRedirectPersistenceManager(_);return null===g?x.removeCurrentUser():x.setCurrentUser(g)})()}getOrInitRedirectPersistenceManager(g){var _=this;return(0,f.Z)(function*(){if(!_.redirectPersistenceManager){const I=g&&ie(g)||_._popupRedirectResolver;re(I,_,"argument-error"),_.redirectPersistenceManager=yield ar.create(_,[ie(I._redirectPersistence)],"redirectUser"),_.redirectUser=yield _.redirectPersistenceManager.getCurrentUser()}return _.redirectPersistenceManager})()}_redirectUserForId(g){var _=this;return(0,f.Z)(function*(){var I,x;return _._isInitialized&&(yield _.queue((0,f.Z)(function*(){}))),(null===(I=_._currentUser)||void 0===I?void 0:I._redirectEventId)===g?_._currentUser:(null===(x=_.redirectUser)||void 0===x?void 0:x._redirectEventId)===g?_.redirectUser:null})()}_persistUserIfCurrent(g){var _=this;return(0,f.Z)(function*(){if(g===_.currentUser)return _.queue((0,f.Z)(function*(){return _.directlySetCurrentUser(g)}))})()}_notifyListenersIfCurrent(g){g===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var g,_;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(_=null===(g=this.currentUser)||void 0===g?void 0:g.uid)&&void 0!==_?_:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(g,_,I,x){if(this._deleted)return()=>{};const k="function"==typeof _?_:_.next.bind(_),ne=this._isInitialized?Promise.resolve():this._initializationPromise;return re(ne,this,"internal-error"),ne.then(()=>k(this.currentUser)),"function"==typeof _?g.addObserver(_,I,x):g.addObserver(_)}directlySetCurrentUser(g){var _=this;return(0,f.Z)(function*(){_.currentUser&&_.currentUser!==g&&_._currentUser._stopProactiveRefresh(),g&&_.isProactiveRefreshEnabled&&g._startProactiveRefresh(),_.currentUser=g,g?yield _.assertedPersistence.setCurrentUser(g):yield _.assertedPersistence.removeCurrentUser()})()}queue(g){return this.operations=this.operations.then(g,g),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(g){!g||this.frameworks.includes(g)||(this.frameworks.push(g),this.frameworks.sort(),this.clientVersion=_r(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var g=this;return(0,f.Z)(function*(){var _;const I={"X-Client-Version":g.clientVersion};g.app.options.appId&&(I["X-Firebase-gmpid"]=g.app.options.appId);const x=yield null===(_=g.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===_?void 0:_.getHeartbeatsHeader();return x&&(I["X-Firebase-Client"]=x),I})()}}function je(w){return(0,j.m9)(w)}class kt{constructor(g){this.auth=g,this.observer=null,this.addObserver=(0,j.ne)(_=>this.observer=_)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function vn(w,g,_){const I=je(w);re(I._canInitEmulator,I,"emulator-config-failed"),re(/^https?:\/\//.test(g),I,"invalid-emulator-scheme");const x=!!(null==_?void 0:_.disableWarnings),k=Zr(g),{host:ne,port:xe}=function ds(w){const g=Zr(w),_=/(\/\/)?([^?#/]+)/.exec(w.substr(g.length));if(!_)return{host:"",port:null};const I=_[2].split("@").pop()||"",x=/^(\[[^\]]+\])(:|$)/.exec(I);if(x){const k=x[1];return{host:k,port:qn(I.substr(k.length+1))}}{const[k,ne]=I.split(":");return{host:k,port:qn(ne)}}}(g);I.config.emulator={url:`${k}//${ne}${null===xe?"":`:${xe}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:ne,port:xe,protocol:k.replace(":",""),options:Object.freeze({disableWarnings:x})}),x||function hs(){function w(){const g=document.createElement("p"),_=g.style;g.innerText="Running in emulator mode. Do not use with production credentials.",_.position="fixed",_.width="100%",_.backgroundColor="#ffffff",_.border=".1em solid #000000",_.color="#b50000",_.bottom="0px",_.left="0px",_.margin="0px",_.zIndex="10000",_.textAlign="center",g.classList.add("firebase-emulator-warning"),document.body.appendChild(g)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}function Zr(w){const g=w.indexOf(":");return g<0?"":w.substr(0,g+1)}function qn(w){if(!w)return null;const g=Number(w);return isNaN(g)?null:g}class dn{constructor(g,_){this.providerId=g,this.signInMethod=_}toJSON(){return ge("not implemented")}_getIdTokenResponse(g){return ge("not implemented")}_linkToIdToken(g,_){return ge("not implemented")}_getReauthenticationResolver(g){return ge("not implemented")}}function go(w,g){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:resetPassword",Vt(w,g))})).apply(this,arguments)}function Nt(w,g){return Wo.apply(this,arguments)}function Wo(){return(Wo=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function mo(w,g){return zo.apply(this,arguments)}function zo(){return(zo=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:update",Vt(w,g))})).apply(this,arguments)}function Pn(){return(Pn=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithPassword",Vt(w,g))})).apply(this,arguments)}function Hs(w,g){return _o.apply(this,arguments)}function _o(){return(_o=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:sendOobCode",Vt(w,g))})).apply(this,arguments)}function Kr(w,g){return mn.apply(this,arguments)}function mn(){return(mn=(0,f.Z)(function*(w,g){return Hs(w,g)})).apply(this,arguments)}function sd(w,g){return yo.apply(this,arguments)}function yo(){return(yo=(0,f.Z)(function*(w,g){return Hs(w,g)})).apply(this,arguments)}function Oi(w,g){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,f.Z)(function*(w,g){return Hs(w,g)})).apply(this,arguments)}function od(w,g){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,f.Z)(function*(w,g){return Hs(w,g)})).apply(this,arguments)}function Ii(){return(Ii=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithEmailLink",Vt(w,g))})).apply(this,arguments)}function ad(){return(ad=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithEmailLink",Vt(w,g))})).apply(this,arguments)}class Uu extends dn{constructor(g,_,I,x=null){super("password",I),this._email=g,this._password=_,this._tenantId=x}static _fromEmailAndPassword(g,_){return new Uu(g,_,"password")}static _fromEmailAndCode(g,_,I=null){return new Uu(g,_,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g;if((null==_?void 0:_.email)&&(null==_?void 0:_.password)){if("password"===_.signInMethod)return this._fromEmailAndPassword(_.email,_.password);if("emailLink"===_.signInMethod)return this._fromEmailAndCode(_.email,_.password,_.tenantId)}return null}_getIdTokenResponse(g){var _=this;return(0,f.Z)(function*(){switch(_.signInMethod){case"password":return function Zo(w,g){return Pn.apply(this,arguments)}(g,{returnSecureToken:!0,email:_._email,password:_._password});case"emailLink":return function $s(w,g){return Ii.apply(this,arguments)}(g,{email:_._email,oobCode:_._password});default:We(g,"internal-error")}})()}_linkToIdToken(g,_){var I=this;return(0,f.Z)(function*(){switch(I.signInMethod){case"password":return Nt(g,{idToken:_,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function uf(w,g){return ad.apply(this,arguments)}(g,{idToken:_,email:I._email,oobCode:I._password});default:We(g,"internal-error")}})()}_getReauthenticationResolver(g){return this._getIdTokenResponse(g)}}function Jn(w,g){return ud.apply(this,arguments)}function ud(){return(ud=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithIdp",Vt(w,g))})).apply(this,arguments)}class fs extends dn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(g){const _=new fs(g.providerId,g.signInMethod);return g.idToken||g.accessToken?(g.idToken&&(_.idToken=g.idToken),g.accessToken&&(_.accessToken=g.accessToken),g.nonce&&!g.pendingToken&&(_.nonce=g.nonce),g.pendingToken&&(_.pendingToken=g.pendingToken)):g.oauthToken&&g.oauthTokenSecret?(_.accessToken=g.oauthToken,_.secret=g.oauthTokenSecret):We("argument-error"),_}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g,{providerId:I,signInMethod:x}=_,k=(0,ae._T)(_,["providerId","signInMethod"]);if(!I||!x)return null;const ne=new fs(I,x);return ne.idToken=k.idToken||void 0,ne.accessToken=k.accessToken||void 0,ne.secret=k.secret,ne.nonce=k.nonce,ne.pendingToken=k.pendingToken||null,ne}_getIdTokenResponse(g){return Jn(g,this.buildRequest())}_linkToIdToken(g,_){const I=this.buildRequest();return I.idToken=_,Jn(g,I)}_getReauthenticationResolver(g){const _=this.buildRequest();return _.autoCreate=!1,Jn(g,_)}buildRequest(){const g={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)g.pendingToken=this.pendingToken;else{const _={};this.idToken&&(_.id_token=this.idToken),this.accessToken&&(_.access_token=this.accessToken),this.secret&&(_.oauth_token_secret=this.secret),_.providerId=this.providerId,this.nonce&&!this.pendingToken&&(_.nonce=this.nonce),g.postBody=(0,j.xO)(_)}return g}}function hg(w,g){return ld.apply(this,arguments)}function ld(){return(ld=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:sendVerificationCode",Vt(w,g))})).apply(this,arguments)}function La(){return(La=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,g))})).apply(this,arguments)}function cd(){return(cd=(0,f.Z)(function*(w,g){const _=yield Rn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,g));if(_.temporaryProof)throw kn(w,"account-exists-with-different-credential",_);return _})).apply(this,arguments)}const pg={USER_NOT_FOUND:"user-not-found"};function dd(){return(dd=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,Object.assign(Object.assign({},g),{operation:"REAUTH"})),pg)})).apply(this,arguments)}class Yo extends dn{constructor(g){super("phone","phone"),this.params=g}static _fromVerification(g,_){return new Yo({verificationId:g,verificationCode:_})}static _fromTokenResponse(g,_){return new Yo({phoneNumber:g,temporaryProof:_})}_getIdTokenResponse(g){return function fg(w,g){return La.apply(this,arguments)}(g,this._makeVerificationRequest())}_linkToIdToken(g,_){return function Ko(w,g){return cd.apply(this,arguments)}(g,Object.assign({idToken:_},this._makeVerificationRequest()))}_getReauthenticationResolver(g){return function gg(w,g){return dd.apply(this,arguments)}(g,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:g,phoneNumber:_,verificationId:I,verificationCode:x}=this.params;return g&&_?{temporaryProof:g,phoneNumber:_}:{sessionInfo:I,code:x}}toJSON(){const g={providerId:this.providerId};return this.params.phoneNumber&&(g.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(g.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(g.verificationCode=this.params.verificationCode),this.params.verificationId&&(g.verificationId=this.params.verificationId),g}static fromJSON(g){"string"==typeof g&&(g=JSON.parse(g));const{verificationId:_,verificationCode:I,phoneNumber:x,temporaryProof:k}=g;return I||_||x||k?new Yo({verificationId:_,verificationCode:I,phoneNumber:x,temporaryProof:k}):null}}class ps{constructor(g){var _,I,x,k,ne,xe;const tt=(0,j.zd)((0,j.pd)(g)),Et=null!==(_=tt.apiKey)&&void 0!==_?_:null,qt=null!==(I=tt.oobCode)&&void 0!==I?I:null,zn=function mg(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(x=tt.mode)&&void 0!==x?x:null);re(Et&&qt&&zn,"argument-error"),this.apiKey=Et,this.operation=zn,this.code=qt,this.continueUrl=null!==(k=tt.continueUrl)&&void 0!==k?k:null,this.languageCode=null!==(ne=tt.languageCode)&&void 0!==ne?ne:null,this.tenantId=null!==(xe=tt.tenantId)&&void 0!==xe?xe:null}static parseLink(g){const _=function lf(w){const g=(0,j.zd)((0,j.pd)(w)).link,_=g?(0,j.zd)((0,j.pd)(g)).deep_link_id:null,I=(0,j.zd)((0,j.pd)(w)).deep_link_id;return(I?(0,j.zd)((0,j.pd)(I)).link:null)||I||_||g||w}(g);try{return new ps(_)}catch(I){return null}}}let Va=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(_,I){return Uu._fromEmailAndPassword(_,I)}static credentialWithLink(_,I){const x=ps.parseLink(I);return re(x,"argument-error"),Uu._fromEmailAndCode(_,x.code,x.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class Gs{constructor(g){this.providerId=g,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(g){this.defaultLanguageCode=g}setCustomParameters(g){return this.customParameters=g,this}getCustomParameters(){return this.customParameters}}class Ci extends Gs{constructor(){super(...arguments),this.scopes=[]}addScope(g){return this.scopes.includes(g)||this.scopes.push(g),this}getScopes(){return[...this.scopes]}}class Qo extends Ci{static credentialFromJSON(g){const _="string"==typeof g?JSON.parse(g):g;return re("providerId"in _&&"signInMethod"in _,"argument-error"),fs._fromParams(_)}credential(g){return this._credential(Object.assign(Object.assign({},g),{nonce:g.rawNonce}))}_credential(g){return re(g.idToken||g.accessToken,"argument-error"),fs._fromParams(Object.assign(Object.assign({},g),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(g){return Qo.oauthCredentialFromTaggedObject(g)}static credentialFromError(g){return Qo.oauthCredentialFromTaggedObject(g.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:g}){if(!g)return null;const{oauthIdToken:_,oauthAccessToken:I,oauthTokenSecret:x,pendingToken:k,nonce:ne,providerId:xe}=g;if(!I&&!x&&!_&&!k||!xe)return null;try{return new Qo(xe)._credential({idToken:_,accessToken:I,nonce:ne,pendingToken:k})}catch(tt){return null}}}let Ua=(()=>{class w extends Ci{constructor(){super("facebook.com")}static credential(_){return fs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch(I){return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),Ba=(()=>{class w extends Ci{constructor(){super("google.com"),this.addScope("profile")}static credential(_,I){return fs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:_,accessToken:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthIdToken:I,oauthAccessToken:x}=_;if(!I&&!x)return null;try{return w.credential(I,x)}catch(k){return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),cf=(()=>{class w extends Ci{constructor(){super("github.com")}static credential(_){return fs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch(I){return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class qs extends dn{constructor(g,_){super(g,g),this.pendingToken=_}_getIdTokenResponse(g){return Jn(g,this.buildRequest())}_linkToIdToken(g,_){const I=this.buildRequest();return I.idToken=_,Jn(g,I)}_getReauthenticationResolver(g){const _=this.buildRequest();return _.autoCreate=!1,Jn(g,_)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g,{providerId:I,signInMethod:x,pendingToken:k}=_;return I&&x&&k&&I===x?new qs(I,k):null}static _create(g,_){return new qs(g,_)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class gs extends Gs{constructor(g){re(g.startsWith("saml."),"argument-error"),super(g)}static credentialFromResult(g){return gs.samlCredentialFromTaggedObject(g)}static credentialFromError(g){return gs.samlCredentialFromTaggedObject(g.customData||{})}static credentialFromJSON(g){const _=qs.fromJSON(g);return re(_,"argument-error"),_}static samlCredentialFromTaggedObject({_tokenResponse:g}){if(!g)return null;const{pendingToken:_,providerId:I}=g;if(!_||!I)return null;try{return qs._create(I,_)}catch(x){return null}}}let ki=(()=>{class w extends Ci{constructor(){super("twitter.com")}static credential(_,I){return fs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:_,oauthTokenSecret:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthAccessToken:I,oauthTokenSecret:x}=_;if(!I||!x)return null;try{return w.credential(I,x)}catch(k){return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function fd(w,g){return Br.apply(this,arguments)}function Br(){return(Br=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signUp",Vt(w,g))})).apply(this,arguments)}class jr{constructor(g){this.user=g.user,this.providerId=g.providerId,this._tokenResponse=g._tokenResponse,this.operationType=g.operationType}static _fromIdTokenResponse(g,_,I,x=!1){return(0,f.Z)(function*(){const k=yield $e._fromIdTokenResponse(g,I,x),ne=pd(I);return new jr({user:k,providerId:ne,_tokenResponse:I,operationType:_})})()}static _forOperation(g,_,I){return(0,f.Z)(function*(){yield g._updateTokensIfNecessary(I,!0);const x=pd(I);return new jr({user:g,providerId:x,_tokenResponse:I,operationType:_})})()}}function pd(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function gd(w){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,f.Z)(function*(w){var g;const _=je(w);if(yield _._initializationPromise,null===(g=_.currentUser)||void 0===g?void 0:g.isAnonymous)return new jr({user:_.currentUser,providerId:null,operationType:"signIn"});const I=yield fd(_,{returnSecureToken:!0}),x=yield jr._fromIdTokenResponse(_,"signIn",I,!0);return yield _._updateCurrentUser(x.user),x})).apply(this,arguments)}class ju extends j.ZR{constructor(g,_,I,x){var k;super(_.code,_.message),this.operationType=I,this.user=x,Object.setPrototypeOf(this,ju.prototype),this.customData={appName:g.name,tenantId:null!==(k=g.tenantId)&&void 0!==k?k:void 0,_serverResponse:_.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(g,_,I,x){return new ju(g,_,I,x)}}function Hu(w,g,_,I){return("reauthenticate"===g?_._getReauthenticationResolver(w):_._getIdTokenResponse(w)).catch(k=>{throw"auth/multi-factor-auth-required"===k.code?ju._fromErrorAndOperation(w,k,g,I):k})}function Hl(w){return new Set(w.map(({providerId:g})=>g).filter(g=>!!g))}function ms(w,g){return $l.apply(this,arguments)}function $l(){return($l=(0,f.Z)(function*(w,g){const _=(0,j.m9)(w);yield Ws(!0,_,g);const{providerUserInfo:I}=yield Lr(_.auth,{idToken:yield _.getIdToken(),deleteProvider:[g]}),x=Hl(I||[]);return _.providerData=_.providerData.filter(k=>x.has(k.providerId)),x.has("phone")||(_.phoneNumber=null),yield _.auth._persistUserIfCurrent(_),_})).apply(this,arguments)}function wn(w,g){return ja.apply(this,arguments)}function ja(){return(ja=(0,f.Z)(function*(w,g,_=!1){const I=yield rt(w,g._linkToIdToken(w.auth,yield w.getIdToken()),_);return jr._forOperation(w,"link",I)})).apply(this,arguments)}function Ws(w,g,_){return _n.apply(this,arguments)}function _n(){return(_n=(0,f.Z)(function*(w,g,_){yield Fn(g);const x=!1===w?"provider-already-linked":"no-such-provider";re(Hl(g.providerData).has(_)===w,g.auth,x)})).apply(this,arguments)}function $u(w,g){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,f.Z)(function*(w,g,_=!1){var I;const{auth:x}=w,k="reauthenticate";try{const ne=yield rt(w,Hu(x,k,g,w),_);re(ne.idToken,x,"internal-error");const xe=Ht(ne.idToken);re(xe,x,"internal-error");const{sub:tt}=xe;return re(w.uid===tt,x,"user-mismatch"),jr._forOperation(w,k,ne)}catch(ne){throw"auth/user-not-found"===(null===(I=ne)||void 0===I?void 0:I.code)&&We(x,"user-mismatch"),ne}})).apply(this,arguments)}function vo(w,g){return yr.apply(this,arguments)}function yr(){return(yr=(0,f.Z)(function*(w,g,_=!1){const I="signIn",x=yield Hu(w,I,g),k=yield jr._fromIdTokenResponse(w,I,x);return _||(yield w._updateCurrentUser(k.user)),k})).apply(this,arguments)}function Gu(w,g){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,f.Z)(function*(w,g){return vo(je(w),g)})).apply(this,arguments)}function _s(w,g){return vr.apply(this,arguments)}function vr(){return(vr=(0,f.Z)(function*(w,g){const _=(0,j.m9)(w);return yield Ws(!1,_,g.providerId),wn(_,g)})).apply(this,arguments)}function Jo(w,g){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,f.Z)(function*(w,g){return $u((0,j.m9)(w),g)})).apply(this,arguments)}function Gl(w,g){return ui.apply(this,arguments)}function ui(){return(ui=(0,f.Z)(function*(w,g){return Rn(w,"POST","/v1/accounts:signInWithCustomToken",Vt(w,g))})).apply(this,arguments)}function zs(w,g){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,f.Z)(function*(w,g){const _=je(w),I=yield Gl(_,{token:g,returnSecureToken:!0}),x=yield jr._fromIdTokenResponse(_,"signIn",I);return yield _._updateCurrentUser(x.user),x})).apply(this,arguments)}class Ct{constructor(g,_){this.factorId=g,this.uid=_.mfaEnrollmentId,this.enrollmentTime=new Date(_.enrolledAt).toUTCString(),this.displayName=_.displayName}static _fromServerResponse(g,_){return"phoneInfo"in _?wo._fromServerResponse(g,_):We(g,"internal-error")}}class wo extends Ct{constructor(g){super("phone",g),this.phoneNumber=g.phoneInfo}static _fromServerResponse(g,_){return new wo(_)}}function qu(w,g,_){var I;re((null===(I=_.url)||void 0===I?void 0:I.length)>0,w,"invalid-continue-uri"),re(void 0===_.dynamicLinkDomain||_.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),g.continueUrl=_.url,g.dynamicLinkDomain=_.dynamicLinkDomain,g.canHandleCodeInApp=_.handleCodeInApp,_.iOS&&(re(_.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),g.iOSBundleId=_.iOS.bundleId),_.android&&(re(_.android.packageName.length>0,w,"missing-android-pkg-name"),g.androidInstallApp=_.android.installApp,g.androidMinimumVersionCode=_.android.minimumVersion,g.androidPackageName=_.android.packageName)}function md(w,g,_){return $a.apply(this,arguments)}function $a(){return($a=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w),x={requestType:"PASSWORD_RESET",email:g};_&&qu(I,x,_),yield sd(I,x)})).apply(this,arguments)}function _d(w,g,_){return Xo.apply(this,arguments)}function Xo(){return(Xo=(0,f.Z)(function*(w,g,_){yield go((0,j.m9)(w),{oobCode:g,newPassword:_})})).apply(this,arguments)}function df(w,g){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,f.Z)(function*(w,g){yield mo((0,j.m9)(w),{oobCode:g})})).apply(this,arguments)}function ke(w,g){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,f.Z)(function*(w,g){const _=(0,j.m9)(w),I=yield go(_,{oobCode:g}),x=I.requestType;switch(re(x,_,"internal-error"),x){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":re(I.newEmail,_,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":re(I.mfaInfo,_,"internal-error");default:re(I.email,_,"internal-error")}let k=null;return I.mfaInfo&&(k=Ct._fromServerResponse(je(_),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:k},operation:x}})).apply(this,arguments)}function Wu(w,g){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,f.Z)(function*(w,g){const{data:_}=yield ke((0,j.m9)(w),g);return _.email})).apply(this,arguments)}function yd(w,g,_){return ys.apply(this,arguments)}function ys(){return(ys=(0,f.Z)(function*(w,g,_){const I=je(w),x=yield fd(I,{returnSecureToken:!0,email:g,password:_}),k=yield jr._fromIdTokenResponse(I,"signIn",x);return yield I._updateCurrentUser(k.user),k})).apply(this,arguments)}function zi(w,g,_){return Gu((0,j.m9)(w),Va.credential(g,_))}function ql(w,g,_){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w),x={requestType:"EMAIL_SIGNIN",email:g};re(_.handleCodeInApp,I,"argument-error"),_&&qu(I,x,_),yield Oi(I,x)})).apply(this,arguments)}function hf(w,g){const _=ps.parseLink(g);return"EMAIL_SIGNIN"===(null==_?void 0:_.operation)}function vd(w,g,_){return wd.apply(this,arguments)}function wd(){return(wd=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w),x=Va.credentialWithLink(g,_||de());return re(x._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),Gu(I,x)})).apply(this,arguments)}function Eo(w,g){return wr.apply(this,arguments)}function wr(){return(wr=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:createAuthUri",Vt(w,g))})).apply(this,arguments)}function Zi(w,g){return ea.apply(this,arguments)}function ea(){return(ea=(0,f.Z)(function*(w,g){const I={identifier:g,continueUri:Ue()?de():"http://localhost"},{signinMethods:x}=yield Eo((0,j.m9)(w),I);return x||[]})).apply(this,arguments)}function ta(w,g){return li.apply(this,arguments)}function li(){return(li=(0,f.Z)(function*(w,g){const _=(0,j.m9)(w),x={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};g&&qu(_.auth,x,g);const{email:k}=yield Kr(_.auth,x);k!==w.email&&(yield w.reload())})).apply(this,arguments)}function ff(w,g,_){return na.apply(this,arguments)}function na(){return(na=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w),k={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:g};_&&qu(I.auth,k,_);const{email:ne}=yield od(I.auth,k);ne!==w.email&&(yield w.reload())})).apply(this,arguments)}function Ed(w,g){return qa.apply(this,arguments)}function qa(){return(qa=(0,f.Z)(function*(w,g){return Jt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function Wl(w,g){return ra.apply(this,arguments)}function ra(){return(ra=(0,f.Z)(function*(w,{displayName:g,photoURL:_}){if(void 0===g&&void 0===_)return;const I=(0,j.m9)(w),k={idToken:yield I.getIdToken(),displayName:g,photoUrl:_,returnSecureToken:!0},ne=yield rt(I,Ed(I.auth,k));I.displayName=ne.displayName||null,I.photoURL=ne.photoUrl||null;const xe=I.providerData.find(({providerId:tt})=>"password"===tt);xe&&(xe.displayName=I.displayName,xe.photoURL=I.photoURL),yield I._updateTokensIfNecessary(ne)})).apply(this,arguments)}function Id(w,g){return zl((0,j.m9)(w),g,null)}function Cd(w,g){return zl((0,j.m9)(w),null,g)}function zl(w,g,_){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,f.Z)(function*(w,g,_){const{auth:I}=w,k={idToken:yield w.getIdToken(),returnSecureToken:!0};g&&(k.email=g),_&&(k.password=_);const ne=yield rt(w,Nt(I,k));yield w._updateTokensIfNecessary(ne,!0)})).apply(this,arguments)}class Io{constructor(g,_,I={}){this.isNewUser=g,this.providerId=_,this.profile=I}}class bd extends Io{constructor(g,_,I,x){super(g,_,I),this.username=x}}class pf extends Io{constructor(g,_){super(g,"facebook.com",_)}}class zu extends bd{constructor(g,_){super(g,"github.com",_,"string"==typeof(null==_?void 0:_.login)?null==_?void 0:_.login:null)}}class ci extends Io{constructor(g,_){super(g,"google.com",_)}}class gf extends bd{constructor(g,_,I){super(g,"twitter.com",_,I)}}function Zl(w){const{user:g,_tokenResponse:_}=w;return g.isAnonymous&&!_?{providerId:null,isNewUser:!1,profile:null}:function za(w){var g,_;if(!w)return null;const{providerId:I}=w,x=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},k=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!I&&(null==w?void 0:w.idToken)){const ne=null===(_=null===(g=Ht(w.idToken))||void 0===g?void 0:g.firebase)||void 0===_?void 0:_.sign_in_provider;if(ne)return new Io(k,"anonymous"!==ne&&"custom"!==ne?ne:null)}if(!I)return null;switch(I){case"facebook.com":return new pf(k,x);case"github.com":return new zu(k,x);case"google.com":return new ci(k,x);case"twitter.com":return new gf(k,x,w.screenName||null);case"custom":case"anonymous":return new Io(k,null);default:return new Io(k,I,x)}}(_)}class vs{constructor(g,_){this.type=g,this.credential=_}static _fromIdtoken(g){return new vs("enroll",g)}static _fromMfaPendingCredential(g){return new vs("signin",g)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(g){var _,I;if(null==g?void 0:g.multiFactorSession){if(null===(_=g.multiFactorSession)||void 0===_?void 0:_.pendingCredential)return vs._fromMfaPendingCredential(g.multiFactorSession.pendingCredential);if(null===(I=g.multiFactorSession)||void 0===I?void 0:I.idToken)return vs._fromIdtoken(g.multiFactorSession.idToken)}return null}}class Za{constructor(g,_,I){this.session=g,this.hints=_,this.signInResolver=I}static _fromError(g,_){const I=je(g),x=_.customData._serverResponse,k=(x.mfaInfo||[]).map(xe=>Ct._fromServerResponse(I,xe));re(x.mfaPendingCredential,I,"internal-error");const ne=vs._fromMfaPendingCredential(x.mfaPendingCredential);return new Za(ne,k,function(){var xe=(0,f.Z)(function*(tt){const Et=yield tt._process(I,ne);delete x.mfaInfo,delete x.mfaPendingCredential;const qt=Object.assign(Object.assign({},x),{idToken:Et.idToken,refreshToken:Et.refreshToken});switch(_.operationType){case"signIn":const zn=yield jr._fromIdTokenResponse(I,_.operationType,qt);return yield I._updateCurrentUser(zn.user),zn;case"reauthenticate":return re(_.user,I,"internal-error"),jr._forOperation(_.user,_.operationType,qt);default:We(I,"internal-error")}});return function(tt){return xe.apply(this,arguments)}}())}resolveSignIn(g){var _=this;return(0,f.Z)(function*(){return _.signInResolver(g)})()}}function Ka(w,g){var _;const I=(0,j.m9)(w),x=g;return re(g.customData.operationType,I,"argument-error"),re(null===(_=x.customData._serverResponse)||void 0===_?void 0:_.mfaPendingCredential,I,"argument-error"),Za._fromError(I,x)}function ur(w,g){return Jt(w,"POST","/v2/accounts/mfaEnrollment:start",Vt(w,g))}class ws{constructor(g){this.user=g,this.enrolledFactors=[],g._onReload(_=>{_.mfaInfo&&(this.enrolledFactors=_.mfaInfo.map(I=>Ct._fromServerResponse(g.auth,I)))})}static _fromUser(g){return new ws(g)}getSession(){var g=this;return(0,f.Z)(function*(){return vs._fromIdtoken(yield g.user.getIdToken())})()}enroll(g,_){var I=this;return(0,f.Z)(function*(){const x=g,k=yield I.getSession(),ne=yield rt(I.user,x._process(I.user.auth,k,_));return yield I.user._updateTokensIfNecessary(ne),I.user.reload()})()}unenroll(g){var _=this;return(0,f.Z)(function*(){var I;const x="string"==typeof g?g:g.uid,k=yield _.user.getIdToken(),ne=yield rt(_.user,function vg(w,g){return Jt(w,"POST","/v2/accounts/mfaEnrollment:withdraw",Vt(w,g))}(_.user.auth,{idToken:k,mfaEnrollmentId:x}));_.enrolledFactors=_.enrolledFactors.filter(({uid:xe})=>xe!==x),yield _.user._updateTokensIfNecessary(ne);try{yield _.user.reload()}catch(xe){if("auth/user-token-expired"!==(null===(I=xe)||void 0===I?void 0:I.code))throw xe}})()}}const ia=new WeakMap;function Ad(w){const g=(0,j.m9)(w);return ia.has(g)||ia.set(g,ws._fromUser(g)),ia.get(g)}const Kl="__sak";class bo{constructor(g,_){this.storageRetriever=g,this.type=_}_isAvailable(){try{return this.storage?(this.storage.setItem(Kl,"1"),this.storage.removeItem(Kl),Promise.resolve(!0)):Promise.resolve(!1)}catch(g){return Promise.resolve(!1)}}_set(g,_){return this.storage.setItem(g,JSON.stringify(_)),Promise.resolve()}_get(g){const _=this.storage.getItem(g);return Promise.resolve(_?JSON.parse(_):null)}_remove(g){return this.storage.removeItem(g),Promise.resolve()}get storage(){return this.storageRetriever()}}const di=(()=>{class w extends bo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(_,I)=>this.onStorageEvent(_,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Yl(){const w=(0,j.z$)();return Y(w)||Ut(w)}()&&function qi(){try{return!(!window||window===window.top)}catch(w){return!1}}(),this.fallbackToPolling=Ur(),this._shouldAllowMigration=!0}forAllChangedKeys(_){for(const I of Object.keys(this.listeners)){const x=this.storage.getItem(I),k=this.localCache[I];x!==k&&_(I,k,x)}}onStorageEvent(_,I=!1){if(!_.key)return void this.forAllChangedKeys((xe,tt,Et)=>{this.notifyListeners(xe,Et)});const x=_.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const xe=this.storage.getItem(x);if(_.newValue!==xe)null!==_.newValue?this.storage.setItem(x,_.newValue):this.storage.removeItem(x);else if(this.localCache[x]===_.newValue&&!I)return}const k=()=>{const xe=this.storage.getItem(x);!I&&this.localCache[x]===xe||this.notifyListeners(x,xe)},ne=this.storage.getItem(x);!function Bt(){return(0,j.w1)()&&10===document.documentMode}()||ne===_.newValue||_.newValue===_.oldValue?k():setTimeout(k,10)}notifyListeners(_,I){this.localCache[_]=I;const x=this.listeners[_];if(x)for(const k of Array.from(x))k(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((_,I,x)=>{this.onStorageEvent(new StorageEvent("storage",{key:_,oldValue:I,newValue:x}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(_,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[_]||(this.listeners[_]=new Set,this.localCache[_]=this.storage.getItem(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(_,I){var x=()=>super._set,k=this;return(0,f.Z)(function*(){yield x().call(k,_,I),k.localCache[_]=JSON.stringify(I)})()}_get(_){var I=()=>super._get,x=this;return(0,f.Z)(function*(){const k=yield I().call(x,_);return x.localCache[_]=JSON.stringify(k),k})()}_remove(_){var I=()=>super._remove,x=this;return(0,f.Z)(function*(){yield I().call(x,_),delete x.localCache[_]})()}}return w.type="LOCAL",w})(),Zu=(()=>{class w extends bo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(_,I){}_removeListener(_,I){}}return w.type="SESSION",w})();let sa=(()=>{class w{constructor(_){this.eventTarget=_,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(_){const I=this.receivers.find(k=>k.isListeningto(_));if(I)return I;const x=new w(_);return this.receivers.push(x),x}isListeningto(_){return this.eventTarget===_}handleEvent(_){var I=this;return(0,f.Z)(function*(){const x=_,{eventId:k,eventType:ne,data:xe}=x.data,tt=I.handlersMap[ne];if(!(null==tt?void 0:tt.size))return;x.ports[0].postMessage({status:"ack",eventId:k,eventType:ne});const Et=Array.from(tt).map(function(){var zn=(0,f.Z)(function*(bi){return bi(x.origin,xe)});return function(bi){return zn.apply(this,arguments)}}()),qt=yield function Jl(w){return Promise.all(w.map(function(){var g=(0,f.Z)(function*(_){try{return{fulfilled:!0,value:yield _}}catch(I){return{fulfilled:!1,reason:I}}});return function(_){return g.apply(this,arguments)}}()))}(Et);x.ports[0].postMessage({status:"done",eventId:k,eventType:ne,response:qt})})()}_subscribe(_,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[_]||(this.handlersMap[_]=new Set),this.handlersMap[_].add(I)}_unsubscribe(_,I){this.handlersMap[_]&&I&&this.handlersMap[_].delete(I),(!I||0===this.handlersMap[_].size)&&delete this.handlersMap[_],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function oa(w="",g=10){let _="";for(let I=0;I<g;I++)_+=Math.floor(10*Math.random());return w+_}class aa{constructor(g){this.target=g,this.handlers=new Set}removeMessageHandler(g){g.messageChannel&&(g.messageChannel.port1.removeEventListener("message",g.onMessage),g.messageChannel.port1.close()),this.handlers.delete(g)}_send(g,_,I=50){var x=this;return(0,f.Z)(function*(){const k="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!k)throw new Error("connection_unavailable");let ne,xe;return new Promise((tt,Et)=>{const qt=oa("",20);k.port1.start();const zn=setTimeout(()=>{Et(new Error("unsupported_event"))},I);xe={messageChannel:k,onMessage(bi){const xs=bi;if(xs.data.eventId===qt)switch(xs.data.status){case"ack":clearTimeout(zn),ne=setTimeout(()=>{Et(new Error("timeout"))},3e3);break;case"done":clearTimeout(ne),tt(xs.data.response);break;default:clearTimeout(zn),clearTimeout(ne),Et(new Error("invalid_response"))}}},x.handlers.add(xe),k.port1.addEventListener("message",xe.onMessage),x.target.postMessage({eventType:g,eventId:qt,data:_},[k.port2])}).finally(()=>{xe&&x.removeMessageHandler(xe)})})()}}function sn(){return window}function wt(){return void 0!==sn().WorkerGlobalScope&&"function"==typeof sn().importScripts}function Ys(){return(Ys=(0,f.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(w){return null}})).apply(this,arguments)}const ec="firebaseLocalStorageDb",Ki="firebaseLocalStorage",Er="fbase_key";class Do{constructor(g){this.request=g}toPromise(){return new Promise((g,_)=>{this.request.addEventListener("success",()=>{g(this.request.result)}),this.request.addEventListener("error",()=>{_(this.request.error)})})}}function Is(w,g){return w.transaction([Ki],g?"readwrite":"readonly").objectStore(Ki)}function Qs(){const w=indexedDB.open(ec,1);return new Promise((g,_)=>{w.addEventListener("error",()=>{_(w.error)}),w.addEventListener("upgradeneeded",()=>{const I=w.result;try{I.createObjectStore(Ki,{keyPath:Er})}catch(x){_(x)}}),w.addEventListener("success",(0,f.Z)(function*(){const I=w.result;I.objectStoreNames.contains(Ki)?g(I):(I.close(),yield function Qu(){const w=indexedDB.deleteDatabase(ec);return new Do(w).toPromise()}(),g(yield Qs()))}))})}function xd(w,g,_){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,f.Z)(function*(w,g,_){const I=Is(w,!0).put({[Er]:g,value:_});return new Do(I).toPromise()})).apply(this,arguments)}function To(){return(To=(0,f.Z)(function*(w,g){const _=Is(w,!1).get(g),I=yield new Do(_).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function Wn(w,g){const _=Is(w,!0).delete(g);return new Do(_).toPromise()}const Ds=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var _=this;return(0,f.Z)(function*(){return _.db||(_.db=yield Qs()),_.db})()}_withRetries(_){var I=this;return(0,f.Z)(function*(){let x=0;for(;;)try{const k=yield I._openDb();return yield _(k)}catch(k){if(x++>3)throw k;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var _=this;return(0,f.Z)(function*(){return wt()?_.initializeReceiver():_.initializeSender()})()}initializeReceiver(){var _=this;return(0,f.Z)(function*(){_.receiver=sa._getInstance(function Xl(){return wt()?self:null}()),_.receiver._subscribe("keyChanged",function(){var I=(0,f.Z)(function*(x,k){return{keyProcessed:(yield _._poll()).includes(k.key)}});return function(x,k){return I.apply(this,arguments)}}()),_.receiver._subscribe("ping",function(){var I=(0,f.Z)(function*(x,k){return["keyChanged"]});return function(x,k){return I.apply(this,arguments)}}())})()}initializeSender(){var _=this;return(0,f.Z)(function*(){var I,x;if(_.activeServiceWorker=yield function Ku(){return Ys.apply(this,arguments)}(),!_.activeServiceWorker)return;_.sender=new aa(_.activeServiceWorker);const k=yield _.sender._send("ping",{},800);!k||(null===(I=k[0])||void 0===I?void 0:I.fulfilled)&&(null===(x=k[0])||void 0===x?void 0:x.value.includes("keyChanged"))&&(_.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(_){var I=this;return(0,f.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function _f(){var w;return(null===(w=null==navigator?void 0:navigator.serviceWorker)||void 0===w?void 0:w.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:_},I.serviceWorkerReceiverAvailable?800:50)}catch(x){}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const _=yield Qs();return yield xd(_,Kl,"1"),yield Wn(_,Kl),!0}catch(_){}return!1})()}_withPendingWrite(_){var I=this;return(0,f.Z)(function*(){I.pendingWrites++;try{yield _()}finally{I.pendingWrites--}})()}_set(_,I){var x=this;return(0,f.Z)(function*(){return x._withPendingWrite((0,f.Z)(function*(){return yield x._withRetries(k=>xd(k,_,I)),x.localCache[_]=I,x.notifyServiceWorker(_)}))})()}_get(_){var I=this;return(0,f.Z)(function*(){const x=yield I._withRetries(k=>function Cs(w,g){return To.apply(this,arguments)}(k,_));return I.localCache[_]=x,x})()}_remove(_){var I=this;return(0,f.Z)(function*(){return I._withPendingWrite((0,f.Z)(function*(){return yield I._withRetries(x=>Wn(x,_)),delete I.localCache[_],I.notifyServiceWorker(_)}))})()}_poll(){var _=this;return(0,f.Z)(function*(){const I=yield _._withRetries(ne=>{const xe=Is(ne,!1).getAll();return new Do(xe).toPromise()});if(!I)return[];if(0!==_.pendingWrites)return[];const x=[],k=new Set;for(const{fbase_key:ne,value:xe}of I)k.add(ne),JSON.stringify(_.localCache[ne])!==JSON.stringify(xe)&&(_.notifyListeners(ne,xe),x.push(ne));for(const ne of Object.keys(_.localCache))_.localCache[ne]&&!k.has(ne)&&(_.notifyListeners(ne,null),x.push(ne));return x})()}notifyListeners(_,I){this.localCache[_]=I;const x=this.listeners[_];if(x)for(const k of Array.from(x))k(I)}startPolling(){var _=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return _._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(_,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[_]||(this.listeners[_]=new Set,this._get(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})();function Md(w,g){return Jt(w,"POST","/v2/accounts/mfaSignIn:start",Vt(w,g))}function Ir(){return(Ir=(0,f.Z)(function*(w){return(yield Jt(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function la(w){return new Promise((g,_)=>{const I=document.createElement("script");I.setAttribute("src",w),I.onload=g,I.onerror=x=>{const k=Fe("internal-error");k.customData=x,_(k)},I.type="text/javascript",I.charset="UTF-8",function Ju(){var w,g;return null!==(g=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==g?g:document}().appendChild(I)})}function Js(w){return`__${w}${Math.floor(1e6*Math.random())}`}const lr=1e12;class Qa{constructor(g){this.auth=g,this.counter=lr,this._widgets=new Map}render(g,_){const I=this.counter;return this._widgets.set(I,new nc(g,this.auth.name,_||{})),this.counter++,I}reset(g){var _;const I=g||lr;null===(_=this._widgets.get(I))||void 0===_||_.delete(),this._widgets.delete(I)}getResponse(g){var _;return(null===(_=this._widgets.get(g||lr))||void 0===_?void 0:_.getResponse())||""}execute(g){var _=this;return(0,f.Z)(function*(){var I;return null===(I=_._widgets.get(g||lr))||void 0===I||I.execute(),""})()}}class nc{constructor(g,_,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const x="string"==typeof g?document.getElementById(g):g;re(x,"argument-error",{appName:_}),this.container=x,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function ca(w){const g=[],_="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<w;I++)g.push(_.charAt(Math.floor(Math.random()*_.length)));return g.join("")}(50);const{callback:g,"expired-callback":_}=this.params;if(g)try{g(this.responseToken)}catch(I){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,_)try{_()}catch(I){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const rc=Js("rcb"),yf=new Ye(3e4,6e4);class Nd{constructor(){var g;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(g=sn().grecaptcha)||void 0===g?void 0:g.render)}load(g,_=""){return re(function Xu(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(_),g,"argument-error"),this.shouldResolveImmediately(_)?Promise.resolve(sn().grecaptcha):new Promise((I,x)=>{const k=sn().setTimeout(()=>{x(Fe(g,"network-request-failed"))},yf.get());sn()[rc]=()=>{sn().clearTimeout(k),delete sn()[rc];const xe=sn().grecaptcha;if(!xe)return void x(Fe(g,"internal-error"));const tt=xe.render;xe.render=(Et,qt)=>{const zn=tt(Et,qt);return this.counter++,zn},this.hostLanguage=_,I(xe)},la(`https://www.google.com/recaptcha/api.js??${(0,j.xO)({onload:rc,render:"explicit",hl:_})}`).catch(()=>{clearTimeout(k),x(Fe(g,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(g){var _;return!!(null===(_=sn().grecaptcha)||void 0===_?void 0:_.render)&&(g===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Eg{load(g){return(0,f.Z)(function*(){return new Qa(g)})()}clearedOneInstance(){}}const vf="recaptcha",Ig={theme:"light",type:"image"};class wf{constructor(g,_=Object.assign({},Ig),I){this.parameters=_,this.type=vf,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=je(I),this.isInvisible="invisible"===this.parameters.size,re("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const x="string"==typeof g?document.getElementById(g):g;re(x,this.auth,"argument-error"),this.container=x,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Eg:new Nd,this.validateStartingState()}verify(){var g=this;return(0,f.Z)(function*(){g.assertNotDestroyed();const _=yield g.render(),I=g.getAssertedRecaptcha();return I.getResponse(_)||new Promise(k=>{const ne=xe=>{!xe||(g.tokenChangeListeners.delete(ne),k(xe))};g.tokenChangeListeners.add(ne),g.isInvisible&&I.execute(_)})})()}render(){try{this.assertNotDestroyed()}catch(g){return Promise.reject(g)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(g=>{throw this.renderPromise=null,g})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(g=>{this.container.removeChild(g)})}validateStartingState(){re(!this.parameters.sitekey,this.auth,"argument-error"),re(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),re("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(g){return _=>{if(this.tokenChangeListeners.forEach(I=>I(_)),"function"==typeof g)g(_);else if("string"==typeof g){const I=sn()[g];"function"==typeof I&&I(_)}}}assertNotDestroyed(){re(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var g=this;return(0,f.Z)(function*(){if(yield g.init(),!g.widgetId){let _=g.container;if(!g.isInvisible){const I=document.createElement("div");_.appendChild(I),_=I}g.widgetId=g.getAssertedRecaptcha().render(_,g.parameters)}return g.widgetId})()}init(){var g=this;return(0,f.Z)(function*(){re(Ue()&&!wt(),g.auth,"internal-error"),yield function Pd(){let w=null;return new Promise(g=>{"complete"!==document.readyState?(w=()=>g(),window.addEventListener("load",w)):g()}).catch(g=>{throw w&&window.removeEventListener("load",w),g})}(),g.recaptcha=yield g._recaptchaLoader.load(g.auth,g.auth.languageCode||void 0);const _=yield function tc(w){return Ir.apply(this,arguments)}(g.auth);re(_,g.auth,"internal-error"),g.parameters.sitekey=_})()}getAssertedRecaptcha(){return re(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class eo{constructor(g,_){this.verificationId=g,this.onConfirmation=_}confirm(g){const _=Yo._fromVerification(this.verificationId,g);return this.onConfirmation(_)}}function Cg(w,g,_){return Mn.apply(this,arguments)}function Mn(){return(Mn=(0,f.Z)(function*(w,g,_){const I=je(w),x=yield Yr(I,g,(0,j.m9)(_));return new eo(x,k=>Gu(I,k))})).apply(this,arguments)}function Fi(w,g,_){return Un.apply(this,arguments)}function Un(){return(Un=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w);yield Ws(!1,I,"phone");const x=yield Yr(I.auth,g,(0,j.m9)(_));return new eo(x,k=>_s(I,k))})).apply(this,arguments)}function Ef(w,g,_){return Od.apply(this,arguments)}function Od(){return(Od=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w),x=yield Yr(I.auth,g,(0,j.m9)(_));return new eo(x,k=>Jo(I,k))})).apply(this,arguments)}function Yr(w,g,_){return Qr.apply(this,arguments)}function Qr(){return(Qr=(0,f.Z)(function*(w,g,_){var I;const x=yield _.verify();try{let k;if(re("string"==typeof x,w,"argument-error"),re(_.type===vf,w,"argument-error"),k="string"==typeof g?{phoneNumber:g}:g,"session"in k){const ne=k.session;if("phoneNumber"in k)return re("enroll"===ne.type,w,"internal-error"),(yield ur(w,{idToken:ne.credential,phoneEnrollmentInfo:{phoneNumber:k.phoneNumber,recaptchaToken:x}})).phoneSessionInfo.sessionInfo;{re("signin"===ne.type,w,"internal-error");const xe=(null===(I=k.multiFactorHint)||void 0===I?void 0:I.uid)||k.multiFactorUid;return re(xe,w,"missing-multi-factor-info"),(yield Md(w,{mfaPendingCredential:ne.credential,mfaEnrollmentId:xe,phoneSignInInfo:{recaptchaToken:x}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:ne}=yield hg(w,{phoneNumber:k.phoneNumber,recaptchaToken:x});return ne}}finally{_._reset()}})).apply(this,arguments)}function Ja(w,g){return So.apply(this,arguments)}function So(){return(So=(0,f.Z)(function*(w,g){yield wn((0,j.m9)(w),g)})).apply(this,arguments)}let to=(()=>{class w{constructor(_){this.providerId=w.PROVIDER_ID,this.auth=je(_)}verifyPhoneNumber(_,I){return Yr(this.auth,_,(0,j.m9)(I))}static credential(_,I){return Yo._fromVerification(_,I)}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{phoneNumber:I,temporaryProof:x}=_;return I&&x?Yo._fromTokenResponse(I,x):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function no(w,g){return g?ie(g):(re(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class da extends dn{constructor(g){super("custom","custom"),this.params=g}_getIdTokenResponse(g){return Jn(g,this._buildIdpRequest())}_linkToIdToken(g,_){return Jn(g,this._buildIdpRequest(_))}_getReauthenticationResolver(g){return Jn(g,this._buildIdpRequest())}_buildIdpRequest(g){const _={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return g&&(_.idToken=g),_}}function If(w){return vo(w.auth,new da(w),w.bypassAuthState)}function uy(w){const{auth:g,user:_}=w;return re(_,g,"internal-error"),$u(_,new da(w),w.bypassAuthState)}function Cf(w){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,f.Z)(function*(w){const{auth:g,user:_}=w;return re(_,g,"internal-error"),wn(_,new da(w),w.bypassAuthState)})).apply(this,arguments)}class Hr{constructor(g,_,I,x,k=!1){this.auth=g,this.resolver=I,this.user=x,this.bypassAuthState=k,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(_)?_:[_]}execute(){var g=this;return new Promise(function(){var _=(0,f.Z)(function*(I,x){g.pendingPromise={resolve:I,reject:x};try{g.eventManager=yield g.resolver._initialize(g.auth),yield g.onExecution(),g.eventManager.registerConsumer(g)}catch(k){g.reject(k)}});return function(I,x){return _.apply(this,arguments)}}())}onAuthEvent(g){var _=this;return(0,f.Z)(function*(){const{urlResponse:I,sessionId:x,postBody:k,tenantId:ne,error:xe,type:tt}=g;if(xe)return void _.reject(xe);const Et={auth:_.auth,requestUri:I,sessionId:x,tenantId:ne||void 0,postBody:k||void 0,user:_.user,bypassAuthState:_.bypassAuthState};try{_.resolve(yield _.getIdpTask(tt)(Et))}catch(qt){_.reject(qt)}})()}onError(g){this.reject(g)}getIdpTask(g){switch(g){case"signInViaPopup":case"signInViaRedirect":return If;case"linkViaPopup":case"linkViaRedirect":return Cf;case"reauthViaPopup":case"reauthViaRedirect":return uy;default:We(this.auth,"internal-error")}}resolve(g){Ce(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(g),this.unregisterAndCleanUp()}reject(g){Ce(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(g),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const el=new Ye(2e3,1e4);function Ao(w,g,_){return tl.apply(this,arguments)}function tl(){return(tl=(0,f.Z)(function*(w,g,_){const I=je(w);De(w,g,Gs);const x=no(I,_);return new ha(I,"signInViaPopup",g,x).executeNotNull()})).apply(this,arguments)}function eu(w,g,_){return kd.apply(this,arguments)}function kd(){return(kd=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w);De(I.auth,g,Gs);const x=no(I.auth,_);return new ha(I.auth,"reauthViaPopup",g,x,I).executeNotNull()})).apply(this,arguments)}function bg(w,g,_){return Fd.apply(this,arguments)}function Fd(){return(Fd=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w);De(I.auth,g,Gs);const x=no(I.auth,_);return new ha(I.auth,"linkViaPopup",g,x,I).executeNotNull()})).apply(this,arguments)}let ha=(()=>{class w extends Hr{constructor(_,I,x,k,ne){super(_,I,k,ne),this.provider=x,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var _=this;return(0,f.Z)(function*(){const I=yield _.execute();return re(I,_.auth,"internal-error"),I})()}onExecution(){var _=this;return(0,f.Z)(function*(){Ce(1===_.filter.length,"Popup operations only handle one event");const I=oa();_.authWindow=yield _.resolver._openPopup(_.auth,_.provider,_.filter[0],I),_.authWindow.associatedEvent=I,_.resolver._originValidation(_.auth).catch(x=>{_.reject(x)}),_.resolver._isIframeWebStorageSupported(_.auth,x=>{x||_.reject(Fe(_.auth,"web-storage-unsupported"))}),_.pollUserCancellation()})()}get eventId(){var _;return(null===(_=this.authWindow)||void 0===_?void 0:_.associatedEvent)||null}cancel(){this.reject(Fe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const _=()=>{var I,x;this.pollId=(null===(x=null===(I=this.authWindow)||void 0===I?void 0:I.window)||void 0===x?void 0:x.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(Fe(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(_,el.get())};_()}}return w.currentPopupAction=null,w})();const Jr=new Map;class xo extends Hr{constructor(g,_,I=!1){super(g,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],_,void 0,I),this.eventId=null}execute(){var g=()=>super.execute,_=this;return(0,f.Z)(function*(){let I=Jr.get(_.auth._key());if(!I){try{const k=(yield function nl(w,g){return rl.apply(this,arguments)}(_.resolver,_.auth))?yield g().call(_):null;I=()=>Promise.resolve(k)}catch(x){I=()=>Promise.reject(x)}Jr.set(_.auth._key(),I)}return _.bypassAuthState||Jr.set(_.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(g){var _=()=>super.onAuthEvent,I=this;return(0,f.Z)(function*(){if("signInViaRedirect"===g.type)return _().call(I,g);if("unknown"!==g.type){if(g.eventId){const x=yield I.auth._redirectUserForId(g.eventId);if(x)return I.user=x,_().call(I,g);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function rl(){return(rl=(0,f.Z)(function*(w,g){const _=il(g),I=bf(w);if(!(yield I._isAvailable()))return!1;const x="true"===(yield I._get(_));return yield I._remove(_),x})).apply(this,arguments)}function Ar(w,g){return nu.apply(this,arguments)}function nu(){return(nu=(0,f.Z)(function*(w,g){return bf(w)._set(il(g),"true")})).apply(this,arguments)}function Ji(){Jr.clear()}function ic(w,g){Jr.set(w._key(),g)}function bf(w){return ie(w._redirectPersistence)}function il(w){return Xt("pendingRedirect",w.config.apiKey,w.name)}function Ld(w,g,_){return function Dg(w,g,_){return fa.apply(this,arguments)}(w,g,_)}function fa(){return(fa=(0,f.Z)(function*(w,g,_){const I=je(w);De(w,g,Gs);const x=no(I,_);return yield Ar(x,I),x._openRedirect(I,g,"signInViaRedirect")})).apply(this,arguments)}function b(w,g,_){return function T(w,g,_){return R.apply(this,arguments)}(w,g,_)}function R(){return(R=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w);De(I.auth,g,Gs);const x=no(I.auth,_);yield Ar(x,I.auth);const k=yield xt(I);return x._openRedirect(I.auth,g,"reauthViaRedirect",k)})).apply(this,arguments)}function U(w,g,_){return function X(w,g,_){return ue.apply(this,arguments)}(w,g,_)}function ue(){return(ue=(0,f.Z)(function*(w,g,_){const I=(0,j.m9)(w);De(I.auth,g,Gs);const x=no(I.auth,_);yield Ws(!1,I,g.providerId),yield Ar(x,I.auth);const k=yield xt(I);return x._openRedirect(I.auth,g,"linkViaRedirect",k)})).apply(this,arguments)}function Ne(w,g){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,f.Z)(function*(w,g){return yield je(w)._initializationPromise,yt(w,g,!1)})).apply(this,arguments)}function yt(w,g){return Dt.apply(this,arguments)}function Dt(){return(Dt=(0,f.Z)(function*(w,g,_=!1){const I=je(w),x=no(I,g),ne=yield new xo(I,x,_).execute();return ne&&!_&&(delete ne.user._redirectEventId,yield I._persistUserIfCurrent(ne.user),yield I._setRedirectUser(null,g)),ne})).apply(this,arguments)}function xt(w){return ot.apply(this,arguments)}function ot(){return(ot=(0,f.Z)(function*(w){const g=oa(`${w.uid}:::`);return w._redirectEventId=g,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),g})).apply(this,arguments)}class cr{constructor(g){this.auth=g,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(g){this.consumers.add(g),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,g)&&(this.sendToConsumer(this.queuedRedirectEvent,g),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(g){this.consumers.delete(g)}onEvent(g){if(this.hasEventBeenHandled(g))return!1;let _=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(g,I)&&(_=!0,this.sendToConsumer(g,I),this.saveEventToCache(g))}),this.hasHandledPotentialRedirect||!function Xi(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ro(w);default:return!1}}(g)||(this.hasHandledPotentialRedirect=!0,_||(this.queuedRedirectEvent=g,_=!0)),_}sendToConsumer(g,_){var I;if(g.error&&!ro(g)){const x=(null===(I=g.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";_.onError(Fe(this.auth,x))}else _.onAuthEvent(g)}isEventForConsumer(g,_){const I=null===_.eventId||!!g.eventId&&g.eventId===_.eventId;return _.filter.includes(g.type)&&I}hasEventBeenHandled(g){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ro(g))}saveEventToCache(g){this.cachedEventUids.add(Ro(g)),this.lastProcessedEventTime=Date.now()}}function Ro(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(g=>g).join("-")}function ro({type:w,error:g}){return"unknown"===w&&"auth/no-auth-event"===(null==g?void 0:g.code)}function pa(w){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,f.Z)(function*(w,g={}){return Jt(w,"GET","/v1/projects",g)})).apply(this,arguments)}const ga=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ss=/^https?/;function As(){return(As=(0,f.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:g}=yield pa(w);for(const _ of g)try{if(Tg(_))return}catch(I){}We(w,"unauthorized-domain")})).apply(this,arguments)}function Tg(w){const g=de(),{protocol:_,hostname:I}=new URL(g);if(w.startsWith("chrome-extension://")){const ne=new URL(w);return""===ne.hostname&&""===I?"chrome-extension:"===_&&w.replace("chrome-extension://","")===g.replace("chrome-extension://",""):"chrome-extension:"===_&&ne.hostname===I}if(!Ss.test(_))return!1;if(ga.test(w))return I===w;const x=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+x+"|"+x+")$","i").test(I)}const ly=new Ye(3e4,6e4);function sc(){const w=sn().___jsl;if(null==w?void 0:w.H)for(const g of Object.keys(w.H))if(w.H[g].r=w.H[g].r||[],w.H[g].L=w.H[g].L||[],w.H[g].r=[...w.H[g].L],w.CP)for(let _=0;_<w.CP.length;_++)w.CP[_]=null}let Mo=null;function cy(w){return Mo=Mo||function ru(w){return new Promise((g,_)=>{var I,x,k;function ne(){sc(),gapi.load("gapi.iframes",{callback:()=>{g(gapi.iframes.getContext())},ontimeout:()=>{sc(),_(Fe(w,"network-request-failed"))},timeout:ly.get()})}if(null===(x=null===(I=sn().gapi)||void 0===I?void 0:I.iframes)||void 0===x?void 0:x.Iframe)g(gapi.iframes.getContext());else{if(!(null===(k=sn().gapi)||void 0===k?void 0:k.load)){const xe=Js("iframefcb");return sn()[xe]=()=>{gapi.load?ne():_(Fe(w,"network-request-failed"))},la(`https://apis.google.com/js/api.js?onload=${xe}`).catch(tt=>_(tt))}ne()}}).catch(g=>{throw Mo=null,g})}(w),Mo}const dy=new Ye(5e3,15e3),Vd={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ac=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kw(w){const g=w.config;re(g.authDomain,w,"auth-domain-config-required");const _=g.emulator?pn(g,"emulator/auth/iframe"):`https://${w.config.authDomain}/__/auth/iframe`,I={apiKey:g.apiKey,appName:w.name,v:P.SDK_VERSION},x=ac.get(w.config.apiHost);x&&(I.eid=x);const k=w._getFrameworks();return k.length&&(I.fw=k.join(",")),`${_}?${(0,j.xO)(I).slice(1)}`}function hy(){return hy=(0,f.Z)(function*(w){const g=yield cy(w),_=sn().gapi;return re(_,w,"internal-error"),g.open({where:document.body,url:Kw(w),messageHandlersFilter:_.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Vd,dontclear:!0},I=>new Promise(function(){var x=(0,f.Z)(function*(k,ne){yield I.restyle({setHideOnLeave:!1});const xe=Fe(w,"network-request-failed"),tt=sn().setTimeout(()=>{ne(xe)},dy.get());function Et(){sn().clearTimeout(tt),k(I)}I.ping(Et).then(Et,()=>{ne(xe)})});return function(k,ne){return x.apply(this,arguments)}}()))}),hy.apply(this,arguments)}const Ud={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class sl{constructor(g){this.window=g,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(g){}}}function jd(w,g,_,I,x,k){re(w.config.authDomain,w,"auth-domain-config-required"),re(w.config.apiKey,w,"invalid-api-key");const ne={apiKey:w.config.apiKey,appName:w.name,authType:_,redirectUrl:I,v:P.SDK_VERSION,eventId:x};if(g instanceof Gs){g.setDefaultLanguage(w.languageCode),ne.providerId=g.providerId||"",(0,j.xb)(g.getCustomParameters())||(ne.customParameters=JSON.stringify(g.getCustomParameters()));for(const[tt,Et]of Object.entries(k||{}))ne[tt]=Et}if(g instanceof Ci){const tt=g.getScopes().filter(Et=>""!==Et);tt.length>0&&(ne.scopes=tt.join(","))}w.tenantId&&(ne.tid=w.tenantId);const xe=ne;for(const tt of Object.keys(xe))void 0===xe[tt]&&delete xe[tt];return`${function ma({config:w}){return w.emulator?pn(w,"emulator/auth/handler"):`https://${w.authDomain}/__/auth/handler`}(w)}?${(0,j.xO)(xe).slice(1)}`}const _a="webStorageSupport",xg=class gy{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zu,this._completeRedirectFn=yt,this._overrideRedirectResult=ic}_openPopup(g,_,I,x){var k=this;return(0,f.Z)(function*(){var ne;Ce(null===(ne=k.eventManagers[g._key()])||void 0===ne?void 0:ne.manager,"_initialize() not called before _openPopup()");const xe=jd(g,_,I,de(),x);return function fy(w,g,_,I=500,x=600){const k=Math.max((window.screen.availHeight-x)/2,0).toString(),ne=Math.max((window.screen.availWidth-I)/2,0).toString();let xe="";const tt=Object.assign(Object.assign({},Ud),{width:I.toString(),height:x.toString(),top:k,left:ne}),Et=(0,j.z$)().toLowerCase();_&&(xe=Se(Et)?"_blank":_),Q(Et)&&(g=g||"http://localhost",tt.scrollbars="yes");const qt=Object.entries(tt).reduce((bi,[xs,ou])=>`${bi}${xs}=${ou},`,"");if(function oi(w=(0,j.z$)()){var g;return Ut(w)&&!!(null===(g=window.navigator)||void 0===g?void 0:g.standalone)}(Et)&&"_self"!==xe)return function Ag(w,g){const _=document.createElement("a");_.href=w,_.target=g;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),_.dispatchEvent(I)}(g||"",xe),new sl(null);const zn=window.open(g||"",xe,qt);re(zn,w,"popup-blocked");try{zn.focus()}catch(bi){}return new sl(zn)}(g,xe,oa())})()}_openRedirect(g,_,I,x){var k=this;return(0,f.Z)(function*(){return yield k._originValidation(g),function er(w){sn().location.href=w}(jd(g,_,I,de(),x)),new Promise(()=>{})})()}_initialize(g){const _=g._key();if(this.eventManagers[_]){const{manager:x,promise:k}=this.eventManagers[_];return x?Promise.resolve(x):(Ce(k,"If manager is not set, promise should be"),k)}const I=this.initAndGetManager(g);return this.eventManagers[_]={promise:I},I.catch(()=>{delete this.eventManagers[_]}),I}initAndGetManager(g){var _=this;return(0,f.Z)(function*(){const I=yield function Yw(w){return hy.apply(this,arguments)}(g),x=new cr(g);return I.register("authEvent",k=>(re(null==k?void 0:k.authEvent,g,"invalid-auth-event"),{status:x.onEvent(k.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),_.eventManagers[g._key()]={manager:x},_.iframes[g._key()]=I,x})()}_isIframeWebStorageSupported(g,_){this.iframes[g._key()].send(_a,{type:_a},x=>{var k;const ne=null===(k=null==x?void 0:x[0])||void 0===k?void 0:k[_a];void 0!==ne&&_(!!ne),We(g,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(g){const _=g._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function Li(w){return As.apply(this,arguments)}(g)),this.originValidationPromises[_]}get _shouldInitProactively(){return Ur()||Y()||Ut()}};class Mg extends class Rg{constructor(g){this.factorId=g}_process(g,_,I){switch(_.type){case"enroll":return this._finalizeEnroll(g,_.credential,I);case"signin":return this._finalizeSignIn(g,_.credential);default:return ge("unexpected MultiFactorSessionType")}}}{constructor(g){super("phone"),this.credential=g}static _fromCredential(g){return new Mg(g)}_finalizeEnroll(g,_,I){return function Sd(w,g){return Jt(w,"POST","/v2/accounts/mfaEnrollment:finalize",Vt(w,g))}(g,{idToken:_,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(g,_){return function Ya(w,g){return Jt(w,"POST","/v2/accounts/mfaSignIn:finalize",Vt(w,g))}(g,{mfaPendingCredential:_,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let my=(()=>{class w{constructor(){}static assertion(_){return Mg._fromCredential(_)}}return w.FACTOR_ID="phone",w})();var _y="@firebase/auth";class yy{constructor(g){this.auth=g,this.internalListeners=new Map}getUid(){var g;return this.assertAuthConfigured(),(null===(g=this.auth.currentUser)||void 0===g?void 0:g.uid)||null}getToken(g){var _=this;return(0,f.Z)(function*(){return _.assertAuthConfigured(),yield _.auth._initializationPromise,_.auth.currentUser?{accessToken:yield _.auth.currentUser.getIdToken(g)}:null})()}addAuthTokenListener(g){if(this.assertAuthConfigured(),this.internalListeners.has(g))return;const _=this.auth.onIdTokenChanged(I=>{var x;g((null===(x=I)||void 0===x?void 0:x.stsTokenManager.accessToken)||null)});this.internalListeners.set(g,_),this.updateProactiveRefresh()}removeAuthTokenListener(g){this.assertAuthConfigured();const _=this.internalListeners.get(g);!_||(this.internalListeners.delete(g),_(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}!function vy(w){(0,P._registerComponent)(new ye.wA("auth",(g,{options:_})=>{const I=g.getProvider("app").getImmediate(),x=g.getProvider("heartbeat"),{apiKey:k,authDomain:ne}=I.options;return((xe,tt)=>{re(k&&!k.includes(":"),"invalid-api-key",{appName:xe.name}),re(!(null==ne?void 0:ne.includes(":")),"argument-error",{appName:xe.name});const Et={apiKey:k,authDomain:ne,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_r(w)},qt=new ai(xe,tt,Et);return function ve(w,g){const _=(null==g?void 0:g.persistence)||[],I=(Array.isArray(_)?_:[_]).map(ie);(null==g?void 0:g.errorMap)&&w._updateErrorMap(g.errorMap),w._initializeWithPersistence(I,null==g?void 0:g.popupRedirectResolver)}(qt,_),qt})(I,x)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((g,_,I)=>{g.getProvider("auth-internal").initialize()})),(0,P._registerComponent)(new ye.wA("auth-internal",g=>{const _=je(g.getProvider("auth").getImmediate());return new yy(_)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,P.registerVersion)(_y,"0.20.6",function Sf(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,P.registerVersion)(_y,"0.20.6","esm2017")}("Browser")},2090:(nt,be,F)=>{F.d(be,{$s:()=>Fn,BH:()=>qe,DV:()=>Jt,Dv:()=>Vr,G6:()=>re,GJ:()=>nn,L:()=>le,LL:()=>de,Mn:()=>De,Pz:()=>Lt,Sg:()=>Pe,UG:()=>_e,UI:()=>Mi,US:()=>ye,Wj:()=>or,Yr:()=>ze,ZB:()=>q,ZR:()=>ve,b$:()=>We,cI:()=>Qt,d:()=>Fe,dS:()=>Ht,eu:()=>Ce,g5:()=>P,gK:()=>sr,gQ:()=>Gi,h$:()=>me,hl:()=>ge,hu:()=>j,jU:()=>Te,lb:()=>cs,m9:()=>zr,ne:()=>vt,p$:()=>G,pd:()=>kn,r3:()=>Vt,ru:()=>Ze,tV:()=>we,uI:()=>Ge,ug:()=>gt,vZ:()=>Fr,w1:()=>Me,w9:()=>gn,xO:()=>yi,xb:()=>Dn,z$:()=>Ve,zI:()=>J,zd:()=>Ni});const j=function(z,H){if(!z)throw P(H)},P=function(z){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+z)},ae=function(z){const H=[];let B=0;for(let $=0;$<z.length;$++){let Z=z.charCodeAt($);Z<128?H[B++]=Z:Z<2048?(H[B++]=Z>>6|192,H[B++]=63&Z|128):55296==(64512&Z)&&$+1<z.length&&56320==(64512&z.charCodeAt($+1))?(Z=65536+((1023&Z)<<10)+(1023&z.charCodeAt(++$)),H[B++]=Z>>18|240,H[B++]=Z>>12&63|128,H[B++]=Z>>6&63|128,H[B++]=63&Z|128):(H[B++]=Z>>12|224,H[B++]=Z>>6&63|128,H[B++]=63&Z|128)}return H},ye={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(z,H){if(!Array.isArray(z))throw Error("encodeByteArray takes an array as a parameter");this.init_();const B=H?this.byteToCharMapWebSafe_:this.byteToCharMap_,$=[];for(let Z=0;Z<z.length;Z+=3){const Re=z[Z],$e=Z+1<z.length,bt=$e?z[Z+1]:0,rn=Z+2<z.length,Xt=rn?z[Z+2]:0;let Q=(15&bt)<<2|Xt>>6,Y=63&Xt;rn||(Y=64,$e||(Q=64)),$.push(B[Re>>2],B[(3&Re)<<4|bt>>4],B[Q],B[Y])}return $.join("")},encodeString(z,H){return this.HAS_NATIVE_SUPPORT&&!H?btoa(z):this.encodeByteArray(ae(z),H)},decodeString(z,H){return this.HAS_NATIVE_SUPPORT&&!H?atob(z):function(z){const H=[];let B=0,$=0;for(;B<z.length;){const Z=z[B++];if(Z<128)H[$++]=String.fromCharCode(Z);else if(Z>191&&Z<224){const Re=z[B++];H[$++]=String.fromCharCode((31&Z)<<6|63&Re)}else if(Z>239&&Z<365){const rn=((7&Z)<<18|(63&z[B++])<<12|(63&z[B++])<<6|63&z[B++])-65536;H[$++]=String.fromCharCode(55296+(rn>>10)),H[$++]=String.fromCharCode(56320+(1023&rn))}else{const Re=z[B++],$e=z[B++];H[$++]=String.fromCharCode((15&Z)<<12|(63&Re)<<6|63&$e)}}return H.join("")}(this.decodeStringToByteArray(z,H))},decodeStringToByteArray(z,H){this.init_();const B=H?this.charToByteMapWebSafe_:this.charToByteMap_,$=[];for(let Z=0;Z<z.length;){const Re=B[z.charAt(Z++)],bt=Z<z.length?B[z.charAt(Z)]:0;++Z;const Xt=Z<z.length?B[z.charAt(Z)]:64;++Z;const ee=Z<z.length?B[z.charAt(Z)]:64;if(++Z,null==Re||null==bt||null==Xt||null==ee)throw Error();$.push(Re<<2|bt>>4),64!==Xt&&($.push(bt<<4&240|Xt>>2),64!==ee&&$.push(Xt<<6&192|ee))}return $},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let z=0;z<this.ENCODED_VALS.length;z++)this.byteToCharMap_[z]=this.ENCODED_VALS.charAt(z),this.charToByteMap_[this.byteToCharMap_[z]]=z,this.byteToCharMapWebSafe_[z]=this.ENCODED_VALS_WEBSAFE.charAt(z),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[z]]=z,z>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(z)]=z,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(z)]=z)}}},me=function(z){const H=ae(z);return ye.encodeByteArray(H,!0)},le=function(z){return me(z).replace(/\./g,"")},we=function(z){try{return ye.decodeString(z,!0)}catch(H){console.error("base64Decode failed: ",H)}return null};function G(z){return q(void 0,z)}function q(z,H){if(!(H instanceof Object))return H;switch(H.constructor){case Date:return new Date(H.getTime());case Object:void 0===z&&(z={});break;case Array:z=[];break;default:return H}for(const B in H)!H.hasOwnProperty(B)||!se(B)||(z[B]=q(z[B],H[B]));return z}function se(z){return"__proto__"!==z}class qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((H,B)=>{this.resolve=H,this.reject=B})}wrapCallback(H){return(B,$)=>{B?this.reject(B):this.resolve($),"function"==typeof H&&(this.promise.catch(()=>{}),1===H.length?H(B):H(B,$))}}}function Pe(z,H){if(z.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const $=H||"demo-project",Z=z.iat||0,Re=z.sub||z.user_id;if(!Re)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const $e=Object.assign({iss:`https://securetoken.google.com/${$}`,aud:$,iat:Z,exp:Z+3600,auth_time:Z,sub:Re,user_id:Re,firebase:{sign_in_provider:"custom",identities:{}}},z);return[le(JSON.stringify({alg:"none",type:"JWT"})),le(JSON.stringify($e)),""].join(".")}function Ve(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ge(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function _e(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(z){return!1}}function Te(){return"object"==typeof self&&self.self===self}function Ze(){const z="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof z&&void 0!==z.id}function We(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Fe(){return Ve().indexOf("Electron/")>=0}function Me(){const z=Ve();return z.indexOf("MSIE ")>=0||z.indexOf("Trident/")>=0}function De(){return Ve().indexOf("MSAppHost/")>=0}function ze(){return!1}function re(){return!_e()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ge(){return"object"==typeof indexedDB}function Ce(){return new Promise((z,H)=>{try{let B=!0;const $="validate-browser-context-for-indexeddb-analytics-module",Z=self.indexedDB.open($);Z.onsuccess=()=>{Z.result.close(),B||self.indexedDB.deleteDatabase($),z(!0)},Z.onupgradeneeded=()=>{B=!1},Z.onerror=()=>{var Re;H((null===(Re=Z.error)||void 0===Re?void 0:Re.message)||"")}}catch(B){H(B)}})}function J(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class ve extends Error{constructor(H,B,$){super(B),this.code=H,this.customData=$,this.name="FirebaseError",Object.setPrototypeOf(this,ve.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,de.prototype.create)}}class de{constructor(H,B,$){this.service=H,this.serviceName=B,this.errors=$}create(H,...B){const $=B[0]||{},Z=`${this.service}/${H}`,Re=this.errors[H],$e=Re?function Ue(z,H){return z.replace(_t,(B,$)=>{const Z=H[$];return null!=Z?String(Z):`<${$}?>`})}(Re,$):"Error";return new ve(Z,`${this.serviceName}: ${$e} (${Z}).`,$)}}const _t=/\{\$([^}]+)}/g;function Qt(z){return JSON.parse(z)}function Lt(z){return JSON.stringify(z)}const Ye=function(z){let H={},B={},$={},Z="";try{const Re=z.split(".");H=Qt(we(Re[0])||""),B=Qt(we(Re[1])||""),Z=Re[2],$=B.d||{},delete B.d}catch(Re){}return{header:H,claims:B,data:$,signature:Z}},gn=function(z){const B=Ye(z).claims;return!!B&&"object"==typeof B&&B.hasOwnProperty("iat")},nn=function(z){const H=Ye(z).claims;return"object"==typeof H&&!0===H.admin};function Vt(z,H){return Object.prototype.hasOwnProperty.call(z,H)}function Jt(z,H){if(Object.prototype.hasOwnProperty.call(z,H))return z[H]}function Dn(z){for(const H in z)if(Object.prototype.hasOwnProperty.call(z,H))return!1;return!0}function Mi(z,H,B){const $={};for(const Z in z)Object.prototype.hasOwnProperty.call(z,Z)&&($[Z]=H.call(B,z[Z],Z,z));return $}function Fr(z,H){if(z===H)return!0;const B=Object.keys(z),$=Object.keys(H);for(const Z of B){if(!$.includes(Z))return!1;const Re=z[Z],$e=H[Z];if(Rn(Re)&&Rn($e)){if(!Fr(Re,$e))return!1}else if(Re!==$e)return!1}for(const Z of $)if(!B.includes(Z))return!1;return!0}function Rn(z){return null!==z&&"object"==typeof z}function yi(z){const H=[];for(const[B,$]of Object.entries(z))Array.isArray($)?$.forEach(Z=>{H.push(encodeURIComponent(B)+"="+encodeURIComponent(Z))}):H.push(encodeURIComponent(B)+"="+encodeURIComponent($));return H.length?"&"+H.join("&"):""}function Ni(z){const H={};return z.replace(/^\?/,"").split("&").forEach($=>{if($){const[Z,Re]=$.split("=");H[decodeURIComponent(Z)]=decodeURIComponent(Re)}}),H}function kn(z){const H=z.indexOf("?");if(!H)return"";const B=z.indexOf("#",H);return z.substring(H,B>0?B:void 0)}class Gi{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let H=1;H<this.blockSize;++H)this.pad_[H]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(H,B){B||(B=0);const $=this.W_;if("string"==typeof H)for(let ee=0;ee<16;ee++)$[ee]=H.charCodeAt(B)<<24|H.charCodeAt(B+1)<<16|H.charCodeAt(B+2)<<8|H.charCodeAt(B+3),B+=4;else for(let ee=0;ee<16;ee++)$[ee]=H[B]<<24|H[B+1]<<16|H[B+2]<<8|H[B+3],B+=4;for(let ee=16;ee<80;ee++){const Q=$[ee-3]^$[ee-8]^$[ee-14]^$[ee-16];$[ee]=4294967295&(Q<<1|Q>>>31)}let Xt,ar,Z=this.chain_[0],Re=this.chain_[1],$e=this.chain_[2],bt=this.chain_[3],rn=this.chain_[4];for(let ee=0;ee<80;ee++){ee<40?ee<20?(Xt=bt^Re&($e^bt),ar=1518500249):(Xt=Re^$e^bt,ar=1859775393):ee<60?(Xt=Re&$e|bt&(Re|$e),ar=2400959708):(Xt=Re^$e^bt,ar=3395469782);const Q=(Z<<5|Z>>>27)+Xt+rn+ar+$[ee]&4294967295;rn=bt,bt=$e,$e=4294967295&(Re<<30|Re>>>2),Re=Z,Z=Q}this.chain_[0]=this.chain_[0]+Z&4294967295,this.chain_[1]=this.chain_[1]+Re&4294967295,this.chain_[2]=this.chain_[2]+$e&4294967295,this.chain_[3]=this.chain_[3]+bt&4294967295,this.chain_[4]=this.chain_[4]+rn&4294967295}update(H,B){if(null==H)return;void 0===B&&(B=H.length);const $=B-this.blockSize;let Z=0;const Re=this.buf_;let $e=this.inbuf_;for(;Z<B;){if(0===$e)for(;Z<=$;)this.compress_(H,Z),Z+=this.blockSize;if("string"==typeof H){for(;Z<B;)if(Re[$e]=H.charCodeAt(Z),++$e,++Z,$e===this.blockSize){this.compress_(Re),$e=0;break}}else for(;Z<B;)if(Re[$e]=H[Z],++$e,++Z,$e===this.blockSize){this.compress_(Re),$e=0;break}}this.inbuf_=$e,this.total_+=B}digest(){const H=[];let B=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let Z=this.blockSize-1;Z>=56;Z--)this.buf_[Z]=255&B,B/=256;this.compress_(this.buf_);let $=0;for(let Z=0;Z<5;Z++)for(let Re=24;Re>=0;Re-=8)H[$]=this.chain_[Z]>>Re&255,++$;return H}}function vt(z,H){const B=new Lr(z,H);return B.subscribe.bind(B)}class Lr{constructor(H,B){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=B,this.task.then(()=>{H(this)}).catch($=>{this.error($)})}next(H){this.forEachObserver(B=>{B.next(H)})}error(H){this.forEachObserver(B=>{B.error(H)}),this.close(H)}complete(){this.forEachObserver(H=>{H.complete()}),this.close()}subscribe(H,B,$){let Z;if(void 0===H&&void 0===B&&void 0===$)throw new Error("Missing Observer.");Z=function un(z,H){if("object"!=typeof z||null===z)return!1;for(const B of H)if(B in z&&"function"==typeof z[B])return!0;return!1}(H,["next","error","complete"])?H:{next:H,error:B,complete:$},void 0===Z.next&&(Z.next=ir),void 0===Z.error&&(Z.error=ir),void 0===Z.complete&&(Z.complete=ir);const Re=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Z.error(this.finalError):Z.complete()}catch($e){}}),this.observers.push(Z),Re}unsubscribeOne(H){void 0===this.observers||void 0===this.observers[H]||(delete this.observers[H],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(H){if(!this.finalized)for(let B=0;B<this.observers.length;B++)this.sendOne(B,H)}sendOne(H,B){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[H])try{B(this.observers[H])}catch($){"undefined"!=typeof console&&console.error&&console.error($)}})}close(H){this.finalized||(this.finalized=!0,void 0!==H&&(this.finalError=H),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ir(){}const Vr=function(z,H,B,$){let Z;if($<H?Z="at least "+H:$>B&&(Z=0===B?"none":"no more than "+B),Z)throw new Error(z+" failed: Was called with "+$+(1===$?" argument.":" arguments.")+" Expects "+Z+".")};function sr(z,H){return`${z} failed: ${H} argument `}function or(z,H,B,$){if((!$||B)&&"function"!=typeof B)throw new Error(sr(z,H)+"must be a valid function.")}function cs(z,H,B,$){if((!$||B)&&("object"!=typeof B||null===B))throw new Error(sr(z,H)+"must be a valid context object.")}const Ht=function(z){const H=[];let B=0;for(let $=0;$<z.length;$++){let Z=z.charCodeAt($);if(Z>=55296&&Z<=56319){const Re=Z-55296;$++,j($<z.length,"Surrogate pair missing trail surrogate."),Z=65536+(Re<<10)+(z.charCodeAt($)-56320)}Z<128?H[B++]=Z:Z<2048?(H[B++]=Z>>6|192,H[B++]=63&Z|128):Z<65536?(H[B++]=Z>>12|224,H[B++]=Z>>6&63|128,H[B++]=63&Z|128):(H[B++]=Z>>18|240,H[B++]=Z>>12&63|128,H[B++]=Z>>6&63|128,H[B++]=63&Z|128)}return H},gt=function(z){let H=0;for(let B=0;B<z.length;B++){const $=z.charCodeAt(B);$<128?H++:$<2048?H+=2:$>=55296&&$<=56319?(H+=4,B++):H+=3}return H};function Fn(z,H=1e3,B=2){const $=H*Math.pow(B,z),Z=Math.round(.5*$*(Math.random()-.5)*2);return Math.min(144e5,$+Z)}function zr(z){return z&&z._delegate?z._delegate:z}},6988:(nt,be,F)=>{var f=F(5e3);let j=null;function P(){return j}const me=new f.OlP("DocumentToken");let le=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return function we(){return(0,f.LFG)(q)}()},providedIn:"platform"}),n})();const G=new f.OlP("Location Initialized");let q=(()=>{class n extends le{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return P().getBaseHref(this._doc)}onPopState(t){const r=P().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=P().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){se()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){se()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(me))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function qe(){return new q((0,f.LFG)(me))}()},providedIn:"platform"}),n})();function se(){return!!window.history.pushState}function Pe(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Ve(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ge(n){return n&&"?"!==n[0]?"?"+n:n}let _e=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return function Te(n){const e=(0,f.LFG)(me).location;return new We((0,f.LFG)(le),e&&e.origin||"")}()},providedIn:"root"}),n})();const Ze=new f.OlP("appBaseHref");let We=(()=>{class n extends _e{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Pe(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Ge(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+Ge(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+Ge(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(le),f.LFG(Ze,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Fe=(()=>{class n extends _e{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Pe(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+Ge(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+Ge(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(le),f.LFG(Ze,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Me=(()=>{class n{constructor(t,r){this._subject=new f.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=Ve(re(i)),this._platformStrategy.onPopState(a=>{this._subject.emit({url:this.path(!0),pop:!0,state:a.state,type:a.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ge(r))}normalize(t){return n.stripTrailingSlash(function ze(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,re(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._platformStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ge(r)),i)}replaceState(t,r="",i=null){this._platformStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ge(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=Ge,n.joinWithSlash=Pe,n.stripTrailingSlash=Ve,n.\u0275fac=function(t){return new(t||n)(f.LFG(_e),f.LFG(le))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function De(){return new Me((0,f.LFG)(_e),(0,f.LFG)(le))}()},providedIn:"root"}),n})();function re(n){return n.replace(/\/index.html$/,"")}let mo=(()=>{class n{constructor(t,r,i,a){this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=i,this._renderer=a,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&((0,f.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,f.AaK)(r.item)}`);this._toggleClass(r.item,!0)}),t.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!0)):Object.keys(t).forEach(r=>this._toggleClass(r,!!t[r])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!1)):Object.keys(t).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(t,r){(t=t.trim())&&t.split(/\s+/g).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.ZZ4),f.Y36(f.aQg),f.Y36(f.SBq),f.Y36(f.Qsj))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class Zo{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Pn=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Zo(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const h=r.get(a);r.move(h,l),Hs(h,i)}});for(let i=0,a=r.length;i<a;i++){const h=r.get(i).context;h.index=i,h.count=a,h.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{Hs(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc),f.Y36(f.ZZ4))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function Hs(n,e){n.context.$implicit=e.item}let Kr=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new mn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){sd("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){sd("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class mn{constructor(){this.$implicit=null,this.ngIf=null}}function sd(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,f.AaK)(e)}'.`)}let qs=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function jr(n){return"server"===n}let ju=(()=>{class n{}return n.\u0275prov=(0,f.Yz7)({token:n,providedIn:"root",factory:()=>new Hu((0,f.LFG)(me),window)}),n})();class Hu{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function ms(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Hl(this.window.history)||Hl(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function Hl(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Ws extends class ja extends class ye{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ce(n){j||(j=n)}(new Ws)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function $u(){return _n=_n||document.querySelector("base"),_n?_n.getAttribute("href"):null}();return null==t?null:function vo(n){Ha=Ha||document.createElement("a"),Ha.setAttribute("href",n);const e=Ha.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){_n=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Wo(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ha,_n=null;const yr=new f.OlP("TRANSITION_ID"),Vn=[{provide:f.ip1,useFactory:function Gu(n,e,t){return()=>{t.get(f.CZH).donePromise.then(()=>{const r=P(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[yr,me,f.zs3],multi:!0}];class _s{static init(){(0,f.VLi)(new _s)}addToWindow(e){f.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},f.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(r=>{const i=f.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(m){l=l||m,a--,0==a&&r(l)};i.forEach(function(m){m.whenStable(h)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?P().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let vr=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Jo=new f.OlP("EventManagerPlugins");let Wi=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Jo),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class Gl{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=P().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let ui=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),zs=(()=>{class n extends ui{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Zs),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Zs))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(me))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function Zs(n){P().remove(n)}const Ct={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wo=/%COMP%/g;function Ks(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Ks(n,i,t):(i=i.replace(wo,n),t.push(i))}return t}function ke(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Wu=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Cn(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case f.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new zi(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case f.ifc.ShadowDom:return new ql(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=Ks(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Wi),f.LFG(zs),f.LFG(f.AFp))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class Cn{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Ct[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=Ct[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Ct[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(f.JOm.DashCase|f.JOm.Important)?e.style.setProperty(t,r,i&f.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&f.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,ke(r)):this.eventManager.addEventListener(e,t,ke(r))}}class zi extends Cn{constructor(e,t,r,i){super(e),this.component=r;const a=Ks(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function Xo(n){return"_ngcontent-%COMP%".replace(wo,n)}(i+"-"+r.id),this.hostAttr=function df(n){return"_nghost-%COMP%".replace(wo,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class ql extends Cn{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=Ks(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const h=document.createElement("style");h.textContent=a[l],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Ga=(()=>{class n extends Gl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(me))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const hf=["alt","control","meta","shift"],wd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Eo={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},wr={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Zi=(()=>{class n extends Gl{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>P().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="";if(hf.forEach(m=>{const v=r.indexOf(m);v>-1&&(r.splice(v,1),l+=m+".")}),l+=a,0!=r.length||0===a.length)return null;const h={};return h.domEventName=i,h.fullKey=l,h}static getEventFullKey(t){let r="",i=function ea(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Eo.hasOwnProperty(e)&&(e=Eo[e]))}return wd[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),hf.forEach(a=>{a!=i&&wr[a](t)&&(r+=a+".")}),r+=i,r}static eventCallback(t,r,i){return a=>{n.getEventFullKey(a)===t&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(me))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Ed=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:"browser"},{provide:f.g9A,useValue:function ta(){Ws.makeCurrent(),_s.init()},multi:!0},{provide:me,useFactory:function ff(){return(0,f.RDi)(document),document},deps:[]}]),qa=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function li(){return new f.qLn},deps:[]},{provide:Jo,useClass:Ga,multi:!0,deps:[me,f.R0b,f.Lbi]},{provide:Jo,useClass:Zi,multi:!0,deps:[me]},{provide:Wu,useClass:Wu,deps:[Wi,zs,f.AFp]},{provide:f.FYo,useExisting:Wu},{provide:ui,useExisting:zs},{provide:zs,useClass:zs,deps:[me]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b]},{provide:Wi,useClass:Wi,deps:[Jo,f.R0b]},{provide:class wn{},useClass:vr,deps:[]}];let Wl=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:f.AFp,useValue:t.appId},{provide:yr,useExisting:f.AFp},Vn]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(n,12))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:qa,imports:[qs,f.hGG]}),n})();"undefined"!=typeof window&&window;var En=F(8996),Es=F(8306);const{isArray:di}=Array,{getPrototypeOf:Ql,prototype:Zu,keys:Jl}=Object;function sa(n){if(1===n.length){const e=n[0];if(di(e))return{args:e,keys:null};if(function oa(n){return n&&"object"==typeof n&&Ql(n)===Zu}(e)){const t=Jl(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}var aa=F(8421),sn=F(7669),er=F(5403),wt=F(4004);const{isArray:Ku}=Array;function _f(n){return(0,wt.U)(e=>function Ys(n,e){return Ku(e)?n(...e):n(e)}(n,e))}function Xl(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}let Yu=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq))},n.\u0275dir=f.lG2({type:n}),n})(),Ki=(()=>{class n extends Yu{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,features:[f.qOj]}),n})();const Er=new f.OlP("NgValueAccessor"),Qu={provide:Er,useExisting:(0,f.Gpc)(()=>Yi),multi:!0},xd=new f.OlP("CompositionEventMode");let Yi=(()=>{class n extends Yu{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Qs(){const n=P()?P().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(xd,8))},n.\u0275dir=f.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&f.NdJ("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[f._Bn([Qu]),f.qOj]}),n})();function Cs(n){return null==n||0===n.length}function To(n){return null!=n&&"number"==typeof n.length}const Wn=new f.OlP("NgValidators"),bs=new f.OlP("NgAsyncValidators"),Rd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ua{static min(e){return function Ds(n){return e=>{if(Cs(e.value)||Cs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function Md(n){return e=>{if(Cs(e.value)||Cs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return Ya(e)}static requiredTrue(e){return function tc(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function Ir(n){return Cs(n.value)||Rd.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function Ju(n){return e=>Cs(e.value)||!To(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function la(n){return e=>To(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function Js(n){if(!n)return Qi;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Cs(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return yf(e)}static composeAsync(e){return Nd(e)}}function Ya(n){return Cs(n.value)?{required:!0}:null}function Qi(n){return null}function Xs(n){return null!=n}function lr(n){const e=(0,f.QGY)(n)?(0,En.D)(n):n;return(0,f.CqO)(e),e}function Qa(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function nc(n,e){return e.map(t=>t(n))}function rc(n){return n.map(e=>function ca(n){return!n.validate}(e)?e:t=>e.validate(t))}function yf(n){if(!n)return null;const e=n.filter(Xs);return 0==e.length?null:function(t){return Qa(nc(t,e))}}function An(n){return null!=n?yf(rc(n)):null}function Nd(n){if(!n)return null;const e=n.filter(Xs);return 0==e.length?null:function(t){return function ec(...n){const e=(0,sn.jO)(n),{args:t,keys:r}=sa(n),i=new Es.y(a=>{const{length:l}=t;if(!l)return void a.complete();const h=new Array(l);let m=l,v=l;for(let D=0;D<l;D++){let S=!1;(0,aa.Xf)(t[D]).subscribe((0,er.x)(a,N=>{S||(S=!0,v--),h[D]=N},()=>m--,void 0,()=>{(!m||!S)&&(v||a.next(r?Xl(r,h):h),a.complete())}))}});return e?i.pipe(_f(e)):i}(nc(t,e).map(lr)).pipe((0,wt.U)(Qa))}}function Xu(n){return null!=n?Nd(rc(n)):null}function Eg(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function vf(n){return n._rawValidators}function Ig(n){return n._rawAsyncValidators}function wf(n){return n?Array.isArray(n)?n:[n]:[]}function Pd(n,e){return Array.isArray(n)?n.includes(e):n===e}function eo(n,e){const t=wf(e);return wf(n).forEach(i=>{Pd(t,i)||t.push(i)}),t}function Cg(n,e){return wf(e).filter(t=>!Pd(n,t))}class Mn{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=An(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Xu(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Fi extends Mn{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Un extends Mn{get formDirective(){return null}get path(){return null}}class Ef{constructor(e){this._cd=e}is(e){var t,r,i;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(i=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===i?void 0:i[e])}}let Qr=(()=>{class n extends Ef{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Fi,2))},n.\u0275dir=f.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&f.ekj("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[f.qOj]}),n})(),Ja=(()=>{class n extends Ef{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Un,10))},n.\u0275dir=f.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&f.ekj("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))("ng-submitted",r.is("submitted"))},features:[f.qOj]}),n})();function tu(n,e){rl(n,e),e.valueAccessor.writeValue(n.value),function nu(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&ic(n,e)})}(n,e),function bf(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Ji(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&ic(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function nl(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Jr(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Ar(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function xo(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function rl(n,e){const t=vf(n);null!==e.validator?n.setValidators(Eg(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=Ig(n);null!==e.asyncValidator?n.setAsyncValidators(Eg(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();xo(e._rawValidators,i),xo(e._rawAsyncValidators,i)}function Ar(n,e){let t=!1;if(null!==n){if(null!==e.validator){const i=vf(n);if(Array.isArray(i)&&i.length>0){const a=i.filter(l=>l!==e.validator);a.length!==i.length&&(t=!0,n.setValidators(a))}}if(null!==e.asyncValidator){const i=Ig(n);if(Array.isArray(i)&&i.length>0){const a=i.filter(l=>l!==e.asyncValidator);a.length!==i.length&&(t=!0,n.setAsyncValidators(a))}}}const r=()=>{};return xo(e._rawValidators,r),xo(e._rawAsyncValidators,r),t}function ic(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function il(n,e){rl(n,e)}function X(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Ne(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Dt="VALID",xt="INVALID",ot="PENDING",Bn="DISABLED";function Ro(n){return(Ts(n)?n.validators:n)||null}function ro(n){return Array.isArray(n)?An(n):n||null}function Xi(n,e){return(Ts(e)?e.asyncValidators:n)||null}function pa(n){return Array.isArray(n)?Xu(n):n||null}function Ts(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const ga=n=>n instanceof ru,Ss=n=>n instanceof Mo;function As(n){return ga(n)?n.value:n.getRawValue()}function Tg(n,e){const t=Ss(n),r=n.controls;if(!(t?Object.keys(r):r).length)throw new f.vHH(1e3,"");if(!r[e])throw new f.vHH(1001,"")}function ly(n,e){Ss(n),n._forEachChild((r,i)=>{if(void 0===e[i])throw new f.vHH(1002,"")})}class sc{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=ro(this._rawValidators),this._composedAsyncValidatorFn=pa(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Dt}get invalid(){return this.status===xt}get pending(){return this.status==ot}get disabled(){return this.status===Bn}get enabled(){return this.status!==Bn}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=ro(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=pa(e)}addValidators(e){this.setValidators(eo(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(eo(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Cg(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Cg(e,this._rawAsyncValidators))}hasValidator(e){return Pd(this._rawValidators,e)}hasAsyncValidator(e){return Pd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ot,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Bn,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Dt,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dt||this.status===ot)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bn:Dt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ot,this._hasOwnPendingAsyncValidator=!0;const t=lr(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function cr(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let r=n;return e.forEach(i=>{r=Ss(r)?r.controls.hasOwnProperty(i)?r.controls[i]:null:(n=>n instanceof cy)(r)&&r.at(i)||null}),r}(this,e,".")}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new f.vpe,this.statusChanges=new f.vpe}_calculateStatus(){return this._allControlsDisabled()?Bn:this.errors?xt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ot)?ot:this._anyControlsHaveStatus(xt)?xt:Dt}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ts(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ru extends sc{constructor(e=null,t,r){super(Ro(t),Xi(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ts(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Ne(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Ne(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class Mo extends sc{constructor(e,t,r){super(Ro(t),Xi(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){ly(this,e),Object.keys(e).forEach(r=>{Tg(this,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=As(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const r=this.controls[t];if(this.contains(t)&&e(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,a)=>{r=t(r,i,a)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class cy extends sc{constructor(e,t,r){super(Ro(t),Xi(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){ly(this,e),e.forEach((r,i)=>{Tg(this,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>As(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const dy={provide:Un,useExisting:(0,f.Gpc)(()=>iu)},oc=(()=>Promise.resolve(null))();let iu=(()=>{class n extends Un{constructor(t,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new f.vpe,this.form=new Mo({},An(t),Xu(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){oc.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),tu(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){oc.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){oc.then(()=>{const r=this._findContainer(t.path),i=new Mo({});il(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){oc.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){oc.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,X(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Wn,10),f.Y36(bs,10))},n.\u0275dir=f.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){1&t&&f.NdJ("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[f._Bn([dy]),f.qOj]}),n})(),sl=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=f.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),jd=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();const Rg=new f.OlP("NgModelWithFormControlWarning"),_y={provide:Un,useExisting:(0,f.Gpc)(()=>su)};let su=(()=>{class n extends Un{constructor(t,r){super(),this.validators=t,this.asyncValidators=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new f.vpe,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Ar(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return tu(r,t),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Jr(t.control||null,t,!1),Ne(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,X(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,i=this.form.get(t.path);r!==i&&(Jr(r||null,t),ga(i)&&(tu(i,t),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);il(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function Ld(n,e){return Ar(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){rl(this.form,this),this._oldForm&&Ar(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Wn,10),f.Y36(bs,10))},n.\u0275dir=f.lG2({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,r){1&t&&f.NdJ("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[f._Bn([_y]),f.qOj,f.TTD]}),n})();const g={provide:Fi,useExisting:(0,f.Gpc)(()=>_)};let _=(()=>{class n extends Fi{constructor(t,r,i,a,l){super(),this._ngModelWarningConfig=l,this._added=!1,this.update=new f.vpe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function ue(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(a=>{a.constructor===Yi?t=a:function U(n){return Object.getPrototypeOf(n.constructor)===Ki}(a)?r=a:i=a}),i||r||t||null}(0,a)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),function R(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function ha(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(f.Y36(Un,13),f.Y36(Wn,10),f.Y36(bs,10),f.Y36(Er,10),f.Y36(Rg,8))},n.\u0275dir=f.lG2({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[f._Bn([g]),f.qOj,f.TTD]}),n})();const I={provide:Er,useExisting:(0,f.Gpc)(()=>ne),multi:!0};function x(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let ne=(()=>{class n extends Ki{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const i=x(this._getOptionId(t),t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){const r=function k(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r):t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){1&t&&f.NdJ("change",function(a){return r.onChange(a.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[f._Bn([I]),f.qOj]}),n})(),xe=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(x(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.SBq),f.Y36(f.Qsj),f.Y36(ne,9))},n.\u0275dir=f.lG2({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const tt={provide:Er,useExisting:(0,f.Gpc)(()=>bi),multi:!0};function Et(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let bi=(()=>{class n extends Ki{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let r;if(this.value=t,Array.isArray(t)){const i=t.map(a=>this._getOptionId(a));r=(a,l)=>{a._setSelected(i.indexOf(l.toString())>-1)}}else r=(i,a)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{const i=[],a=r.selectedOptions;if(void 0!==a){const l=a;for(let h=0;h<l.length;h++){const v=this._getOptionValue(l[h].value);i.push(v)}}else{const l=r.options;for(let h=0;h<l.length;h++){const m=l[h];if(m.selected){const v=this._getOptionValue(m.value);i.push(v)}}}this.value=i,t(i)}}_registerOption(t){const r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){const r=function qt(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){1&t&&f.NdJ("change",function(a){return r.onChange(a.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[f._Bn([tt]),f.qOj]}),n})(),xs=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(Et(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Et(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.SBq),f.Y36(f.Qsj),f.Y36(bi,9))},n.\u0275dir=f.lG2({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),No=(()=>{class n{constructor(){this._validator=Qi}ngOnChanges(t){if(this.inputName in t){const r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Qi,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=f.lG2({type:n,features:[f.TTD]}),n})();const $d={provide:Wn,useExisting:(0,f.Gpc)(()=>lc),multi:!0};let lc=(()=>{class n extends No{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=t=>function wy(n){return null!=n&&!1!==n&&"false"!=`${n}`}(t),this.createValidator=t=>Ya}enabled(t){return t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,r){2&t&&f.uIk("required",r._enabled?"":null)},inputs:{required:"required"},features:[f._Bn([$d]),f.qOj]}),n})(),BD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[[jd]]}),n})(),jD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[BD]}),n})(),Rf=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Rg,useValue:t.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[BD]}),n})(),tE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[[jD,Rf,qs]]}),n})();function ut(...n){const e=(0,sn.yG)(n);return(0,En.D)(n,e)}var io=F(7579);class Rs extends io.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}var Gd=F(4671),$D=F(9672);function by(n,e,t){n?(0,$D.f)(t,n,e):e()}var Dy=F(576);function Mf(n,e){const t=(0,Dy.m)(n)?n:()=>n,r=i=>i.error(t());return new Es.y(e?i=>e.schedule(r,0,i):r)}const kg=(0,F(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var qd=F(8189);function Ty(...n){return function WD(){return(0,qd.J)(1)}()((0,En.D)(n,(0,sn.yG)(n)))}function Fg(n){return new Es.y(e=>{(0,aa.Xf)(n()).subscribe(e)})}var cc=F(515),rE=F(727),xr=F(4482);function iE(){return(0,xr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,er.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class zD extends Es.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,xr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new rE.w0;const t=this.getSubject();e.add(this.source.subscribe((0,er.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=rE.w0.EMPTY)}return e}refCount(){return iE()(this)}}function Xr(n,e){return(0,xr.e)((t,r)=>{let i=null,a=0,l=!1;const h=()=>l&&!i&&r.complete();t.subscribe((0,er.x)(r,m=>{null==i||i.unsubscribe();let v=0;const D=a++;(0,aa.Xf)(n(m,D)).subscribe(i=(0,er.x)(r,S=>r.next(e?e(m,S,D,v++):S),()=>{i=null,h()}))},()=>{l=!0,h()}))})}function Sy(n){return n<=0?()=>cc.E:(0,xr.e)((e,t)=>{let r=0;e.subscribe((0,er.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Lg(...n){const e=(0,sn.yG)(n);return(0,xr.e)((t,r)=>{(e?Ty(n,t,e):Ty(n,t)).subscribe(r)})}function sE(n,e,t,r,i){return(a,l)=>{let h=t,m=e,v=0;a.subscribe((0,er.x)(l,D=>{const S=v++;m=h?n(m,D,S):(h=!0,D),r&&l.next(m)},i&&(()=>{h&&l.next(m),l.complete()})))}}function dc(n,e){return(0,xr.e)(sE(n,e,arguments.length>=2,!0))}function au(n,e){return(0,xr.e)((t,r)=>{let i=0;t.subscribe((0,er.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}function al(n){return(0,xr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,er.x)(t,void 0,void 0,l=>{a=(0,aa.Xf)(n(l,al(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}var Di=F(5577);function Nf(n,e){return(0,Dy.m)(e)?(0,Di.z)(n,e,1):(0,Di.z)(n,1)}function Ay(n){return n<=0?()=>cc.E:(0,xr.e)((e,t)=>{let r=[];e.subscribe((0,er.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function oE(n=ZD){return(0,xr.e)((e,t)=>{let r=!1;e.subscribe((0,er.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function ZD(){return new kg}function hc(n){return(0,xr.e)((e,t)=>{let r=!1;e.subscribe((0,er.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Wd(n,e){const t=arguments.length>=2;return r=>r.pipe(n?au((i,a)=>n(i,a,r)):Gd.y,Sy(1),t?hc(e):oE(()=>new kg))}var so=F(8505);class ul{constructor(e,t){this.id=e,this.url=t}}class oo extends ul{constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class fc extends ul{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Vg extends ul{constructor(e,t,r){super(e,t),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class KD extends ul{constructor(e,t,r){super(e,t),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class uE extends ul{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pf extends ul{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lE extends ul{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class cE extends ul{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xy extends ul{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ug{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ry{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class MM{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zd{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class My{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dE{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hE{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Zt="primary";class YD{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Zd(n){return new YD(n)}const fE="ngNavigationCancelingError";function Ny(n){const e=Error("NavigationCancelingError: "+n);return e[fE]=!0,e}function JD(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function ao(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Py(n[i],e[i]))return!1;return!0}function Py(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function Bg(n){return Array.prototype.concat.apply([],n)}function gE(n){return n.length>0?n[n.length-1]:null}function ei(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Po(n){return(0,f.CqO)(n)?n:(0,f.QGY)(n)?(0,En.D)(Promise.resolve(n)):ut(n)}const mE={exact:function yE(n,e,t){if(!uu(n.segments,e.segments)||!Kd(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!yE(n.children[r],e.children[r],t))return!1;return!0},subset:ky},Oy={exact:function jg(n,e){return ao(n,e)},subset:function vE(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Py(n[t],e[t]))},ignored:()=>!0};function _E(n,e,t){return mE[t.paths](n.root,e.root,t.matrixParams)&&Oy[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function ky(n,e,t){return Fy(n,e,e.segments,t)}function Fy(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!uu(i,t)||e.hasChildren()||!Kd(i,t,r))}if(n.segments.length===t.length){if(!uu(n.segments,t)||!Kd(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!ky(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(uu(n.segments,i)&&Kd(n.segments,i,r)&&n.children[Zt])&&Fy(n.children[Zt],e,a,r)}}function Kd(n,e,t){return e.every((r,i)=>Oy[t](n[i].parameters,r.parameters))}class ll{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Zd(this.queryParams)),this._queryParamMap}toString(){return XD.serialize(this)}}class Yt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,ei(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Of(this)}}class cl{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Zd(this.parameters)),this._parameterMap}toString(){return CE(this)}}function uu(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class Hg{}class Yd{parse(e){const t=new sT(e);return new ll(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${kf(e.root,!0)}`,r=function eT(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Ff(t)}=${Ff(i)}`).join("&"):`${Ff(t)}=${Ff(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Ly(n){return encodeURI(n)}(e.fragment)}`:""}`}}const XD=new Yd;function Of(n){return n.segments.map(e=>CE(e)).join("/")}function kf(n,e){if(!n.hasChildren())return Of(n);if(e){const t=n.children[Zt]?kf(n.children[Zt],!1):"",r=[];return ei(n.children,(i,a)=>{a!==Zt&&r.push(`${a}:${kf(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function EE(n,e){let t=[];return ei(n.children,(r,i)=>{i===Zt&&(t=t.concat(e(r,i)))}),ei(n.children,(r,i)=>{i!==Zt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===Zt?[kf(n.children[Zt],!1)]:[`${i}:${kf(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Zt]?`${Of(n)}/${t[0]}`:`${Of(n)}/(${t.join("//")})`}}function IE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ff(n){return IE(n).replace(/%3B/gi,";")}function $g(n){return IE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vy(n){return decodeURIComponent(n)}function Uy(n){return Vy(n.replace(/\+/g,"%20"))}function CE(n){return`${$g(n.path)}${function bE(n){return Object.keys(n).map(e=>`;${$g(e)}=${$g(n[e])}`).join("")}(n.parameters)}`}const tT=/^[^\/()?;=#]+/;function ts(n){const e=n.match(tT);return e?e[0]:""}const nT=/^[^=?&#]+/,rT=/^[^&#]+/;class sT{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yt([],{}):new Yt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Zt]=new Yt(e,t)),r}parseSegment(){const e=ts(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new cl(Vy(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ts(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=ts(this.remaining);i&&(r=i,this.capture(r))}e[Vy(t)]=Vy(r)}parseQueryParam(e){const t=function DE(n){const e=n.match(nT);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function iT(n){const e=n.match(rT);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=Uy(t),a=Uy(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ts(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let a;r.indexOf(":")>-1?(a=r.substr(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=Zt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[Zt]:new Yt([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class TE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Gg(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=Gg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=By(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return By(e,this._root).map(t=>t.value)}}function Gg(n,e){if(n===e.value)return e;for(const t of e.children){const r=Gg(n,t);if(r)return r}return null}function By(n,e){if(n===e.value)return[e];for(const t of e.children){const r=By(n,t);if(r.length)return r.unshift(e),r}return[]}class lu{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Qd(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Pt extends TE{constructor(e,t){super(e),this.snapshot=t,Uf(this,e)}toString(){return this.snapshot.toString()}}function jy(n,e){const t=function SE(n,e){const l=new Vf([],{},{},"",{},Zt,e,null,n.root,-1,{});return new AE("",new lu(l,[]))}(n,e),r=new Rs([new cl("",{})]),i=new Rs({}),a=new Rs({}),l=new Rs({}),h=new Rs(""),m=new gc(r,i,l,h,a,Zt,e,t.root);return m.snapshot=t.root,new Pt(new lu(m,[]),t)}class gc{constructor(e,t,r,i,a,l,h,m){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,wt.U)(e=>Zd(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,wt.U)(e=>Zd(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Lf(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function Oo(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Vf{constructor(e,t,r,i,a,l,h,m,v,D,S){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=m,this._urlSegment=v,this._lastPathIndex=D,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Zd(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Zd(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class AE extends TE{constructor(e,t){super(t),this.url=e,Uf(this,t)}toString(){return va(this._root)}}function Uf(n,e){e.value._routerState=n,e.children.forEach(t=>Uf(n,t))}function va(n){const e=n.children.length>0?` { ${n.children.map(va).join(", ")} } `:"";return`${n.value}${e}`}function Bf(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ao(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),ao(e.params,t.params)||n.params.next(t.params),function pE(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ao(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),ao(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function qg(n,e){const t=ao(n.params,e.params)&&function wE(n,e){return uu(n,e)&&n.every((t,r)=>ao(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||qg(n.parent,e.parent))}function Wg(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function xE(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Wg(n,r,i);return Wg(n,r)})}(n,e,t);return new lu(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>Wg(n,h)),l}}const r=function PM(n){return new gc(new Rs(n.url),new Rs(n.params),new Rs(n.queryParams),new Rs(n.fragment),new Rs(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>Wg(n,a));return new lu(r,i)}}function mc(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function _c(n){return"object"==typeof n&&null!=n&&n.outlets}function jf(n,e,t,r,i){let a={};if(r&&ei(r,(h,m)=>{a[m]=Array.isArray(h)?h.map(v=>`${v}`):`${h}`}),n===e)return new ll(t,a,i);const l=Zg(n,e,t);return new ll(l,a,i)}function Zg(n,e,t){const r={};return ei(n.children,(i,a)=>{r[a]=i===e?t:Zg(i,e,t)}),new Yt(n.segments,r)}class oT{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&mc(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(_c);if(i&&i!==gE(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class $y{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function cT(n,e,t){if(n||(n=new Yt([],{})),0===n.segments.length&&n.hasChildren())return Kg(n,e,t);const r=function OM(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(_c(h))break;const m=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===m)break;if(m&&v&&"object"==typeof v&&void 0===v.outlets){if(!Qg(m,v,l))return a;r+=2}else{if(!Qg(m,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new Yt(n.segments.slice(0,r.pathIndex),{});return a.children[Zt]=new Yt(n.segments.slice(r.pathIndex),n.children),Kg(a,0,i)}return r.match&&0===i.length?new Yt(n.segments,{}):r.match&&!n.hasChildren()?Yg(n,e,t):r.match?Kg(n,0,i):Yg(n,e,t)}function Kg(n,e,t){if(0===t.length)return new Yt(n.segments,{});{const r=function RE(n){return _c(n[0])?n[0].outlets:{[Zt]:n}}(t),i={};return ei(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=cT(n.children[l],e,a))}),ei(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new Yt(n.segments,i)}}function Yg(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(_c(a)){const m=ME(a.outlets);return new Yt(r,m)}if(0===i&&mc(t[0])){r.push(new cl(n.segments[e].path,NE(t[0]))),i++;continue}const l=_c(a)?a.outlets[Zt]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&mc(h)?(r.push(new cl(l,NE(h))),i+=2):(r.push(new cl(l,{})),i++)}return new Yt(r,{})}function ME(n){const e={};return ei(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=Yg(new Yt([],{}),0,t))}),e}function NE(n){const e={};return ei(n,(t,r)=>e[r]=`${t}`),e}function Qg(n,e,t){return n==t.path&&ao(e,t.parameters)}class FM{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Bf(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Qd(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),ei(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Qd(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Qd(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Qd(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new dE(a.value.snapshot))}),e.children.length&&this.forwardEvent(new zd(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(Bf(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),Bf(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=function LM(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),m=h?h.module.componentFactoryResolver:null;l.attachRef=null,l.route=i,l.resolver=m,l.outlet&&l.outlet.activateWith(i,m),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class PE{constructor(e,t){this.routes=e,this.module=t}}function yc(n){return"function"==typeof n}function Jd(n){return n instanceof ll}const vc=Symbol("INITIAL_VALUE");function Hf(){return Xr(n=>function nE(...n){const e=(0,sn.yG)(n),t=(0,sn.jO)(n),{args:r,keys:i}=sa(n);if(0===r.length)return(0,En.D)([],e);const a=new Es.y(function GD(n,e,t=Gd.y){return r=>{by(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let m=0;m<i;m++)by(e,()=>{const v=(0,En.D)(n[m],e);let D=!1;v.subscribe((0,er.x)(r,S=>{a[m]=S,D||(D=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>Xl(i,l):Gd.y));return t?a.pipe(_f(t)):a}(n.map(e=>e.pipe(Sy(1),Lg(vc)))).pipe(dc((e,t)=>{let r=!1;return t.reduce((i,a,l)=>i!==vc?i:(a===vc&&(r=!0),r||!1!==a&&l!==t.length-1&&!Jd(a)?i:a),e)},vc),au(e=>e!==vc),(0,wt.U)(e=>Jd(e)?e:!0===e),Sy(1)))}class OE{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new wc,this.attachRef=null}}class wc{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new OE,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let Jg=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.resolver=i,this.changeDetector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.name=a||Zt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const l=(r=r||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),h=this.parentContexts.getOrCreateContext(this.name).children,m=new Gy(t,h,this.location.injector);this.activated=this.location.createComponent(l,this.location.length,m),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(wc),f.Y36(f.s_b),f.Y36(f._Vd),f.$8M("name"),f.Y36(f.sBO))},n.\u0275dir=f.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class Gy{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===gc?this.route:e===wc?this.childContexts:this.parent.get(e,t)}}let kE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&f._UZ(0,"router-outlet")},directives:[Jg],encapsulation:2}),n})();function cu(n,e=""){for(let t=0;t<n.length;t++){const r=n[t];FE(r,dT(e,r))}}function FE(n,e){n.children&&cu(n.children,e)}function dT(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function $f(n){const e=n.children&&n.children.map($f),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Zt&&(t.component=kE),t}function uo(n){return n.outlet||Zt}function qy(n,e){const t=n.filter(r=>uo(r)===e);return t.push(...n.filter(r=>uo(r)!==e)),t}const LE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Xg(n,e,t){var r;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},LE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const a=(e.matcher||JD)(t,n,e);if(!a)return Object.assign({},LE);const l={};ei(a.posParams,(m,v)=>{l[v]=m.path});const h=a.consumed.length>0?Object.assign(Object.assign({},l),a.consumed[a.consumed.length-1].parameters):l;return{matched:!0,consumedSegments:a.consumed,remainingSegments:t.slice(a.consumed.length),parameters:h,positionalParamSegments:null!==(r=a.posParams)&&void 0!==r?r:{}}}function hl(n,e,t,r,i="corrected"){if(t.length>0&&function eh(n,e,t){return t.some(r=>du(n,e,r)&&uo(r)!==Zt)}(n,t,r)){const l=new Yt(e,function Wy(n,e,t,r){const i={};i[Zt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&uo(a)!==Zt){const l=new Yt([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[uo(a)]=l}return i}(n,e,r,new Yt(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function Gf(n,e,t){return t.some(r=>du(n,e,r))}(n,t,r)){const l=new Yt(n.segments,function Xd(n,e,t,r,i,a){const l={};for(const h of r)if(du(n,t,h)&&!i[uo(h)]){const m=new Yt([],{});m._sourceSegment=n,m._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[uo(h)]=m}return Object.assign(Object.assign({},i),l)}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new Yt(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function du(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function VE(n,e,t,r){return!!(uo(n)===r||r!==Zt&&du(e,t,n))&&("**"===n.path||Xg(e,n,t).matched)}function zy(n,e,t){return 0===e.length&&!n.children[t]}class qf{constructor(e){this.segmentGroup=e||null}}class em{constructor(e){this.urlTree=e}}function Ec(n){return Mf(new qf(n))}function Zy(n){return Mf(new em(n))}class HM{constructor(e,t,r,i,a){this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=e.get(f.h0i)}apply(){const e=hl(this.urlTree.root,[],[],this.config).segmentGroup,t=new Yt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Zt).pipe((0,wt.U)(a=>this.createUrlTree(nm(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(al(a=>{if(a instanceof em)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof qf?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Zt).pipe((0,wt.U)(i=>this.createUrlTree(nm(i),e.queryParams,e.fragment))).pipe(al(i=>{throw i instanceof qf?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,r){const i=e.segments.length>0?new Yt([],{[Zt]:e}):e;return new ll(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,wt.U)(a=>new Yt([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,En.D)(i).pipe(Nf(a=>{const l=r.children[a],h=qy(t,a);return this.expandSegmentGroup(e,h,l,a).pipe((0,wt.U)(m=>({segment:m,outlet:a})))}),dc((a,l)=>(a[l.outlet]=l.segment,a),{}),function ya(n,e){const t=arguments.length>=2;return r=>r.pipe(n?au((i,a)=>n(i,a,r)):Gd.y,Ay(1),t?hc(e):oE(()=>new kg))}())}expandSegment(e,t,r,i,a,l){return(0,En.D)(r).pipe(Nf(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,l).pipe(al(v=>{if(v instanceof qf)return ut(null);throw v}))),Wd(h=>!!h),al((h,m)=>{if(h instanceof kg||"EmptyError"===h.name)return zy(t,i,a)?ut(new Yt([],{})):Ec(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,l,h){return VE(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):Ec(t):Ec(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Zy(a):this.lineralizeSegments(r,a).pipe((0,Di.z)(l=>{const h=new Yt(l,{});return this.expandSegment(e,h,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:m,remainingSegments:v,positionalParamSegments:D}=Xg(t,i,a);if(!h)return Ec(t);const S=this.applyRedirectCommands(m,i.redirectTo,D);return i.redirectTo.startsWith("/")?Zy(S):this.lineralizeSegments(i,S).pipe((0,Di.z)(N=>this.expandSegment(e,t,r,N.concat(v),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){if("**"===r.path)return r.loadChildren?(r._loadedConfig?ut(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe((0,wt.U)(S=>(r._loadedConfig=S,new Yt(i,{})))):ut(new Yt(i,{}));const{matched:l,consumedSegments:h,remainingSegments:m}=Xg(t,r,i);return l?this.getChildConfig(e,r,i).pipe((0,Di.z)(D=>{const S=D.module,N=D.routes,{segmentGroup:V,slicedSegments:W}=hl(t,h,m,N),fe=new Yt(V.segments,V.children);if(0===W.length&&fe.hasChildren())return this.expandChildren(S,N,fe).pipe((0,wt.U)(pt=>new Yt(h,pt)));if(0===N.length&&0===W.length)return ut(new Yt(h,{}));const Ae=uo(r)===a;return this.expandSegment(S,fe,N,W,Ae?Zt:a,!0).pipe((0,wt.U)(ft=>new Yt(h.concat(ft.segments),ft.children)))})):Ec(t)}getChildConfig(e,t,r){return t.children?ut(new PE(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?ut(t._loadedConfig):this.runCanLoadGuards(e.injector,t,r).pipe((0,Di.z)(i=>i?this.configLoader.load(e.injector,t).pipe((0,wt.U)(a=>(t._loadedConfig=a,a))):function hT(n){return Mf(Ny(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):ut(new PE([],e))}runCanLoadGuards(e,t,r){const i=t.canLoad;return i&&0!==i.length?ut(i.map(l=>{const h=e.get(l);let m;if(function UM(n){return n&&yc(n.canLoad)}(h))m=h.canLoad(t,r);else{if(!yc(h))throw new Error("Invalid CanLoad guard");m=h(t,r)}return Po(m)})).pipe(Hf(),(0,so.b)(l=>{if(!Jd(l))return;const h=Ny(`Redirecting to "${this.urlSerializer.serialize(l)}"`);throw h.url=l,h}),(0,wt.U)(l=>!0===l)):ut(!0)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return ut(r);if(i.numberOfChildren>1||!i.children[Zt])return Mf(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));i=i.children[Zt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new ll(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return ei(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return ei(t.children,(h,m)=>{l[m]=this.createSegmentGroup(e,h,r,i)}),new Yt(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function nm(n){const e={};for(const r of Object.keys(n.children)){const a=nm(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function BE(n){if(1===n.numberOfChildren&&n.children[Zt]){const e=n.children[Zt];return new Yt(n.segments.concat(e.segments),e.children)}return n}(new Yt(n.segments,e))}class Ky{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class rm{constructor(e,t){this.component=e,this.route=t}}function pT(n,e,t){const r=n._root;return sm(r,e?e._root:null,t,[r.value])}function im(n,e,t){const r=function gT(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:t).get(n)}function sm(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Qd(e);return n.children.forEach(l=>{(function $M(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const m=function jE(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!uu(n.url,e.url);case"pathParamsOrQueryParamsChange":return!uu(n.url,e.url)||!ao(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qg(n,e)||!ao(n.queryParams,e.queryParams);default:return!qg(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);m?i.canActivateChecks.push(new Ky(r)):(a.data=l.data,a._resolvedData=l._resolvedData),sm(n,e,a.component?h?h.children:null:t,r,i),m&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new rm(h.outlet.component,l))}else l&&om(e,h,i),i.canActivateChecks.push(new Ky(r)),sm(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),ei(a,(l,h)=>om(l,t.getContext(h),i)),i}function om(n,e,t){const r=Qd(n),i=n.value;ei(r,(a,l)=>{om(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new rm(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class GE{}function qE(n){return new Es.y(e=>e.error(n))}class WE{constructor(e,t,r,i,a,l){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=l}recognize(){const e=hl(this.urlTree.root,[],[],this.config.filter(l=>void 0===l.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Zt);if(null===t)return null;const r=new Vf([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Zt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new lu(r,t),a=new AE(this.url,i);return this.inheritParamsAndData(a._root),a}inheritParamsAndData(e){const t=e.value,r=Lf(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const a of Object.keys(t.children)){const l=t.children[a],h=qy(e,a),m=this.processSegmentGroup(h,l,a);if(null===m)return null;r.push(...m)}const i=am(r);return function zE(n){n.sort((e,t)=>e.value.outlet===Zt?-1:t.value.outlet===Zt?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,r,i){for(const a of e){const l=this.processSegmentAgainstRoute(a,t,r,i);if(null!==l)return l}return zy(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!VE(e,t,r,i))return null;let a,l=[],h=[];if("**"===e.path){const V=r.length>0?gE(r).parameters:{};a=new Vf(r,V,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qy(e),uo(e),e.component,e,ZE(t),CT(t)+r.length,KE(e))}else{const V=Xg(t,e,r);if(!V.matched)return null;l=V.consumedSegments,h=V.remainingSegments,a=new Vf(l,V.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qy(e),uo(e),e.component,e,ZE(t),CT(t)+l.length,KE(e))}const m=function IT(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:v,slicedSegments:D}=hl(t,l,h,m.filter(V=>void 0===V.redirectTo),this.relativeLinkResolution);if(0===D.length&&v.hasChildren()){const V=this.processChildren(m,v);return null===V?null:[new lu(a,V)]}if(0===m.length&&0===D.length)return[new lu(a,[])];const S=uo(e)===i,N=this.processSegment(m,v,D,S?Zt:i);return null===N?null:[new lu(a,N)]}}function wa(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function am(n){const e=[],t=new Set;for(const r of n){if(!wa(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=am(r.children);e.push(new lu(r.value,i))}return e.filter(r=>!t.has(r))}function ZE(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function CT(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function Qy(n){return n.data||{}}function KE(n){return n.resolve||{}}function YE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Wf(n){return Xr(e=>{const t=n(e);return t?(0,En.D)(t).pipe((0,wt.U)(()=>e)):ut(e)})}class ev extends class Xy{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const lm=new f.OlP("ROUTES");class AT{constructor(e,t,r,i){this.injector=e,this.compiler=t,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe((0,wt.U)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t);const l=a.create(e);return new PE(Bg(l.injector.get(lm,void 0,f.XFs.Self|f.XFs.Optional)).map($f),l)}),al(a=>{throw t._loader$=void 0,a}));return t._loader$=new zD(i,()=>new io.x).pipe(iE()),t._loader$}loadModuleFactory(e){return Po(e()).pipe((0,Di.z)(t=>t instanceof f.YKP?ut(t):(0,En.D)(this.compiler.compileModuleAsync(t))))}}class tv{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function WM(n){throw n}function xT(n,e,t){return e.parse("/")}function nv(n,e){return ut(null)}const QE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},JE={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Vi=(()=>{class n{constructor(t,r,i,a,l,h,m){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=m,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new io.x,this.errorHandler=WM,this.malformedUriErrorHandler=xT,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:nv,afterPreactivation:nv},this.urlHandlingStrategy=new tv,this.routeReuseStrategy=new ev,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=l.get(f.h0i),this.console=l.get(f.c2e);const S=l.get(f.R0b);this.isNgZoneEnabled=S instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(m),this.currentUrlTree=function pc(){return new ll(new Yt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new AT(l,h,N=>this.triggerEvent(new Ug(N)),N=>this.triggerEvent(new Ry(N))),this.routerState=jy(this.currentUrlTree,this.rootComponentType),this.transitions=new Rs({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(au(i=>0!==i.id),(0,wt.U)(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),Xr(i=>{let a=!1,l=!1;return ut(i).pipe((0,so.b)(h=>{this.currentNavigation={id:h.id,initialUrl:h.currentRawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Xr(h=>{const m=this.browserUrlTree.toString(),v=!this.navigated||h.extractedUrl.toString()!==m||m!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||v)&&this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return Ea(h.source)&&(this.browserUrlTree=h.extractedUrl),ut(h).pipe(Xr(S=>{const N=this.transitions.getValue();return r.next(new oo(S.id,this.serializeUrl(S.extractedUrl),S.source,S.restoredState)),N!==this.transitions.getValue()?cc.E:Promise.resolve(S)}),function fT(n,e,t,r){return Xr(i=>function UE(n,e,t,r,i){return new HM(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,wt.U)(a=>Object.assign(Object.assign({},i),{urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,so.b)(S=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:S.urlAfterRedirects})}),function bT(n,e,t,r,i){return(0,Di.z)(a=>function ET(n,e,t,r,i="emptyOnly",a="legacy"){try{const l=new WE(n,e,t,r,i,a).recognize();return null===l?qE(new GE):ut(l)}catch(l){return qE(l)}}(n,e,a.urlAfterRedirects,t(a.urlAfterRedirects),r,i).pipe((0,wt.U)(l=>Object.assign(Object.assign({},a),{targetSnapshot:l}))))}(this.rootComponentType,this.config,S=>this.serializeUrl(S),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,so.b)(S=>{if("eager"===this.urlUpdateStrategy){if(!S.extras.skipLocationChange){const V=this.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl);this.setBrowserUrl(V,S)}this.browserUrlTree=S.urlAfterRedirects}const N=new uE(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot);r.next(N)}));if(v&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:N,extractedUrl:V,source:W,restoredState:fe,extras:Ae}=h,at=new oo(N,this.serializeUrl(V),W,fe);r.next(at);const ft=jy(V,this.rootComponentType).snapshot;return ut(Object.assign(Object.assign({},h),{targetSnapshot:ft,urlAfterRedirects:V,extras:Object.assign(Object.assign({},Ae),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=h.rawUrl,h.resolve(null),cc.E}),Wf(h=>{const{targetSnapshot:m,id:v,extractedUrl:D,rawUrl:S,extras:{skipLocationChange:N,replaceUrl:V}}=h;return this.hooks.beforePreactivation(m,{navigationId:v,appliedUrlTree:D,rawUrlTree:S,skipLocationChange:!!N,replaceUrl:!!V})}),(0,so.b)(h=>{const m=new Pf(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(m)}),(0,wt.U)(h=>Object.assign(Object.assign({},h),{guards:pT(h.targetSnapshot,h.currentSnapshot,this.rootContexts)})),function mT(n,e){return(0,Di.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?ut(Object.assign(Object.assign({},t),{guardsResult:!0})):function Yy(n,e,t,r){return(0,En.D)(n).pipe((0,Di.z)(i=>function wT(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ut(a.map(h=>{const m=im(h,e,i);let v;if(function dl(n){return n&&yc(n.canDeactivate)}(m))v=Po(m.canDeactivate(n,e,t,r));else{if(!yc(m))throw new Error("Invalid CanDeactivate guard");v=Po(m(n,e,t,r))}return v.pipe(Wd())})).pipe(Hf()):ut(!0)}(i.component,i.route,t,e,r)),Wd(i=>!0!==i,!0))}(l,r,i,n).pipe((0,Di.z)(h=>h&&function VM(n){return"boolean"==typeof n}(h)?function HE(n,e,t,r){return(0,En.D)(e).pipe(Nf(i=>Ty(function yT(n,e){return null!==n&&e&&e(new MM(n)),ut(!0)}(i.route.parent,r),function _T(n,e){return null!==n&&e&&e(new My(n)),ut(!0)}(i.route,r),function $E(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function Ms(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>Fg(()=>ut(l.guards.map(m=>{const v=im(m,l.node,t);let D;if(function jM(n){return n&&yc(n.canActivateChild)}(v))D=Po(v.canActivateChild(r,n));else{if(!yc(v))throw new Error("Invalid CanActivateChild guard");D=Po(v(r,n))}return D.pipe(Wd())})).pipe(Hf())));return ut(a).pipe(Hf())}(n,i.path,t),function vT(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return ut(!0);const i=r.map(a=>Fg(()=>{const l=im(a,e,t);let h;if(function BM(n){return n&&yc(n.canActivate)}(l))h=Po(l.canActivate(e,n));else{if(!yc(l))throw new Error("Invalid CanActivate guard");h=Po(l(e,n))}return h.pipe(Wd())}));return ut(i).pipe(Hf())}(n,i.route,t))),Wd(i=>!0!==i,!0))}(r,a,n,e):ut(h)),(0,wt.U)(h=>Object.assign(Object.assign({},t),{guardsResult:h})))})}(this.ngModule.injector,h=>this.triggerEvent(h)),(0,so.b)(h=>{if(Jd(h.guardsResult)){const v=Ny(`Redirecting to "${this.serializeUrl(h.guardsResult)}"`);throw v.url=h.guardsResult,v}const m=new lE(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.triggerEvent(m)}),au(h=>!!h.guardsResult||(this.restoreHistory(h),this.cancelNavigationTransition(h,""),!1)),Wf(h=>{if(h.guards.canActivateChecks.length)return ut(h).pipe((0,so.b)(m=>{const v=new cE(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}),Xr(m=>{let v=!1;return ut(m).pipe(function DT(n,e){return(0,Di.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ut(t);let a=0;return(0,En.D)(i).pipe(Nf(l=>function Jy(n,e,t,r){return function TT(n,e,t,r){const i=YE(n);if(0===i.length)return ut({});const a={};return(0,En.D)(i).pipe((0,Di.z)(l=>function um(n,e,t,r){const i=im(n,e,r);return Po(i.resolve?i.resolve(e,t):i(e,t))}(n[l],e,t,r).pipe((0,so.b)(h=>{a[l]=h}))),Ay(1),(0,Di.z)(()=>YE(a).length===i.length?ut(a):cc.E))}(n._resolve,n,e,r).pipe((0,wt.U)(a=>(n._resolvedData=a,n.data=Object.assign(Object.assign({},n.data),Lf(n,t).resolve),null)))}(l.route,r,n,e)),(0,so.b)(()=>a++),Ay(1),(0,Di.z)(l=>a===i.length?ut(t):cc.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,so.b)({next:()=>v=!0,complete:()=>{v||(this.restoreHistory(m),this.cancelNavigationTransition(m,"At least one route resolver didn't emit any value."))}}))}),(0,so.b)(m=>{const v=new xy(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}))}),Wf(h=>{const{targetSnapshot:m,id:v,extractedUrl:D,rawUrl:S,extras:{skipLocationChange:N,replaceUrl:V}}=h;return this.hooks.afterPreactivation(m,{navigationId:v,appliedUrlTree:D,rawUrlTree:S,skipLocationChange:!!N,replaceUrl:!!V})}),(0,wt.U)(h=>{const m=function Hy(n,e,t){const r=Wg(n,e._root,t?t._root:void 0);return new Pt(r,e)}(this.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return Object.assign(Object.assign({},h),{targetRouterState:m})}),(0,so.b)(h=>{this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects)}),((n,e,t)=>(0,wt.U)(r=>(new FM(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,h=>this.triggerEvent(h)),(0,so.b)({next(){a=!0},complete(){a=!0}}),function aE(n){return(0,xr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var h;a||l||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(h=this.currentNavigation)||void 0===h?void 0:h.id)===i.id&&(this.currentNavigation=null)}),al(h=>{if(l=!0,function QD(n){return n&&n[fE]}(h)){const m=Jd(h.url);m||(this.navigated=!0,this.restoreHistory(i,!0));const v=new Vg(i.id,this.serializeUrl(i.extractedUrl),h.message);r.next(v),m?setTimeout(()=>{const D=this.urlHandlingStrategy.merge(h.url,this.rawUrlTree),S={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ea(i.source)};this.scheduleNavigation(D,"imperative",null,S,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const m=new KD(i.id,this.serializeUrl(i.extractedUrl),h);r.next(m);try{i.resolve(this.errorHandler(h))}catch(v){i.reject(v)}}return cc.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const a={replaceUrl:!0},l=(null===(i=t.state)||void 0===i?void 0:i.navigationId)?t.state:null;if(l){const m=Object.assign({},l);delete m.navigationId,delete m.\u0275routerPageId,0!==Object.keys(m).length&&(a.state=m)}const h=this.parseUrl(t.url);this.scheduleNavigation(h,r,l,a)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){cu(t),this.config=t.map($f),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:m}=r,v=i||this.routerState.root,D=m?this.currentUrlTree.fragment:l;let S=null;switch(h){case"merge":S=Object.assign(Object.assign({},this.currentUrlTree.queryParams),a);break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=a||null}return null!==S&&(S=this.removeEmptyProps(S)),function zg(n,e,t,r,i){if(0===t.length)return jf(e.root,e.root,e.root,r,i);const a=function aT(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new oT(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return ei(a.outlets,(m,v)=>{h[v]="string"==typeof m?m.split("/"):m}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,m)=>{0==m&&"."===h||(0==m&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new oT(t,e,r)}(t);if(a.toRoot())return jf(e.root,e.root,new Yt([],{}),r,i);const l=function uT(n,e,t){if(n.isAbsolute)return new $y(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const a=t.snapshot._urlSegment;return new $y(a,a===e.root,0)}const r=mc(n.commands[0])?0:1;return function lT(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new $y(r,!1,i-a)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(a,e,n),h=l.processChildren?Kg(l.segmentGroup,l.index,a.commands):cT(l.segmentGroup,l.index,a.commands);return jf(e.root,l.segmentGroup,h,r,i)}(v,this.currentUrlTree,t,S,null!=D?D:null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Jd(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function XE(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?Object.assign({},QE):!1===r?Object.assign({},JE):r,Jd(t))return _E(this.currentUrlTree,t,i);const a=this.parseUrl(t);return _E(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new fc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){var h,m;if(this.disposed)return Promise.resolve(!1);let v,D,S;l?(v=l.resolve,D=l.reject,S=l.promise):S=new Promise((W,fe)=>{v=W,D=fe});const N=++this.navigationId;let V;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),V=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?null!==(h=this.browserPageId)&&void 0!==h?h:0:(null!==(m=this.browserPageId)&&void 0!==m?m:0)+1):V=0,this.setTransition({id:N,targetPageId:V,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:v,reject:D,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(W=>Promise.reject(W))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){var i,a;if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===l?this.currentUrlTree===(null===(a=this.currentNavigation)||void 0===a?void 0:a.finalUrl)&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new Vg(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function Ea(n){return"imperative"!==n}class sv{}class rh{preload(e,t){return ut(null)}}let eI=(()=>{class n{constructor(t,r,i,a){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new AT(i,r,m=>t.triggerEvent(new Ug(m)),m=>t.triggerEvent(new Ry(m)))}setUpPreloading(){this.subscription=this.router.events.pipe(au(t=>t instanceof fc),Nf(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(f.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r)if(a.loadChildren&&!a.canLoad&&a._loadedConfig){const l=a._loadedConfig;i.push(this.processRoutes(l.module,l.routes))}else a.loadChildren&&!a.canLoad?i.push(this.preloadConfig(t,a)):a.children&&i.push(this.processRoutes(t,a.children));return(0,En.D)(i).pipe((0,qd.J)(),(0,wt.U)(a=>{}))}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?ut(r._loadedConfig):this.loader.load(t.injector,r)).pipe((0,Di.z)(a=>(r._loadedConfig=a,this.processRoutes(a.module,a.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Vi),f.LFG(f.Sil),f.LFG(f.zs3),f.LFG(sv))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),zf=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof oo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof fc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof hE&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new hE(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const fl=new f.OlP("ROUTER_CONFIGURATION"),av=new f.OlP("ROUTER_FORROOT_GUARD"),MT=[Me,{provide:Hg,useClass:Yd},{provide:Vi,useFactory:function PT(n,e,t,r,i,a,l={},h,m){const v=new Vi(null,n,e,t,r,i,Bg(a));return h&&(v.urlHandlingStrategy=h),m&&(v.routeReuseStrategy=m),function OT(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,v),l.enableTracing&&v.events.subscribe(D=>{var S,N;null===(S=console.group)||void 0===S||S.call(console,`Router Event: ${D.constructor.name}`),console.log(D.toString()),console.log(D),null===(N=console.groupEnd)||void 0===N||N.call(console)}),v},deps:[Hg,wc,Me,f.zs3,f.Sil,lm,fl,[class qM{},new f.FiY],[class ST{},new f.FiY]]},wc,{provide:gc,useFactory:function sh(n){return n.routerState.root},deps:[Vi]},eI,rh,class ov{preload(e,t){return t().pipe(al(()=>ut(null)))}},{provide:fl,useValue:{enableTracing:!1}}];function uv(){return new f.PXZ("Router",Vi)}let tI=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[MT,lv(t),{provide:av,useFactory:ih,deps:[[Vi,new f.FiY,new f.tp0]]},{provide:fl,useValue:r||{}},{provide:_e,useFactory:nI,deps:[le,[new f.tBr(Ze),new f.FiY],fl]},{provide:zf,useFactory:NT,deps:[Vi,ju,fl]},{provide:sv,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:rh},{provide:f.PXZ,multi:!0,useFactory:uv},[cv,{provide:f.ip1,multi:!0,useFactory:kT,deps:[cv]},{provide:rI,useFactory:FT,deps:[cv]},{provide:f.tb,multi:!0,useExisting:rI}]]}}static forChild(t){return{ngModule:n,providers:[lv(t)]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(av,8),f.LFG(Vi,8))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function NT(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new zf(n,e,t)}function nI(n,e,t={}){return t.useHash?new Fe(n,e):new We(n,e)}function ih(n){return"guarded"}function lv(n){return[{provide:f.deG,multi:!0,useValue:n},{provide:lm,multi:!0,useValue:n}]}let cv=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new io.x}appInitializer(){return this.injector.get(G,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(h=>r=h),a=this.injector.get(Vi),l=this.injector.get(fl);return"disabled"===l.initialNavigation?(a.setUpLocationChangeListener(),r(!0)):"enabled"===l.initialNavigation||"enabledBlocking"===l.initialNavigation?(a.hooks.afterPreactivation=()=>this.initNavigation?ut(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),a.initialNavigation()):r(!0),i})}bootstrapListener(t){const r=this.injector.get(fl),i=this.injector.get(eI),a=this.injector.get(zf),l=this.injector.get(Vi),h=this.injector.get(f.z2F);t===h.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&l.initialNavigation(),i.setUpPreloading(),a.init(),l.resetRootComponentType(h.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(f.zs3))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function kT(n){return n.appInitializer.bind(n)}function FT(n){return n.bootstrapListener.bind(n)}const rI=new f.OlP("Router Initializer");var cm=F(4986),hn=F(5813);function dm(){return(0,xr.e)((n,e)=>{let t,r=!1;n.subscribe((0,er.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function dv(n,e=Gd.y){return n=null!=n?n:LT,(0,xr.e)((t,r)=>{let i,a=!0;t.subscribe((0,er.x)(r,l=>{const h=e(l);(a||!n(i,h))&&(a=!1,i=h,r.next(l))}))})}function LT(n,e){return n===e}var it,$r=F(2011),hv=(F(5881),F(3942)),Ee=F(5861),ns=F(9681),lo=F(4859),ko=F(1877),O=F(2090),KM="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},pl={},fv=fv||{},Mt=KM||self;function Zf(){}function sI(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ui(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var oI="closure_uid_"+(1e9*Math.random()>>>0),aI=0;function uI(n,e,t){return n.call.apply(n.bind,arguments)}function lI(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function hi(n,e,t){return(hi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?uI:lI).apply(null,arguments)}function pv(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ti(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function Ca(){this.s=this.s,this.o=this.o}var gv={};Ca.prototype.s=!1,Ca.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function YM(n){return Object.prototype.hasOwnProperty.call(n,oI)&&n[oI]||(n[oI]=++aI)}(this);delete gv[n]}},Ca.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const cI=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},dI=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let a=0;a<r;a++)a in i&&e.call(t,i[a],a,n)};function hI(n){return Array.prototype.concat.apply([],arguments)}function mv(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function hm(n){return/^[\s\xa0]*$/.test(n)}var Gr,Kf=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Rr(n,e){return-1!=n.indexOf(e)}function _v(n,e){return n<e?-1:n>e?1:0}e:{var fI=Mt.navigator;if(fI){var pI=fI.userAgent;if(pI){Gr=pI;break e}}Gr=""}function Yf(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function Fo(n){const e={};for(const t in n)e[t]=n[t];return e}var oh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fi(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<oh.length;a++)t=oh[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function hu(n){return hu[" "](n),n}hu[" "]=Zf;var fu,n,co=Rr(Gr,"Opera"),gl=Rr(Gr,"Trident")||Rr(Gr,"MSIE"),Ic=Rr(Gr,"Edge"),ml=Ic||gl,Cc=Rr(Gr,"Gecko")&&!(Rr(Gr.toLowerCase(),"webkit")&&!Rr(Gr,"Edge"))&&!(Rr(Gr,"Trident")||Rr(Gr,"MSIE"))&&!Rr(Gr,"Edge"),ah=Rr(Gr.toLowerCase(),"webkit")&&!Rr(Gr,"Edge");function bc(){var n=Mt.document;return n?n.documentMode:void 0}e:{var _l="",yl=(n=Gr,Cc?/rv:([^\);]+)(\)|;)/.exec(n):Ic?/Edge\/([\d\.]+)/.exec(n):gl?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ah?/WebKit\/(\S+)/.exec(n):co?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(yl&&(_l=yl?yl[1]:""),gl){var vl=bc();if(null!=vl&&vl>parseFloat(_l)){fu=String(vl);break e}}fu=_l}var gI={};var _I=Mt.document&&gl&&(bc()||parseInt(fu,10))||void 0,yI=function(){if(!Mt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Mt.addEventListener("test",Zf,e),Mt.removeEventListener("test",Zf,e)}catch(t){}return n}();function pi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function uh(n,e){if(pi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Cc){e:{try{hu(e.nodeName);var i=!0;break e}catch(a){}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:vI[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&uh.Z.h.call(this)}}pi.prototype.h=function(){this.defaultPrevented=!0},ti(uh,pi);var vI={2:"touch",3:"pen",4:"mouse"};uh.prototype.h=function(){uh.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Qf="closure_listenable_"+(1e6*Math.random()|0),wI=0;function BT(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++wI,this.ca=this.fa=!1}function gm(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function Jf(n){this.src=n,this.g={},this.h=0}function vv(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=cI(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(gm(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function wv(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ca&&a.listener==e&&a.capture==!!t&&a.ia==r)return i}return-1}Jf.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=wv(n,e,r,i);return-1<l?(e=n[l],t||(e.fa=!1)):((e=new BT(e,this.src,a,!!r,i)).fa=t,n.push(e)),e};var mm="closure_lm_"+(1e6*Math.random()|0),Ev={};function Iv(n,e,t,r,i){if(r&&r.once)return HT(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)Iv(n,e[a],t,r,i);return null}return t=DI(t),n&&n[Qf]?n.N(e,t,Ui(r)?!!r.capture:!!r,i):EI(n,e,t,!1,r,i)}function EI(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Ui(i)?!!i.capture:!!i,h=CI(n);if(h||(n[mm]=h=new Jf(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function jT(){var e=$T;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)yI||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(_m(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function HT(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)HT(n,e[a],t,r,i);return null}return t=DI(t),n&&n[Qf]?n.O(e,t,Ui(r)?!!r.capture:!!r,i):EI(n,e,t,!0,r,i)}function II(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)II(n,e[a],t,r,i);else r=Ui(r)?!!r.capture:!!r,t=DI(t),n&&n[Qf]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=wv(a=n.g[e],t,r,i))&&(gm(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=CI(n))&&(e=n.g[e.toString()],n=-1,e&&(n=wv(e,t,r,i)),(t=-1<n?e[n]:null)&&Xf(t))}function Xf(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[Qf])vv(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(_m(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=CI(e))?(vv(t,n),0==t.h&&(t.src=null,e[mm]=null)):gm(n)}}}function _m(n){return n in Ev?Ev[n]:Ev[n]="on"+n}function $T(n,e){if(n.ca)n=!0;else{e=new uh(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&Xf(n),n=t.call(r,e)}return n}function CI(n){return(n=n[mm])instanceof Jf?n:null}var bI="__closure_events_fn_"+(1e9*Math.random()>>>0);function DI(n){return"function"==typeof n?n:(n[bI]||(n[bI]=function(e){return n.handleEvent(e)}),n[bI])}function ni(){Ca.call(this),this.i=new Jf(this),this.P=this,this.I=null}function ri(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new pi(e,n);else if(e instanceof pi)e.target=e.target||n;else{var i=e;fi(e=new pi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=Cv(l,r,!0,e)&&i}if(i=Cv(l=e.g=n,r,!0,e)&&i,i=Cv(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=Cv(l=e.g=t[a],r,!1,e)&&i}function Cv(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ca&&l.capture==t){var h=l.listener,m=l.ia||l.src;l.fa&&vv(n.i,l),i=!1!==h.call(m,r)&&i}}return i&&!r.defaultPrevented}ti(ni,Ca),ni.prototype[Qf]=!0,ni.prototype.removeEventListener=function(n,e,t,r){II(this,n,e,t,r)},ni.prototype.M=function(){if(ni.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)gm(t[r]);delete n.g[e],n.h--}}this.I=null},ni.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},ni.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var bv=Mt.JSON.stringify;function lh(){var n=AI;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Tv,Dv=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new qT,n=>n.reset());class qT{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function TI(n){Mt.setTimeout(()=>{throw n},0)}function ch(n,e){Tv||function SI(){var n=Mt.Promise.resolve(void 0);Tv=function(){n.then(WT)}}(),Sv||(Tv(),Sv=!0),AI.add(n,e)}var Sv=!1,AI=new class GT{constructor(){this.h=this.g=null}add(e,t){const r=Dv.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function WT(){for(var n;n=lh();){try{n.h.call(n.g)}catch(t){TI(t)}var e=Dv;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Sv=!1}function ym(n,e){ni.call(this),this.h=n||1,this.g=e||Mt,this.j=hi(this.kb,this),this.l=Date.now()}function Av(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function vm(n,e,t){if("function"==typeof n)t&&(n=hi(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=hi(n.handleEvent,n)}return 2147483647<Number(e)?-1:Mt.setTimeout(n,e||0)}function xI(n){n.g=vm(()=>{n.g=null,n.i&&(n.i=!1,xI(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ti(ym,ni),(it=ym.prototype).da=!1,it.S=null,it.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ri(this,"tick"),this.da&&(Av(this),this.start()))}},it.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},it.M=function(){ym.Z.M.call(this),Av(this),delete this.g};class RI extends Ca{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:xI(this)}M(){super.M(),this.g&&(Mt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dh(n){Ca.call(this),this.h=n,this.g={}}ti(dh,Ca);var wm=[];function zT(n,e,t,r){Array.isArray(t)||(t&&(wm[0]=t.toString()),t=wm);for(var i=0;i<t.length;i++){var a=Iv(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function Em(n){Yf(n.g,function(e,t){this.g.hasOwnProperty(t)&&Xf(e)},n),n.g={}}function Im(){this.g=!0}function Dc(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Rv(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return bv(t)}catch(h){return e}}(n,t)+(r?" "+r:"")})}dh.prototype.M=function(){dh.Z.M.call(this),Em(this)},dh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Im.prototype.Aa=function(){this.g=!1},Im.prototype.info=function(){};var Tc={},tp=null;function Sc(){return tp=tp||new ni}function Cm(n){pi.call(this,Tc.Ma,n)}function bm(n){const e=Sc();ri(e,new Cm(e,n))}function MI(n,e){pi.call(this,Tc.STAT_EVENT,n),this.stat=e}function gi(n){const e=Sc();ri(e,new MI(e,n))}function Dm(n,e){pi.call(this,Tc.Na,n),this.size=e}function hh(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Mt.setTimeout(function(){n()},e)}Tc.Ma="serverreachability",ti(Cm,pi),Tc.STAT_EVENT="statevent",ti(MI,pi),Tc.Na="timingevent",ti(Dm,pi);var np={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Tm={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Sm(){}function Am(){}Sm.prototype.h=null;var Rm,fh={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Nv(){pi.call(this,"d")}function xm(){pi.call(this,"c")}function ph(){}function gh(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new dh(this),this.P=ZT,this.W=new ym(n=ml?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new NI}function NI(){this.i=null,this.g="",this.h=!1}ti(Nv,pi),ti(xm,pi),ti(ph,Sm),ph.prototype.g=function(){return new XMLHttpRequest},ph.prototype.i=function(){return{}},Rm=new ph;var ZT=45e3,Pv={},rp={};function ip(n,e,t){n.K=1,n.v=up(pu(e)),n.s=t,n.U=!0,Ov(n,null)}function Ov(n,e){n.F=Date.now(),mh(n),n.A=pu(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),VI(t.h,"t",r),n.C=0,t=n.l.H,n.h=new NI,n.g=Qv(n.l,t?e:null,!n.s),0<n.O&&(n.L=new RI(hi(n.Ia,n,n.g),n.O)),zT(n.V,n.g,"readystatechange",n.gb),e=n.H?Fo(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),bm(1),function QM(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),m=0;m<h.length;m++){var v=h[m].split("=");if(1<v.length){var D=v[0];v=v[1];var S=D.split("_");l=2<=S.length&&"type"==S[1]?l+(D+"=")+v+"&":l+(D+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.X,n.s)}function kv(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function Fv(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=PI(n,t),i==rp){4==e&&(n.o=4,gi(14),r=!1),Dc(n.j,n.m,null,"[Incomplete Response]");break}if(i==Pv){n.o=4,gi(15),Dc(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Dc(n.j,n.m,i,null),Vv(n,i)}kv(n)&&i!=rp&&i!=Pv&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,gi(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),jm(e),e.L=!0,gi(11))):(Dc(n.j,n.m,t,"[Invalid Chunked Response]"),yh(n),_h(n))}function PI(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?rp:(t=Number(e.substring(t,r)),isNaN(t)?Pv:(r+=1)+t>e.length?rp:(e=e.substr(r,t),n.C=r+t,e))}function mh(n){n.Y=Date.now()+n.P,Lv(n,n.P)}function Lv(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=hh(hi(n.eb,n),e)}function sp(n){n.B&&(Mt.clearTimeout(n.B),n.B=null)}function _h(n){0==n.l.G||n.I||QI(n.l,n)}function yh(n){sp(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Av(n.W),Em(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Vv(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Pm(t.i,n)))if(t.I=n.N,!n.J&&Pm(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch(v){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(t.u)t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=hh(hi(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;Hm(t),fp(t)}Bm(t),gi(18)}if(1>=UI(t.i)&&t.ka){try{t.ka()}catch(v){}t.ka=void 0}}else Th(t,11)}else if((n.J||t.g==n)&&Hm(t),!hm(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.U=v[0],v=v[1],2==t.G)if("c"==v[0]){t.J=v[1],t.la=v[2];const D=v[3];null!=D&&(t.ma=D,t.h.info("VER="+t.ma));const S=v[4];null!=S&&(t.za=S,t.h.info("SVER="+t.za));const N=v[5];null!=N&&"number"==typeof N&&0<N&&(t.K=r=1.5*N,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const V=n.g;if(V){const W=V.g?V.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(W){var a=r.i;!a.g&&(Rr(W,"spdy")||Rr(W,"quic")||Rr(W,"h2"))&&(a.j=a.l,a.g=new Set,a.h&&(Om(a,a.h),a.h=null))}if(r.D){const fe=V.g?V.g.getResponseHeader("X-HTTP-Session-Id"):null;fe&&(r.sa=fe,Zn(r.F,r.D,fe))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var l=n;if((r=t).oa=aS(r,r.H?r.la:null,r.W),l.J){lp(r.i,l);var h=l,m=r.K;m&&h.setTimeout(m),h.B&&(sp(h),mh(h)),r.g=l}else Yv(r);0<t.l.length&&pp(t)}else"stop"!=v[0]&&"close"!=v[0]||Th(t,7);else 3==t.G&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?Th(t,7):Wv(t):"noop"!=v[0]&&t.j&&t.j.wa(v),t.A=0)}bm(4)}catch(v){}}function Mm(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(sI(n)||"string"==typeof n)dI(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(sI(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function KT(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(sI(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}}function vh(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof vh)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function br(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];wl(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)wl(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function wl(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(it=gh.prototype).setTimeout=function(n){this.P=n},it.gb=function(n){n=n.target;const e=this.L;e&&3==_u(n)?e.l():this.Ia(n)},it.Ia=function(n){try{if(n==this.g)e:{const D=_u(this.g);var e=this.g.Da();const S=this.g.ba();if(!(3>D)&&(3!=D||ml||this.g&&(this.h.h||this.g.ga()||ZI(this.g)))){this.I||4!=D||7==e||bm(8==e||0>=S?3:2),sp(this);var t=this.g.ba();this.N=t;t:if(kv(this)){var r=ZI(this.g);n="";var i=r.length,a=4==_u(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){yh(this),_h(this);var l="";break t}this.h.i=new Mt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.ga();if(this.i=200==t,function ep(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.X,D,t),this.i){if(this.$&&!this.J){t:{if(this.g){var h,m=this.g;if((h=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!hm(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,gi(12),yh(this),_h(this);break e}Dc(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Vv(this,t)}this.U?(Fv(this,D,l),ml&&this.i&&3==D&&(zT(this.V,this.W,"tick",this.fb),this.W.start())):(Dc(this.j,this.m,l,null),Vv(this,l)),4==D&&yh(this),this.i&&!this.I&&(4==D?QI(this.l,this):(this.i=!1,mh(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,gi(12)):(this.o=0,gi(13)),yh(this),_h(this)}}}catch(D){}},it.fb=function(){if(this.g){var n=_u(this.g),e=this.g.ga();this.C<e.length&&(sp(this),Fv(this,n,e),this.i&&4!=n&&mh(this))}},it.cancel=function(){this.I=!0,yh(this)},it.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function xv(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(bm(3),gi(17)),yh(this),this.o=2,_h(this)):Lv(this,this.Y-n)},(it=vh.prototype).R=function(){br(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},it.T=function(){return br(this),this.g.concat()},it.get=function(n,e){return wl(this.h,n)?this.h[n]:e},it.set=function(n,e){wl(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},it.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],a=this.get(i);n.call(e,a,i,this)}};var OI=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function El(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof El){this.g=void 0!==e?e:n.g,op(this,n.j),this.s=n.s,ap(this,n.i),gu(this,n.m),this.l=n.l,e=n.h;var t=new Bi;t.i=e.i,e.g&&(t.g=new vh(e.g),t.h=e.h),kI(this,t),this.o=n.o}else n&&(t=String(n).match(OI))?(this.g=!!e,op(this,t[1]||"",!0),this.s=Nm(t[2]||""),ap(this,t[3]||"",!0),gu(this,t[4]),this.l=Nm(t[5]||"",!0),kI(this,t[6]||"",!0),this.o=Nm(t[7]||"")):(this.g=!!e,this.h=new Bi(null,this.g))}function pu(n){return new El(n)}function op(n,e,t){n.j=t?Nm(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function ap(n,e,t){n.i=t?Nm(e,!0):e}function gu(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function kI(n,e,t){e instanceof Bi?(n.h=e,function eS(n,e){e&&!n.j&&(mu(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Bv(this,r),VI(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=wh(e,ba)),n.h=new Bi(e,n.g))}function Zn(n,e,t){n.h.set(e,t)}function up(n){return Zn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Nm(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function wh(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Uv),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Uv(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}El.prototype.toString=function(){var n=[],e=this.j;e&&n.push(wh(e,Lo,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(wh(e,Lo,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(wh(t,"/"==t.charAt(0)?XT:JT,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",wh(t,Vo)),n.join("")};var Lo=/[#\/\?@]/g,JT=/[#\?:]/g,XT=/[#\?]/g,ba=/[#\?@]/g,Vo=/#/g;function Bi(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function mu(n){n.g||(n.g=new vh,n.h=0,n.i&&function YT(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Bv(n,e){mu(n),e=Eh(n,e),wl(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,wl((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&br(n)))}function LI(n,e){return mu(n),e=Eh(n,e),wl(n.g.h,e)}function VI(n,e,t){Bv(n,e),0<t.length&&(n.i=null,n.g.set(Eh(n,e),mv(t)),n.h+=t.length)}function Eh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Ih(n){this.l=n||tS,n=Mt.PerformanceNavigationTiming?0<(n=Mt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Mt.g&&Mt.g.Ea&&Mt.g.Ea()&&Mt.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(it=Bi.prototype).add=function(n,e){mu(this),this.i=null,n=Eh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},it.forEach=function(n,e){mu(this),this.g.forEach(function(t,r){dI(t,function(i){n.call(e,i,r,this)},this)},this)},it.T=function(){mu(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],a=0;a<i.length;a++)t.push(e[r]);return t},it.R=function(n){mu(this);var e=[];if("string"==typeof n)LI(this,n)&&(e=hI(e,this.g.get(Eh(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=hI(e,n[t])}return e},it.set=function(n,e){return mu(this),this.i=null,LI(this,n=Eh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},it.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},it.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var l=i;""!==r[a]&&(l+="="+encodeURIComponent(String(r[a]))),n.push(l)}}return this.i=n.join("&")};var tS=10;function Hv(n){return!!n.h||!!n.g&&n.g.size>=n.j}function UI(n){return n.h?1:n.g?n.g.size:0}function Pm(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Om(n,e){n.g?n.g.add(e):n.h=e}function lp(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function BI(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return mv(n.i)}function km(){}function jI(){this.g=new km}function $v(n,e,t){const r=t||"";try{Mm(n,function(i,a){let l=i;Ui(i)&&(l=bv(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function cp(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(a){}}function Ac(n){this.l=n.$b||null,this.j=n.ib||!1}function dp(n,e){ni.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=Lm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ih.prototype.cancel=function(){if(this.i=BI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},km.prototype.stringify=function(n){return Mt.JSON.stringify(n,void 0)},km.prototype.parse=function(n){return Mt.JSON.parse(n,void 0)},ti(Ac,Sm),Ac.prototype.g=function(){return new dp(this.l,this.j)},Ac.prototype.i=function(n){return function(){return n}}({}),ti(dp,ni);var Lm=0;function Gv(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function Ch(n){n.readyState=4,n.l=null,n.j=null,n.A=null,bh(n)}function bh(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(it=dp.prototype).open=function(n,e){if(this.readyState!=Lm)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,bh(this)},it.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Mt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},it.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ch(this)),this.readyState=Lm},it.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,bh(this)),this.g&&(this.readyState=3,bh(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Mt.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Gv(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},it.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Ch(this):bh(this),3==this.readyState&&Gv(this)}},it.Ua=function(n){this.g&&(this.response=this.responseText=n,Ch(this))},it.Ta=function(n){this.g&&(this.response=n,Ch(this))},it.ha=function(){this.g&&Ch(this)},it.setRequestHeader=function(n,e){this.v.append(n,e)},it.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},it.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(dp.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var HI=Mt.JSON.parse;function Mr(n){ni.call(this),this.headers=new vh,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=$I,this.K=this.L=!1}ti(Mr,ni);var $I="",nS=/^https?$/i,rS=["POST","PUT"];function sS(n){return"content-type"==n.toLowerCase()}function GI(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,qI(n),Vm(n)}function qI(n){n.D||(n.D=!0,ri(n,"complete"),ri(n,"error"))}function WI(n){if(n.h&&void 0!==fv&&(!n.C[1]||4!=_u(n)||2!=n.ba()))if(n.v&&4==_u(n))vm(n.Fa,0,n);else if(ri(n,"readystatechange"),4==_u(n)){n.h=!1;try{const h=n.ba();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(OI)[1]||null;if(!i&&Mt.self&&Mt.self.location){var a=Mt.self.location.protocol;i=a.substr(0,a.length-1)}r=!nS.test(i?i.toLowerCase():"")}t=r}if(t)ri(n,"complete"),ri(n,"success");else{n.m=6;try{var l=2<_u(n)?n.g.statusText:""}catch(m){l=""}n.j=l+" ["+n.ba()+"]",qI(n)}}finally{Vm(n)}}}function Vm(n,e){if(n.g){zI(n);const t=n.g,r=n.C[0]?Zf:null;n.g=null,n.C=null,e||ri(n,"ready");try{t.onreadystatechange=r}catch(i){}}}function zI(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Mt.clearTimeout(n.A),n.A=null)}function _u(n){return n.g?n.g.readyState:0}function ZI(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case $I:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function qv(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function oS(n){let e="";return Yf(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Zn(n,e,t))}function hp(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function KI(n){this.za=0,this.l=[],this.h=new Im,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=hp("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=hp("baseRetryDelayMs",5e3,n),this.$a=hp("retryDelaySeedMs",1e4,n),this.Ya=hp("forwardChannelMaxRetries",2,n),this.ra=hp("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new Ih(n&&n.concurrentRequestLimit),this.Ca=new jI,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function Wv(n){if(zv(n),3==n.G){var e=n.V++,t=pu(n.F);Zn(t,"SID",n.J),Zn(t,"RID",e),Zn(t,"TYPE","terminate"),Dh(n,t),(e=new gh(n,n.h,e,void 0)).K=2,e.v=up(pu(t)),t=!1,Mt.navigator&&Mt.navigator.sendBeacon&&(t=Mt.navigator.sendBeacon(e.v.toString(),"")),!t&&Mt.Image&&((new Image).src=e.v,t=!0),t||(e.g=Qv(e.l,null),e.g.ea(e.v)),e.F=Date.now(),mh(e)}$m(n)}function fp(n){n.g&&(jm(n),n.g.cancel(),n.g=null)}function zv(n){fp(n),n.u&&(Mt.clearTimeout(n.u),n.u=null),Hm(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Mt.clearTimeout(n.m),n.m=null)}function Um(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&pp(n)}function pp(n){Hv(n.i)||n.m||(n.m=!0,ch(n.Ha,n),n.C=0)}function Zv(n,e){var t;t=e?e.m:n.V++;const r=pu(n.F);Zn(r,"SID",n.J),Zn(r,"RID",t),Zn(r,"AID",n.U),Dh(n,r),n.o&&n.s&&qv(r,n.o,n.s),t=new gh(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=Kv(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),Om(n.i,t),ip(t,r,e)}function Dh(n,e){n.j&&Mm({},function(t,r){Zn(e,r,t)})}function Kv(n,e,t){t=Math.min(n.l.length,t);var r=n.j?hi(n.j.Oa,n.j,n):null;e:{var i=n.l;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let m=0;m<t;m++){let v=i[m].h;const D=i[m].g;if(v-=a,0>v)a=Math.max(0,i[m].h-100),h=!1;else try{$v(D,l,"req"+v+"_")}catch(S){r&&r(D)}}if(h){r=l.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function Yv(n){n.g||n.u||(n.Y=1,ch(n.Ga,n),n.A=0)}function Bm(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=hh(hi(n.Ga,n),xc(n,n.A)),n.A++,0))}function jm(n){null!=n.B&&(Mt.clearTimeout(n.B),n.B=null)}function Il(n){n.g=new gh(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=pu(n.oa);Zn(e,"RID","rpc"),Zn(e,"SID",n.J),Zn(e,"CI",n.N?"0":"1"),Zn(e,"AID",n.U),Dh(n,e),Zn(e,"TYPE","xmlhttp"),n.o&&n.s&&qv(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=up(pu(e)),t.s=null,t.U=!0,Ov(t,n)}function Hm(n){null!=n.v&&(Mt.clearTimeout(n.v),n.v=null)}function QI(n,e){var t=null;if(n.g==e){Hm(n),jm(n),n.g=null;var r=2}else{if(!Pm(n.i,e))return;t=e.D,lp(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;ri(r=Sc(),new Dm(r,t,e,i)),pp(n)}else Yv(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function YI(n,e){return!(UI(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=hh(hi(n.Ha,n,e),xc(n,n.C)),n.C++,0)))}(n,e)||2==r&&Bm(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Th(n,5);break;case 4:Th(n,10);break;case 3:Th(n,6);break;default:Th(n,2)}}function xc(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Th(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=hi(n.jb,n);t||(t=new El("//www.google.com/images/cleardot.gif"),Mt.location&&"http"==Mt.location.protocol||op(t,"https"),up(t)),function Fm(n,e){const t=new Im;if(Mt.Image){const r=new Image;r.onload=pv(cp,t,r,"TestLoadImage: loaded",!0,e),r.onerror=pv(cp,t,r,"TestLoadImage: error",!1,e),r.onabort=pv(cp,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=pv(cp,t,r,"TestLoadImage: timeout",!1,e),Mt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else gi(2);n.G=0,n.j&&n.j.va(e),$m(n),zv(n)}function $m(n){n.G=0,n.I=-1,n.j&&((0!=BI(n.i).length||0!=n.l.length)&&(n.i.i.length=0,mv(n.l),n.l.length=0),n.j.ua())}function aS(n,e,t){let r=function QT(n){return n instanceof El?pu(n):new El(n,void 0)}(t);if(""!=r.i)e&&ap(r,e+"."+r.i),gu(r,r.m);else{const i=Mt.location;r=function FI(n,e,t,r){var i=new El(null,void 0);return n&&op(i,n),e&&ap(i,e),t&&gu(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&Yf(n.aa,function(i,a){Zn(r,a,i)}),t=n.sa,(e=n.D)&&t&&Zn(r,e,t),Zn(r,"VER",n.ma),Dh(n,r),r}function Qv(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Mr(t&&n.Ba&&!n.qa?new Ac({ib:!0}):n.qa)).L=n.H,e}function Jv(){}function Xv(){if(gl&&!(10<=Number(_I)))throw Error("Environmental error: no available transport.")}function ct(n,e){ni.call(this),this.g=new KI(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!hm(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!hm(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Sh(this)}function JI(n){Nv.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function XI(){xm.call(this),this.status=1}function Sh(n){this.g=n}(it=Mr.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Rm.g(),this.C=function Mv(n){return n.h||(n.h=n.i())}(this.u?this.u:Rm),this.g.onreadystatechange=hi(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void GI(this,a)}n=t||"";const i=new vh(this.headers);r&&Mm(r,function(a,l){i.set(l,a)}),r=function UT(n){e:{var e=sS;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=Mt.FormData&&n instanceof Mt.FormData,!(0<=cI(rS,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(a,l){this.g.setRequestHeader(l,a)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{zI(this),0<this.B&&((this.K=function iS(n){return gl&&function mI(){return function fm(n){var e=gI;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Kf(String(fu)).split("."),t=Kf("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=_v(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||_v(0==i[2].length,0==a[2].length)||_v(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=hi(this.pa,this)):this.A=vm(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){GI(this,a)}},it.pa=function(){void 0!==fv&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ri(this,"timeout"),this.abort(8))},it.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ri(this,"complete"),ri(this,"abort"),Vm(this))},it.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vm(this,!0)),Mr.Z.M.call(this)},it.Fa=function(){this.s||(this.F||this.v||this.l?WI(this):this.cb())},it.cb=function(){WI(this)},it.ba=function(){try{return 2<_u(this)?this.g.status:-1}catch(n){return-1}},it.ga=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},it.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),HI(e)}},it.Da=function(){return this.m},it.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(it=KI.prototype).ma=8,it.G=1,it.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch(e){}},it.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new gh(this,this.h,n,void 0);let a=this.s;if(this.P&&(a?(a=Fo(a),fi(a,this.P)):a=this.P),null===this.o&&(i.H=a),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Kv(this,i,e),Zn(t=pu(this.F),"RID",n),Zn(t,"CVER",22),this.D&&Zn(t,"X-HTTP-Session-Id",this.D),Dh(this,t),this.o&&a&&qv(t,this.o,a),Om(this.i,i),this.Ra&&Zn(t,"TYPE","init"),this.ja?(Zn(t,"$req",e),Zn(t,"SID","null"),i.$=!0,ip(i,t,null)):ip(i,t,e),this.G=2}}else 3==this.G&&(n?Zv(this,n):0==this.l.length||Hv(this.i)||Zv(this))},it.Ga=function(){if(this.u=null,Il(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=hh(hi(this.bb,this),n)}},it.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,gi(10),fp(this),Il(this))},it.ab=function(){null!=this.v&&(this.v=null,fp(this),Bm(this),gi(19))},it.jb=function(n){n?(this.h.info("Successfully pinged google.com"),gi(2)):(this.h.info("Failed to ping google.com"),gi(1))},(it=Jv.prototype).xa=function(){},it.wa=function(){},it.va=function(){},it.ua=function(){},it.Oa=function(){},Xv.prototype.g=function(n,e){return new ct(n,e)},ti(ct,ni),ct.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),ch(hi(n.hb,n,e))),gi(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=aS(n,null,n.W),pp(n)},ct.prototype.close=function(){Wv(this.g)},ct.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,Um(this.g,e)}else this.v?((e={}).__data__=bv(n),Um(this.g,e)):Um(this.g,n)},ct.prototype.M=function(){this.g.j=null,delete this.j,Wv(this.g),delete this.g,ct.Z.M.call(this)},ti(JI,Nv),ti(XI,xm),ti(Sh,Jv),Sh.prototype.xa=function(){ri(this.g,"a")},Sh.prototype.wa=function(n){ri(this.g,new JI(n))},Sh.prototype.va=function(n){ri(this.g,new XI(n))},Sh.prototype.ua=function(){ri(this.g,"b")},Xv.prototype.createWebChannel=Xv.prototype.g,ct.prototype.send=ct.prototype.u,ct.prototype.open=ct.prototype.m,ct.prototype.close=ct.prototype.close,np.NO_ERROR=0,np.TIMEOUT=8,np.HTTP_ERROR=6,Tm.COMPLETE="complete",Am.EventType=fh,fh.OPEN="a",fh.CLOSE="b",fh.ERROR="c",fh.MESSAGE="d",ni.prototype.listen=ni.prototype.N,Mr.prototype.listenOnce=Mr.prototype.O,Mr.prototype.getLastError=Mr.prototype.La,Mr.prototype.getLastErrorCode=Mr.prototype.Da,Mr.prototype.getStatus=Mr.prototype.ba,Mr.prototype.getResponseJson=Mr.prototype.Qa,Mr.prototype.getResponseText=Mr.prototype.ga,Mr.prototype.send=Mr.prototype.ea;var Gm=pl.createWebChannelTransport=function(){return new Xv},uS=pl.getStatEventTarget=function(){return Sc()},Ah=pl.ErrorCode=np,qm=pl.EventType=Tm,dr=pl.Event=Tc,lS=pl.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},eC=pl.FetchXmlHttpFactory=Ac,Wm=pl.WebChannel=Am,cS=pl.XhrIo=Mr;const e0="@firebase/firestore";class qr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qr.UNAUTHENTICATED=new qr(null),qr.GOOGLE_CREDENTIALS=new qr("google-credentials-uid"),qr.FIRST_PARTY=new qr("first-party-uid"),qr.MOCK_USER=new qr("mock-user");let Rc="9.9.4";const yu=new ko.Yd("@firebase/firestore");function t0(){return yu.logLevel}function Be(n,...e){if(yu.logLevel<=ko.in.DEBUG){const t=e.map(n0);yu.debug(`Firestore (${Rc}): ${n}`,...t)}}function jn(n,...e){if(yu.logLevel<=ko.in.ERROR){const t=e.map(n0);yu.error(`Firestore (${Rc}): ${n}`,...t)}}function Mc(n,...e){if(yu.logLevel<=ko.in.WARN){const t=e.map(n0);yu.warn(`Firestore (${Rc}): ${n}`,...t)}}function n0(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function lt(n="Unexpected state"){const e=`FIRESTORE (${Rc}) INTERNAL ASSERTION FAILED: `+n;throw jn(e),new Error(e)}function St(n,e){n||lt()}function et(n,e){return n}const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Le extends O.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class xh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qr.UNAUTHENTICATED))}shutdown(){}}class fS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class pS{constructor(e){this.t=e,this.currentUser=qr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let l=new hr;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new hr,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=l;e.enqueueRetryable((0,Ee.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},m=v=>{Be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>m(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?m(v):(Be("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new hr)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(St("string"==typeof r.accessToken),new xh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return St(null===e||"string"==typeof e),new qr(e)}}class nC{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=qr.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(St(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class rC{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new nC(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(qr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class r0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gS{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&Be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,Be("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{Be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):Be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(St("string"==typeof t.token),this.A=t.token,new r0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function _S(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class iC{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=_S(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function Ot(n,e){return n<e?-1:n>e?1:0}function gp(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function yS(n){return n+"\0"}class tr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Le(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Le(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Le(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Le(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return tr.fromMillis(Date.now())}static fromDate(e){return tr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new tr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ot(this.nanoseconds,e.nanoseconds):Ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class At{constructor(e){this.timestamp=e}static fromTimestamp(e){return new At(e)}static min(){return new At(new tr(0,0))}static max(){return new At(new tr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Cl{constructor(e,t,r){void 0===t?t=0:t>e.length&&lt(),void 0===r?r=e.length-t:r>e.length-t&&lt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Cl.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Cl?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ln extends Cl{construct(e,t,r){return new ln(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Le(pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ln(t)}static emptyPath(){return new ln([])}}const vS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nr extends Cl{construct(e,t,r){return new nr(e,t,r)}static isValidIdentifier(e){return vS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new nr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Le(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Le(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if("\\"!==m&&"."!==m&&"`"!==m)throw new Le(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new Le(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nr(t)}static emptyPath(){return new nr([])}}class Ke{constructor(e){this.path=e}static fromPath(e){return new Ke(ln.fromString(e))}static fromName(e){return new Ke(ln.fromString(e).popFirst(5))}static empty(){return new Ke(ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ln.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ln.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ke(new ln(e.slice()))}}class zm{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function s0(n){return n.fields.find(e=>2===e.kind)}function Nc(n){return n.fields.filter(e=>2!==e.kind)}zm.UNKNOWN_ID=-1;class Zm{constructor(e,t){this.fieldPath=e,this.kind=t}}class mp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new mp(0,Ns.min())}}function oC(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=At.fromTimestamp(1e9===r?new tr(t+1,0):new tr(t,r));return new Ns(i,Ke.empty(),e)}function Pc(n){return new Ns(n.readTime,n.key,-1)}class Ns{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ns(At.min(),Ke.empty(),-1)}static max(){return new Ns(At.max(),Ke.empty(),-1)}}function Km(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ke.comparator(n.documentKey,e.documentKey),0!==t?t:Ot(n.largestBatchId,e.largestBatchId))}const aC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class o0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function bl(n){return Ym.apply(this,arguments)}function Ym(){return Ym=(0,Ee.Z)(function*(n){if(n.code!==pe.FAILED_PRECONDITION||n.message!==aC)throw n;Be("LocalStore","Unexpectedly lost primary lease")}),Ym.apply(this,arguments)}class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new he((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof he?t:he.resolve(t)}catch(t){return he.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):he.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):he.reject(t)}static resolve(e){return new he((t,r)=>{t(e)})}static reject(e){return new he((t,r)=>{r(e)})}static waitFor(e){return new he((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},m=>r(m))}),l=!0,a===i&&t()})}static or(e){let t=he.resolve(!1);for(const r of e)t=t.next(i=>i?he.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new he((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let m=0;m<a;m++){const v=m;t(e[v]).next(D=>{l[v]=D,++h,h===a&&r(l)},D=>i(D))}})}static doWhile(e,t){return new he((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Rh{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new hr,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new Mh(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=a0(r.target.error);this.P.reject(new Mh(e,i))}}static open(e,t,r,i){try{return new Rh(t,e.transaction(i,r))}catch(a){throw new Mh(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(Be("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ES(t)}}class Uo{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===Uo.D((0,O.z$)())&&jn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Be("SimpleDb","Removing database:",e),Oc(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,O.hl)())return!1;if(Uo.N())return!0;const e=(0,O.z$)(),t=Uo.D(e),r=0<t&&t<10,i=Uo.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.M)}static O(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,Ee.Z)(function*(){return t.db||(Be("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new Mh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new Le(pe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Le(pe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new Mh(e,h))},a.onupgradeneeded=l=>{Be("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{Be("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,Ee.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.F(e);const m=Rh.open(a.db,e,l?"readonly":"readwrite",r),v=i(m).next(D=>(m.V(),D)).catch(D=>(m.abort(D),he.reject(D))).toPromise();return v.catch(()=>{}),yield m.v,v}catch(m){const v=m,D="FirebaseError"!==v.name&&h<3;if(Be("SimpleDb","Transaction failed with error:",v.message,"Retrying:",D),a.close(),!D)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class uC{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return Oc(this.U.delete())}}class Mh extends Le{constructor(e,t){super(pe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Dl(n){return"IndexedDbTransactionError"===n.name}class ES{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Be("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Be("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oc(r)}add(e){return Be("SimpleDb","ADD",this.store.name,e,e),Oc(this.store.add(e))}get(e){return Oc(this.store.get(e)).next(t=>(void 0===t&&(t=null),Be("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Be("SimpleDb","DELETE",this.store.name,e),Oc(this.store.delete(e))}count(){return Be("SimpleDb","COUNT",this.store.name),Oc(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new he((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new he((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){Be("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,h)=>h.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new he((r,i)=>{t.onerror=a=>{const l=a0(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}H(e,t){const r=[];return new he((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const m=new uC(h),v=t(h.primaryKey,h.value,m);if(v instanceof he){const D=v.catch(S=>(m.done(),he.reject(S)));r.push(D)}m.isDone?i():null===m.G?h.continue():h.continue(m.G)}}).next(()=>he.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oc(n){return new he((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=a0(r.target.error);t(i)}})}let Qm=!1;function a0(n){const e=Uo.D((0,O.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Qm||(Qm=!0,setTimeout(()=>{throw r},0)),r}}return n}class lC{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;Be("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Ee.Z)(function*(){t.task=null;try{Be("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){Dl(r)?Be("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield bl(r)}yield t.nt(1)}))}}class IS{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,Ee.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return he.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return Be("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(h=>(Be("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=Pc(a);Km(l,r)>0&&(r=l)}),new Ns(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class rs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function cC(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function kc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}rs.at=-1;class fr{constructor(e,t){this.comparator=e,this.root=t||mi.EMPTY}insert(e,t){return new fr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mi.BLACK,null,null))}remove(e){return new fr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jm(this.root,e,this.comparator,!0)}}class Jm{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mi{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=null!=r?r:mi.RED,this.left=null!=i?i:mi.EMPTY,this.right=null!=a?a:mi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new mi(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return mi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw lt();const e=this.left.check();if(e!==this.right.check())throw lt();return e+(this.isRed()?0:1)}}mi.EMPTY=null,mi.RED=!0,mi.BLACK=!1,mi.EMPTY=new class{constructor(){this.size=0}get key(){throw lt()}get value(){throw lt()}get color(){throw lt()}get left(){throw lt()}get right(){throw lt()}copy(n,e,t,r,i){return this}insert(n,e,t){return new mi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class bn{constructor(e){this.comparator=e,this.data=new fr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new u0(this.data.getIterator())}getIteratorFrom(e){return new u0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new bn(this.comparator);return t.data=e,t}}class u0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Nh(n){return n.hasNext()?n.getNext():void 0}class Ps{constructor(e){this.fields=e,e.sort(nr.comparator)}static empty(){return new Ps([])}unionWith(e){let t=new bn(nr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ps(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gp(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Wr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Wr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Wr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wr.EMPTY_BYTE_STRING=new Wr("");const CS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tl(n){if(St(!!n),"string"==typeof n){let e=0;const t=CS.exec(n);if(St(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Kn(n.seconds),nanos:Kn(n.nanos)}}function Kn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function vu(n){return"string"==typeof n?Wr.fromBase64String(n):Wr.fromUint8Array(n)}function Xm(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function e_(n){const e=n.mapValue.fields.__previous_value__;return Xm(e)?e_(e):e}function _p(n){const e=Tl(n.mapValue.fields.__local_write_time__.timestampValue);return new tr(e.seconds,e.nanos)}class bS{constructor(e,t,r,i,a,l,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=m}}class Da{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Da("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Da&&e.projectId===this.projectId&&e.database===this.database}}function yp(n){return null==n}function Ph(n){return 0===n&&1/n==-1/0}function fC(n){return"number"==typeof n&&Number.isInteger(n)&&!Ph(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const wu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},t_={nullValue:"NULL_VALUE"};function Sl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xm(n)?4:l0(n)?9007199254740991:10:lt()}function Eu(n,e){if(n===e)return!0;const t=Sl(n);if(t!==Sl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return _p(n).isEqual(_p(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Tl(r.timestampValue),l=Tl(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,vu(n.bytesValue).isEqual(vu(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Kn(r.geoPointValue.latitude)===Kn(i.geoPointValue.latitude)&&Kn(r.geoPointValue.longitude)===Kn(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Kn(r.integerValue)===Kn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Kn(r.doubleValue),l=Kn(i.doubleValue);return a===l?Ph(a)===Ph(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return gp(n.arrayValue.values||[],e.arrayValue.values||[],Eu);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(cC(a)!==cC(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!Eu(a[h],l[h])))return!1;return!0}(n,e);default:return lt()}var i}function vp(n,e){return void 0!==(n.values||[]).find(t=>Eu(t,e))}function Bo(n,e){if(n===e)return 0;const t=Sl(n),r=Sl(e);if(t!==r)return Ot(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ot(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Kn(i.integerValue||i.doubleValue),h=Kn(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return pC(n.timestampValue,e.timestampValue);case 4:return pC(_p(n),_p(e));case 5:return Ot(n.stringValue,e.stringValue);case 6:return function(i,a){const l=vu(i),h=vu(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let m=0;m<l.length&&m<h.length;m++){const v=Ot(l[m],h[m]);if(0!==v)return v}return Ot(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ot(Kn(i.latitude),Kn(a.latitude));return 0!==l?l:Ot(Kn(i.longitude),Kn(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let m=0;m<l.length&&m<h.length;++m){const v=Bo(l[m],h[m]);if(v)return v}return Ot(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===wu.mapValue&&a===wu.mapValue)return 0;if(i===wu.mapValue)return 1;if(a===wu.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),m=a.fields||{},v=Object.keys(m);h.sort(),v.sort();for(let D=0;D<h.length&&D<v.length;++D){const S=Ot(h[D],v[D]);if(0!==S)return S;const N=Bo(l[h[D]],m[v[D]]);if(0!==N)return N}return Ot(h.length,v.length)}(n.mapValue,e.mapValue);default:throw lt()}}function pC(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ot(n,e);const t=Tl(n),r=Tl(e),i=Ot(t.seconds,r.seconds);return 0!==i?i:Ot(t.nanos,r.nanos)}function jo(n){return Fc(n)}function Fc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=Tl(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?vu(n.bytesValue).toBase64():"referenceValue"in n?Ke.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=Fc(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${Fc(r.fields[h])}`;return a+"}"}(n.mapValue):lt();var e}function Lc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gC(n){return!!n&&"integerValue"in n}function Oh(n){return!!n&&"arrayValue"in n}function mC(n){return!!n&&"nullValue"in n}function _C(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function n_(n){return!!n&&"mapValue"in n}function wp(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return kc(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=wp(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wp(n.arrayValue.values[t]);return e}return Object.assign({},n)}function l0(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function yC(n){return"nullValue"in n?t_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Lc(Da.empty(),Ke.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:lt()}function c0(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Lc(Da.empty(),Ke.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?wu:lt()}function Ep(n,e){const t=Bo(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function kh(n,e){const t=Bo(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class _i{constructor(e){this.value=e}static empty(){return new _i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!n_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wp(t)}setAll(e){let t=nr.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=wp(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());n_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Eu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];n_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){kc(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new _i(wp(this.value))}}function d0(n){const e=[];return kc(n.fields,(t,r)=>{const i=new nr([t]);if(n_(r)){const a=d0(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new Ps(e)}class Nn{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Nn(e,0,At.min(),At.min(),_i.empty(),0)}static newFoundDocument(e,t,r){return new Nn(e,1,t,At.min(),r,0)}static newNoDocument(e,t){return new Nn(e,2,t,At.min(),_i.empty(),0)}static newUnknownDocument(e,t){return new Nn(e,3,t,At.min(),_i.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_i.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_i.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=At.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class DS{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ht=null}}function vC(n,e=null,t=[],r=[],i=null,a=null,l=null){return new DS(n,e,t,r,i,a,l)}function Iu(n){const e=et(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+jo(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),yp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>jo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>jo(r)).join(",")),e.ht=t}return e.ht}function r_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!xS(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Eu(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bC(n.startAt,e.startAt)&&bC(n.endAt,e.endAt)}function i_(n){return Ke.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function s_(n,e){return n.filters.filter(t=>t instanceof pr&&t.field.isEqual(e))}function Vc(n,e,t){let r=t_,i=!0;for(const a of s_(n,e)){let l=t_,h=!0;switch(a.op){case"<":case"<=":l=yC(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=t_}Ep({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];Ep({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function h0(n,e,t){let r=wu,i=!0;for(const a of s_(n,e)){let l=wu,h=!0;switch(a.op){case">=":case">":l=c0(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=wu}kh({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];kh({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class pr extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new JM(e,t,r):"array-contains"===t?new EC(e,r):"in"===t?new XM(e,r):"not-in"===t?new IC(e,r):"array-contains-any"===t?new f0(e,r):new pr(e,t,r)}static lt(e,t,r){return"in"===t?new wC(e,r):new SS(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(Bo(t,this.value)):null!==t&&Sl(this.value)===Sl(t)&&this.ft(Bo(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return lt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class JM extends pr{constructor(e,t,r){super(e,t,r),this.key=Ke.fromName(r.referenceValue)}matches(e){const t=Ke.comparator(e.key,this.key);return this.ft(t)}}class wC extends pr{constructor(e,t){super(e,"in",t),this.keys=AS(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class SS extends pr{constructor(e,t){super(e,"not-in",t),this.keys=AS(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function AS(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Ke.fromName(r.referenceValue))}class EC extends pr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Oh(t)&&vp(t.arrayValue,this.value)}}class XM extends pr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&vp(this.value.arrayValue,t)}}class IC extends pr{constructor(e,t){super(e,"not-in",t)}matches(e){if(vp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!vp(this.value.arrayValue,t)}}class f0 extends pr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Oh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>vp(this.value.arrayValue,r))}}class Al{constructor(e,t){this.position=e,this.inclusive=t}}class Fh{constructor(e,t="asc"){this.field=e,this.dir=t}}function xS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function CC(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?Ke.comparator(Ke.fromName(l.referenceValue),t.key):Bo(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function bC(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Eu(n.position[t],e.position[t]))return!1;return!0}class Cu{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=m,this._t=null,this.wt=null}}function DC(n,e,t,r,i,a,l,h){return new Cu(n,e,t,r,i,a,l,h)}function Lh(n){return new Cu(n)}function TC(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function p0(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Uc(n){for(const e of n.filters)if(e.dt())return e.field;return null}function o_(n){return null!==n.collectionGroup}function Bc(n){const e=et(n);if(null===e._t){e._t=[];const t=Uc(e),r=p0(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new Fh(t)),e._t.push(new Fh(nr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e._t.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new Fh(nr.keyField(),a))}}}return e._t}function ji(n){const e=et(n);if(!e.wt)if("F"===e.limitType)e.wt=vC(e.path,e.collectionGroup,Bc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of Bc(e))t.push(new Fh(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Al(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Al(e.startAt.position,e.startAt.inclusive):null;e.wt=vC(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.wt}function Ip(n,e,t){return new Cu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Vh(n,e){return r_(ji(n),ji(e))&&n.limitType===e.limitType}function SC(n){return`${Iu(ji(n))}|lt:${n.limitType}`}function g0(n){return`Query(target=${function TS(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${jo(r.value)}`;var r}).join(", ")}]`),yp(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>jo(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>jo(t)).join(",")),`Target(${e})`}(ji(n))}; limitType=${n.limitType})`}function m0(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ke.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=CC(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,Bc(t),r)||t.endAt&&!function(i,a,l){const h=CC(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,Bc(t),r)));var t,r}function AC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function xC(n){return(e,t)=>{let r=!1;for(const i of Bc(n)){const a=RS(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function RS(n,e,t){const r=n.field.isKeyField()?Ke.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),m=l.data.field(i);return null!==h&&null!==m?Bo(h,m):lt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return lt()}}function RC(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ph(e)?"-0":e}}function Uh(n){return{integerValue:""+n}}function MC(n,e){return fC(e)?Uh(e):RC(n,e)}class Bh{constructor(){this._=void 0}}function Ta(n,e,t){return n instanceof Sa?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof jc?NC(n,e):n instanceof Hc?Cp(n,e):function(r,i){const a=a_(r,i),l=PC(a)+PC(r.yt);return gC(a)&&gC(r.yt)?Uh(l):RC(r.It,l)}(n,e)}function MS(n,e,t){return n instanceof jc?NC(n,e):n instanceof Hc?Cp(n,e):t}function a_(n,e){return n instanceof bu?gC(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Sa extends Bh{}class jc extends Bh{constructor(e){super(),this.elements=e}}function NC(n,e){const t=OC(e);for(const r of n.elements)t.some(i=>Eu(i,r))||t.push(r);return{arrayValue:{values:t}}}class Hc extends Bh{constructor(e){super(),this.elements=e}}function Cp(n,e){let t=OC(e);for(const r of n.elements)t=t.filter(i=>!Eu(i,r));return{arrayValue:{values:t}}}class bu extends Bh{constructor(e,t){super(),this.It=e,this.yt=t}}function PC(n){return Kn(n.integerValue||n.doubleValue)}function OC(n){return Oh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class jh{constructor(e,t){this.field=e,this.transform=t}}class _0{constructor(e,t){this.version=e,this.transformResults=t}}class Hn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Hn}static exists(e){return new Hn(void 0,e)}static updateTime(e){return new Hn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function u_(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class l_{}function NS(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Gc(n.key,Hn.none()):new xl(n.key,n.data,Hn.none());{const t=n.data,r=_i.empty();let i=new bn(nr.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Du(n.key,r,new Ps(i.toArray()),Hn.none())}}function y0(n,e,t){n instanceof xl?function(r,i,a){const l=r.value.clone(),h=VC(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Du?function(r,i,a){if(!u_(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=VC(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(LC(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function $c(n,e,t,r){return n instanceof xl?function(i,a,l,h){if(!u_(i.precondition,a))return l;const m=i.value.clone(),v=UC(i.fieldTransforms,h,a);return m.setAll(v),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Du?function(i,a,l,h){if(!u_(i.precondition,a))return l;const m=UC(i.fieldTransforms,h,a),v=a.data;return v.setAll(LC(i)),v.setAll(m),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(D=>D.field))}(n,e,t,r):(l=t,u_(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function FC(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=a_(r.transform,i||null);null!=a&&(null===t&&(t=_i.empty()),t.set(r.field,a))}return t||null}function c_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&gp(t,r,(i,a)=>function kC(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof jc&&r instanceof jc||t instanceof Hc&&r instanceof Hc?gp(t.elements,r.elements,Eu):t instanceof bu&&r instanceof bu?Eu(t.yt,r.yt):t instanceof Sa&&r instanceof Sa);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class xl extends l_{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Du extends l_{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function LC(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function VC(n,e,t){const r=new Map;St(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,MS(l,h,t[i]))}return r}function UC(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,Ta(a,l,e))}return r}class Gc extends l_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bp extends l_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class BC{constructor(e){this.count=e}}var Nr,an;function v0(n){switch(n){default:return lt();case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0}}function jC(n){if(void 0===n)return jn("GRPC error has no .code"),pe.UNKNOWN;switch(n){case Nr.OK:return pe.OK;case Nr.CANCELLED:return pe.CANCELLED;case Nr.UNKNOWN:return pe.UNKNOWN;case Nr.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case Nr.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case Nr.INTERNAL:return pe.INTERNAL;case Nr.UNAVAILABLE:return pe.UNAVAILABLE;case Nr.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case Nr.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case Nr.NOT_FOUND:return pe.NOT_FOUND;case Nr.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case Nr.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case Nr.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case Nr.ABORTED:return pe.ABORTED;case Nr.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case Nr.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case Nr.DATA_LOSS:return pe.DATA_LOSS;default:return lt()}}(an=Nr||(Nr={}))[an.OK=0]="OK",an[an.CANCELLED=1]="CANCELLED",an[an.UNKNOWN=2]="UNKNOWN",an[an.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",an[an.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",an[an.NOT_FOUND=5]="NOT_FOUND",an[an.ALREADY_EXISTS=6]="ALREADY_EXISTS",an[an.PERMISSION_DENIED=7]="PERMISSION_DENIED",an[an.UNAUTHENTICATED=16]="UNAUTHENTICATED",an[an.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",an[an.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",an[an.ABORTED=10]="ABORTED",an[an.OUT_OF_RANGE=11]="OUT_OF_RANGE",an[an.UNIMPLEMENTED=12]="UNIMPLEMENTED",an[an.INTERNAL=13]="INTERNAL",an[an.UNAVAILABLE=14]="UNAVAILABLE",an[an.DATA_LOSS=15]="DATA_LOSS";class Tu{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){kc(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return dC(this.inner)}size(){return this.innerSize}}const HC=new fr(Ke.comparator);function is(){return HC}const w0=new fr(Ke.comparator);function Dp(...n){let e=w0;for(const t of n)e=e.insert(t.key,t);return e}function Ti(n){let e=w0;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Hi(){return Tp()}function $C(){return Tp()}function Tp(){return new Tu(n=>n.toString(),(n,e)=>n.isEqual(e))}const eN=new fr(Ke.comparator),Sp=new bn(Ke.comparator);function jt(...n){let e=Sp;for(const t of n)e=e.add(t);return e}const E0=new bn(Ot);function d_(){return E0}class Hh{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,Ap.createSynthesizedTargetChangeForCurrentChange(e,t)),new Hh(At.min(),r,d_(),is(),jt())}}class Ap{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Ap(Wr.EMPTY_BYTE_STRING,t,jt(),jt(),jt())}}class h_{constructor(e,t,r,i){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=i}}class f_{constructor(e,t){this.targetId=e,this.At=t}}class I0{constructor(e,t,r=Wr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class C0{constructor(){this.Rt=0,this.bt=PS(),this.Pt=Wr.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=jt(),t=jt(),r=jt();return this.bt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:lt()}}),new Ap(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=PS()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Mt(e){this.Vt=!0,this.bt=this.bt.remove(e)}Ot(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class p_{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=is(),this.qt=g_(),this.Kt=new bn(Ot)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:lt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,i)=>{this.Ht(i)&&t(i)})}Yt(e){const t=e.targetId,r=e.At.count,i=this.Xt(t);if(i){const a=i.target;if(i_(a))if(0===r){const l=new Ke(a.path);this.jt(t,l,Nn.newNoDocument(l,At.min()))}else St(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((a,l)=>{const h=this.Xt(l);if(h){if(a.current&&i_(h.target)){const m=new Ke(h.target.path);null!==this.Ut.get(m)||this.ee(l,m)||this.jt(l,m,Nn.newNoDocument(m,e))}a.Dt&&(t.set(l,a.xt()),a.Nt())}});let r=jt();this.qt.forEach((a,l)=>{let h=!0;l.forEachWhile(m=>{const v=this.Xt(m);return!v||2===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.Ut.forEach((a,l)=>l.setReadTime(e));const i=new Hh(e,t,this.Kt,this.Ut,r);return this.Ut=is(),this.qt=g_(),this.Kt=new bn(Ot),i}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Mt(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.zt(e).Ot()}zt(e){let t=this.Lt.get(e);return t||(t=new C0,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new bn(Ot),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||Be("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new C0),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function g_(){return new fr(Ke.comparator)}function PS(){return new fr(Ke.comparator)}const GC={asc:"ASCENDING",desc:"DESCENDING"},OS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class qC{constructor(e,t){this.databaseId=e,this.gt=t}}function Rl(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b0(n,e){return n.gt?e.toBase64():e.toUint8Array()}function kS(n,e){return Rl(n,e.toTimestamp())}function Pr(n){return St(!!n),At.fromTimestamp(function(e){const t=Tl(e);return new tr(t.seconds,t.nanos)}(n))}function xp(n,e){return(t=n,new ln(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function FS(n){const e=ln.fromString(n);return St(BS(e)),e}function Rp(n,e){return xp(n.databaseId,e.path)}function Aa(n,e){const t=FS(e);if(t.get(1)!==n.databaseId.projectId)throw new Le(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Le(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ke(T0(t))}function m_(n,e){return xp(n.databaseId,e)}function D0(n){const e=FS(n);return 4===e.length?ln.emptyPath():T0(e)}function Mp(n){return new ln(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function T0(n){return St(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function S0(n,e,t){return{name:Rp(n,e),fields:t.value.mapValue.fields}}function WC(n,e,t){const r=Aa(n,e.name),i=Pr(e.updateTime),a=new _i({mapValue:{fields:e.fields}}),l=Nn.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Np(n,e){let t;if(e instanceof xl)t={update:S0(n,e.key,e.value)};else if(e instanceof Gc)t={delete:Rp(n,e.key)};else if(e instanceof Du)t={update:S0(n,e.key,e.data),updateMask:iN(e.fieldMask)};else{if(!(e instanceof bp))return lt();t={verify:Rp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Sa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof jc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Hc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof bu)return{fieldPath:a.field.canonicalString(),increment:l.yt};throw lt()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:kS(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:lt()),t;var i}function __(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Hn.updateTime(Pr(i.updateTime)):void 0!==i.exists?Hn.exists(i.exists):Hn.none():Hn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(St("REQUEST_TIME"===l.setToServerValue),h=new Sa):"appendMissingElements"in l?h=new jc(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new Hc(l.removeAllFromArray.values||[]):"increment"in l?h=new bu(a,l.increment):lt();const m=nr.fromServerFormat(l.fieldPath);return new jh(m,h)}(n,i)):[];var i;if(e.update){const i=Aa(n,e.update.name),a=new _i({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new Ps((e.updateMask.fieldPaths||[]).map(v=>nr.fromServerFormat(v)));return new Du(i,a,l,t,r)}return new xl(i,a,t,r)}if(e.delete){const i=Aa(n,e.delete);return new Gc(i,t)}if(e.verify){const i=Aa(n,e.verify);return new bp(i,t)}return lt()}function A0(n,e){return{documents:[m_(n,e.path)]}}function x0(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=m_(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=m_(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(m){if(0===m.length)return;const v=m.map(D=>function(S){if("=="===S.op){if(_C(S.value))return{unaryFilter:{field:Pp(S.field),op:"IS_NAN"}};if(mC(S.value))return{unaryFilter:{field:Pp(S.field),op:"IS_NULL"}}}else if("!="===S.op){if(_C(S.value))return{unaryFilter:{field:Pp(S.field),op:"IS_NOT_NAN"}};if(mC(S.value))return{unaryFilter:{field:Pp(S.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pp(S.field),op:tN(S.op),value:S.value}}}(D));return 1===v.length?v[0]:{compositeFilter:{op:"AND",filters:v}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(m){if(0!==m.length)return m.map(v=>{return{field:Pp((D=v).field),direction:YC(D.dir)};var D})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(v=e.limit,n.gt||yp(v)?v:{value:v});var v,h,m;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(m=e.endAt).inclusive,values:m.position}),t}function KC(n){let e=D0(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){St(1===r);const D=t.from[0];D.allDescendants?i=D.collectionId:e=e.child(D.collectionId)}let a=[];t.where&&(a=US(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(D=>{return new Fh(Op((S=D).field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let h=null;t.limit&&(h=function(D){let S;return S="object"==typeof D?D.value:D,yp(S)?null:S}(t.limit));let m=null;var D;t.startAt&&(m=new Al((D=t.startAt).values||[],!!D.before));let v=null;return t.endAt&&(v=function(D){return new Al(D.values||[],!D.before)}(t.endAt)),DC(e,i,l,a,h,"F",m,v)}function US(n){return n?void 0!==n.unaryFilter?[rN(n)]:void 0!==n.fieldFilter?[nN(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>US(e)).reduce((e,t)=>e.concat(t)):lt():[]}function YC(n){return GC[n]}function tN(n){return OS[n]}function Pp(n){return{fieldPath:n.canonicalString()}}function Op(n){return nr.fromServerFormat(n.fieldPath)}function nN(n){return pr.create(Op(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return lt()}}(n.fieldFilter.op),n.fieldFilter.value)}function rN(n){switch(n.unaryFilter.op){case"IS_NAN":const e=Op(n.unaryFilter.field);return pr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=Op(n.unaryFilter.field);return pr.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Op(n.unaryFilter.field);return pr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Op(n.unaryFilter.field);return pr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return lt()}}function iN(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function BS(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function ss(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jS(e)),e=y_(n.get(t),e);return jS(e)}function y_(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function jS(n){return n+"\x01\x01"}function Ho(n){const e=n.length;if(St(e>=2),2===e)return St("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),ln.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&lt(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let m;0===i.length?m=h:(i+=h,m=i,i=""),r.push(m);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:lt()}a=l+2}return new ln(r)}const v_=["userId","batchId"];function kp(n,e){return[n,ss(e)]}function R0(n,e,t){return[n,ss(e),t]}const sN={},M0=["prefixPath","collectionGroup","readTime","documentId"],QC=["prefixPath","collectionGroup","documentId"],HS=["collectionGroup","readTime","prefixPath","documentId"],JC=["canonicalId","targetId"],oN=["targetId","path"],$S=["path","targetId"],GS=["collectionId","parent"],N0=["indexId","uid"],qS=["uid","sequenceNumber"],aN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uN=["indexId","uid","orderedDocumentKey"],lN=["userId","collectionPath","documentId"],WS=["userId","collectionPath","largestBatchId"],zS=["userId","collectionGroup","largestBatchId"],XC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],cN=[...XC,"documentOverlays"],eb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],w_=eb,ZS=[...w_,"indexConfiguration","indexState","indexEntries"];class Os extends o0{constructor(e,t){super(),this.ie=e,this.currentSequenceNumber=t}}function ii(n,e){const t=et(n);return Uo.O(t.ie,e)}class Fp{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&y0(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=$c(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=$c(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=$C();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const m=NS(l,h);null!==m&&r.set(i.key,m),l.isValidDocument()||l.convertToNoDocument(At.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),jt())}isEqual(e){return this.batchId===e.batchId&&gp(this.mutations,e.mutations,(t,r)=>c_(t,r))&&gp(this.baseMutations,e.baseMutations,(t,r)=>c_(t,r))}}class P0{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){St(e.mutations.length===r.length);let i=eN;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new P0(e,t,r,i)}}class O0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class xa{constructor(e,t,r,i,a=At.min(),l=At.min(),h=Wr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new xa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new xa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class k0{constructor(e){this.re=e}}function nb(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Lp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Rp(i=n.re,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Rl(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:qc(e.version)};else{if(!e.isUnknownDocument())return lt();r.unknownDocument={path:t.path.toArray(),version:qc(e.version)}}var i,a;return r}function Lp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function qc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Wc(n){const e=new tr(n.seconds,n.nanoseconds);return At.fromTimestamp(e)}function zc(n,e){const t=(e.baseMutations||[]).map(a=>__(n.re,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>__(n.re,a)),i=tr.fromMillis(e.localWriteTimeMs);return new Fp(e.batchId,i,t,r)}function Zc(n){const e=Wc(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Wc(n.lastLimboFreeSnapshotVersion):At.min();let r;var i;return void 0!==n.query.documents?(St(1===(i=n.query).documents.length),r=ji(Lh(D0(i.documents[0])))):r=ji(KC(n.query)),new xa(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Wr.fromBase64String(n.resumeToken))}function Ml(n,e){const t=qc(e.snapshotVersion),r=qc(e.lastLimboFreeSnapshotVersion);let i;i=i_(e.target)?A0(n.re,e.target):x0(n.re,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Iu(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function E_(n){const e=KC({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Ip(e,e.limit,"L"):e}function I_(n,e){return new O0(e.largestBatchId,__(n.re,e.overlayMutation))}function rb(n,e){const t=e.path.lastSegment();return[n,ss(e.path.popLast()),t]}function KS(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:qc(r.readTime),documentKey:ss(r.documentKey.path),largestBatchId:r.largestBatchId}}class YS{getBundleMetadata(e,t){return ib(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Wc(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return ib(e).put({bundleId:(r=t).id,createTime:qc(Pr(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return sb(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:E_(i.bundledQuery),readTime:Wc(i.readTime)};var i})}saveNamedQuery(e,t){return sb(e).put({name:(r=t).name,readTime:qc(Pr(r.readTime)),bundledQuery:r.bundledQuery});var r}}function ib(n){return ii(n,"bundles")}function sb(n){return ii(n,"namedQueries")}class Vp{constructor(e,t){this.It=e,this.userId=t}static oe(e,t){return new Vp(e,t.uid||"")}getOverlay(e,t){return Up(e).get(rb(this.userId,t)).next(r=>r?I_(this.It,r):null)}getOverlays(e,t){const r=Hi();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new O0(t,l);i.push(this.ue(e,h))}),he.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(ss(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(Up(e).Y("collectionPathOverlayIndex",h))}),he.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Hi(),a=ss(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Up(e).W("collectionPathOverlayIndex",l).next(h=>{for(const m of h){const v=I_(this.It,m);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=Hi();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Up(e).Z({index:"collectionGroupOverlayIndex",range:h},(m,v,D)=>{const S=I_(this.It,v);a.size()<i||S.largestBatchId===l?(a.set(S.getKey(),S),l=S.largestBatchId):D.done()}).next(()=>a)}ue(e,t){return Up(e).put(function(r,i,a){const[l,h,m]=rb(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Np(r.re,a.mutation)}}(this.It,this.userId,t))}}function Up(n){return ii(n,"documentOverlays")}class Kc{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(Kn(e.integerValue));else if("doubleValue"in e){const r=Kn(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),Ph(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(vu(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?l0(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):lt()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const i of Object.keys(r))this._e(i,t),this.ae(r[i],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const i of r)this.ae(i,t)}ge(e,t){this.le(t,37),Ke.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}function dN(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function C_(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=dN(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Kc.Te=new Kc;class ob{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.ve()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=t.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const t=this.Ce(e),r=C_(t);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ne(e){const t=this.Ce(e),r=C_(t);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}ke(){this.Me(255),this.Me(255)}Oe(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ae(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}Pe(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Me(0),this.Me(1)}ve(){this.Fe(0),this.Fe(1)}Me(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class QS{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class JS{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Oe()}}class $h{constructor(){this.Be=new ob,this.Le=new QS(this.Be),this.Ue=new JS(this.Be)}seed(e){this.Be.seed(e)}qe(e){return 0===e?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}class Su{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Su(this.indexId,this.documentKey,this.arrayValue,r)}}function Au(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=F0(n.arrayValue,e.arrayValue),0!==t?t:(t=F0(n.directionalValue,e.directionalValue),0!==t?t:Ke.comparator(n.documentKey,e.documentKey)))}function F0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class XS{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const t of e.filters){const r=t;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const t=s0(e);if(void 0!==t&&!this.ze(t))return!1;const r=Nc(e);let i=0,a=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.je){const l=r[i];if(!this.He(this.je,l)||!this.Je(this.Ge[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ge.length||!this.Je(this.Ge[a++],l))return!1}return!0}ze(e){for(const t of this.Qe)if(this.He(t,e))return!0;return!1}He(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Je(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class ab{constructor(){this.Ye=new b_}addToCollectionParentIndex(e,t){return this.Ye.add(t),he.resolve()}getCollectionParents(e,t){return he.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return he.resolve()}deleteFieldIndex(e,t){return he.resolve()}getDocumentsMatchingTarget(e,t){return he.resolve(null)}getIndexType(e,t){return he.resolve(0)}getFieldIndexes(e,t){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,t){return he.resolve(Ns.min())}getMinOffsetFromCollectionGroup(e,t){return he.resolve(Ns.min())}updateCollectionGroup(e,t,r){return he.resolve()}updateIndexEntries(e,t){return he.resolve()}}class b_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new bn(ln.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new bn(ln.comparator)).toArray()}}const D_=new Uint8Array(0);class eA{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new b_,this.Ze=new Tu(r=>Iu(r),(r,i)=>r_(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:ss(i)};return tA(e).put(a)}return he.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[yS(t),""],!1,!0);return tA(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Ho(l.parent))}return r})}addFieldIndex(e,t){const r=Bp(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=jp(e);return a.next(h=>{l.put(KS(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=Bp(e),i=jp(e),a=T_(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=T_(e);let i=!0;const a=new Map;return he.forEach(this.tn(t),l=>this.en(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=jt();const h=[];return he.forEach(a,(m,v)=>{var D;Be("IndexedDbIndexManager",`Using index ${D=m,`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map(pt=>`${pt.fieldPath}:${pt.kind}`).join(",")}`} to execute ${Iu(t)}`);const S=function(pt,dt){const Rt=s0(dt);if(void 0===Rt)return null;for(const Ft of s_(pt,Rt.fieldPath))switch(Ft.op){case"array-contains-any":return Ft.value.arrayValue.values||[];case"array-contains":return[Ft.value]}return null}(v,m),N=function(pt,dt){const Rt=new Map;for(const Ft of Nc(dt))for(const Tr of s_(pt,Ft.fieldPath))switch(Tr.op){case"==":case"in":Rt.set(Ft.fieldPath.canonicalString(),Tr.value);break;case"not-in":case"!=":return Rt.set(Ft.fieldPath.canonicalString(),Tr.value),Array.from(Rt.values())}return null}(v,m),V=function(pt,dt){const Rt=[];let Ft=!0;for(const Tr of Nc(dt)){const Lu=0===Tr.kind?Vc(pt,Tr.fieldPath,pt.startAt):h0(pt,Tr.fieldPath,pt.startAt);Rt.push(Lu.value),Ft&&(Ft=Lu.inclusive)}return new Al(Rt,Ft)}(v,m),W=function(pt,dt){const Rt=[];let Ft=!0;for(const Tr of Nc(dt)){const Lu=0===Tr.kind?h0(pt,Tr.fieldPath,pt.endAt):Vc(pt,Tr.fieldPath,pt.endAt);Rt.push(Lu.value),Ft&&(Ft=Lu.inclusive)}return new Al(Rt,Ft)}(v,m),fe=this.nn(m,v,V),Ae=this.nn(m,v,W),at=this.sn(m,v,N),ft=this.rn(m.indexId,S,fe,V.inclusive,Ae,W.inclusive,at);return he.forEach(ft,pt=>r.J(pt,t.limit).next(dt=>{dt.forEach(Rt=>{const Ft=Ke.fromSegments(Rt.documentKey);l.has(Ft)||(l=l.add(Ft),h.push(Ft))})}))}).next(()=>h)}return he.resolve(null)})}tn(e){let t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}rn(e,t,r,i,a,l,h){const m=(null!=t?t.length:1)*Math.max(r.length,a.length),v=m/(null!=t?t.length:1),D=[];for(let S=0;S<m;++S){const N=t?this.on(t[S/v]):D_,V=this.un(e,N,r[S%v],i),W=this.cn(e,N,a[S%v],l),fe=h.map(Ae=>this.un(e,N,Ae,!0));D.push(...this.createRange(V,W,fe))}return D}un(e,t,r,i){const a=new Su(e,Ke.empty(),t,r);return i?a:a.Ke()}cn(e,t,r,i){const a=new Su(e,Ke.empty(),t,r);return i?a.Ke():a}en(e,t){const r=new XS(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.We(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;return he.forEach(this.tn(t),i=>this.en(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let h=new bn(nr.comparator),m=!1;for(const v of l.filters){const D=v;D.field.isKeyField()||("array-contains"===D.op||"array-contains-any"===D.op?m=!0:h=h.add(D.field))}for(const v of l.orderBy)v.field.isKeyField()||(h=h.add(v.field));return h.size+(m?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,t){const r=new $h;for(const i of Nc(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);Kc.Te.ce(a,l)}return r.$e()}on(e){const t=new $h;return Kc.Te.ce(e,t.qe(0)),t.$e()}hn(e,t){const r=new $h;return Kc.Te.ce(Lc(this.databaseId,t),r.qe(function(i){const a=Nc(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.$e()}sn(e,t,r){if(null===r)return[];let i=[];i.push(new $h);let a=0;for(const l of Nc(e)){const h=r[a++];for(const m of i)if(this.ln(t,l.fieldPath)&&Oh(h))i=this.fn(i,l,h);else{const v=m.qe(l.kind);Kc.Te.ce(h,v)}}return this.dn(i)}nn(e,t,r){return this.sn(e,t,r.position)}dn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].$e();return t}fn(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const m=new $h;m.seed(h.$e()),Kc.Te.ce(l,m.qe(t.kind)),a.push(m)}return a}ln(e,t){return!!e.filters.find(r=>r instanceof pr&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Bp(e),i=jp(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return he.forEach(a,h=>i.get([h.indexId,this.uid]).next(m=>{l.push(function(v,D){const S=D?new mp(D.sequenceNumber,new Ns(Wc(D.readTime),new Ke(Ho(D.documentKey)),D.largestBatchId)):mp.empty(),N=v.fields.map(([V,W])=>new Zm(nr.fromServerFormat(V),W));return new zm(v.indexId,v.collectionGroup,N,S)}(h,m))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Ot(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Bp(e),a=jp(e);return this._n(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>he.forEach(h,m=>a.put(KS(m.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return he.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?he.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),he.forEach(h,m=>this.wn(e,i,m).next(v=>{const D=this.mn(a,m);return v.isEqual(D)?he.resolve():this.gn(e,a,m,v,D)}))))})}yn(e,t,r,i){return T_(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,t.key),documentKey:t.key.path.toArray()})}pn(e,t,r,i){return T_(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=T_(e);let a=new bn(Au);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,t)])},(l,h)=>{a=a.add(new Su(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}mn(e,t){let r=new bn(Au);const i=this.an(t,e);if(null==i)return r;const a=s0(t);if(null!=a){const l=e.data.field(a.fieldPath);if(Oh(l))for(const h of l.arrayValue.values||[])r=r.add(new Su(t.indexId,e.key,this.on(h),i))}else r=r.add(new Su(t.indexId,e.key,D_,i));return r}gn(e,t,r,i,a){Be("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,m,v,D,S){const N=h.getIterator(),V=m.getIterator();let W=Nh(N),fe=Nh(V);for(;W||fe;){let Ae=!1,at=!1;if(W&&fe){const ft=v(W,fe);ft<0?at=!0:ft>0&&(Ae=!0)}else null!=W?at=!0:Ae=!0;Ae?(D(fe),fe=Nh(V)):at?(S(W),W=Nh(N)):(W=Nh(N),fe=Nh(V))}}(i,a,Au,h=>{l.push(this.yn(e,t,r,h))},h=>{l.push(this.pn(e,t,r,h))}),he.waitFor(l)}_n(e){let t=1;return jp(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>Au(l,h)).filter((l,h,m)=>!h||0!==Au(l,m[h-1]));const i=[];i.push(e);for(const l of r){const h=Au(l,e),m=Au(l,t);if(0===h)i[0]=e.Ke();else if(h>0&&m<0)i.push(l),i.push(l.Ke());else if(m>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,D_,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,D_,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ub)}getMinOffset(e,t){return he.mapArray(this.tn(t),r=>this.en(e,r).next(i=>i||lt())).next(ub)}}function tA(n){return ii(n,"collectionParents")}function T_(n){return ii(n,"indexEntries")}function Bp(n){return ii(n,"indexConfiguration")}function jp(n){return ii(n,"indexState")}function ub(n){St(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Km(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ns(e.readTime,e.documentKey,t)}const lb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ks{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ks(e,ks.DEFAULT_COLLECTION_PERCENTILE,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function nA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const m=r.Z({range:l},(D,S,N)=>(h++,N.delete()));a.push(m.next(()=>{St(1===h)}));const v=[];for(const D of t.mutations){const S=R0(e,D.key.path,t.batchId);a.push(i.delete(S)),v.push(D.key)}return he.waitFor(a).next(()=>v)}function L0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw lt();e=n.noDocument}return JSON.stringify(e).length}ks.DEFAULT_COLLECTION_PERCENTILE=10,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ks.DEFAULT=new ks(41943040,ks.DEFAULT_COLLECTION_PERCENTILE,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ks.DISABLED=new ks(-1,0,0);class V0{constructor(e,t,r,i){this.userId=e,this.It=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,t,r,i){St(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new V0(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=xu(e),l=Nl(e);return l.add({}).next(h=>{St("number"==typeof h);const m=new Fp(h,t,r,i),v=function(N,V,W){const fe=W.baseMutations.map(at=>Np(N.re,at)),Ae=W.mutations.map(at=>Np(N.re,at));return{userId:V,batchId:W.batchId,localWriteTimeMs:W.localWriteTime.toMillis(),baseMutations:fe,mutations:Ae}}(this.It,this.userId,m),D=[];let S=new bn((N,V)=>Ot(N.canonicalString(),V.canonicalString()));for(const N of i){const V=R0(this.userId,N.key.path,h);S=S.add(N.key.path.popLast()),D.push(l.put(v)),D.push(a.put(V,sN))}return S.forEach(N=>{D.push(this.indexManager.addToCollectionParentIndex(e,N))}),e.addOnCommittedListener(()=>{this.In[h]=m.keys()}),he.waitFor(D).next(()=>m)})}lookupMutationBatch(e,t){return Nl(e).get(t).next(r=>r?(St(r.userId===this.userId),zc(this.It,r)):null)}Tn(e,t){return this.In[t]?he.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Nl(e).Z({index:"userMutationsIndex",range:i},(l,h,m)=>{h.userId===this.userId&&(St(h.batchId>=r),a=zc(this.It,h)),m.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Nl(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).W("userMutationsIndex",t).next(r=>r.map(i=>zc(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=kp(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return xu(e).Z({range:i},(l,h,m)=>{const[v,D,S]=l,N=Ho(D);if(v===this.userId&&t.path.isEqual(N))return Nl(e).get(S).next(V=>{if(!V)throw lt();St(V.userId===this.userId),a.push(zc(this.It,V))});m.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new bn(Ot);const i=[];return t.forEach(a=>{const l=kp(this.userId,a.path),h=IDBKeyRange.lowerBound(l),m=xu(e).Z({range:h},(v,D,S)=>{const[N,V,W]=v,fe=Ho(V);N===this.userId&&a.path.isEqual(fe)?r=r.add(W):S.done()});i.push(m)}),he.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=kp(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new bn(Ot);return xu(e).Z({range:l},(m,v,D)=>{const[S,N,V]=m,W=Ho(N);S===this.userId&&r.isPrefixOf(W)?W.length===i&&(h=h.add(V)):D.done()}).next(()=>this.En(e,h))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Nl(e).get(a).next(l=>{if(null===l)throw lt();St(l.userId===this.userId),r.push(zc(this.It,l))}))}),he.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return nA(e.ie,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),he.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return he.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return xu(e).Z({range:r},(a,l,h)=>{if(a[0]===this.userId){const m=Ho(a[1]);i.push(m)}else h.done()}).next(()=>{St(0===i.length)})})}containsKey(e,t){return rA(e,this.userId,t)}Rn(e){return cb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function rA(n,e,t){const r=kp(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return xu(n).Z({range:a,X:!0},(h,m,v)=>{const[D,S,N]=h;D===e&&S===i&&(l=!0),v.done()}).next(()=>l)}function Nl(n){return ii(n,"mutations")}function xu(n){return ii(n,"documentMutations")}function cb(n){return ii(n,"mutationQueues")}class Yc{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Yc(0)}static vn(){return new Yc(-1)}}class db{constructor(e,t){this.referenceDelegate=e,this.It=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new Yc(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>At.fromTimestamp(new tr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ho(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(St(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return ho(e).Z((l,h)=>{const m=Zc(h);m.sequenceNumber<=t&&null===r.get(m.targetId)&&(i++,a.push(this.removeTargetData(e,m)))}).next(()=>he.waitFor(a)).next(()=>i)}forEachTarget(e,t){return ho(e).Z((r,i)=>{const a=Zc(i);t(a)})}Vn(e){return U0(e).get("targetGlobalKey").next(t=>(St(null!==t),t))}Sn(e,t){return U0(e).put("targetGlobalKey",t)}Dn(e,t){return ho(e).put(Ml(this.It,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Iu(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return ho(e).Z({range:i,index:"queryTargetsIndex"},(l,h,m)=>{const v=Zc(h);r_(t,v.target)&&(a=v,m.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Ra(e);return t.forEach(l=>{const h=ss(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),he.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ra(e);return he.forEach(t,a=>{const l=ss(a.path);return he.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Ra(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ra(e);let a=jt();return i.Z({range:r,X:!0},(l,h,m)=>{const v=Ho(l[1]),D=new Ke(v);a=a.add(D)}).next(()=>a)}containsKey(e,t){const r=ss(t.path),i=IDBKeyRange.bound([r],[yS(r)],!1,!0);let a=0;return Ra(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,h],m,v)=>{0!==l&&(a++,v.done())}).next(()=>a>0)}se(e,t){return ho(e).get(t).next(r=>r?Zc(r):null)}}function ho(n){return ii(n,"targets")}function U0(n){return ii(n,"targetGlobal")}function Ra(n){return ii(n,"targetDocuments")}function S_([n,e],[t,r]){const i=Ot(n,t);return 0===i?Ot(e,r):i}class iA{constructor(e){this.xn=e,this.buffer=new bn(S_),this.Nn=0}kn(){return++this.Nn}Mn(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();S_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class B0{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.On=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return null!==this.On}Fn(e){var t=this;Be("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Ee.Z)(function*(){t.On=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Dl(r)?Be("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield bl(r)}yield t.Fn(3e5)}))}}class j0{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return he.resolve(rs.at);const r=new iA(t);return this.$n.forEachTarget(e,i=>r.Mn(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.Mn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Be("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(lb)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Be("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lb):this.Un(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,t){let r,i,a,l,h,m,v;const D=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(Be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),i=this.params.maximumSequenceNumbersToCollect):i=S,l=Date.now(),this.nthSequenceNumber(e,i))).next(S=>(r=S,h=Date.now(),this.removeTargets(e,r,t))).next(S=>(a=S,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(S=>(v=Date.now(),t0()<=ko.in.DEBUG&&Be("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-D}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(m-h)+`ms\n\tRemoved ${S} documents in `+(v-m)+`ms\nTotal Duration: ${v-D}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:S})))}}class A_{constructor(e,t){this.db=e,this.garbageCollector=new j0(this,t)}Bn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}qn(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return H0(e,r)}removeReference(e,t,r){return H0(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return H0(e,t)}Gn(e,t){return function(r,i){let a=!1;return cb(r).tt(l=>rA(r,l,i).next(h=>(h&&(a=!0),he.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,h)=>{if(h<=t){const m=this.Gn(e,l).next(v=>{if(!v)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,At.min()),Ra(e).delete([0,ss(l.path)])))});i.push(m)}}).next(()=>he.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return H0(e,t)}Kn(e,t){const r=Ra(e);let i,a=rs.at;return r.Z({index:"documentTargetsIndex"},([l,h],{path:m,sequenceNumber:v})=>{0===l?(a!==rs.at&&t(new Ke(Ho(i)),a),a=v,i=m):a=rs.at}).next(()=>{a!==rs.at&&t(new Ke(Ho(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function H0(n,e){return Ra(n).put((r=n.currentSequenceNumber,{targetId:0,path:ss(e.path),sequenceNumber:r}));var r}class sA{constructor(){this.changes=new Tu(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?he.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class hN{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Qc(e).put(r)}removeEntry(e,t,r){return Qc(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Lp(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=Nn.newInvalidDocument(t);return Qc(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Hp(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:Nn.newInvalidDocument(t)};return Qc(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Hp(t))},(i,a)=>{r={document:this.jn(t,a),size:L0(a)}}).next(()=>r)}getEntries(e,t){let r=is();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=is(),i=new fr(Ke.comparator);return this.zn(e,t,(a,l)=>{const h=this.jn(a,l);r=r.insert(a,h),i=i.insert(a,L0(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return he.resolve();let i=new bn($0);t.forEach(m=>i=i.add(m));const a=IDBKeyRange.bound(Hp(i.first()),Hp(i.last())),l=i.getIterator();let h=l.getNext();return Qc(e).Z({index:"documentKeyIndex",range:a},(m,v,D)=>{const S=Ke.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&$0(h,S)<0;)r(h,null),h=l.getNext();h&&h.isEqual(S)&&(r(h,v),h=l.hasNext()?l.getNext():null),h?D.j(Hp(h)):D.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),Lp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qc(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=is();for(const m of l){const v=this.jn(Ke.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);h=h.insert(v.key,v)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=is();const l=pb(t,r),h=pb(t,Ns.max());return Qc(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(m,v,D)=>{const S=this.jn(Ke.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(S.key,S),a.size===i&&D.done()}).next(()=>a)}newChangeBuffer(e){return new hb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return fb(e).get("remoteDocumentGlobalKey").next(t=>(St(!!t),t))}Qn(e,t){return fb(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function tb(n,e){let t;if(e.document)t=WC(n.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ke.fromSegments(e.noDocument.path),i=Wc(e.noDocument.readTime);t=Nn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return lt();{const r=Ke.fromSegments(e.unknownDocument.path),i=Wc(e.unknownDocument.version);t=Nn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new tr(r[0],r[1]);return At.fromTimestamp(i)}(e.readTime)),t}(this.It,t);if(!r.isNoDocument()||!r.version.isEqual(At.min()))return r}return Nn.newInvalidDocument(e)}}function oA(n){return new hN(n)}class hb extends sA{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new Tu(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new bn((a,l)=>Ot(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const m=nb(this.Yn.It,l);i=i.add(a.path.popLast()),r+=L0(m)-h.size,t.push(this.Yn.addEntry(e,a,m))}else if(r-=h.size,this.trackRemovals){const m=nb(this.Yn.It,l.convertToNoDocument(At.min()));t.push(this.Yn.addEntry(e,a,m))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),he.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function fb(n){return ii(n,"remoteDocumentGlobal")}function Qc(n){return ii(n,"remoteDocumentsV14")}function Hp(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pb(n,e){const t=e.documentKey.path.toArray();return[n,Lp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function $0(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Ot(t[a],r[a]),i)return i;return i=Ot(t.length,r.length),i||(i=Ot(t[t.length-2],r[r.length-2]),i||Ot(t[t.length-1],r[r.length-1]))}class gb{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class G0{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&$c(r.mutation,i,Ps.empty(),tr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,jt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=jt()){const i=Hi();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=Dp();return a.forEach((h,m)=>{l=l.insert(h,m.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=Hi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,jt()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=is();const l=Tp(),h=Tp();return t.forEach((m,v)=>{const D=r.get(v.key);i.has(v.key)&&(void 0===D||D.mutation instanceof Du)?a=a.insert(v.key,v):void 0!==D&&(l.set(v.key,D.mutation.getFieldMask()),$c(D.mutation,v,D.mutation.getFieldMask(),tr.now()))}),this.recalculateAndSaveOverlays(e,a).next(m=>(m.forEach((v,D)=>l.set(v,D)),t.forEach((v,D)=>{var S;return h.set(v,new gb(D,null!==(S=l.get(v))&&void 0!==S?S:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Tp();let i=new fr((l,h)=>l-h),a=jt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(m=>{const v=t.get(m);if(null===v)return;let D=r.get(m)||Ps.empty();D=h.applyToLocalView(v,D),r.set(m,D);const S=(i.get(h.batchId)||jt()).add(m);i=i.insert(h.batchId,S)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),v=m.key,D=m.value,S=$C();D.forEach(N=>{if(!a.has(N)){const V=NS(t.get(N),r.get(N));null!==V&&S.set(N,V),a=a.add(N)}}),l.push(this.documentOverlayCache.saveOverlays(e,v,S))}return he.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return Ke.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):o_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):he.resolve(Hi());let h=-1,m=a;return l.next(v=>he.forEach(v,(D,S)=>(h<S.largestBatchId&&(h=S.largestBatchId),a.get(D)?he.resolve():this.getBaseDocument(e,D,S).next(N=>{m=m.insert(D,N)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,m,v,jt())).next(D=>({batchId:h,changes:Ti(D)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ke(t)).next(r=>{let i=Dp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=Dp();return this.indexManager.getCollectionParents(e,i).next(l=>he.forEach(l,h=>{const m=(v=t,D=h.child(i),new Cu(D,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,D;return this.getDocumentsMatchingCollectionQuery(e,m,r).next(v=>{v.forEach((D,S)=>{a=a.insert(D,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,m)=>{const v=m.getKey();null===i.get(v)&&(i=i.insert(v,Nn.newInvalidDocument(v)))});let l=Dp();return i.forEach((h,m)=>{const v=a.get(h);void 0!==v&&$c(v.mutation,m,Ps.empty(),tr.now()),m0(t,m)&&(l=l.insert(h,m))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):he.resolve(Nn.newInvalidDocument(t))}}class aA{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return he.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:Pr(r.createTime)}),he.resolve()}getNamedQuery(e,t){return he.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:E_(r.bundledQuery),readTime:Pr(r.readTime)}),he.resolve();var r}}class uA{constructor(){this.overlays=new fr(Ke.comparator),this.es=new Map}getOverlay(e,t){return he.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Hi();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ue(e,t,a)}),he.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),he.resolve()}getOverlaysForCollection(e,t,r){const i=Hi(),a=t.length+1,l=new Ke(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const m=h.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return he.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new fr((v,D)=>v-D);const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let D=a.get(v.largestBatchId);null===D&&(D=Hi(),a=a.insert(v.largestBatchId,D)),D.set(v.getKey(),v)}}const h=Hi(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((v,D)=>h.set(v,D)),!(h.size()>=i)););return he.resolve(h)}ue(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new O0(t,r));let a=this.es.get(t);void 0===a&&(a=jt(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class x_{constructor(){this.ns=new bn(Or.ss),this.rs=new bn(Or.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new Or(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new Or(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new Ke(new ln([])),r=new Or(t,e),i=new Or(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new Ke(new ln([])),r=new Or(t,e),i=new Or(t,e+1);let a=jt();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Or(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Or{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return Ke.comparator(e.key,t.key)||Ot(e._s,t._s)}static os(e,t){return Ot(e._s,t._s)||Ke.comparator(e.key,t.key)}}class fN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new bn(Or.ss)}checkEmpty(e){return he.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new Fp(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.gs=this.gs.add(new Or(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return he.resolve(l)}lookupMutationBatch(e,t){return he.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return he.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Or(t,0),i=new Or(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const h=this.ys(l._s);a.push(h)}),he.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new bn(Ot);return t.forEach(i=>{const a=new Or(i,0),l=new Or(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],h=>{r=r.add(h._s)})}),he.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Ke.isDocumentKey(a)||(a=a.child(""));const l=new Or(new Ke(a),0);let h=new bn(Ot);return this.gs.forEachWhile(m=>{const v=m.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(m._s)),!0)},l),he.resolve(this.Is(h))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){St(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return he.forEach(t.mutations,i=>{const a=new Or(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new Or(t,0),i=this.gs.firstAfterOrEqual(r);return he.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return he.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class mb{constructor(e){this.Es=e,this.docs=new fr(Ke.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return he.resolve(r?r.document.mutableCopy():Nn.newInvalidDocument(t))}getEntries(e,t){let r=is();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Nn.newInvalidDocument(i))}),he.resolve(r)}getAllFromCollection(e,t,r){let i=is();const a=new Ke(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:m}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||Km(Pc(m),r)<=0||(i=i.insert(m.key,m.mutableCopy()))}return he.resolve(i)}getAllFromCollectionGroup(e,t,r,i){lt()}As(e,t){return he.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new q0(this)}getSize(e){return he.resolve(this.size)}}class q0 extends sA{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),he.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class lA{constructor(e){this.persistence=e,this.Rs=new Tu(t=>Iu(t),r_),this.lastRemoteSnapshotVersion=At.min(),this.highestTargetId=0,this.bs=0,this.Ps=new x_,this.targetCount=0,this.vs=Yc.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),he.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Yc(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,he.resolve()}updateTargetData(e,t){return this.Dn(t),he.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),he.waitFor(a).next(()=>i)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return he.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),he.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),he.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),he.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return he.resolve(r)}containsKey(e,t){return he.resolve(this.Ps.containsKey(t))}}class _b{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new rs(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new lA(this),this.indexManager=new ab,this.remoteDocumentCache=new mb(r=>this.referenceDelegate.xs(r)),this.It=new k0(t),this.Ns=new aA(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new fN(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){Be("MemoryPersistence","Starting transaction:",e);const i=new pN(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Ms(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Os(e,t){return he.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class pN extends o0{constructor(e){super(),this.currentSequenceNumber=e}}class W0{constructor(e){this.persistence=e,this.Fs=new x_,this.$s=null}static Bs(e){return new W0(e)}get Ls(){if(this.$s)return this.$s;throw lt()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),he.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),he.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),he.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Ms(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.Ls,r=>{const i=Ke.fromPath(r);return this.Us(e,i).next(a=>{a||t.removeEntry(i,At.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return he.or([()=>he.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Os(e,t)])}}class cA{constructor(e){this.It=e}$(e,t,r,i){const a=new Rh("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v_,{unique:!0}),h.createObjectStore("documentMutations"),yb(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=he.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),yb(e)),l=l.next(()=>function(h){const m=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:At.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,m){return m.store("mutations").W().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v_,{unique:!0});const D=m.store("mutations"),S=v.map(N=>D.put(N));return he.waitFor(S)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.qs(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const m=h.createObjectStore("documentOverlays",{keyPath:lN});m.createIndex("collectionPathOverlayIndex",WS,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",zS,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:M0});m.createIndex("documentKeyIndex",QC),m.createIndex("collectionGroupIndex",HS)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:N0}).createIndex("sequenceNumberIndex",qS,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:aN}).createIndex("documentKeyIndex",uN,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=L0(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>he.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(h=>he.forEach(h,m=>{St(m.userId===a.userId);const v=zc(this.It,m);return nA(e,a.userId,v).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,h)=>{const m=new ln(l),v=[0,ss(m)];a.push(t.get(v).next(D=>D?he.resolve():t.put({targetId:0,path:ss(m),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>he.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:GS});const r=t.store("collectionParents"),i=new b_,a=l=>{if(i.add(l)){const h=l.lastSegment(),m=l.popLast();return r.put({collectionId:h,parent:ss(m)})}};return t.store("remoteDocuments").Z({X:!0},(l,h)=>{const m=new ln(l);return a(m.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,h,m],v)=>{const D=Ho(h);return a(D.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=Zc(i),l=Ml(this.It,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const h=t.store("remoteDocumentsV14"),m=(v=l,v.document?new Ke(ln.fromString(v.document.name).popFirst(5)):v.noDocument?Ke.fromSegments(v.noDocument.path):v.unknownDocument?Ke.fromSegments(v.unknownDocument.path):lt()).path.toArray();var v;const D={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(D))}).next(()=>he.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=oA(this.It),a=new _b(W0.Bs,this.It.re);return r.W().next(l=>{const h=new Map;return l.forEach(m=>{var v;let D=null!==(v=h.get(m.userId))&&void 0!==v?v:jt();zc(this.It,m).keys().forEach(S=>D=D.add(S)),h.set(m.userId,D)}),he.forEach(h,(m,v)=>{const D=new qr(v),S=Vp.oe(this.It,D),N=a.getIndexManager(D),V=V0.oe(D,this.It,N,a.referenceDelegate);return new G0(i,V,S,N).recalculateAndSaveOverlaysForDocumentKeys(new Os(t,rs.at),m).next()})})}}function yb(n){n.createObjectStore("targetDocuments",{keyPath:oN}).createIndex("documentTargetsIndex",$S,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",JC,{unique:!0}),n.createObjectStore("targetGlobal")}const vb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class wb{constructor(e,t,r,i,a,l,h,m,v,D,S=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=h,this.Js=v,this.Ys=D,this.Xs=S,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=N=>Promise.resolve(),!wb.C())throw new Le(pe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new A_(this,i),this.ii=t+"main",this.It=new k0(m),this.ri=new Uo(this.ii,this.Xs,new cA(this.It)),this.Cs=new db(this.referenceDelegate,this.It),this.remoteDocumentCache=oA(this.It),this.Ns=new YS,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===D&&jn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Le(pe.FAILED_PRECONDITION,vb);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new rs(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,Ee.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,Ee.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,Ee.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>z0(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Dl(e))return Be("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Be("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return R_(e).get("owner").next(t=>he.resolve(this.mi(t)))}gi(e){return z0(e).delete(this.clientId)}yi(){var e=this;return(0,Ee.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=ii(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),h=a.filter(m=>-1===l.indexOf(m));return he.forEach(h,m=>i.delete(m.clientId)).next(()=>h)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?he.resolve(!0):R_(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new Le(pe.FAILED_PRECONDITION,vb);return!1}}return!(!this.networkEnabled||!this.inForeground)||z0(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Be("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Ee.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Os(t,rs.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>z0(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return V0.oe(e,this.It,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eA(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return Vp.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){Be("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?ZS:14===l?w_:13===l?eb:12===l?cN:11===l?XC:void lt();var l;let h;return this.ri.runTransaction(e,i,a,m=>(h=new Os(m,this.Ss?this.Ss.next():rs.at),"readwrite-primary"===t?this.fi(h).next(v=>!!v||this.di(h)).next(v=>{if(!v)throw jn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Le(pe.FAILED_PRECONDITION,aC);return r(h)}).next(v=>this.wi(h).next(()=>v)):this.Vi(h).next(()=>r(h)))).then(m=>(h.raiseOnCommittedEvent(),m))}Vi(e){return R_(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Le(pe.FAILED_PRECONDITION,vb)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return R_(e).put("owner",t)}static C(){return Uo.C()}_i(e){const t=R_(e);return t.get("owner").next(r=>this.mi(r)?(Be("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):he.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(jn(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,O.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Be("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return jn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){jn("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function R_(n){return ii(n,"owner")}function z0(n){return ii(n,"clientMetadata")}function Eb(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Z0{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=jt(),i=jt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Z0(e,t.fromCache,r,i)}}class dA{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Mi(e,t,i,r)).next(a=>a||this.Oi(e,t))}ki(e,t){if(TC(t))return he.resolve(null);let r=ji(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Ip(t,null,"F"),r=ji(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=jt(...a);return this.Ni.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(m=>{const v=this.Fi(t,h);return this.$i(t,v,l,m.readTime)?this.ki(e,Ip(t,null,"F")):this.Bi(e,v,t,m)}))})))}Mi(e,t,r,i){return TC(t)||i.isEqual(At.min())?this.Oi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Oi(e,t):(t0()<=ko.in.DEBUG&&Be("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),g0(t)),this.Bi(e,l,t,oC(i,-1)))})}Fi(e,t){let r=new bn(xC(e));return t.forEach((i,a)=>{m0(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Oi(e,t){return t0()<=ko.in.DEBUG&&Be("QueryEngine","Using full collection scan to execute query:",g0(t)),this.Ni.getDocumentsMatchingQuery(e,t,Ns.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class gN{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new fr(Ot),this.qi=new Tu(a=>Iu(a),r_),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new G0(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function hA(n,e,t,r){return new gN(n,e,t,r)}function fA(n,e){return s.apply(this,arguments)}function s(){return s=(0,Ee.Z)(function*(n,e){const t=et(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let m=jt();for(const v of i){l.push(v.batchId);for(const D of v.mutations)m=m.add(D.key)}for(const v of a){h.push(v.batchId);for(const D of v.mutations)m=m.add(D.key)}return t.localDocuments.getDocuments(r,m).next(v=>({ji:v,removedBatchIds:l,addedBatchIds:h}))})})}),s.apply(this,arguments)}function o(n,e){const t=et(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,h,m,v){const D=m.batch,S=D.keys();let N=he.resolve();return S.forEach(V=>{N=N.next(()=>v.getEntry(h,V)).next(W=>{const fe=m.docVersions.get(V);St(null!==fe),W.version.compareTo(fe)<0&&(D.applyToRemoteDocument(W,m),W.isValidDocument()&&(W.setReadTime(m.commitVersion),v.addEntry(W)))})}),N.next(()=>l.mutationQueue.removeMutationBatch(h,D))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=jt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(h=h.add(l.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function u(n){const e=et(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function c(n,e){const t=et(n),r=e.snapshotVersion;let i=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.Ui;const h=[];e.targetChanges.forEach((D,S)=>{const N=i.get(S);if(!N)return;h.push(t.Cs.removeMatchingKeys(a,D.removedDocuments,S).next(()=>t.Cs.addMatchingKeys(a,D.addedDocuments,S)));let V=N.withSequenceNumber(a.currentSequenceNumber);var W,fe,Ae;e.targetMismatches.has(S)?V=V.withResumeToken(Wr.EMPTY_BYTE_STRING,At.min()).withLastLimboFreeSnapshotVersion(At.min()):D.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(D.resumeToken,r)),i=i.insert(S,V),fe=V,Ae=D,(0===(W=N).resumeToken.approximateByteSize()||fe.snapshotVersion.toMicroseconds()-W.snapshotVersion.toMicroseconds()>=3e8||Ae.addedDocuments.size+Ae.modifiedDocuments.size+Ae.removedDocuments.size>0)&&h.push(t.Cs.updateTargetData(a,V))});let m=is(),v=jt();if(e.documentUpdates.forEach(D=>{e.resolvedLimboDocuments.has(D)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,D))}),h.push(d(a,l,e.documentUpdates).next(D=>{m=D.Wi,v=D.zi})),!r.isEqual(At.min())){const D=t.Cs.getLastRemoteSnapshotVersion(a).next(S=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(D)}return he.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,m,v)).next(()=>m)}).then(a=>(t.Ui=i,a))}function d(n,e,t){let r=jt(),i=jt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=is();return t.forEach((h,m)=>{const v=a.get(h);m.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),m.isNoDocument()&&m.version.isEqual(At.min())?(e.removeEntry(h,m.readTime),l=l.insert(h,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||0===m.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(m),l=l.insert(h,m)):Be("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",m.version)}),{Wi:l,zi:i}})}function p(n,e){const t=et(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function y(n,e){const t=et(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,he.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new xa(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ui.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function E(n,e,t){return C.apply(this,arguments)}function C(){return C=(0,Ee.Z)(function*(n,e,t){const r=et(n),i=r.Ui.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Dl(l))throw l;Be("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}),C.apply(this,arguments)}function A(n,e,t){const r=et(n);let i=At.min(),a=jt();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,m,v){const D=et(h),S=D.qi.get(v);return void 0!==S?he.resolve(D.Ui.get(S)):D.Cs.getTargetData(m,v)}(r,l,ji(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,h.targetId).next(m=>{a=m})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:At.min(),t?a:jt())).next(h=>(K(r,AC(e),h),{documents:h,Hi:a})))}function M(n,e){const t=et(n),r=et(t.Cs),i=t.Ui.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.se(a,e).next(l=>l?l.target:null))}function L(n,e){const t=et(n),r=t.Ki.get(e)||At.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,oC(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(K(t,e,i),i))}function K(n,e,t){let r=At.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function Ie(){return Ie=(0,Ee.Z)(function*(n,e,t,r){const i=et(n);let a=jt(),l=is();for(const v of t){const D=e.Ji(v.metadata.name);v.document&&(a=a.add(D));const S=e.Yi(v);S.setReadTime(e.Xi(v.metadata.readTime)),l=l.insert(D,S)}const h=i.Gi.newChangeBuffer({trackRemovals:!0}),m=yield y(i,(v=r,ji(Lh(ln.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>d(v,h,l).next(D=>(h.apply(v),D)).next(D=>i.Cs.removeMatchingKeysForTargetId(v,m.targetId).next(()=>i.Cs.addMatchingKeys(v,a,m.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,D.Wi,D.zi)).next(()=>D.Wi)))}),Ie.apply(this,arguments)}function He(n,e){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,Ee.Z)(function*(n,e,t=jt()){const r=yield y(n,ji(E_(e.bundledQuery))),i=et(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=Pr(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const h=r.withResumeToken(Wr.EMPTY_BYTE_STRING,l);return i.Ui=i.Ui.insert(h.targetId,h),i.Cs.updateTargetData(a,h).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),Qe.apply(this,arguments)}function st(n,e){return`firestore_clients_${n}_${e}`}function Oe(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function It(n,e){return`firestore_targets_${n}_${e}`}class Kt{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Le(i.error.code,i.error.message))),l?new Kt(e,t,i.state,a):(jn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cn{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Le(r.error.code,r.error.message))),a?new cn(e,r.state,i):(jn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Si{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=d_();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=fC(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new Si(e,a):(jn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ru{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Ru(t.clientId,t.onlineState):(jn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $p{constructor(){this.activeTargetIds=d_()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gp{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new fr(Ot),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=st(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new $p),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(st(e.persistenceKey,i));if(a){const l=Si.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(It(this.persistenceKey,e));if(r){const i=cn.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(It(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Be("SharedClientState","READ",e,t),t}setItem(e,t){Be("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Be("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Be("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void jn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,Ee.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=rs.at;if(null!=a)try{const h=JSON.parse(a);St("number"==typeof h),l=h}catch(h){jn("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==rs.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Mr(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Or(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new Kt(this.currentUser,e,t,r),a=Oe(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=Oe(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=It(this.persistenceKey,e),a=new cn(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return Si.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return Kt.Zi(new qr(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return cn.Zi(i,t)}yr(e){return Ru.Zi(e)}Mr(e){return JSON.parse(e)}Cr(e){var t=this;return(0,Ee.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);Be("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],h=[];return a.forEach(m=>{i.has(m)||l.push(m)}),i.forEach(m=>{a.has(m)||h.push(m)}),this.syncEngine.Br(l,h).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=d_();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class M_{constructor(){this.Lr=new $p,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new $p,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class K0{qr(e){}shutdown(){}}class N_{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){Be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Y0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Q0{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class J0 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(e,t,r,i,a){const l=this.ao(e,t);Be("RestConnection","Sending: ",l,r);const h={};return this.ho(h,i,a),this.lo(e,l,h,r).then(m=>(Be("RestConnection","Received: ",m),m),m=>{throw Mc("RestConnection",`${e} failed with error: `,m,"url: ",l,"request:",r),m})}fo(e,t,r,i,a,l){return this.co(e,t,r,i,a)}ho(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Rc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ao(e,t){return`${this.oo}/v1/${t}:${Y0[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,t,r,i){return new Promise((a,l)=>{const h=new cS;h.listenOnce(qm.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ah.NO_ERROR:const v=h.getResponseJson();Be("Connection","XHR received:",JSON.stringify(v)),a(v);break;case Ah.TIMEOUT:Be("Connection",'RPC "'+e+'" timed out'),l(new Le(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Ah.HTTP_ERROR:const D=h.getStatus();if(Be("Connection",'RPC "'+e+'" failed with status:',D,"response text:",h.getResponseText()),D>0){const S=h.getResponseJson().error;if(S&&S.status&&S.message){const N=function(V){const W=V.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(W)>=0?W:pe.UNKNOWN}(S.status);l(new Le(N,S.message))}else l(new Le(pe.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Le(pe.UNAVAILABLE,"Connection failed."));break;default:lt()}}finally{Be("Connection",'RPC "'+e+'" completed.')}});const m=JSON.stringify(i);h.send(t,"POST",m,r,15)})}_o(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Gm(),l=uS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new eC({})),this.ho(h.initMessageHeaders,t,r),(0,O.uI)()||(0,O.b$)()||(0,O.d)()||(0,O.w1)()||(0,O.Mn)()||(0,O.ru)()||(h.httpHeadersOverwriteParam="$httpHeaders");const m=i.join("");Be("Connection","Creating WebChannel: "+m,h);const v=a.createWebChannel(m,h);let D=!1,S=!1;const N=new Q0({Hr:W=>{S?Be("Connection","Not sending because WebChannel is closed:",W):(D||(Be("Connection","Opening WebChannel transport."),v.open(),D=!0),Be("Connection","WebChannel sending:",W),v.send(W))},Jr:()=>v.close()}),V=(W,fe,Ae)=>{W.listen(fe,at=>{try{Ae(at)}catch(ft){setTimeout(()=>{throw ft},0)}})};return V(v,Wm.EventType.OPEN,()=>{S||Be("Connection","WebChannel transport opened.")}),V(v,Wm.EventType.CLOSE,()=>{S||(S=!0,Be("Connection","WebChannel transport closed"),N.io())}),V(v,Wm.EventType.ERROR,W=>{S||(S=!0,Mc("Connection","WebChannel transport errored:",W),N.io(new Le(pe.UNAVAILABLE,"The operation could not be completed")))}),V(v,Wm.EventType.MESSAGE,W=>{var fe;if(!S){const Ae=W.data[0];St(!!Ae);const at=Ae,ft=at.error||(null===(fe=at[0])||void 0===fe?void 0:fe.error);if(ft){Be("Connection","WebChannel received error:",ft);const pt=ft.status;let dt=function(Ft){const Tr=Nr[Ft];if(void 0!==Tr)return jC(Tr)}(pt),Rt=ft.message;void 0===dt&&(dt=pe.INTERNAL,Rt="Unknown error status: "+pt+" with message "+ft.message),S=!0,N.io(new Le(dt,Rt)),v.close()}else Be("Connection","WebChannel received:",Ae),N.ro(Ae)}}),V(l,dr.STAT_EVENT,W=>{W.stat===lS.PROXY?Be("Connection","Detected buffering proxy"):W.stat===lS.NOPROXY&&Be("Connection","Detected no buffering proxy")}),setTimeout(()=>{N.so()},0),N}}function P_(){return"undefined"!=typeof window?window:null}function Ib(){return"undefined"!=typeof document?document:null}function X0(n){return new qC(n,!0)}class pA{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.wo=r,this.mo=i,this.yo=a,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const t=Math.floor(this.po+this.Ro()),r=Math.max(0,Date.now()-this.To),i=Math.max(0,t-r);i>0&&Be("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.po} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Io=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}bo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class mN{constructor(e,t,r,i,a,l,h,m){this.Hs=e,this.Po=r,this.vo=i,this.Vo=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new pA(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}stop(){var e=this;return(0,Ee.Z)(function*(){e.No()&&(yield e.close(0))})()}Oo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,Ee.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return(0,Ee.Z)(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(jn(t.toString()),jn("Using maximum backoff delay to prevent overloading the backend."),r.xo.Eo()):t&&t.code===pe.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.So===t&&this.Go(r,i)},r=>{e(()=>{const i=new Le(pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(i)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.Qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Mo(){var e=this;this.state=5,this.xo.Ao((0,Ee.Z)(function*(){e.state=0,e.start()}))}Qo(e){return Be("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(Be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wF extends mN{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.It=a}jo(e,t){return this.Vo._o("Listen",e,t)}onMessage(e){this.xo.reset();const t=function zC(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:lt(),i=e.targetChange.targetIds||[],a=function(m,v){return m.gt?(St(void 0===v||"string"==typeof v),Wr.fromBase64String(v||"")):(St(void 0===v||v instanceof Uint8Array),Wr.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const v=void 0===m.code?pe.UNKNOWN:jC(m.code);return new Le(v,m.message||"")}(l);t=new I0(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Aa(n,r.document.name),a=Pr(r.document.updateTime),l=new _i({mapValue:{fields:r.document.fields}}),h=Nn.newFoundDocument(i,a,l);t=new h_(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=Aa(n,r.document),a=r.readTime?Pr(r.readTime):At.min(),l=Nn.newNoDocument(i,a);t=new h_([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Aa(n,r.document);t=new h_([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return lt();{const r=e.filter,a=new BC(r.count||0);t=new f_(r.targetId,a)}}var m;return t}(this.It,e),r=function(i){if(!("targetChange"in i))return At.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?At.min():a.readTime?Pr(a.readTime):At.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=Mp(this.It),t.addTarget=function(i,a){let l;const h=a.target;return l=i_(h)?{documents:A0(i,h)}:{query:x0(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=b0(i,a.resumeToken):a.snapshotVersion.compareTo(At.min())>0&&(l.readTime=Rl(i,a.snapshotVersion.toTimestamp())),l}(this.It,e);const r=function VS(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return lt()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=Mp(this.It),t.removeTarget=e,this.Bo(t)}}class EF extends mN{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.It=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.Vo._o("Write",e,t)}onMessage(e){if(St(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function ZC(n,e){return n&&n.length>0?(St(void 0!==e),n.map(t=>function(r,i){let a=Pr(r.updateTime?r.updateTime:i);return a.isEqual(At.min())&&(a=Pr(i)),new _0(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Pr(e.commitTime);return this.listener.Zo(r,t)}return St(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Mp(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Np(this.It,r))};this.Bo(t)}}class IF extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.Vo=r,this.It=i,this.nu=!1}su(){if(this.nu)throw new Le(pe.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.Vo.co(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Le(pe.UNKNOWN,i.toString())})}fo(e,t,r,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.Vo.fo(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Le(pe.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class CF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(jn(t),this.ou=!1):Be("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class bF{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.qr(h=>{r.enqueueAndForget((0,Ee.Z)(function*(){var m;Gh(l)&&(Be("RemoteStore","Restarting streams for network reachability change."),yield(m=(0,Ee.Z)(function*(v){const D=et(v);D._u.add(4),yield O_(D),D.gu.set("Unknown"),D._u.delete(4),yield ew(D)}),function(v){return m.apply(this,arguments)})(l))}))}),this.gu=new CF(r,i)}}function ew(n){return gA.apply(this,arguments)}function gA(){return gA=(0,Ee.Z)(function*(n){if(Gh(n))for(const e of n.wu)yield e(!0)}),gA.apply(this,arguments)}function O_(n){return mA.apply(this,arguments)}function mA(){return mA=(0,Ee.Z)(function*(n){for(const e of n.wu)yield e(!1)}),mA.apply(this,arguments)}function Cb(n,e){const t=et(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),vA(t)?yA(t):F_(t).ko()&&_A(t,e))}function tw(n,e){const t=et(n),r=F_(t);t.du.delete(e),r.ko()&&_N(t,e),0===t.du.size&&(r.ko()?r.Fo():Gh(t)&&t.gu.set("Unknown"))}function _A(n,e){n.yu.Ot(e.targetId),F_(n).zo(e)}function _N(n,e){n.yu.Ot(e),F_(n).Ho(e)}function yA(n){n.yu=new p_({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n.du.get(e)||null}),F_(n).start(),n.gu.uu()}function vA(n){return Gh(n)&&!F_(n).No()&&n.du.size>0}function Gh(n){return 0===et(n)._u.size}function yN(n){n.yu=void 0}function DF(n){return wA.apply(this,arguments)}function wA(){return wA=(0,Ee.Z)(function*(n){n.du.forEach((e,t)=>{_A(n,e)})}),wA.apply(this,arguments)}function TF(n,e){return EA.apply(this,arguments)}function EA(){return EA=(0,Ee.Z)(function*(n,e){yN(n),vA(n)?(n.gu.hu(e),yA(n)):n.gu.set("Unknown")}),EA.apply(this,arguments)}function SF(n,e,t){return IA.apply(this,arguments)}function IA(){return IA=(0,Ee.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof I0&&2===e.state&&e.cause)try{yield(r=(0,Ee.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i.du.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i.du.delete(h),i.yu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){Be("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield bb(n,r)}else if(e instanceof h_?n.yu.Gt(e):e instanceof f_?n.yu.Yt(e):n.yu.Wt(e),!t.isEqual(At.min()))try{const r=yield u(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.yu.te(a);return l.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const v=i.du.get(m);v&&i.du.set(m,v.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const m=i.du.get(h);if(!m)return;i.du.set(h,m.withResumeToken(Wr.EMPTY_BYTE_STRING,m.snapshotVersion)),_N(i,h);const v=new xa(m.target,h,1,m.sequenceNumber);_A(i,v)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){Be("RemoteStore","Failed to raise snapshot:",r),yield bb(n,r)}var r}),IA.apply(this,arguments)}function bb(n,e,t){return CA.apply(this,arguments)}function CA(){return CA=(0,Ee.Z)(function*(n,e,t){if(!Dl(e))throw e;n._u.add(1),yield O_(n),n.gu.set("Offline"),t||(t=()=>u(n.localStore)),n.asyncQueue.enqueueRetryable((0,Ee.Z)(function*(){Be("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield ew(n)}))}),CA.apply(this,arguments)}function vN(n,e){return e().catch(t=>bb(n,t,e))}function k_(n){return bA.apply(this,arguments)}function bA(){return bA=(0,Ee.Z)(function*(n){const e=et(n),t=qh(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;AF(e);)try{const i=yield p(e.localStore,r);if(null===i){0===e.fu.length&&t.Fo();break}r=i.batchId,xF(e,i)}catch(i){yield bb(e,i)}wN(e)&&EN(e)}),bA.apply(this,arguments)}function AF(n){return Gh(n)&&n.fu.length<10}function xF(n,e){n.fu.push(e);const t=qh(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function wN(n){return Gh(n)&&!qh(n).No()&&n.fu.length>0}function EN(n){qh(n).start()}function RF(n){return DA.apply(this,arguments)}function DA(){return DA=(0,Ee.Z)(function*(n){qh(n).eu()}),DA.apply(this,arguments)}function MF(n){return TA.apply(this,arguments)}function TA(){return TA=(0,Ee.Z)(function*(n){const e=qh(n);for(const t of n.fu)e.Xo(t.mutations)}),TA.apply(this,arguments)}function NF(n,e,t){return SA.apply(this,arguments)}function SA(){return SA=(0,Ee.Z)(function*(n,e,t){const r=n.fu.shift(),i=P0.from(r,e,t);yield vN(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield k_(n)}),SA.apply(this,arguments)}function PF(n,e){return AA.apply(this,arguments)}function AA(){return AA=(0,Ee.Z)(function*(n,e){var t;e&&qh(n).Yo&&(yield(t=(0,Ee.Z)(function*(r,i){if(v0(a=i.code)&&a!==pe.ABORTED){const l=r.fu.shift();qh(r).Oo(),yield vN(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield k_(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),wN(n)&&EN(n)}),AA.apply(this,arguments)}function IN(n,e){return xA.apply(this,arguments)}function xA(){return xA=(0,Ee.Z)(function*(n,e){const t=et(n);t.asyncQueue.verifyOperationInProgress(),Be("RemoteStore","RemoteStore received new credentials");const r=Gh(t);t._u.add(3),yield O_(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield ew(t)}),xA.apply(this,arguments)}function RA(n,e){return MA.apply(this,arguments)}function MA(){return MA=(0,Ee.Z)(function*(n,e){const t=et(n);e?(t._u.delete(2),yield ew(t)):e||(t._u.add(2),yield O_(t),t.gu.set("Unknown"))}),MA.apply(this,arguments)}function F_(n){return n.pu||(n.pu=function(e,t,r){const i=et(e);return i.su(),new wF(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:DF.bind(null,n),Zr:TF.bind(null,n),Wo:SF.bind(null,n)}),n.wu.push(function(){var e=(0,Ee.Z)(function*(t){t?(n.pu.Oo(),vA(n)?yA(n):n.gu.set("Unknown")):(yield n.pu.stop(),yN(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function qh(n){return n.Iu||(n.Iu=function(e,t,r){const i=et(e);return i.su(),new EF(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:RF.bind(null,n),Zr:PF.bind(null,n),tu:MF.bind(null,n),Zo:NF.bind(null,n)}),n.wu.push(function(){var e=(0,Ee.Z)(function*(t){t?(n.Iu.Oo(),yield k_(n)):(yield n.Iu.stop(),n.fu.length>0&&(Be("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class NA{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new NA(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Le(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function L_(n,e){if(jn("AsyncQueue",`${e}: ${n}`),Dl(n))return new Le(pe.UNAVAILABLE,`${e}: ${n}`);throw n}class V_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ke.comparator(t.key,r.key):(t,r)=>Ke.comparator(t.key,r.key),this.keyedMap=Dp(),this.sortedSet=new fr(this.comparator)}static emptySet(e){return new V_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof V_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new V_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class CN{constructor(){this.Tu=new fr(Ke.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):lt():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class U_{constructor(e,t,r,i,a,l,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=m}static fromInitialDocuments(e,t,r,i){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new U_(e,t,V_.emptySet(t),a,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class OF{constructor(){this.Au=void 0,this.listeners=[]}}class kF{constructor(){this.queries=new Tu(e=>SC(e),Vh),this.onlineState="Unknown",this.Ru=new Set}}function PA(n,e){return OA.apply(this,arguments)}function OA(){return OA=(0,Ee.Z)(function*(n,e){const t=et(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new OF),i)try{a.Au=yield t.onListen(r)}catch(l){const h=L_(l,`Initialization of query '${g0(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&LA(t)}),OA.apply(this,arguments)}function kA(n,e){return FA.apply(this,arguments)}function FA(){return FA=(0,Ee.Z)(function*(n,e){const t=et(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),FA.apply(this,arguments)}function FF(n,e){const t=et(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.Pu(i)&&(r=!0);l.Au=i}}r&&LA(t)}function LF(n,e,t){const r=et(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function LA(n){n.Ru.forEach(e=>{e.next()})}class VA{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new U_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||!(this.options.Nu&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=U_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Vu=!0,this.vu.next(e)}}class VF{constructor(e,t){this.payload=e,this.byteLength=t}ku(){return"metadata"in this.payload}}class bN{constructor(e){this.It=e}Ji(e){return Aa(this.It,e)}Yi(e){return e.metadata.exists?WC(this.It,e.document,!1):Nn.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return Pr(e)}}class UF{constructor(e,t,r){this.Mu=e,this.localStore=t,this.It=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=DN(e)}Ou(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=ln.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Fu(e){const t=new Map,r=new bN(this.It);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||jt()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,Ee.Z)(function*(){const t=yield function te(n,e,t,r){return Ie.apply(this,arguments)}(e.localStore,new bN(e.It),e.documents,e.Mu.id),r=e.Fu(e.documents);for(const i of e.queries)yield He(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,$u:e.collectionGroups,Bu:t}})()}}function DN(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class TN{constructor(e){this.key=e}}class SN{constructor(e){this.key=e}}class AN{constructor(e,t){this.query=e,this.Lu=t,this.Uu=null,this.current=!1,this.qu=jt(),this.mutatedKeys=jt(),this.Ku=xC(e),this.Gu=new V_(this.Ku)}get Qu(){return this.Lu}ju(e,t){const r=t?t.Wu:new CN,i=t?t.Gu:this.Gu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const m="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((D,S)=>{const N=i.get(D),V=m0(this.query,S)?S:null,W=!!N&&this.mutatedKeys.has(N.key),fe=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let Ae=!1;N&&V?N.data.isEqual(V.data)?W!==fe&&(r.track({type:3,doc:V}),Ae=!0):this.zu(N,V)||(r.track({type:2,doc:V}),Ae=!0,(m&&this.Ku(V,m)>0||v&&this.Ku(V,v)<0)&&(h=!0)):!N&&V?(r.track({type:0,doc:V}),Ae=!0):N&&!V&&(r.track({type:1,doc:N}),Ae=!0,(m||v)&&(h=!0)),Ae&&(V?(l=l.add(V),a=fe?a.add(D):a.delete(D)):(l=l.delete(D),a=a.delete(D)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const D="F"===this.query.limitType?l.last():l.first();l=l.delete(D.key),a=a.delete(D.key),r.track({type:1,doc:D})}return{Gu:l,Wu:r,$i:h,mutatedKeys:a}}zu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const a=e.Wu.Eu();a.sort((v,D)=>function(S,N){const V=W=>{switch(W){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt()}};return V(S)-V(N)}(v.type,D.type)||this.Ku(v.doc,D.doc)),this.Hu(r);const l=t?this.Ju():[],h=0===this.qu.size&&this.current?1:0,m=h!==this.Uu;return this.Uu=h,0!==a.length||m?{snapshot:new U_(this.query,e.Gu,i,a,e.mutatedKeys,0===h,m,!1),Yu:l}:{Yu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new CN,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}Xu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(t=>this.Lu=this.Lu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Lu=this.Lu.delete(t)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.qu;this.qu=jt(),this.Gu.forEach(r=>{this.Xu(r.key)&&(this.qu=this.qu.add(r.key))});const t=[];return e.forEach(r=>{this.qu.has(r)||t.push(new SN(r))}),this.qu.forEach(r=>{e.has(r)||t.push(new TN(r))}),t}Zu(e){this.Lu=e.Hi,this.qu=jt();const t=this.ju(e.documents);return this.applyChanges(t,!0)}tc(){return U_.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.Uu)}}class BF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class jF{constructor(e){this.key=e,this.ec=!1}}class HF{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.nc={},this.sc=new Tu(h=>SC(h),Vh),this.ic=new Map,this.rc=new Set,this.oc=new fr(Ke.comparator),this.uc=new Map,this.cc=new x_,this.ac={},this.hc=new Map,this.lc=Yc.vn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}function $F(n,e){return UA.apply(this,arguments)}function UA(){return UA=(0,Ee.Z)(function*(n,e){const t=ux(n);let r,i;const a=t.sc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.tc();else{const l=yield y(t.localStore,ji(e));t.isPrimaryClient&&Cb(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield BA(t,e,r,"current"===h)}return i}),UA.apply(this,arguments)}function BA(n,e,t,r){return jA.apply(this,arguments)}function jA(){return jA=(0,Ee.Z)(function*(n,e,t,r){n.dc=(D,S,N)=>{return(V=(0,Ee.Z)(function*(W,fe,Ae,at){let ft=fe.view.ju(Ae);ft.$i&&(ft=yield A(W.localStore,fe.query,!1).then(({documents:Rt})=>fe.view.ju(Rt,ft)));const pt=at&&at.targetChanges.get(fe.targetId),dt=fe.view.applyChanges(ft,W.isPrimaryClient,pt);return QA(W,fe.targetId,dt.Yu),dt.snapshot}),function(W,fe,Ae,at){return V.apply(this,arguments)})(n,D,S,N);var V};const i=yield A(n.localStore,e,!0),a=new AN(e,i.Hi),l=a.ju(i.documents),h=Ap.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),m=a.applyChanges(l,n.isPrimaryClient,h);QA(n,t,m.Yu);const v=new BF(e,t,a);return n.sc.set(e,v),n.ic.has(t)?n.ic.get(t).push(e):n.ic.set(t,[e]),m.snapshot}),jA.apply(this,arguments)}function GF(n,e){return HA.apply(this,arguments)}function HA(){return HA=(0,Ee.Z)(function*(n,e){const t=et(n),r=t.sc.get(e),i=t.ic.get(r.targetId);if(i.length>1)return t.ic.set(r.targetId,i.filter(a=>!Vh(a,e))),void t.sc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield E(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),tw(t.remoteStore,r.targetId),B_(t,r.targetId)}).catch(bl))):(B_(t,r.targetId),yield E(t.localStore,r.targetId,!0))}),HA.apply(this,arguments)}function $A(){return $A=(0,Ee.Z)(function*(n,e,t){const r=lx(n);try{const i=yield function(a,l){const h=et(a),m=tr.now(),v=l.reduce((N,V)=>N.add(V.key),jt());let D,S;return h.persistence.runTransaction("Locally write mutations","readwrite",N=>{let V=is(),W=jt();return h.Gi.getEntries(N,v).next(fe=>{V=fe,V.forEach((Ae,at)=>{at.isValidDocument()||(W=W.add(Ae))})}).next(()=>h.localDocuments.getOverlayedDocuments(N,V)).next(fe=>{D=fe;const Ae=[];for(const at of l){const ft=FC(at,D.get(at.key).overlayedDocument);null!=ft&&Ae.push(new Du(at.key,ft,d0(ft.value.mapValue),Hn.exists(!0)))}return h.mutationQueue.addMutationBatch(N,m,Ae,l)}).next(fe=>{S=fe;const Ae=fe.applyToLocalDocumentSet(D,W);return h.documentOverlayCache.saveOverlays(N,fe.batchId,Ae)})}).then(()=>({batchId:S.batchId,changes:Ti(D)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let m=a.ac[a.currentUser.toKey()];m||(m=new fr(Ot)),m=m.insert(l,h),a.ac[a.currentUser.toKey()]=m}(r,i.batchId,t),yield Jc(r,i.changes),yield k_(r.remoteStore)}catch(i){const a=L_(i,"Failed to persist write");t.reject(a)}}),$A.apply(this,arguments)}function xN(n,e){return GA.apply(this,arguments)}function GA(){return GA=(0,Ee.Z)(function*(n,e){const t=et(n);try{const r=yield c(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.uc.get(a);l&&(St(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.ec=!0:i.modifiedDocuments.size>0?St(l.ec):i.removedDocuments.size>0&&(St(l.ec),l.ec=!1))}),yield Jc(t,r,e)}catch(r){yield bl(r)}}),GA.apply(this,arguments)}function RN(n,e,t){const r=et(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.sc.forEach((a,l)=>{const h=l.view.bu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=et(a);h.onlineState=l;let m=!1;h.queries.forEach((v,D)=>{for(const S of D.listeners)S.bu(l)&&(m=!0)}),m&&LA(h)}(r.eventManager,e),i.length&&r.nc.Wo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function WF(n,e,t){return qA.apply(this,arguments)}function qA(){return qA=(0,Ee.Z)(function*(n,e,t){const r=et(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.uc.get(e),a=i&&i.key;if(a){let l=new fr(Ke.comparator);l=l.insert(a,Nn.newNoDocument(a,At.min()));const h=jt().add(a),m=new Hh(At.min(),new Map,new bn(Ot),l,h);yield xN(r,m),r.oc=r.oc.remove(a),r.uc.delete(e),JA(r)}else yield E(r.localStore,e,!1).then(()=>B_(r,e,t)).catch(bl)}),qA.apply(this,arguments)}function zF(n,e){return WA.apply(this,arguments)}function WA(){return WA=(0,Ee.Z)(function*(n,e){const t=et(n),r=e.batch.batchId;try{const i=yield o(t.localStore,e);YA(t,r,null),KA(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Jc(t,i)}catch(i){yield bl(i)}}),WA.apply(this,arguments)}function ZF(n,e,t){return zA.apply(this,arguments)}function zA(){return zA=(0,Ee.Z)(function*(n,e,t){const r=et(n);try{const i=yield function(a,l){const h=et(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return h.mutationQueue.lookupMutationBatch(m,l).next(D=>(St(null!==D),v=D.keys(),h.mutationQueue.removeMutationBatch(m,D))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>h.localDocuments.getDocuments(m,v))})}(r.localStore,e);YA(r,e,t),KA(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Jc(r,i)}catch(i){yield bl(i)}}),zA.apply(this,arguments)}function ZA(){return ZA=(0,Ee.Z)(function*(n,e){const t=et(n);Gh(t.remoteStore)||Be("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=et(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.hc.get(r)||[];i.push(e),t.hc.set(r,i)}catch(r){const i=L_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),ZA.apply(this,arguments)}function KA(n,e){(n.hc.get(e)||[]).forEach(t=>{t.resolve()}),n.hc.delete(e)}function YA(n,e,t){const r=et(n);let i=r.ac[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.ac[r.currentUser.toKey()]=i}}function B_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ic.get(e))n.sc.delete(r),t&&n.nc._c(r,t);n.ic.delete(e),n.isPrimaryClient&&n.cc.ls(e).forEach(r=>{n.cc.containsKey(r)||MN(n,r)})}function MN(n,e){n.rc.delete(e.path.canonicalString());const t=n.oc.get(e);null!==t&&(tw(n.remoteStore,t),n.oc=n.oc.remove(e),n.uc.delete(t),JA(n))}function QA(n,e,t){for(const r of t)r instanceof TN?(n.cc.addReference(r.key,e),YF(n,r)):r instanceof SN?(Be("SyncEngine","Document no longer in limbo: "+r.key),n.cc.removeReference(r.key,e),n.cc.containsKey(r.key)||MN(n,r.key)):lt()}function YF(n,e){const t=e.key,r=t.path.canonicalString();n.oc.get(t)||n.rc.has(r)||(Be("SyncEngine","New document in limbo: "+t),n.rc.add(r),JA(n))}function JA(n){for(;n.rc.size>0&&n.oc.size<n.maxConcurrentLimboResolutions;){const e=n.rc.values().next().value;n.rc.delete(e);const t=new Ke(ln.fromString(e)),r=n.lc.next();n.uc.set(r,new jF(t)),n.oc=n.oc.insert(t,r),Cb(n.remoteStore,new xa(ji(Lh(t.path)),r,2,rs.at))}}function Jc(n,e,t){return XA.apply(this,arguments)}function XA(){return XA=(0,Ee.Z)(function*(n,e,t){const r=et(n),i=[],a=[],l=[];var h;r.sc.isEmpty()||(r.sc.forEach((h,m)=>{l.push(r.dc(m,e,t).then(v=>{if(v){r.isPrimaryClient&&r.sharedClientState.updateQueryState(m.targetId,v.fromCache?"not-current":"current"),i.push(v);const D=Z0.Ci(m.targetId,v);a.push(D)}}))}),yield Promise.all(l),r.nc.Wo(i),yield(h=(0,Ee.Z)(function*(m,v){const D=et(m);try{yield D.persistence.runTransaction("notifyLocalViewChanges","readwrite",S=>he.forEach(v,N=>he.forEach(N.Si,V=>D.persistence.referenceDelegate.addReference(S,N.targetId,V)).next(()=>he.forEach(N.Di,V=>D.persistence.referenceDelegate.removeReference(S,N.targetId,V)))))}catch(S){if(!Dl(S))throw S;Be("LocalStore","Failed to update sequence numbers: "+S)}for(const S of v){const N=S.targetId;if(!S.fromCache){const V=D.Ui.get(N),fe=V.withLastLimboFreeSnapshotVersion(V.snapshotVersion);D.Ui=D.Ui.insert(N,fe)}}}),function(m,v){return h.apply(this,arguments)})(r.localStore,a))}),XA.apply(this,arguments)}function QF(n,e){return ex.apply(this,arguments)}function ex(){return ex=(0,Ee.Z)(function*(n,e){const t=et(n);if(!t.currentUser.isEqual(e)){Be("SyncEngine","User change. New user:",e.toKey());const r=yield fA(t.localStore,e);t.currentUser=e,(i=t).hc.forEach(l=>{l.forEach(h=>{h.reject(new Le(pe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.hc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Jc(t,r.ji)}var i}),ex.apply(this,arguments)}function JF(n,e){const t=et(n),r=t.uc.get(e);if(r&&r.ec)return jt().add(r.key);{let i=jt();const a=t.ic.get(e);if(!a)return i;for(const l of a){const h=t.sc.get(l);i=i.unionWith(h.view.Qu)}return i}}function XF(n,e){return tx.apply(this,arguments)}function tx(){return tx=(0,Ee.Z)(function*(n,e){const t=et(n),r=yield A(t.localStore,e.query,!0),i=e.view.Zu(r);return t.isPrimaryClient&&QA(t,e.targetId,i.Yu),i}),tx.apply(this,arguments)}function eL(n,e){return nx.apply(this,arguments)}function nx(){return nx=(0,Ee.Z)(function*(n,e){const t=et(n);return L(t.localStore,e).then(r=>Jc(t,r))}),nx.apply(this,arguments)}function tL(n,e,t,r){return rx.apply(this,arguments)}function rx(){return rx=(0,Ee.Z)(function*(n,e,t,r){const i=et(n),a=yield function(l,h){const m=et(l),v=et(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",D=>v.Tn(D,h).next(S=>S?m.localDocuments.getDocuments(D,S):he.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield k_(i.remoteStore):"acknowledged"===t||"rejected"===t?(YA(i,e,r||null),KA(i,e),h=e,et(et(i.localStore).mutationQueue).An(h)):lt(),yield Jc(i,a)):Be("SyncEngine","Cannot apply mutation batch with id: "+e)}),rx.apply(this,arguments)}function ix(){return ix=(0,Ee.Z)(function*(n,e){const t=et(n);if(ux(t),lx(t),!0===e&&!0!==t.fc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield NN(t,r.toArray());t.fc=!0,yield RA(t.remoteStore,!0);for(const a of i)Cb(t.remoteStore,a)}else if(!1===e&&!1!==t.fc){const r=[];let i=Promise.resolve();t.ic.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(B_(t,l),E(t.localStore,l,!0))),tw(t.remoteStore,l)}),yield i,yield NN(t,r),function(a){const l=et(a);l.uc.forEach((h,m)=>{tw(l.remoteStore,m)}),l.cc.fs(),l.uc=new Map,l.oc=new fr(Ke.comparator)}(t),t.fc=!1,yield RA(t.remoteStore,!1)}}),ix.apply(this,arguments)}function NN(n,e,t){return sx.apply(this,arguments)}function sx(){return sx=(0,Ee.Z)(function*(n,e,t){const r=et(n),i=[],a=[];for(const l of e){let h;const m=r.ic.get(l);if(m&&0!==m.length){h=yield y(r.localStore,ji(m[0]));for(const v of m){const D=r.sc.get(v),S=yield XF(r,D);S.snapshot&&a.push(S.snapshot)}}else{const v=yield M(r.localStore,l);h=yield y(r.localStore,v),yield BA(r,PN(v),l,!1)}i.push(h)}return r.nc.Wo(a),i}),sx.apply(this,arguments)}function PN(n){return DC(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function rL(n){const e=et(n);return et(et(e.localStore).persistence).vi()}function iL(n,e,t,r){return ox.apply(this,arguments)}function ox(){return ox=(0,Ee.Z)(function*(n,e,t,r){const i=et(n);if(i.fc)return void Be("SyncEngine","Ignoring unexpected query state notification.");const a=i.ic.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield L(i.localStore,AC(a[0])),h=Hh.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Jc(i,l,h);break}case"rejected":yield E(i.localStore,e,!0),B_(i,e,r);break;default:lt()}}),ox.apply(this,arguments)}function sL(n,e,t){return ax.apply(this,arguments)}function ax(){return ax=(0,Ee.Z)(function*(n,e,t){const r=ux(n);if(r.fc){for(const i of e){if(r.ic.has(i)){Be("SyncEngine","Adding an already active target "+i);continue}const a=yield M(r.localStore,i),l=yield y(r.localStore,a);yield BA(r,PN(a),l.targetId,!1),Cb(r.remoteStore,l)}for(const i of t)r.ic.has(i)&&(yield E(r.localStore,i,!1).then(()=>{tw(r.remoteStore,i),B_(r,i)}).catch(bl))}}),ax.apply(this,arguments)}function ux(n){const e=et(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=xN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WF.bind(null,e),e.nc.Wo=FF.bind(null,e.eventManager),e.nc._c=LF.bind(null,e.eventManager),e}function lx(n){const e=et(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZF.bind(null,e),e}class ON{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Ee.Z)(function*(){t.It=X0(e.databaseInfo.databaseId),t.sharedClientState=t.mc(e),t.persistence=t.gc(e),yield t.persistence.start(),t.localStore=t.yc(e),t.gcScheduler=t.Ic(e,t.localStore),t.indexBackfillerScheduler=t.Tc(e,t.localStore)})()}Ic(e,t){return null}Tc(e,t){return null}yc(e){return hA(this.persistence,new dA,e.initialUser,this.It)}gc(e){return new _b(W0.Bs,this.It)}mc(e){return new M_}terminate(){var e=this;return(0,Ee.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class kN extends ON{constructor(e,t,r){super(),this.Ec=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Ee.Z)(function*(){yield t().call(r,e),yield r.Ec.initialize(r,e),yield lx(r.Ec.syncEngine),yield k_(r.Ec.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}yc(e){return hA(this.persistence,new dA,e.initialUser,this.It)}Ic(e,t){return new B0(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Tc(e,t){const r=new IS(t,this.persistence);return new lC(e.asyncQueue,r)}gc(e){const t=Eb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ks.withCacheSize(this.cacheSizeBytes):ks.DEFAULT;return new wb(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,P_(),Ib(),this.It,this.sharedClientState,!!this.forceOwnership)}mc(e){return new M_}}class aL extends kN{constructor(e,t){super(e,t,!1),this.Ec=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Ee.Z)(function*(){yield t().call(r,e);const i=r.Ec.syncEngine;r.sharedClientState instanceof Gp&&(r.sharedClientState.syncEngine={Fr:tL.bind(null,i),$r:iL.bind(null,i),Br:sL.bind(null,i),vi:rL.bind(null,i),Or:eL.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,Ee.Z)(function*(l){yield function nL(n,e){return ix.apply(this,arguments)}(r.Ec.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}mc(e){const t=P_();if(!Gp.C(t))throw new Le(pe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Eb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gp(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class cx{initialize(e,t){var r=this;return(0,Ee.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>RN(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=QF.bind(null,r.syncEngine),yield RA(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new kF}createDatastore(e){const t=X0(e.databaseInfo.databaseId),r=new J0(e.databaseInfo);return new IF(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>RN(this.syncEngine,h,0),l=N_.C()?new N_:new K0,new bF(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,m,v){const D=new HF(r,i,a,l,h,m);return v&&(D.fc=!0),D}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Ee.Z)(function*(t){const r=et(t);Be("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield O_(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function FN(n,e=10240){let t=0;return{read:()=>(0,Ee.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Ee.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class Db{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ac(this.observer.next,e)}error(e){this.observer.error?this.Ac(this.observer.error,e):jn("Uncaught Error in snapshot listener:",e)}Rc(){this.muted=!0}Ac(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class uL{constructor(e,t){this.bc=e,this.It=t,this.metadata=new hr,this.buffer=new Uint8Array,this.Pc=new TextDecoder("utf-8"),this.vc().then(r=>{r&&r.ku()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.bc.cancel()}getMetadata(){var e=this;return(0,Ee.Z)(function*(){return e.metadata.promise})()}wc(){var e=this;return(0,Ee.Z)(function*(){return yield e.getMetadata(),e.vc()})()}vc(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.Vc();if(null===t)return null;const r=e.Pc.decode(t),i=Number(r);isNaN(i)&&e.Sc(`length string (${r}) is not valid number`);const a=yield e.Dc(i);return new VF(JSON.parse(a),t.length+i)})()}Cc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Vc(){var e=this;return(0,Ee.Z)(function*(){for(;e.Cc()<0&&!(yield e.xc()););if(0===e.buffer.length)return null;const t=e.Cc();t<0&&e.Sc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Dc(e){var t=this;return(0,Ee.Z)(function*(){for(;t.buffer.length<e;)(yield t.xc())&&t.Sc("Reached the end of bundle when more is expected.");const r=t.Pc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Sc(e){throw this.bc.cancel(),new Error(`Invalid bundle format: ${e}`)}xc(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.bc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class lL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Ee.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Le(pe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Ee.Z)(function*(a,l){const h=et(a),m=Mp(h.It)+"/documents",v={documents:l.map(V=>Rp(h.It,V))},D=yield h.fo("BatchGetDocuments",m,v,l.length),S=new Map;D.forEach(V=>{const W=function LS(n,e){return"found"in e?function(t,r){St(!!r.found);const i=Aa(t,r.found.name),a=Pr(r.found.updateTime),l=new _i({mapValue:{fields:r.found.fields}});return Nn.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){St(!!r.missing),St(!!r.readTime);const i=Aa(t,r.missing),a=Pr(r.readTime);return Nn.newNoDocument(i,a)}(n,e):lt()}(h.It,V);S.set(W.key.toString(),W)});const N=[];return l.forEach(V=>{const W=S.get(V.toString());St(!!W),N.push(W)}),N}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Gc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Ee.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=Ke.fromPath(i);e.mutations.push(new bp(a,e.precondition(a)))}),yield(r=(0,Ee.Z)(function*(i,a){const l=et(i),h=Mp(l.It)+"/documents",m={writes:a.map(v=>Np(l.It,v))};yield l.co("Commit",h,m)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw lt();t=At.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Le(pe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(At.min())?Hn.exists(!1):Hn.updateTime(t):Hn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(At.min()))throw new Le(pe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Hn.updateTime(t)}return Hn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class cL{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Nc=r.maxAttempts,this.xo=new pA(this.asyncQueue,"transaction_retry")}run(){this.Nc-=1,this.kc()}kc(){var e=this;this.xo.Ao((0,Ee.Z)(function*(){const t=new lL(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Oc(a)}))}).catch(i=>{e.Oc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!yp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Oc(e){this.Nc>0&&this.Fc(e)?(this.Nc-=1,this.asyncQueue.enqueueAndForget(()=>(this.kc(),Promise.resolve()))):this.deferred.reject(e)}Fc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!v0(t)}return!1}}class dL{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=qr.UNAUTHENTICATED,this.clientId=iC.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,Ee.Z)(function*(h){Be("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(Be("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,Ee.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Le(pe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Ee.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=L_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function LN(n,e){return dx.apply(this,arguments)}function dx(){return dx=(0,Ee.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Be("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Ee.Z)(function*(a){r.isEqual(a)||(yield fA(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),dx.apply(this,arguments)}function VN(n,e){return hx.apply(this,arguments)}function hx(){return hx=(0,Ee.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield fx(n);Be("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>IN(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>IN(e.remoteStore,a)),n.onlineComponents=e}),hx.apply(this,arguments)}function fx(n){return px.apply(this,arguments)}function px(){return px=(0,Ee.Z)(function*(n){return n.offlineComponents||(Be("FirestoreClient","Using default OfflineComponentProvider"),yield LN(n,new ON)),n.offlineComponents}),px.apply(this,arguments)}function Tb(n){return gx.apply(this,arguments)}function gx(){return gx=(0,Ee.Z)(function*(n){return n.onlineComponents||(Be("FirestoreClient","Using default OnlineComponentProvider"),yield VN(n,new cx)),n.onlineComponents}),gx.apply(this,arguments)}function UN(n){return fx(n).then(e=>e.persistence)}function Sb(n){return fx(n).then(e=>e.localStore)}function BN(n){return Tb(n).then(e=>e.remoteStore)}function mx(n){return Tb(n).then(e=>e.syncEngine)}function j_(n){return _x.apply(this,arguments)}function _x(){return _x=(0,Ee.Z)(function*(n){const e=yield Tb(n),t=e.eventManager;return t.onListen=$F.bind(null,e.syncEngine),t.onUnlisten=GF.bind(null,e.syncEngine),t}),_x.apply(this,arguments)}function jN(n,e,t={}){const r=new hr;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function(i,a,l,h,m){const v=new Db({next:S=>{a.enqueueAndForget(()=>kA(i,D));const N=S.docs.has(l);!N&&S.fromCache?m.reject(new Le(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&S.fromCache&&h&&"server"===h.source?m.reject(new Le(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),D=new VA(Lh(l.path),v,{includeMetadataChanges:!0,Nu:!0});return PA(i,D)}(yield j_(n),n.asyncQueue,e,t,r)})),r.promise}function HN(n,e,t={}){const r=new hr;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function(i,a,l,h,m){const v=new Db({next:S=>{a.enqueueAndForget(()=>kA(i,D)),S.fromCache&&"server"===h.source?m.reject(new Le(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(S)},error:S=>m.reject(S)}),D=new VA(l,v,{includeMetadataChanges:!0,Nu:!0});return PA(i,D)}(yield j_(n),n.asyncQueue,e,t,r)})),r.promise}const $N=new Map;function yx(n,e,t){if(!t)throw new Le(pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function GN(n,e,t,r){if(!0===e&&!0===r)throw new Le(pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qN(n){if(!Ke.isDocumentKey(n))throw new Le(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function WN(n){if(Ke.isDocumentKey(n))throw new Le(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ab(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":lt()}function fn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Le(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ab(n);throw new Le(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function zN(n,e){if(e<=0)throw new Le(pe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class ZN{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Le(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Le(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,GN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ZN({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Le(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Le(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ZN(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new hS;switch(t.type){case"gapi":return new rC(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Le(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=$N.get(e);t&&(Be("ComponentProvider","Removing Datastore"),$N.delete(e),t.terminate())}(this),Promise.resolve()}}class rr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rr(this.firestore,e,this._key)}}class os{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new os(this.firestore,e,this._query)}}class Pl extends os{constructor(e,t,r){super(e,t,Lh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rr(this.firestore,null,new Ke(e))}withConverter(e){return new Pl(this.firestore,e,this._path)}}function KN(n,e,...t){if(n=(0,O.m9)(n),yx("collection","path",e),n instanceof nw){const r=ln.fromString(e,...t);return WN(r),new Pl(n,null,r)}{if(!(n instanceof rr||n instanceof Pl))throw new Le(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ln.fromString(e,...t));return WN(r),new Pl(n.firestore,null,r)}}function xb(n,e,...t){if(n=(0,O.m9)(n),1===arguments.length&&(e=iC.R()),yx("doc","path",e),n instanceof nw){const r=ln.fromString(e,...t);return qN(r),new rr(n,null,new Ke(r))}{if(!(n instanceof rr||n instanceof Pl))throw new Le(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ln.fromString(e,...t));return qN(r),new rr(n.firestore,n instanceof Pl?n.converter:null,new Ke(r))}}function YN(n,e){return n=(0,O.m9)(n),e=(0,O.m9)(e),(n instanceof rr||n instanceof Pl)&&(e instanceof rr||e instanceof Pl)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function QN(n,e){return n=(0,O.m9)(n),e=(0,O.m9)(e),n instanceof os&&e instanceof os&&n.firestore===e.firestore&&Vh(n._query,e._query)&&n.converter===e.converter}class IL{constructor(){this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new pA(this,"async_queue_retry"),this.jc=()=>{const t=Ib();t&&Be("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.bo()};const e=Ib();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.jc)}get isShuttingDown(){return this.Lc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Wc(),this.zc(e)}enterRestrictedMode(e){if(!this.Lc){this.Lc=!0,this.Gc=e||!1;const t=Ib();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.jc)}}enqueue(e){if(this.Wc(),this.Lc)return new Promise(()=>{});const t=new hr;return this.zc(()=>this.Lc&&this.Gc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Bc.push(e),this.Hc()))}Hc(){var e=this;return(0,Ee.Z)(function*(){if(0!==e.Bc.length){try{yield e.Bc[0](),e.Bc.shift(),e.xo.reset()}catch(t){if(!Dl(t))throw t;Be("AsyncQueue","Operation failed with retryable error: "+t)}e.Bc.length>0&&e.xo.Ao(()=>e.Hc())}})()}zc(e){const t=this.$c.then(()=>(this.Kc=!0,e().catch(r=>{throw this.qc=r,this.Kc=!1,jn("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Kc=!1,r))));return this.$c=t,t}enqueueAfterDelay(e,t,r){this.Wc(),this.Qc.indexOf(e)>-1&&(t=0);const i=NA.createAndSchedule(this,e,t,r,a=>this.Jc(a));return this.Uc.push(i),i}Wc(){this.qc&&lt()}verifyOperationInProgress(){}Yc(){var e=this;return(0,Ee.Z)(function*(){let t;do{t=e.$c,yield t}while(t!==e.$c)})()}Xc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}Zc(e){return this.Yc().then(()=>{this.Uc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Yc()})}ta(e){this.Qc.push(e)}Jc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function vx(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class CL{constructor(){this._progressObserver={},this._taskCompletionResolver=new hr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class gr extends nw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new IL,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||JN(this),this._firestoreClient.terminate()}}function si(n){return n._firestoreClient||JN(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function JN(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new bS(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new dL(n._authCredentials,n._appCheckCredentials,n._queue,r)}function XN(n,e,t){const r=new hr;return n.asyncQueue.enqueue((0,Ee.Z)(function*(){try{yield LN(n,t),yield VN(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===pe.FAILED_PRECONDITION||l.code===pe.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;Mc("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function eP(n){if(n._initialized||n._terminated)throw new Le(pe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Xc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Le(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ol{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ol(Wr.fromBase64String(e))}catch(t){throw new Le(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ol(Wr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class qp{constructor(e){this._methodName=e}}class Rb{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Le(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Le(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ot(this._lat,e._lat)||Ot(this._long,e._long)}}const PL=/^__.*__$/;class OL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Du(e,this.data,this.fieldMask,t,this.fieldTransforms):new xl(e,this.data,t,this.fieldTransforms)}}class tP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Du(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function nP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt()}}class Mb{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ea(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get na(){return this.settings.na}sa(e){return new Mb(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:r,ra:!1});return i.oa(e),i}ua(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:r,ra:!1});return i.ea(),i}ca(e){return this.sa({path:void 0,ra:!0})}aa(e){return Ob(e,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ea(){if(this.path)for(let e=0;e<this.path.length;e++)this.oa(this.path.get(e))}oa(e){if(0===e.length)throw this.aa("Document fields must not be empty");if(nP(this.na)&&PL.test(e))throw this.aa('Document fields cannot begin and end with "__"')}}class kL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||X0(e)}fa(e,t,r,i=!1){return new Mb({na:e,methodName:t,la:r,path:nr.emptyPath(),ra:!1,ha:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Wp(n){const e=n._freezeSettings(),t=X0(n._databaseId);return new kL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Nb(n,e,t,r,i,a={}){const l=n.fa(a.merge||a.mergeFields?2:0,e,t,i);Cx("Data must be an object, but it was:",l,r);const h=sP(r,l);let m,v;if(a.merge)m=new Ps(l.fieldMask),v=l.fieldTransforms;else if(a.mergeFields){const D=[];for(const S of a.mergeFields){const N=bx(e,S,t);if(!l.contains(N))throw new Le(pe.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);aP(D,N)||D.push(N)}m=new Ps(D),v=l.fieldTransforms.filter(S=>m.covers(S.field))}else m=null,v=l.fieldTransforms;return new OL(new _i(h),m,v)}class rw extends qp{_toFieldTransform(e){if(2!==e.na)throw e.aa(1===e.na?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rw}}function rP(n,e,t){return new Mb({na:3,la:e.settings.la,methodName:n._methodName,ra:t},e.databaseId,e.It,e.ignoreUndefinedProperties)}class wx extends qp{_toFieldTransform(e){return new jh(e.path,new Sa)}isEqual(e){return e instanceof wx}}class FL extends qp{constructor(e,t){super(e),this.da=t}_toFieldTransform(e){const t=rP(this,e,!0),r=this.da.map(a=>zp(a,t)),i=new jc(r);return new jh(e.path,i)}isEqual(e){return this===e}}class LL extends qp{constructor(e,t){super(e),this.da=t}_toFieldTransform(e){const t=rP(this,e,!0),r=this.da.map(a=>zp(a,t)),i=new Hc(r);return new jh(e.path,i)}isEqual(e){return this===e}}class VL extends qp{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=new bu(e.It,MC(e.It,this._a));return new jh(e.path,t)}isEqual(e){return this===e}}function Ex(n,e,t,r){const i=n.fa(1,e,t);Cx("Data must be an object, but it was:",i,r);const a=[],l=_i.empty();kc(r,(m,v)=>{const D=Pb(e,m,t);v=(0,O.m9)(v);const S=i.ua(D);if(v instanceof rw)a.push(D);else{const N=zp(v,S);null!=N&&(a.push(D),l.set(D,N))}});const h=new Ps(a);return new tP(l,h,i.fieldTransforms)}function Ix(n,e,t,r,i,a){const l=n.fa(1,e,t),h=[bx(e,r,t)],m=[i];if(a.length%2!=0)throw new Le(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let N=0;N<a.length;N+=2)h.push(bx(e,a[N])),m.push(a[N+1]);const v=[],D=_i.empty();for(let N=h.length-1;N>=0;--N)if(!aP(v,h[N])){const V=h[N];let W=m[N];W=(0,O.m9)(W);const fe=l.ua(V);if(W instanceof rw)v.push(V);else{const Ae=zp(W,fe);null!=Ae&&(v.push(V),D.set(V,Ae))}}const S=new Ps(v);return new tP(D,S,l.fieldTransforms)}function iP(n,e,t,r=!1){return zp(t,n.fa(r?4:3,e))}function zp(n,e){if(oP(n=(0,O.m9)(n)))return Cx("Unsupported field value:",e,n),sP(n,e);if(n instanceof qp)return function(t,r){if(!nP(r.na))throw r.aa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.aa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ra&&4!==e.na)throw e.aa("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=zp(l,r.ca(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,O.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return MC(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=tr.fromDate(t);return{timestampValue:Rl(r.It,i)}}if(t instanceof tr){const i=new tr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Rl(r.It,i)}}if(t instanceof Rb)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ol)return{bytesValue:b0(r.It,t._byteString)};if(t instanceof rr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.aa(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:xp(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.aa(`Unsupported field value: ${Ab(t)}`)}(n,e)}function sP(n,e){const t={};return dC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):kc(n,(r,i)=>{const a=zp(i,e.ia(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function oP(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof tr||n instanceof Rb||n instanceof Ol||n instanceof rr||n instanceof qp)}function Cx(n,e,t){if(!oP(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=Ab(t);throw e.aa("an object"===r?n+" a custom object":n+" "+r)}var r}function bx(n,e,t){if((e=(0,O.m9)(e))instanceof Xc)return e._internalPath;if("string"==typeof e)return Pb(n,e);throw Ob("Field path arguments must be of type string or ",n,!1,void 0,t)}const UL=new RegExp("[~\\*/\\[\\]]");function Pb(n,e,t){if(e.search(UL)>=0)throw Ob(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Xc(...e.split("."))._internalPath}catch(r){throw Ob(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ob(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(a||l)&&(m+=" (found",a&&(m+=` in field ${r}`),l&&(m+=` in document ${i}`),m+=")"),new Le(pe.INVALID_ARGUMENT,h+n+m)}function aP(n,e){return n.some(t=>t.isEqual(e))}class iw{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new rr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new BL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(kb("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class BL extends iw{data(){return super.data()}}function kb(n,e){return"string"==typeof e?Pb(n,e):e instanceof Xc?e._internalPath:e._delegate._internalPath}class Zp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ed extends iw{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(kb("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class sw extends ed{data(e={}){return super.data(e)}}class Wh{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sw(this._firestore,this._userDataWriter,r.key,r,new Zp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Le(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new sw(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new sw(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,v=-1;return 0!==l.type&&(m=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),v=a.indexOf(l.doc.key)),{type:jL(l.type),doc:h,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function jL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt()}}function uP(n,e){return n instanceof ed&&e instanceof ed?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Wh&&e instanceof Wh&&n._firestore===e._firestore&&QN(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function lP(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Le(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ow{}function zh(n,...e){for(const t of e)n=t._apply(n);return n}class HL extends ow{constructor(e,t,r){super(),this.wa=e,this.ma=t,this.ga=r,this.type="where"}_apply(e){const t=Wp(e.firestore),r=function(i,a,l,h,m,v,D){let S;if(m.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new Le(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){gP(D,v);const V=[];for(const W of D)V.push(pP(h,i,W));S={arrayValue:{values:V}}}else S=pP(h,i,D)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||gP(D,v),S=iP(l,"where",D,"in"===v||"not-in"===v);const N=pr.create(m,v,S);return function(V,W){if(W.dt()){const Ae=Uc(V);if(null!==Ae&&!Ae.isEqual(W.field))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Ae.toString()}' and '${W.field.toString()}'`);const at=p0(V);null!==at&&mP(0,W.field,at)}const fe=function(Ae,at){for(const ft of Ae.filters)if(at.indexOf(ft.op)>=0)return ft.op;return null}(V,function(Ae){switch(Ae){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(W.op));if(null!==fe)throw new Le(pe.INVALID_ARGUMENT,fe===W.op?`Invalid query. You cannot use more than one '${W.op.toString()}' filter.`:`Invalid query. You cannot use '${W.op.toString()}' filters with '${fe.toString()}' filters.`)}(i,N),N}(e._query,0,t,e.firestore._databaseId,this.wa,this.ma,this.ga);return new os(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new Cu(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class GL extends ow{constructor(e,t){super(),this.wa=e,this.ya=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Le(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Le(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new Fh(i,a);return function(h,m){if(null===p0(h)){const v=Uc(h);null!==v&&mP(0,v,m.field)}}(r,l),l}(e._query,this.wa,this.ya);return new os(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Cu(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class cP extends ow{constructor(e,t,r){super(),this.type=e,this.pa=t,this.Ia=r}_apply(e){return new os(e.firestore,e.converter,Ip(e._query,this.pa,this.Ia))}}class dP extends ow{constructor(e,t,r){super(),this.type=e,this.Ta=t,this.Ea=r}_apply(e){const t=fP(e,this.type,this.Ta,this.Ea);return new os(e.firestore,e.converter,(i=t,new Cu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class hP extends ow{constructor(e,t,r){super(),this.type=e,this.Ta=t,this.Ea=r}_apply(e){const t=fP(e,this.type,this.Ta,this.Ea);return new os(e.firestore,e.converter,(i=t,new Cu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function fP(n,e,t,r){if(t[0]=(0,O.m9)(t[0]),t[0]instanceof iw)return function(i,a,l,h,m){if(!h)throw new Le(pe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const v=[];for(const D of Bc(i))if(D.field.isKeyField())v.push(Lc(a,h.key));else{const S=h.data.field(D.field);if(Xm(S))throw new Le(pe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+D.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===S){const N=D.field.canonicalString();throw new Le(pe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}v.push(S)}return new Al(v,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Wp(n.firestore);return function(a,l,h,m,v,D){const S=a.explicitOrderBy;if(v.length>S.length)throw new Le(pe.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let V=0;V<v.length;V++){const W=v[V];if(S[V].field.isKeyField()){if("string"!=typeof W)throw new Le(pe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof W}`);if(!o_(a)&&-1!==W.indexOf("/"))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${W}' contains a slash.`);const fe=a.path.child(ln.fromString(W));if(!Ke.isDocumentKey(fe))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${fe}' is not because it contains an odd number of segments.`);const Ae=new Ke(fe);N.push(Lc(l,Ae))}else{const fe=iP(h,m,W);N.push(fe)}}return new Al(N,D)}(n._query,n.firestore._databaseId,i,e,t,r)}}function pP(n,e,t){if("string"==typeof(t=(0,O.m9)(t))){if(""===t)throw new Le(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!o_(e)&&-1!==t.indexOf("/"))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ln.fromString(t));if(!Ke.isDocumentKey(r))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Lc(n,new Ke(r))}if(t instanceof rr)return Lc(n,t._key);throw new Le(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ab(t)}.`)}function gP(n,e){if(!Array.isArray(n)||0===n.length)throw new Le(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Le(pe.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function mP(n,e,t){if(!t.isEqual(e))throw new Le(pe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const JL={maxAttempts:5};class Dx{convertValue(e,t="none"){switch(Sl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw lt()}}convertObject(e,t){const r={};return kc(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new Rb(Kn(e.latitude),Kn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=e_(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(_p(e));default:return null}}convertTimestamp(e){const t=Tl(e);return new tr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ln.fromString(e);St(BS(r));const i=new Da(r.get(1),r.get(3)),a=new Ke(r.popFirst(5));return i.isEqual(t)||jn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function Fb(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class XL extends Dx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ol(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rr(this.firestore,null,t)}}class _P{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wp(e)}set(e,t,r){this._verifyNotCommitted();const i=Zh(e,this._firestore),a=Fb(i.converter,t,r),l=Nb(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,Hn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Zh(e,this._firestore);let l;return l="string"==typeof(t=(0,O.m9)(t))||t instanceof Xc?Ix(this._dataReader,"WriteBatch.update",a._key,t,r,i):Ex(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Hn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Zh(e,this._firestore);return this._mutations=this._mutations.concat(new Gc(t._key,Hn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Le(pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Zh(n,e){if((n=(0,O.m9)(n)).firestore!==e)throw new Le(pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Kp extends Dx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ol(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rr(this.firestore,null,t)}}function yP(n,e,t){n=fn(n,rr);const r=fn(n.firestore,gr),i=Fb(n.converter,e,t);return H_(r,[Nb(Wp(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Hn.none())])}function vP(n,e,t,...r){n=fn(n,rr);const i=fn(n.firestore,gr),a=Wp(i);let l;return l="string"==typeof(e=(0,O.m9)(e))||e instanceof Xc?Ix(a,"updateDoc",n._key,e,t,r):Ex(a,"updateDoc",n._key,e),H_(i,[l.toMutation(n._key,Hn.exists(!0))])}function wP(n,...e){var t,r,i;n=(0,O.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||vx(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if(vx(e[l])){const S=e[l];e[l]=null===(t=S.next)||void 0===t?void 0:t.bind(S),e[l+1]=null===(r=S.error)||void 0===r?void 0:r.bind(S),e[l+2]=null===(i=S.complete)||void 0===i?void 0:i.bind(S)}let m,v,D;if(n instanceof rr)v=fn(n.firestore,gr),D=Lh(n._key.path),m={next:S=>{e[l]&&e[l](Tx(v,n,S))},error:e[l+1],complete:e[l+2]};else{const S=fn(n,os);v=fn(S.firestore,gr),D=S._query;const N=new Kp(v);m={next:V=>{e[l]&&e[l](new Wh(v,N,S,V))},error:e[l+1],complete:e[l+2]},lP(n._query)}return function(S,N,V,W){const fe=new Db(W),Ae=new VA(N,fe,V);return S.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return PA(yield j_(S),Ae)})),()=>{fe.Rc(),S.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return kA(yield j_(S),Ae)}))}}(si(v),D,h,m)}function H_(n,e){return function(t,r){const i=new hr;return t.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function qF(n,e,t){return $A.apply(this,arguments)}(yield mx(t),r,i)})),i.promise}(si(n),e)}function Tx(n,e,t){const r=t.docs.get(e._key),i=new Kp(n);return new ed(n,i,e._key,r,new Zp(t.hasPendingWrites,t.fromCache),e.converter)}class lV extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Wp(e)}get(e){const t=Zh(e,this._firestore),r=new XL(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return lt();const a=i[0];if(a.isFoundDocument())return new iw(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new iw(this._firestore,r,t._key,null,t.converter);throw lt()})}set(e,t,r){const i=Zh(e,this._firestore),a=Fb(i.converter,t,r),l=Nb(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=Zh(e,this._firestore);let l;return l="string"==typeof(t=(0,O.m9)(t))||t instanceof Xc?Ix(this._dataReader,"Transaction.update",a._key,t,r,i):Ex(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Zh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Zh(e,this._firestore),r=new Kp(this._firestore);return super.get(e).then(i=>new ed(this._firestore,r,t._key,i._document,new Zp(!1,!1),t.converter))}}function Sx(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Le("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function IP(){if("undefined"==typeof Uint8Array)throw new Le("unimplemented","Uint8Arrays are not available in this environment.")}function CP(){if(!function hC(){return"undefined"!=typeof atob}())throw new Le("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Rc=ns.SDK_VERSION,(0,ns._registerComponent)(new lo.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new gr(new pS(t.getProvider("auth-internal")),new gS(t.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Le(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Da(h.options.projectId,m)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,ns.registerVersion)(e0,"3.4.15",n),(0,ns.registerVersion)(e0,"3.4.15","esm2017")}();class aw{constructor(e){this._delegate=e}static fromBase64String(e){return CP(),new aw(Ol.fromBase64String(e))}static fromUint8Array(e){return IP(),new aw(Ol.fromUint8Array(e))}toBase64(){return CP(),this._delegate.toBase64()}toUint8Array(){return IP(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Ax(n){return function yV(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class vV{enableIndexedDbPersistence(e,t){return function DL(n,e){eP(n=fn(n,gr));const t=si(n),r=n._freezeSettings(),i=new cx;return XN(t,i,new kN(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function TL(n){eP(n=fn(n,gr));const e=si(n),t=n._freezeSettings(),r=new cx;return XN(e,r,new aL(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function SL(n){if(n._initialized&&!n._terminated)throw new Le(pe.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new hr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Ee.Z)(function*(){try{yield(t=(0,Ee.Z)(function*(r){if(!Uo.C())return Promise.resolve();const i=r+"main";yield Uo.delete(i)}),function(r){return t.apply(this,arguments)})(Eb(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class bP{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Da||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Mc("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function wL(n,e,t,r={}){var i;const a=(n=fn(n,nw))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Mc("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=qr.MOCK_USER;else{l=(0,O.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Le(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new qr(m)}n._authCredentials=new fS(new xh(l,h))}}(this._delegate,e,t,r)}enableNetwork(){return function xL(n){return function hL(n){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){const e=yield UN(n),t=yield BN(n);return e.setNetworkEnabled(!0),function(r){const i=et(r);return i._u.delete(0),ew(i)}(t)}))}(si(n=fn(n,gr)))}(this._delegate)}disableNetwork(){return function RL(n){return function fL(n){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){const e=yield UN(n),t=yield BN(n);return e.setNetworkEnabled(!1),(r=(0,Ee.Z)(function*(i){const a=et(i);a._u.add(0),yield O_(a),a.gu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(si(n=fn(n,gr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,GN("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function AL(n){return function(e){const t=new hr;return e.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function KF(n,e){return ZA.apply(this,arguments)}(yield mx(e),t)})),t.promise}(si(n=fn(n,gr)))}(this._delegate)}onSnapshotsInSync(e){return function uV(n,e){return function mL(n,e){const t=new Db(e);return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return r=yield j_(n),i=t,et(r).Ru.add(i),void i.next();var r,i})),()=>{t.Rc(),n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return r=yield j_(n),i=t,void et(r).Ru.delete(i);var r,i}))}}(si(n=fn(n,gr)),vx(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Le("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new $_(this,KN(this._delegate,e))}catch(t){throw Fs(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ma(this,xb(this._delegate,e))}catch(t){throw Fs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ls(this,function EL(n,e){if(n=fn(n,nw),yx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Le(pe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new os(n,null,(t=e,new Cu(ln.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Fs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function cV(n,e,t){n=fn(n,gr);const r=Object.assign(Object.assign({},JL),t);return function(i){if(i.maxAttempts<1)throw new Le(pe.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function _L(n,e,t){const r=new hr;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){const i=yield(a=n,Tb(a).then(l=>l.datastore));var a;new cL(n.asyncQueue,i,t,e,r).run()})),r.promise}(si(n),i=>e(new lV(n,i)),r)}(this._delegate,t=>e(new DP(this,t)))}batch(){return si(this._delegate),new TP(new _P(this._delegate,e=>H_(this._delegate,e)))}loadBundle(e){return function ML(n,e){const t=si(n=fn(n,gr)),r=new CL;return function yL(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,m=function(m,v){if(m instanceof Uint8Array)return FN(m,v);if(m instanceof ArrayBuffer)return FN(new Uint8Array(m),v);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new uL(m,l);var m}(t,X0(e));n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){!function oL(n,e,t){const r=et(n);var i;(i=(0,Ee.Z)(function*(a,l,h){try{const m=yield l.getMetadata();if(yield function(N,V){const W=et(N),fe=Pr(V.createTime);return W.persistence.runTransaction("hasNewerBundle","readonly",Ae=>W.Ns.getBundleMetadata(Ae,V.id)).then(Ae=>!!Ae&&Ae.createTime.compareTo(fe)>=0)}(a.localStore,m))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(N=m).totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}),Promise.resolve(new Set);h._updateProgress(DN(m));const v=new UF(m,a.localStore,l.It);let D=yield l.wc();for(;D;){const N=yield v.Ou(D);N&&h._updateProgress(N),D=yield l.wc()}const S=yield v.complete();return yield Jc(a,S.Bu,void 0),yield function(N,V){const W=et(N);return W.persistence.runTransaction("Save bundle","readwrite",fe=>W.Ns.saveBundleMetadata(fe,V))}(a.localStore,m),h._completeWith(S.progress),Promise.resolve(S.$u)}catch(m){return Mc("SyncEngine",`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}var N}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield mx(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function NL(n,e){return function vL(n,e){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){return function(t,r){const i=et(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield Sb(n),e)}))}(si(n=fn(n,gr)),e).then(t=>t?new os(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ls(this,t):null)}}class Lb extends Dx{constructor(e){super(),this.firestore=e}convertBytes(e){return new aw(new Ol(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ma.forKey(t,this.firestore,null)}}class DP{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Lb(e)}get(e){const t=Qp(e);return this._delegate.get(t).then(r=>new uw(this._firestore,new ed(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Qp(e);return r?(Sx("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Qp(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Qp(e);return this._delegate.delete(t),this}}class TP{constructor(e){this._delegate=e}set(e,t,r){const i=Qp(e);return r?(Sx("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Qp(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Qp(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Yp{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new sw(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new lw(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Yp.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Yp(e,new Lb(e),t),i.set(t,a)),a}}Yp.INSTANCES=new WeakMap;class Ma{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lb(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Le("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ma(t,new rr(t._delegate,r,new Ke(e)))}static forKey(e,t,r){return new Ma(t,new rr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new $_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new $_(this.firestore,KN(this._delegate,e))}catch(t){throw Fs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,O.m9)(e))instanceof rr&&YN(this._delegate,e)}set(e,t){t=Sx("DocumentReference.set",t);try{return t?yP(this._delegate,e,t):yP(this._delegate,e)}catch(r){throw Fs(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?vP(this._delegate,e):vP(this._delegate,e,t,...r)}catch(i){throw Fs(i,"updateDoc()","DocumentReference.update()")}}delete(){return function oV(n){return H_(fn(n.firestore,gr),[new Gc(n._key,Hn.none())])}(this._delegate)}onSnapshot(...e){const t=SP(e),r=AP(e,i=>new uw(this.firestore,new ed(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return wP(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function tV(n){n=fn(n,rr);const e=fn(n.firestore,gr),t=si(e),r=new Kp(e);return function pL(n,e){const t=new hr;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return(r=(0,Ee.Z)(function*(i,a,l){try{const h=yield function(m,v){const D=et(m);return D.persistence.runTransaction("read document","readonly",S=>D.localDocuments.getDocument(S,v))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new Le(pe.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=L_(h,`Failed to get document '${a} from cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield Sb(n),e,t);var r})),t.promise}(t,n._key).then(i=>new ed(e,r,n._key,i,new Zp(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function nV(n){n=fn(n,rr);const e=fn(n.firestore,gr);return jN(si(e),n._key,{source:"server"}).then(t=>Tx(e,n,t))}(this._delegate):function eV(n){n=fn(n,rr);const e=fn(n.firestore,gr);return jN(si(e),n._key).then(t=>Tx(e,n,t))}(this._delegate),t.then(r=>new uw(this.firestore,new ed(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Ma(this.firestore,this._delegate.withConverter(e?Yp.getInstance(this.firestore,e):null))}}function Fs(n,e,t){return n.message=n.message.replace(e,t),n}function SP(n){for(const e of n)if("object"==typeof e&&!Ax(e))return e;return{}}function AP(n,e){var t,r;let i;return i=Ax(n[0])?n[0]:Ax(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class uw{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ma(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uP(this._delegate,e._delegate)}}class lw extends uw{data(e){const t=this._delegate.data(e);return function tC(n,e){n||lt()}(void 0!==t),t}}class Ls{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lb(e)}where(e,t,r){try{return new Ls(this.firestore,zh(this._delegate,function $L(n,e,t){const r=e,i=kb("where",n);return new HL(i,r,t)}(e,t,r)))}catch(i){throw Fs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ls(this.firestore,zh(this._delegate,function qL(n,e="asc"){const t=e,r=kb("orderBy",n);return new GL(r,t)}(e,t)))}catch(r){throw Fs(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ls(this.firestore,zh(this._delegate,function WL(n){return zN("limit",n),new cP("limit",n,"F")}(e)))}catch(t){throw Fs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ls(this.firestore,zh(this._delegate,function zL(n){return zN("limitToLast",n),new cP("limitToLast",n,"L")}(e)))}catch(t){throw Fs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ls(this.firestore,zh(this._delegate,function ZL(...n){return new dP("startAt",n,!0)}(...e)))}catch(t){throw Fs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ls(this.firestore,zh(this._delegate,function KL(...n){return new dP("startAfter",n,!1)}(...e)))}catch(t){throw Fs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ls(this.firestore,zh(this._delegate,function YL(...n){return new hP("endBefore",n,!1)}(...e)))}catch(t){throw Fs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ls(this.firestore,zh(this._delegate,function QL(...n){return new hP("endAt",n,!0)}(...e)))}catch(t){throw Fs(t,"endAt()","Query.endAt()")}}isEqual(e){return QN(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function iV(n){n=fn(n,os);const e=fn(n.firestore,gr),t=si(e),r=new Kp(e);return function gL(n,e){const t=new hr;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return(r=(0,Ee.Z)(function*(i,a,l){try{const h=yield A(i,a,!0),m=new AN(a,h.Hi),v=m.ju(h.documents),D=m.applyChanges(v,!1);l.resolve(D.snapshot)}catch(h){const m=L_(h,`Failed to execute query '${a} against cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield Sb(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Wh(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function sV(n){n=fn(n,os);const e=fn(n.firestore,gr),t=si(e),r=new Kp(e);return HN(t,n._query,{source:"server"}).then(i=>new Wh(e,r,n,i))}(this._delegate):function rV(n){n=fn(n,os);const e=fn(n.firestore,gr),t=si(e),r=new Kp(e);return lP(n._query),HN(t,n._query).then(i=>new Wh(e,r,n,i))}(this._delegate),t.then(r=>new xx(this.firestore,new Wh(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=SP(e),r=AP(e,i=>new xx(this.firestore,new Wh(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return wP(this._delegate,t,r)}withConverter(e){return new Ls(this.firestore,this._delegate.withConverter(e?Yp.getInstance(this.firestore,e):null))}}class EV{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new lw(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class xx{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ls(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new lw(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new EV(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new lw(this._firestore,r))})}isEqual(e){return uP(this._delegate,e._delegate)}}class $_ extends Ls{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ma(this.firestore,e):null}doc(e){try{return new Ma(this.firestore,void 0===e?xb(this._delegate):xb(this._delegate,e))}catch(t){throw Fs(t,"doc()","CollectionReference.doc()")}}add(e){return function aV(n,e){const t=fn(n.firestore,gr),r=xb(n),i=Fb(n.converter,e);return H_(t,[Nb(Wp(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Hn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Ma(this.firestore,t))}isEqual(e){return YN(this._delegate,e._delegate)}withConverter(e){return new $_(this.firestore,this._delegate.withConverter(e?Yp.getInstance(this.firestore,e):null))}}function Qp(n){return fn(n,rr)}class Rx{constructor(...e){this._delegate=new Xc(...e)}static documentId(){return new Rx(nr.keyField().canonicalString())}isEqual(e){return(e=(0,O.m9)(e))instanceof Xc&&this._delegate._internalPath.isEqual(e._internalPath)}}class Jp{constructor(e){this._delegate=e}static serverTimestamp(){const e=function hV(){return new wx("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Jp(e)}static delete(){const e=function dV(){return new rw("deleteField")}();return e._methodName="FieldValue.delete",new Jp(e)}static arrayUnion(...e){const t=function fV(...n){return new FL("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Jp(t)}static arrayRemove(...e){const t=function pV(...n){return new LL("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Jp(t)}static increment(e){const t=function gV(n){return new VL("increment",n)}(e);return t._methodName="FieldValue.increment",new Jp(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const IV={Firestore:bP,GeoPoint:Rb,Timestamp:tr,Blob:aw,Transaction:DP,WriteBatch:TP,DocumentReference:Ma,DocumentSnapshot:uw,Query:Ls,QueryDocumentSnapshot:lw,QuerySnapshot:xx,CollectionReference:$_,FieldPath:Rx,FieldValue:Jp,setLogLevel:function wV(n){!function dS(n){yu.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function bV(n){(function CV(n,e){n.INTERNAL.registerComponent(new lo.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},IV)))})(n,(e,t)=>new bP(e,t,new vV)),n.registerVersion("@firebase/firestore-compat","0.1.24")}(hv.Z);var Mx=F(6451),Vb=F(5363),DV=F(6063);class TV extends io.x{constructor(e=1/0,t=1/0,r=DV.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let m=1;m<r.length&&r[m]<=l;m+=2)h=m;h&&r.splice(0,h+1)}}}var xP=F(3099);function RP(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=null!=n?n:1/0,(0,xP.B)({connector:()=>new TV(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function MP(n,e){return(0,Dy.m)(e)?Xr(()=>n,e):Xr(()=>n)}var Nx=F(9468);F(5867);const PP=new Map,MV={activated:!1,tokenObservers:[]},NV={initialized:!1,enabled:!1};function Ai(n){return PP.get(n)||MV}function Mu(n,e){PP.set(n,e)}function Bb(){return NV}class LV{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Ee.Z)(function*(){t.stop();try{t.pending=new O.BH,yield function VV(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new O.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Vs=new O.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function kP(n){if(!Ai(n).activated)throw Vs.create("use-before-activation",{appName:n.name})}function Fx(n,e){return Lx.apply(this,arguments)}function Lx(){return Lx=(0,Ee.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const V=yield l.getHeartbeatsHeader();V&&(a["X-Firebase-Client"]=V)}const h={method:"POST",body:JSON.stringify(e),headers:a};let m,v;try{m=yield fetch(n,h)}catch(V){throw Vs.create("fetch-network-error",{originalErrorMessage:null===(r=V)||void 0===r?void 0:r.message})}if(200!==m.status)throw Vs.create("fetch-status-error",{httpStatus:m.status});try{v=yield m.json()}catch(V){throw Vs.create("fetch-parse-error",{originalErrorMessage:null===(i=V)||void 0===i?void 0:i.message})}const D=v.ttl.match(/^([\d.]+)(s)$/);if(!D||!D[2]||isNaN(Number(D[1])))throw Vs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${v.ttl}`});const S=1e3*Number(D[1]),N=Date.now();return{token:v.token,expireTimeMillis:N+S,issuedAtTimeMillis:N}}),Lx.apply(this,arguments)}function HV(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const cw="firebase-app-check-store";let $b=null;function LP(){return $b||($b=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(Vs.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(cw,{keyPath:"compositeKey"})}}catch(r){e(Vs.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),$b)}function Vx(){return Vx=(0,Ee.Z)(function*(n,e){const r=(yield LP()).transaction(cw,"readwrite"),a=r.objectStore(cw).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=m=>{l()},r.onerror=m=>{var v;h(Vs.create("storage-set",{originalErrorMessage:null===(v=m.target.error)||void 0===v?void 0:v.message}))}})}),Vx.apply(this,arguments)}const dw=new ko.Yd("@firebase/app-check");function jP(n,e){return(0,O.hl)()?function WV(n,e){return function VP(n,e){return Vx.apply(this,arguments)}(function BP(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{dw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function HP(){return Bb().enabled}function $P(){return Hx.apply(this,arguments)}function Hx(){return Hx=(0,Ee.Z)(function*(){const n=Bb();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),Hx.apply(this,arguments)}const JV={error:"UNKNOWN_ERROR"};function XV(n){return O.US.encodeString(JSON.stringify(n),!1)}function Gb(n){return $x.apply(this,arguments)}function $x(){return $x=(0,Ee.Z)(function*(n,e=!1){const t=n.app;kP(t);const r=Ai(t);let a,i=r.token;if(!i){const m=yield r.cachedTokenPromise;m&&qb(m)&&(i=m)}if(!e&&i&&qb(i))return{token:i.token};let h,l=!1;if(HP()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Fx(HV(t,yield $P()),n.heartbeatServiceProvider).then(v=>(r.exchangeTokenPromise=void 0,v)),l=!0);const m=yield r.exchangeTokenPromise;return yield jP(t,m),Mu(t,Object.assign(Object.assign({},r),{token:m})),{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(m=>(r.exchangeTokenPromise=void 0,m)),l=!0),i=yield r.exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?dw.warn(m.message):dw.error(m),a=m}return i?(h={token:i.token},Mu(t,Object.assign(Object.assign({},r),{token:i})),yield jP(t,i)):h=tU(a),l&&qP(t,h),h}),$x.apply(this,arguments)}function qx(n,e){const t=Ai(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Mu(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function GP(n){const{app:e}=n,t=Ai(e);let r=t.tokenRefresher;r||(r=function eU(n){const{app:e}=n;return new LV((0,Ee.Z)(function*(){let r;if(r=Ai(e).token?yield Gb(n,!0):yield Gb(n),r.error)throw r.error}),()=>!0,()=>{const t=Ai(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Mu(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function qP(n,e){const t=Ai(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(i){}}function qb(n){return n.expireTimeMillis-Date.now()>0}function tU(n){return{token:XV(JV),error:n}}class nU{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Ai(this.app);for(const t of e)qx(this.app,t.next);return Promise.resolve()}}const XP="app-check-internal";!function mU(){(0,ns._registerComponent)(new lo.wA("app-check",n=>function rU(n,e){return new nU(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(XP).initialize()})),(0,ns._registerComponent)(new lo.wA(XP,n=>function iU(n){return{getToken:e=>Gb(n,e),addTokenListener:e=>function Gx(n,e,t,r){const{app:i}=n,a=Ai(i),l={next:t,error:r,type:e};if(Mu(i,Object.assign(Object.assign({},a),{tokenObservers:[...a.tokenObservers,l]})),a.token&&qb(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),GP(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>GP(n))}(n,"INTERNAL",e),removeTokenListener:e=>qx(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ns.registerVersion)("@firebase/app-check","0.5.12")}();class hw{constructor(){return(0,hn.vb)("app-check")}}"undefined"!=typeof window&&window;var zb=F(127);const Yx=new f.OlP("angularfire2.auth.use-emulator"),Qx=new f.OlP("angularfire2.auth.settings"),Jx=new f.OlP("angularfire2.auth.tenant-id"),Xx=new f.OlP("angularfire2.auth.langugage-code"),eR=new f.OlP("angularfire2.auth.use-device-language"),tR=new f.OlP("angularfire.auth.persistence"),nR=(n,e,t,r,i,a,l,h)=>(0,$r.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const m=e.runOutsideAngular(()=>n.auth());if(t&&m.useEmulator(...t),r&&(m.tenantId=r),m.languageCode=i,a&&m.useDeviceLanguage(),l)for(const[v,D]of Object.entries(l))m.settings[v]=D;return h&&m.setPersistence(h),m},[t,r,i,a,l,h]);let fw=(()=>{class n{constructor(t,r,i,a,l,h,m,v,D,S,N,V){const W=new io.x,fe=ut(void 0).pipe((0,Vb.Q)(l.outsideAngular),Xr(()=>a.runOutsideAngular(()=>Promise.resolve().then(F.bind(F,5881)))),(0,wt.U)(()=>(0,$r.on)(t,a,r)),(0,wt.U)(Ae=>nR(Ae,a,h,v,D,S,m,N)),RP({bufferSize:1,refCount:!1}));if(jr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ut(null);else{fe.pipe(Wd()).subscribe();const at=fe.pipe(Xr(dt=>dt.getRedirectResult().then(Rt=>Rt,()=>null)),hn.iC,RP({bufferSize:1,refCount:!1})),ft=fe.pipe(Xr(dt=>new Es.y(Rt=>({unsubscribe:a.runOutsideAngular(()=>dt.onAuthStateChanged(Ft=>Rt.next(Ft),Ft=>Rt.error(Ft),()=>Rt.complete()))})))),pt=fe.pipe(Xr(dt=>new Es.y(Rt=>({unsubscribe:a.runOutsideAngular(()=>dt.onIdTokenChanged(Ft=>Rt.next(Ft),Ft=>Rt.error(Ft),()=>Rt.complete()))}))));this.authState=at.pipe(MP(ft),(0,Nx.R)(l.outsideAngular),(0,Vb.Q)(l.insideAngular)),this.user=at.pipe(MP(pt),(0,Nx.R)(l.outsideAngular),(0,Vb.Q)(l.insideAngular)),this.idToken=this.user.pipe(Xr(dt=>dt?(0,En.D)(dt.getIdToken()):ut(null))),this.idTokenResult=this.user.pipe(Xr(dt=>dt?(0,En.D)(dt.getIdTokenResult()):ut(null))),this.credential=(0,Mx.T)(at,W,this.authState.pipe(au(dt=>!dt))).pipe((0,wt.U)(dt=>(null==dt?void 0:dt.user)?dt:null),(0,Nx.R)(l.outsideAngular),(0,Vb.Q)(l.insideAngular))}return(0,$r.pX)(this,fe,a,{spy:{apply:(Ae,at,ft)=>{(Ae.startsWith("signIn")||Ae.startsWith("createUser"))&&ft.then(pt=>W.next(pt))}}})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG($r.Dh),f.LFG($r.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(hn.HU),f.LFG(Yx,8),f.LFG(Qx,8),f.LFG(Jx,8),f.LFG(Xx,8),f.LFG(eR,8),f.LFG(tR,8),f.LFG(hw,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),IU=(()=>{class n{constructor(){zb.Z.registerVersion("angularfire",hn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[fw]}),n})();function tO(n,e){return function CU(n,e=cm.z){return new Es.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function rR(n,e){return tO(n,e).pipe((0,wt.U)(t=>({payload:t,type:"query"})))}function Zb(n,e){return rR(n,e).pipe(Lg(void 0),dm(),(0,wt.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const m=i.find(D=>D.doc.ref.isEqual(l.ref)),v=null==t?void 0:t.payload.docs.find(D=>D.ref.isEqual(l.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(l.metadata)||!m&&v&&JSON.stringify(v.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function nO(n,e,t){return Zb(n,t).pipe(dc((r,i)=>function DU(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function TU(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return iR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return iR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return iR(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),dv(),(0,wt.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function iR(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function rO(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class iO{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Zb(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,wt.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Lg(void 0),dm(),au(([r,i])=>i.length>0||!r),(0,wt.U)(([r,i])=>i),hn.iC)}auditTrail(e){return this.stateChanges(e).pipe(dc((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=rO(e);return nO(this.query,t,this.afs.schedulers.outsideAngular).pipe(hn.iC)}valueChanges(e={}){return rR(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),hn.iC)}get(e){return(0,En.D)(this.query.get(e)).pipe(hn.iC)}add(e){return this.ref.add(e)}doc(e){return new sO(this.ref.doc(e),this.afs)}}class sO{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=uO(r,t);return new iO(i,a,this.afs)}snapshotChanges(){return function bU(n,e){return tO(n,e).pipe(Lg(void 0),dm(),(0,wt.U)(([t,r])=>r.exists?(null==t?void 0:t.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(hn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,wt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,En.D)(this.ref.get(e)).pipe(hn.iC)}}class SU{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Zb(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),au(t=>t.length>0),hn.iC):Zb(this.query,this.afs.schedulers.outsideAngular).pipe(hn.iC)}auditTrail(e){return this.stateChanges(e).pipe(dc((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=rO(e);return nO(this.query,t,this.afs.schedulers.outsideAngular).pipe(hn.iC)}valueChanges(e={}){return rR(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),hn.iC)}get(e){return(0,En.D)(this.query.get(e)).pipe(hn.iC)}}const oO=new f.OlP("angularfire2.enableFirestorePersistence"),aO=new f.OlP("angularfire2.firestore.persistenceSettings"),AU=new f.OlP("angularfire2.firestore.settings"),xU=new f.OlP("angularfire2.firestore.use-emulator");function uO(n,e=(t=>t)){return{query:e(n),ref:n}}let pw=(()=>{class n{constructor(t,r,i,a,l,h,m,v,D,S,N,V,W,fe,Ae,at,ft){this.schedulers=m;const pt=(0,$r.on)(t,h,r),dt=D;S&&nR(pt,h,N,W,fe,Ae,V,at),[this.firestore,this.persistenceEnabled$]=(0,$r.cc)(`${pt.name}.firestore`,"AngularFirestore",pt.name,()=>{const Rt=h.runOutsideAngular(()=>pt.firestore());if(a&&Rt.settings(a),dt&&Rt.useEmulator(...dt),i&&!jr(l)){const Ft=()=>{try{return(0,En.D)(Rt.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(Tr){return"undefined"!=typeof console&&console.warn(Tr),ut(!1)}};return[Rt,h.runOutsideAngular(Ft)]}return[Rt,ut(!1)]},[a,dt,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=uO(i,r),h=this.schedulers.ngZone.run(()=>a);return new iO(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new SU(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new sO(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(f.LFG($r.Dh),f.LFG($r.xv,8),f.LFG(oO,8),f.LFG(AU,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(hn.HU),f.LFG(aO,8),f.LFG(xU,8),f.LFG(fw,8),f.LFG(Yx,8),f.LFG(Qx,8),f.LFG(Jx,8),f.LFG(Xx,8),f.LFG(eR,8),f.LFG(tR,8),f.LFG(hw,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),RU=(()=>{class n{constructor(){zb.Z.registerVersion("angularfire",hn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:oO,useValue:!0},{provide:aO,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[pw]}),n})(),lO=(()=>{class n{constructor(t){this.firestore=t}createCategory(t){return new Promise((r,i)=>{this.firestore.collection("categories").add(t).then(a=>{},a=>i(a))})}getCategory(){return this.firestore.collection("categories").snapshotChanges()}updateCategory(t){return this.firestore.collection("categories").doc(t.payload.doc.id).set({completed:!0},{merge:!0})}deleteCategory(t){return this.firestore.collection("categories").doc(t).delete()}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pw))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),cO=(()=>{class n{constructor(t){this.firestore=t}createItems(t){return new Promise((r,i)=>{this.firestore.collection("items").add(t).then(a=>{},a=>i(a))})}getItems(){return this.firestore.collection("items").snapshotChanges()}updateItem(t){return this.firestore.collection("items").doc("").set({completed:!0},{merge:!0})}deleteItem(t){return this.firestore.collection("items").doc(t).delete()}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pw))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function MU(n,e){if(1&n&&(f.TgZ(0,"option",15),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.Q6J("ngValue",t.name),f.xp6(1),f.Oqu(t.name)}}function NU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",16),f._uU(1),f.TgZ(2,"button",17),f.NdJ("click",function(){const a=f.CHM(t).$implicit;return f.oxw().deleteItem(a.id)}),f._uU(3,"Delete"),f.qZA()()}if(2&n){const t=e.$implicit;f.xp6(1),f.hij(" ",t.name," ")}}let PU=(()=>{class n{constructor(t,r){this.itemService=t,this.categoryService=r,this.items=[],this.itemForm=new Mo({}),this.item={name:"",id:null,description:"",price:0,category:""},this.categories=[]}ngOnInit(){this.itemForm=new Mo({name:new ru(this.item.name,[ua.required,ua.minLength(4)]),price:new ru(this.item.price),description:new ru(this.item.description),category:new ru(this.item.category)}),this.categoryService.getCategory().subscribe(t=>{this.categories=[],t.forEach(r=>{let i=r.payload.doc.data();i.id=r.payload.doc.id,this.categories.push(i),console.log(i,r.payload.doc.data())})})}createItems(t){console.log("__________________",t),this.itemService.createItems(t)}getItems(){this.itemService.getItems().subscribe(t=>{this.items=[],t.forEach(r=>{let i=r.payload.doc.data();i.id=r.payload.doc.id,this.items.push(i)})})}updateItem(t){}deleteItem(t){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(cO),f.Y36(lO))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-edit-menu"]],decls:31,vars:3,consts:[[1,"row"],[1,"col-4"],[3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"form-outline","mb-4"],[1,"form-label"],["type","text","formControlName","name","name","name","required","",1,"form-control"],["type","text","formControlName","price","name","price","required","",1,"form-control"],["type","text","formControlName","description","name","description","required","",1,"form-control"],["name","categories","id","categories","formControlName","category","name","category","required",""],["categry",""],[3,"ngValue",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary","btn-block","mb-4"],[1,"text-center"],["class","text-right",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"text-right"],[1,"text-danger",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0),f._UZ(1,"div",1),f.TgZ(2,"div",1)(3,"form",2),f.NdJ("ngSubmit",function(){return r.createItems(r.itemForm.value)}),f.TgZ(4,"div",3)(5,"h2"),f._uU(6,"Add Menu"),f.qZA()(),f.TgZ(7,"div",4)(8,"label",5),f._uU(9,"Name"),f.qZA(),f._UZ(10,"input",6),f.qZA(),f.TgZ(11,"div",4)(12,"label",5),f._uU(13,"Price"),f.qZA(),f._UZ(14,"input",7),f.qZA(),f.TgZ(15,"div",4)(16,"label",5),f._uU(17,"Description"),f.qZA(),f._UZ(18,"input",8),f.qZA(),f.TgZ(19,"div",4)(20,"label",5),f._uU(21,"Category"),f.qZA(),f.TgZ(22,"select",9,10),f.YNc(24,MU,2,2,"option",11),f.qZA()(),f.TgZ(25,"button",12),f._uU(26,"save"),f.qZA()()(),f.TgZ(27,"div",1)(28,"h2",13),f._uU(29,"Menu List"),f.qZA(),f.YNc(30,NU,4,1,"div",14),f.qZA()()),2&t&&(f.xp6(3),f.Q6J("formGroup",r.itemForm),f.xp6(21),f.Q6J("ngForOf",r.categories),f.xp6(6),f.Q6J("ngForOf",r.items))},directives:[sl,Ja,su,Yi,Qr,_,lc,ne,Pn,xe,xs],styles:[""]}),n})();function OU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",10),f._uU(1),f.TgZ(2,"button",11),f.NdJ("click",function(){const a=f.CHM(t).$implicit;return f.oxw().del(a.id)}),f._uU(3,"Delete"),f.qZA()()}if(2&n){const t=e.$implicit;f.xp6(1),f.hij(" ",t.name," ")}}let kU=(()=>{class n{constructor(t){this.categoryService=t,this.categoryForm=new Mo({}),this.category={name:"",id:null},this.categories=[]}ngOnInit(){this.categoryForm=new Mo({name:new ru(this.category.name,[ua.required,ua.minLength(4)])}),this.categoryService.getCategory().subscribe(t=>{this.categories=[],t.forEach(r=>{let i=r.payload.doc.data();i.id=r.payload.doc.id,this.categories.push(i),console.log(i,r.payload.doc.data())})})}get name(){return this.categoryForm.get("name")}onSubmit(t){this.categoryService.createCategory(t).finally(()=>{console.log("added")})}del(t){console.log("**"),this.categoryService.deleteCategory(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(lO))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-config"]],decls:18,vars:2,consts:[[1,"row"],[1,"col-4"],[3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"form-outline","mb-4"],[1,"form-label"],["type","text","formControlName","name","name","username","required","",1,"form-control"],["type","submit",1,"btn","btn-primary","btn-block","mb-4"],[1,"text-center"],["class","text-right",4,"ngFor","ngForOf"],[1,"text-right"],[1,"text-danger",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0),f._UZ(1,"div",1),f.TgZ(2,"div",1)(3,"form",2),f.NdJ("ngSubmit",function(){return r.onSubmit(r.categoryForm.value)}),f.TgZ(4,"div",3)(5,"h2"),f._uU(6,"Add Category"),f.qZA()(),f.TgZ(7,"div",4)(8,"label",5),f._uU(9,"Category Name"),f.qZA(),f._UZ(10,"input",6),f.qZA(),f.TgZ(11,"button",7),f._uU(12,"save"),f.qZA()()(),f.TgZ(13,"div",1)(14,"h2",8),f._uU(15,"Category List"),f.qZA(),f.YNc(16,OU,4,1,"div",9),f.qZA()(),f._UZ(17,"app-edit-menu")),2&t&&(f.xp6(3),f.Q6J("formGroup",r.categoryForm),f.xp6(13),f.Q6J("ngForOf",r.categories))},directives:[sl,Ja,su,Yi,Qr,_,lc,Pn,PU],styles:[""]}),n})(),dO=(()=>{class n{constructor(t){this.firestore=t}createOrder(t){return console.log("************8888",t),new Promise((r,i)=>{this.firestore.collection("orders").add(t).then(a=>{},a=>{console.log("*****888"),i(a)})})}getOrder(){return this.firestore.collection("orders").snapshotChanges()}updateOrder(t){return this.firestore.collection("orders").doc(t.payload.doc.id).set({completed:!0},{merge:!0})}deleteOrder(t){return this.firestore.collection("orders").doc(t).delete()}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pw))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function FU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",10)(1,"h6",11),f.NdJ("click",function(){const a=f.CHM(t).$implicit;return f.oxw(2).select(a.category)}),f._uU(2),f.qZA()()}if(2&n){const t=e.$implicit,r=f.oxw(2);f.xp6(1),f.Q6J("ngClass",r.selectCategory==t.category?"selected":"notSelected"),f.xp6(1),f.Oqu(t.category)}}function LU(n,e){if(1&n&&(f.TgZ(0,"div",8)(1,"h2",0),f._uU(2,"Categories"),f.qZA(),f.TgZ(3,"div",5),f.YNc(4,FU,3,2,"div",9),f.qZA()()),2&n){const t=f.oxw();f.xp6(4),f.Q6J("ngForOf",t.data)}}function VU(n,e){if(1&n&&(f.TgZ(0,"div"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.lnq(" ",t.it.name,".....",t.count,"x",t.it.price," ")}}function UU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",12)(1,"h2"),f._uU(2,"Select Items"),f.qZA(),f.YNc(3,VU,2,3,"div",13),f.TgZ(4,"div"),f._uU(5),f.qZA(),f.TgZ(6,"a",14),f.NdJ("click",function(){return f.CHM(t),f.oxw().placeOrder()}),f._uU(7,"Add"),f.qZA()()}if(2&n){const t=f.oxw();f.xp6(3),f.Q6J("ngForOf",t.cart),f.xp6(2),f.hij(" Total ............................",t.total," ")}}function BU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",18)(1,"div",19)(2,"div",5)(3,"div",20)(4,"h5",21),f._uU(5),f.qZA(),f.TgZ(6,"p",22),f._uU(7),f.qZA(),f.TgZ(8,"p",23),f._uU(9),f.qZA(),f.TgZ(10,"a",14),f.NdJ("click",function(){const a=f.CHM(t).$implicit;return f.oxw(4).add(a)}),f._uU(11,"Add"),f.qZA()(),f.TgZ(12,"div",6),f._UZ(13,"img",24),f.qZA()()()()}if(2&n){const t=e.$implicit;f.xp6(5),f.Oqu(t.name),f.xp6(2),f.Oqu(t.price),f.xp6(2),f.Oqu(t.description)}}function jU(n,e){if(1&n&&(f.TgZ(0,"div"),f.YNc(1,BU,14,3,"div",17),f.qZA()),2&n){const t=f.oxw().$implicit;f.xp6(1),f.Q6J("ngForOf",t.items)}}function HU(n,e){if(1&n&&(f.TgZ(0,"div"),f.YNc(1,jU,2,1,"div",16),f.qZA()),2&n){const t=e.$implicit,r=f.oxw(2);f.xp6(1),f.Q6J("ngIf",r.selectCategory==t.category)}}function $U(n,e){if(1&n&&(f.TgZ(0,"div",15),f.YNc(1,HU,2,1,"div",13),f.qZA()),2&n){const t=f.oxw();f.xp6(1),f.Q6J("ngForOf",t.data)}}function GU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",25),f.NdJ("click",function(){return f.CHM(t),f.oxw().selectPage("cart")}),f.TgZ(1,"p"),f._uU(2,"Cart "),f.TgZ(3,"span",26),f._uU(4),f.qZA()()()}if(2&n){const t=f.oxw();f.xp6(4),f.Oqu(t.itemCount)}}function qU(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",25),f.NdJ("click",function(){return f.CHM(t),f.oxw().selectPage("menu")}),f.TgZ(1,"p"),f._uU(2,"Menu"),f.qZA()()}}let WU=(()=>{class n{constructor(t,r){this.itemService=t,this.cartService=r,this.data=[],this.cart=[],this.itemCount="",this.isCart=!1,this.isMenu=!0,this.total=0}ngOnInit(){this.itemService.getItems().subscribe(t=>{this.data=[],t.forEach(r=>{let i=r.payload.doc.data(),a=this.data.find(l=>l.category==i.category);if(console.log((null==a?void 0:a.category)==i.category,a),(null==a?void 0:a.category)==i.category)console.log("inside if"),a.items.push(i);else{console.log("inside else");let l={category:i.category,items:[]};l.items.push(i),this.data.push(l),this.selectCategory=this.data[0].category}})}),console.log(this.data)}add(t){let r={it:t,count:1};this.cart.find(a=>a.it.name==t.name&&(a.count++,this.total=this.total+t.price,!0))||(this.cart.push(r),this.itemCount=this.cart.length+" x Items",this.total=this.total+r.it.price)}placeOrder(){this.cartService.createOrder({total:this.total,items:this.cart,isPlaced:!0}).then(r=>{})}updateOrder(){this.cartService.updateOrder(this.cart).then()}select(t){this.selectCategory=t}selectPage(t){"cart"==t&&(this.isCart=!0,this.isMenu=!1),"menu"==t&&(this.isCart=!1,this.isMenu=!0)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(cO),f.Y36(dO))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-menu"]],decls:12,vars:5,consts:[[1,"text-center"],[1,"row","mb-5"],["class","col-lg-4 col-sm-2",4,"ngIf"],["class","col-lg-4 col-sm-2 h2 text-center",4,"ngIf"],["class","col-lg-4 col-sm-4",4,"ngIf"],[1,"row"],[1,"col-4"],["class","fixed-bottom cart-btn ",3,"click",4,"ngIf"],[1,"col-lg-4","col-sm-2"],["class","col-2",4,"ngFor","ngForOf"],[1,"col-2"],[3,"ngClass","click"],[1,"col-lg-4","col-sm-2","h2","text-center"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[1,"col-lg-4","col-sm-4"],[4,"ngIf"],["class","card mt-2",4,"ngFor","ngForOf"],[1,"card","mt-2"],[1,"card-body"],[1,"col-8"],[1,"card-title"],[1,"card-text","h6"],[1,"card-text"],["src","../../app/shared/big-hamburger-with-double-beef-french-fries_252907-8.jpg"],[1,"fixed-bottom","cart-btn",3,"click"],[1,"quant"]],template:function(t,r){1&t&&(f.TgZ(0,"h2",0),f._uU(1,"Menu"),f.qZA(),f.TgZ(2,"div",1),f.YNc(3,LU,5,1,"div",2),f.YNc(4,UU,8,2,"div",3),f.YNc(5,$U,2,1,"div",4),f.qZA(),f.TgZ(6,"div",5),f._UZ(7,"div",6),f.TgZ(8,"div",6),f.YNc(9,GU,5,1,"div",7),f.YNc(10,qU,3,0,"div",7),f.qZA(),f._UZ(11,"div",6),f.qZA()),2&t&&(f.xp6(3),f.Q6J("ngIf",r.isMenu),f.xp6(1),f.Q6J("ngIf",r.isCart),f.xp6(1),f.Q6J("ngIf",r.isMenu),f.xp6(4),f.Q6J("ngIf",r.isMenu),f.xp6(1),f.Q6J("ngIf",r.isCart))},directives:[Kr,Pn,mo],styles:[".cart-btn[_ngcontent-%COMP%]{background-color:red;color:#fff;height:48px;font-size:27px}.selected[_ngcontent-%COMP%]{color:red}.notSelected[_ngcontent-%COMP%]{color:#000}.quant[_ngcontent-%COMP%]{float:right;margin-right:36px}"]}),n})();function zU(n,e){if(1&n&&(f.TgZ(0,"div"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.lnq(" ",t.it.name,".....",t.count,"x",t.it.price," ")}}function ZU(n,e){if(1&n&&(f.TgZ(0,"div"),f.YNc(1,zU,2,3,"div",1),f.TgZ(2,"div"),f._uU(3),f.qZA(),f.TgZ(4,"h2"),f._uU(5,"____________________________________________________________________________-"),f.qZA()()),2&n){const t=e.$implicit;f.xp6(1),f.Q6J("ngForOf",t.items),f.xp6(2),f.hij(" Total ............................",t.total," ")}}const KU=[{path:"menu",component:WU},{path:"config",component:kU},{path:"order-list",component:(()=>{class n{constructor(t){this.cartService=t,this.orders=[]}ngOnInit(){this.cartService.getOrder().subscribe(t=>{t.forEach(r=>{let i=r.payload.doc.data();this.orders.push(i),console.log(this.orders)})})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(dO))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-order-list"]],decls:4,vars:1,consts:[[1,"col-lg-4","col-sm-2","h2","text-center"],[4,"ngFor","ngForOf"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"h2"),f._uU(2,"Select Items"),f.qZA(),f.YNc(3,ZU,6,2,"div",1),f.qZA()),2&t&&(f.xp6(3),f.Q6J("ngForOf",r.orders))},directives:[Pn],styles:[""]}),n})()}];let YU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[[tI.forRoot(KU)],tI]}),n})(),QU=(()=>{class n{constructor(){this.tittle="Logo"}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-toolbar"]],decls:21,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light"],[1,"container-fluid"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","href","#",1,"nav-link","active"],["href","#",1,"nav-link"],["href","#","tabindex","-1","aria-disabled","true",1,"nav-link","disabled"],[1,"d-flex"],["type","search","placeholder","Search","aria-label","Search",1,"form-control","me-2"],["type","submit",1,"btn","btn-outline-success"]],template:function(t,r){1&t&&(f.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),f._uU(3),f.qZA(),f.TgZ(4,"button",3),f._UZ(5,"span",4),f.qZA(),f.TgZ(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),f._uU(10,"Home"),f.qZA()(),f.TgZ(11,"li",7)(12,"a",9),f._uU(13,"Link"),f.qZA()(),f.TgZ(14,"li",7)(15,"a",10),f._uU(16,"Disabled"),f.qZA()()()()()(),f.TgZ(17,"form",11),f._UZ(18,"input",12),f.TgZ(19,"button",13),f._uU(20,"Search"),f.qZA()()),2&t&&(f.xp6(3),f.Oqu(r.tittle))},directives:[sl,Ja,iu],styles:[""]}),n})(),JU=(()=>{class n{constructor(){this.title="rest-mgmt-ui"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){1&t&&f._UZ(0,"app-toolbar")(1,"router-outlet")},directives:[QU,Jg],styles:[""]}),n})();const hO_firebaseConfig={apiKey:"AIzaSyA3Fy9lG9jmvv-x84lj92eB_DYatvqSlm8",authDomain:"rest-mgmt-system.firebaseapp.com",projectId:"rest-mgmt-system",storageBucket:"rest-mgmt-system.appspot.com",messagingSenderId:"521610699054",appId:"1:521610699054:web:39dfc2ab83c353b6aa5abf",measurementId:"G-DG400LRKPE"},fO="firebasestorage.googleapis.com",pO="storageBucket";class kr extends O.ZR{constructor(e,t){super(sR(e),`Firebase Storage: ${t} (${sR(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kr.prototype)}_codeEquals(e){return sR(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function sR(n){return"storage/"+n}function oR(){return new kr("unknown","An unknown error occurred, please check the error payload for server response.")}function gO(){return new kr("canceled","User canceled the upload/download.")}function mO(){return new kr("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function G_(n){return new kr("invalid-argument",n)}function _O(){return new kr("app-deleted","The Firebase app was deleted.")}function yO(n){return new kr("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gw(n,e){return new kr("invalid-format","String does not match format '"+n+"': "+e)}function mw(n){throw new kr("internal-error","Internal error: "+n)}class as{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=as.makeFromUrl(e,t)}catch(i){return new as(e,"")}if(""===r.path)return r;throw function lB(n){return new kr("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function v(dt){dt.path_=decodeURIComponent(dt.path)}const S=t.replace(/[.]/g,"\\."),pt=[{regex:h,indices:{bucket:1,path:3},postModify:function a(dt){"/"===dt.path.charAt(dt.path.length-1)&&(dt.path_=dt.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${S}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:v},{regex:new RegExp(`^https?://${t===fO?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:v}];for(let dt=0;dt<pt.length;dt++){const Rt=pt[dt],Ft=Rt.regex.exec(e);if(Ft){let Lu=Ft[Rt.indices.path];Lu||(Lu=""),r=new as(Ft[Rt.indices.bucket],Lu),Rt.postModify(r);break}}if(null==r)throw function uB(n){return new kr("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class fB{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Kb(n){return"string"==typeof n||n instanceof String}function vO(n){return aR()&&n instanceof Blob}function aR(){return"undefined"!=typeof Blob}function uR(n,e,t,r){if(r<e)throw G_(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw G_(`Invalid value for '${n}'. Expected ${t} or less.`)}function td(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function wO(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var Kh=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(Kh||(Kh={})),Kh))();class vB{constructor(e,t,r,i,a,l,h,m,v,D,S){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=m,this.timeout_=v,this.progressCallback_=D,this.connectionFactory_=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,V)=>{this.resolve_=N,this.reject_=V,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());!function mB(n){return void 0!==n}(m)?a():a(m)}catch(m){l(m)}else if(null!==h){const m=oR();m.serverResponse=h.getErrorText(),l(this.errorCallback_?this.errorCallback_(h,m):m)}else l(i.canceled?this.appDelete_?_O():gO():function aB(){return new kr("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new Yb(!1,null,!0)):this.backoffId_=function pB(n,e,t){let r=1,i=null,a=null,l=!1,h=0;function m(){return 2===h}let v=!1;function D(...Ae){v||(v=!0,e.apply(null,Ae))}function S(Ae){i=setTimeout(()=>{i=null,n(V,m())},Ae)}function N(){a&&clearTimeout(a)}function V(Ae,...at){if(v)return void N();if(Ae)return N(),void D.call(null,Ae,...at);if(m()||l)return N(),void D.call(null,Ae,...at);let pt;r<64&&(r*=2),1===h?(h=2,pt=0):pt=1e3*(r+Math.random()),S(pt)}let W=!1;function fe(Ae){W||(W=!0,N(),!v&&(null!==i?(Ae||(h=2),clearTimeout(i),S(0)):Ae||(h=1)))}return S(0),a=setTimeout(()=>{l=!0,fe(!0)},t),fe}((r,i)=>{if(i)return void r(!1,new Yb(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const h=a.getErrorCode()===Kh.NO_ERROR,m=a.getStatus();if(!h||this.isRetryStatusCode_(m)){const D=a.getErrorCode()===Kh.ABORT;return void r(!1,new Yb(!1,null,D))}const v=-1!==this.successCodes_.indexOf(m);r(!0,new Yb(v,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function gB(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,i=-1!==[408,429].indexOf(e),a=-1!==this.additionalRetryCodes_.indexOf(e);return t||i||a}}class Yb{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function TB(...n){const e=function DB(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(aR())return new Blob(n);throw new kr("unsupported-environment","This browser doesn't seem to support creating Blobs")}const $o={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class lR{constructor(e,t){this.data=e,this.contentType=t||null}}function cR(n,e){switch(n){case $o.RAW:return new lR(EO(e));case $o.BASE64:case $o.BASE64URL:return new lR(IO(n,e));case $o.DATA_URL:return new lR(function RB(n){const e=new CO(n);return e.base64?IO($o.BASE64,e.rest):function xB(n){let e;try{e=decodeURIComponent(n)}catch(t){throw gw($o.DATA_URL,"Malformed data URL.")}return EO(e)}(e.rest)}(e),function MB(n){return new CO(n).contentType}(e))}throw oR()}function EO(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function IO(n,e){switch(n){case $o.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw gw(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case $o.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw gw(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function AB(n){return atob(n)}(e)}catch(i){throw gw(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class CO{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw gw($o.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function NB(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class kl{constructor(e,t){let r=0,i="";vO(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(vO(this.data_)){const i=function SB(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new kl(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new kl(r,!0)}}static getBlob(...e){if(aR()){const t=e.map(r=>r instanceof kl?r.data_:r);return new kl(TB.apply(null,t))}{const t=e.map(l=>Kb(l)?cR($o.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let h=0;h<l.length;h++)i[a++]=l[h]}),new kl(i,!0)}}uploadData(){return this.data_}}function dR(n){let e;try{e=JSON.parse(n)}catch(t){return null}return function yB(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function bO(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function kB(n,e){return e}class Us{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||kB}}let Qb=null;function _w(){if(Qb)return Qb;const n=[];n.push(new Us("bucket")),n.push(new Us("generation")),n.push(new Us("metageneration")),n.push(new Us("name","fullPath",!0));const t=new Us("name");t.xform=function e(a,l){return function FB(n){return!Kb(n)||n.length<2?n:bO(n)}(l)},n.push(t);const i=new Us("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new Us("timeCreated")),n.push(new Us("updated")),n.push(new Us("md5Hash",null,!0)),n.push(new Us("cacheControl",null,!0)),n.push(new Us("contentDisposition",null,!0)),n.push(new Us("contentEncoding",null,!0)),n.push(new Us("contentLanguage",null,!0)),n.push(new Us("contentType",null,!0)),n.push(new Us("metadata","customMetadata",!0)),Qb=n,Qb}function DO(n,e,t){const r=dR(e);return null===r?null:function VB(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function LB(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new as(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function hR(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const TO="prefixes";class Fl{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ll(n){if(!n)throw oR()}function Jb(n,e){return function t(r,i){const a=DO(n,i,e);return Ll(null!==a),a}}function q_(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function sB(){return new kr("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function iB(){return new kr("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function rB(n){return new kr("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function oB(n){return new kr("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.serverResponse=r.serverResponse,i}}function yw(n){const e=q_(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function nB(n){return new kr("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function AO(n,e,t){const i=td(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Fl(i,"GET",Jb(n,t),l);return h.errorHandler=yw(e),h}function GB(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=td(e.bucketOnlyServerUrl(),n.host,n._protocol),v=n.maxOperationRetryTime,D=new Fl(h,"GET",function HB(n,e){return function t(r,i){const a=function jB(n,e,t){const r=dR(t);return null===r?null:function BB(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[TO])for(const i of t[TO]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new as(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new as(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return Ll(null!==a),a}}(n,e.bucket),v);return D.urlParams=a,D.errorHandler=q_(e),D}function RO(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function ZB(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class Xb{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function fR(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch(i){Ll(!1)}return Ll(!!t&&-1!==(e||["active"]).indexOf(t)),t}const JB={STATE_CHANGED:"state_changed"},Bs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function pR(n){switch(n){case"running":case"pausing":case"canceling":return Bs.RUNNING;case"paused":return Bs.PAUSED;case"success":return Bs.SUCCESS;case"canceled":return Bs.CANCELED;default:return Bs.ERROR}}class XB{constructor(e,t,r){if(function _B(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=r?r:void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function W_(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class t2 extends class e2{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Kh.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Kh.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Kh.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw mw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mw("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw mw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function Nu(){return new t2}class OO{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=_w(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function KB(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=RO(e,r,i),h={name:l.fullPath},m=td(a,n.host,n._protocol),D={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},S=hR(l,t),W=new Fl(m,"POST",function V(fe){let Ae;fR(fe);try{Ae=fe.getResponseHeader("X-Goog-Upload-URL")}catch(at){Ll(!1)}return Ll(Kb(Ae)),Ae},n.maxUploadRetryTime);return W.urlParams=h,W.headers=D,W.body=S,W.errorHandler=q_(e),W}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Nu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function YB(n,e,t,r){const m=new Fl(t,"POST",function a(v){const D=fR(v,["active","final"]);let S=null;try{S=v.getResponseHeader("X-Goog-Upload-Size-Received")}catch(V){Ll(!1)}S||Ll(!1);const N=Number(S);return Ll(!isNaN(N)),new Xb(N,r.size(),"final"===D)},n.maxUploadRetryTime);return m.headers={"X-Goog-Upload-Command":"query"},m.errorHandler=q_(e),m}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,Nu,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new Xb(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function QB(n,e,t,r,i,a,l,h){const m=new Xb(0,0);if(l?(m.current=l.current,m.total=l.total):(m.current=0,m.total=r.size()),r.size()!==m.total)throw function dB(){return new kr("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const v=m.total-m.current;let D=v;i>0&&(D=Math.min(D,i));const S=m.current,W={"X-Goog-Upload-Command":D===v?"upload, finalize":"upload","X-Goog-Upload-Offset":`${m.current}`},fe=r.slice(S,S+D);if(null===fe)throw mO();const pt=new Fl(t,"POST",function Ae(dt,Rt){const Ft=fR(dt,["active","final"]),Tr=m.current+D,Lu=r.size();let SM;return SM="final"===Ft?Jb(e,a)(dt,Rt):null,new Xb(Tr,Lu,"final"===Ft,SM)},e.maxUploadRetryTime);return pt.headers=W,pt.body=fe.uploadData(),pt.progressCallback=h||null,pt.errorHandler=q_(n),pt}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(m){return this._error=m,void this._transition("error")}const h=this._ref.storage._makeRequest(l,Nu,i,a);this._request=h,h.getPromise().then(m=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(m.current),m.finalized?(this._metadata=m.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=AO(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Nu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function MO(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},m=function h(){let pt="";for(let dt=0;dt<2;dt++)pt+=Math.random().toString().slice(2);return pt}();l["Content-Type"]="multipart/related; boundary="+m;const v=RO(e,r,i),D=hR(v,t),V=kl.getBlob("--"+m+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+D+"\r\n--"+m+"\r\nContent-Type: "+v.contentType+"\r\n\r\n",r,"\r\n--"+m+"--");if(null===V)throw mO();const W={name:v.fullPath},fe=td(a,n.host,n._protocol),at=n.maxUploadRetryTime,ft=new Fl(fe,"POST",Jb(n,t),at);return ft.urlParams=W,ft.headers=l,ft.body=V.uploadData(),ft.errorHandler=q_(e),ft}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Nu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=gO(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=pR(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new XB(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(pR(this._state)){case Bs.SUCCESS:W_(this._resolve.bind(null,this.snapshot))();break;case Bs.CANCELED:case Bs.ERROR:W_(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(pR(this._state)){case Bs.RUNNING:case Bs.PAUSED:e.next&&W_(e.next.bind(e,this.snapshot))();break;case Bs.SUCCESS:e.complete&&W_(e.complete.bind(e))();break;default:e.error&&W_(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Xp{constructor(e,t){this._service=e,this._location=t instanceof as?t:as.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xp(e,t)}get root(){const e=new as(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bO(this._location.path)}get storage(){return this._service}get parent(){const e=function PB(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new as(this._location.bucket,e);return new Xp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw yO(e)}}function FO(n,e,t){return gR.apply(this,arguments)}function gR(){return gR=(0,Ee.Z)(function*(n,e,t){const i=yield LO(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield FO(n,e,i.nextPageToken))}),gR.apply(this,arguments)}function LO(n,e){null!=e&&"number"==typeof e.maxResults&&uR("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=GB(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Nu)}function f2(n){n._throwIfRoot("getDownloadURL");const e=function qB(n,e,t){const i=td(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Fl(i,"GET",function $B(n,e){return function t(r,i){const a=DO(n,i,e);return Ll(null!==a),function UB(n,e,t,r){const i=dR(e);if(null===i||!Kb(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(v=>{const S=n.fullPath;return td("/b/"+l(n.bucket)+"/o/"+l(S),t,r)+wO({alt:"media",token:v})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return h.errorHandler=yw(e),h}(n.storage,n._location,_w());return n.storage.makeRequestWithTokens(e,Nu).then(t=>{if(null===t)throw function hB(){return new kr("no-download-url","The given file does not have any download URLs.")}();return t})}function VO(n,e){const t=function OB(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new as(n._location.bucket,t);return new Xp(n.storage,r)}function UO(n,e){if(n instanceof mR){const t=n;if(null==t._bucket)throw function cB(){return new kr("no-default-bucket","No default bucket found. Did you set the '"+pO+"' property when initializing the app?")}();const r=new Xp(t,t._bucket);return null!=e?UO(r,e):r}return void 0!==e?VO(n,e):n}function _2(n,e){if(e&&function g2(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof mR)return function m2(n,e){return new Xp(n,e)}(n,e);throw G_("To use ref(service, url), the first argument must be a Storage instance.")}return UO(n,e)}function BO(n,e){const t=null==e?void 0:e[pO];return null==t?null:as.makeFromBucketSpec(t,n)}class mR{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=fO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?as.makeFromBucketSpec(i,this._host):BO(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?as.makeFromBucketSpec(this._url,e):BO(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Ee.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Ee.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xp(this,e)}_makeRequest(e,t,r,i){if(this._deleted)return new fB(_O());{const a=function bB(n,e,t,r,i,a){const l=wO(n.urlParams),h=n.url+l,m=Object.assign({},n.headers);return function IB(n,e){e&&(n["X-Firebase-GMPID"]=e)}(m,e),function wB(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(m,t),function EB(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(m,a),function CB(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(m,r),new vB(h,n.method,m,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i)}(e,this._appId,r,i,t,this._firebaseVersion);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){var r=this;return(0,Ee.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const jO="@firebase/storage";function GO(n,e){return _2(n=(0,O.m9)(n),e)}function A2(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new mR(t,r,i,e,ns.SDK_VERSION)}!function x2(){(0,ns._registerComponent)(new lo.wA("storage",A2,"PUBLIC").setMultipleInstances(!0)),(0,ns.registerVersion)(jO,"0.9.9",""),(0,ns.registerVersion)(jO,"0.9.9","esm2017")}();class eD{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class qO{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new eD(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new eD(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new eD(l,this,this._ref)):{next:t.next?l=>t.next(new eD(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class WO{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new nd(e,this._service))}get items(){return this._delegate.items.map(e=>new nd(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class nd{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function T2(n,e){return VO(n,e)}(this._delegate,e);return new nd(t,this.storage)}get root(){return new nd(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new nd(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new qO(function v2(n,e,t){return function u2(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new OO(n,new kl(e),t)}(n=(0,O.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=$o.RAW,r){this._throwIfRoot("putString");const i=cR(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new qO(new OO(this._delegate,new kl(i.data,!0),a),this)}listAll(){return function C2(n){return function c2(n){const e={prefixes:[],items:[]};return FO(n,e).then(()=>e)}(n=(0,O.m9)(n))}(this._delegate).then(e=>new WO(e,this.storage))}list(e){return function I2(n,e){return LO(n=(0,O.m9)(n),e)}(this._delegate,e||void 0).then(t=>new WO(t,this.storage))}getMetadata(){return function w2(n){return function d2(n){n._throwIfRoot("getMetadata");const e=AO(n.storage,n._location,_w());return n.storage.makeRequestWithTokens(e,Nu)}(n=(0,O.m9)(n))}(this._delegate)}updateMetadata(e){return function E2(n,e){return function h2(n,e){n._throwIfRoot("updateMetadata");const t=function WB(n,e,t,r){const a=td(e.fullServerUrl(),n.host,n._protocol),h=hR(t,r),v=n.maxOperationRetryTime,D=new Fl(a,"PATCH",Jb(n,r),v);return D.headers={"Content-Type":"application/json; charset=utf-8"},D.body=h,D.errorHandler=yw(e),D}(n.storage,n._location,e,_w());return n.storage.makeRequestWithTokens(t,Nu)}(n=(0,O.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function b2(n){return f2(n=(0,O.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function D2(n){return function p2(n){n._throwIfRoot("deleteObject");const e=function zB(n,e){const r=td(e.fullServerUrl(),n.host,n._protocol),h=new Fl(r,"DELETE",function l(m,v){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=yw(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Nu)}(n=(0,O.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw yO(e)}}class zO{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(ZO(e))throw G_("ref() expected a child path but got a URL, use refFromURL instead.");return new nd(GO(this._delegate,e),this)}refFromURL(e){if(!ZO(e))throw G_("refFromURL() expected a full URL but got a child path, use ref() instead.");try{as.makeFromUrl(e,this._delegate.host)}catch(t){throw G_("refFromUrl() expected a valid full URL but got an invalid one.")}return new nd(GO(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function S2(n,e,t,r={}){!function y2(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,O.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function ZO(n){return/^[A-Za-z]+:\/\//.test(n)}function P2(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new zO(t,r)}function KO(n){const e=function k2(n){return new Es.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function XU(n,e=cm.z){return(0,xr.e)((t,r)=>{let i=null,a=null,l=null;const h=()=>{if(i){i.unsubscribe(),i=null;const v=a;a=null,r.next(v)}};function m(){const v=l+n,D=e.now();if(D<v)return i=this.schedule(void 0,v-D),void r.add(i);h()}t.subscribe((0,er.x)(r,v=>{a=v,l=e.now(),i||(i=e.schedule(m,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,wt.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function tD(n){return{getDownloadURL:()=>ut(void 0).pipe(hn.fc,Xr(()=>n.getDownloadURL()),hn.iC),getMetadata:()=>ut(void 0).pipe(hn.fc,Xr(()=>n.getMetadata()),hn.iC),delete:()=>(0,En.D)(n.delete()),child:e=>tD(n.child(e)),updateMetadata:e=>(0,En.D)(n.updateMetadata(e)),put:(e,t)=>KO(n.put(e,t)),putString:(e,t,r)=>KO(n.putString(e,t,r)),list:e=>(0,En.D)(n.list(e)),listAll:()=>(0,En.D)(n.listAll())}}!function O2(n){const e={TaskState:Bs,TaskEvent:JB,StringFormat:$o,Storage:zO,Reference:nd};n.INTERNAL.registerComponent(new lo.wA("storage-compat",P2,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.17")}(hv.Z);const F2=new f.OlP("angularfire2.storageBucket"),L2=new f.OlP("angularfire2.storage.maxUploadRetryTime"),V2=new f.OlP("angularfire2.storage.maxOperationRetryTime"),U2=new f.OlP("angularfire2.storage.use-emulator");let B2=(()=>{class n{constructor(t,r,i,a,l,h,m,v,D,S){const N=(0,$r.on)(t,l,r);this.storage=(0,$r.cc)(`${N.name}.storage.${i}`,"AngularFireStorage",N.name,()=>{const V=l.runOutsideAngular(()=>N.storage(i||void 0)),W=D;return W&&V.useEmulator(...W),m&&V.setMaxUploadRetryTime(m),v&&V.setMaxOperationRetryTime(v),V},[m,v])}ref(t){return tD(this.storage.ref(t))}refFromURL(t){return tD(this.storage.refFromURL(t))}upload(t,r,i){return tD(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG($r.Dh),f.LFG($r.xv,8),f.LFG(F2,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(hn.HU),f.LFG(L2,8),f.LFG(V2,8),f.LFG(U2,8),f.LFG(hw,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),j2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),H2=(()=>{class n{constructor(){zb.Z.registerVersion("angularfire",hn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[B2],imports:[j2]}),n})();var $2=F(5032);const YO="@firebase/database";let _R="";function JO(n){_R=n}class W2{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,O.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,O.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class z2{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,O.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const XO=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new W2(e)}}catch(e){}return new z2},eg=XO("localStorage"),yR=XO("sessionStorage"),z_=new ko.Yd("@firebase/database"),ek=function(){let n=1;return function(){return n++}}(),tk=function(n){const e=(0,O.dS)(n),t=new O.gQ;t.update(e);const r=t.digest();return O.US.encodeByteArray(r)},vw=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=vw.apply(null,r):e+="object"==typeof r?(0,O.Pz)(r):r,e+=" "}return e};let tg=null,nk=!0;const rk=function(n,e){(0,O.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(z_.logLevel=ko.in.VERBOSE,tg=z_.log.bind(z_),e&&yR.set("logging_enabled",!0)):"function"==typeof n?tg=n:(tg=null,yR.remove("logging_enabled"))},xi=function(...n){if(!0===nk&&(nk=!1,null===tg&&!0===yR.get("logging_enabled")&&rk(!0)),tg){const e=vw.apply(null,n);tg(e)}},ww=function(n){return function(...e){xi(n,...e)}},vR=function(...n){const e="FIREBASE INTERNAL ERROR: "+vw(...n);z_.error(e)},Vl=function(...n){const e=`FIREBASE FATAL ERROR: ${vw(...n)}`;throw z_.error(e),new Error(e)},us=function(...n){const e="FIREBASE WARNING: "+vw(...n);z_.warn(e)},nD=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},rd="[MIN_NAME]",Ul="[MAX_NAME]",ng=function(n,e){if(n===e)return 0;if(n===rd||e===Ul)return-1;if(e===rd||n===Ul)return 1;{const t=rD(n),r=rD(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},Y2=function(n,e){return n===e?0:n<e?-1:1},Ew=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,O.Pz)(e))},wR=function(n){if("object"!=typeof n||null===n)return(0,O.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,O.Pz)(e[r]),t+=":",t+=wR(n[e[r]]);return t+="}",t},ik=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Ri(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const sk=function(n){(0,O.hu)(!nD(n),"Invalid JSON number");const r=1023;let i,a,l,h,m;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const v=[];for(m=52;m;m-=1)v.push(l%2?1:0),l=Math.floor(l/2);for(m=11;m;m-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const D=v.join("");let S="";for(m=0;m<64;m+=8){let N=parseInt(D.substr(m,8),2).toString(16);1===N.length&&(N="0"+N),S+=N}return S.toLowerCase()},ej=new RegExp("^-?(0*)\\d{1,10}$"),ok=-2147483648,ER=2147483647,rD=function(n){if(ej.test(n)){const e=Number(n);if(e>=ok&&e<=ER)return e}return null},Z_=function(n){try{n()}catch(e){setTimeout(()=>{throw us("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},Iw=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class nj{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){us(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class rj{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(xi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',us(e)}}let Cw=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const dk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pk="websocket",gk="long_polling";class CR{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=eg.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&eg.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function mk(n,e,t){let r;if((0,O.hu)("string"==typeof e,"typeof type must == string"),(0,O.hu)("object"==typeof t,"typeof params must == object"),e===pk)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==gk)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function ij(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Ri(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class sj{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,O.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,O.p$)(this.counters_)}}const bR={},DR={};function TR(n){const e=n.toString();return bR[e]||(bR[e]=new sj),bR[e]}class aj{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Z_(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Yh{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ww(e),this.stats_=TR(t),this.urlFn=m=>(this.appCheckToken&&(m.ac=this.appCheckToken),mk(t,gk,m))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new aj(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,O.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new SR((...a)=>{const[l,h,m,v,D]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=m;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&dk.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Yh.forceAllow_=!0}static forceDisallow(){Yh.forceDisallow_=!0}static isAvailable(){return!((0,O.Yr)()||!Yh.forceAllow_&&(Yh.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,O.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,O.h$)(t),i=ik(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,O.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,O.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class SR{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,O.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=ek(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=SR.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){xi("frame writing exception"),h.stack&&xi(h.stack),xi(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||xi("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,O.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{xi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(r){}},Math.floor(1))}}let sD=null;"undefined"!=typeof MozWebSocket?sD=MozWebSocket:"undefined"!=typeof WebSocket&&(sD=WebSocket);let K_=(()=>{class n{constructor(t,r,i,a,l,h,m){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ww(this.connId),this.stats_=TR(r),this.connURL=n.connectionURL_(r,h,m,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,O.Yr)()&&"undefined"!=typeof location&&location.hostname&&dk.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),mk(t,pk,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,eg.set("previous_websocket_failure",!0);try{let i;if((0,O.Yr)()){i={headers:{"User-Agent":`Firebase/5/${_R}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new sD(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==sD&&!n.forceDisallow_}static previouslyFailed(){return eg.isInMemoryStorage||!0===eg.get("previous_websocket_failure")}markConnectionHealthy(){eg.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,O.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,O.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,O.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=ik(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Ck=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Yh,K_]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=K_&&K_.isAvailable();let i=r&&!K_.previouslyFailed();if(t.webSocketOnly&&(r||us("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[K_];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Rk{constructor(e,t,r,i,a,l,h,m,v,D){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=m,this.onKill_=v,this.lastSessionId=D,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ww("c:"+this.id+":"),this.transportManager_=new Ck(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Iw(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ew("t",e),r=Ew("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ew("t",e),r=Ew("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ew("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?vR("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vR("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&us("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Iw(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Iw(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(eg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Mk{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class Nk{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,O.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,O.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class oD extends Nk{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,O.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new oD}getInitialEvent(e){return(0,O.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class xn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function In(){return new xn("")}function en(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Qh(n){return n.pieces_.length-n.pieceNum_}function $n(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new xn(n.pieces_,e)}function xR(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function bw(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function kk(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new xn(e,0)}function mr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof xn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new xn(t,0)}function tn(n){return n.pieceNum_>=n.pieces_.length}function js(n,e){const t=en(n),r=en(e);if(null===t)return e;if(t===r)return js($n(n),$n(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function xj(n,e){const t=bw(n,0),r=bw(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=ng(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function RR(n,e){if(Qh(n)!==Qh(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Na(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Qh(n)>Qh(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class Rj{constructor(e,t){this.errorPrefix_=t,this.parts_=bw(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,O.ug)(this.parts_[r]);Fk(this)}}function Fk(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+rg(n))}function rg(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class MR extends Nk{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new MR}getInitialEvent(e){return(0,O.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Dw=1e3;let uD,ig=(()=>{class n extends Mk{constructor(t,r,i,a,l,h,m,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=m,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=ww("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Dw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,O.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");MR.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&oD.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,O.Pz)(l)),(0,O.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new O.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:h=>{const m=h.d;"ok"===h.s?r.resolve(m):r.reject(m)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,O.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,O.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const m={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,m),this.connected_&&this.sendListen_(m)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,m=>{const v=m.d,D=m.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",m),"ok"!==D&&this.removeListen_(i,a),t.onComplete&&t.onComplete(D,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,O.r3)(t,"w")){const i=(0,O.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();us(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,O.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,O.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,O.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,O.Pz)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):vR("Unrecognized action received from server: "+(0,O.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,O.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Dw,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Dw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Dw),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Ee.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let m=!1,v=null;const D=function(){v?v.close():(m=!0,a())};t.realtime_={close:D,sendRequest:function(V){(0,O.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(V)}};const N=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[V,W]=yield Promise.all([t.authTokenProvider_.getToken(N),t.appCheckTokenProvider_.getToken(N)]);m?xi("getToken() completed but was canceled"):(xi("getToken() completed. Creating connection."),t.authToken_=V&&V.accessToken,t.appCheckToken_=W&&W.token,v=new Rk(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,fe=>{us(fe+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(V){t.log_("Failed to get token: "+V),m||(t.repoInfo_.nodeAdmin&&us(V),D())}}})()}interrupt(t){xi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){xi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,O.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Dw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>wR(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new xn(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){xi("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){xi("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,O.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+_R.replace(/\./g,"-")]=1,(0,O.uI)()?t["framework.cordova"]=1:(0,O.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=oD.getInstance().currentlyOnline();return(0,O.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class on{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new on(e,t)}}class aD{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new on(rd,e),i=new on(rd,t);return 0!==this.compare(r,i)}minPost(){return on.MIN}}class Uk extends aD{static get __EMPTY_NODE(){return uD}static set __EMPTY_NODE(e){uD=e}compare(e,t){return ng(e.name,t.name)}isDefinedOn(e){throw(0,O.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return on.MIN}maxPost(){return new on(Ul,uD)}makePost(e,t){return(0,O.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new on(e,uD)}toString(){return".key"}}const Bl=new Uk;class lD{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let PR,Pu=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=null!=i?i:n.RED,this.left=null!=a?a:fo.EMPTY_NODE,this.right=null!=l?l:fo.EMPTY_NODE}copy(t,r,i,a,l){return new n(null!=t?t:this.key,null!=r?r:this.value,null!=i?i:this.color,null!=a?a:this.left,null!=l?l:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return fo.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return fo.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class fo{constructor(e,t=fo.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new fo(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Pu.BLACK,null,null))}remove(e){return new fo(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Pu.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new lD(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new lD(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new lD(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new lD(this.root_,null,this.comparator_,!0,e)}}function Vj(n,e){return ng(n.name,e.name)}function NR(n,e){return ng(n,e)}fo.EMPTY_NODE=new class Lj{copy(e,t,r,i,a){return this}insert(e,t,r){return new Pu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Bk=function(n){return"number"==typeof n?"number:"+sk(n):"string:"+n},jk=function(n){if(n.isLeafNode()){const e=n.val();(0,O.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,O.r3)(e,".sv"),"Priority must be a string or number.")}else(0,O.hu)(n===PR||n.isEmpty(),"priority of unexpected type.");(0,O.hu)(n===PR||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Hk,$k,Gk,Y_=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,O.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),jk(this.priorityNode_)}static set __childrenNodeConstructor(t){Hk=t}static get __childrenNodeConstructor(){return Hk}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return tn(t)?this:".priority"===en(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=en(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,O.hu)(".priority"!==i||1===Qh(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild($n(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Bk(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?sk(this.value_):this.value_,this.lazyHash_=tk(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,O.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,O.hu)(a>=0,"Unknown leaf type: "+r),(0,O.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Yn=new class Hj extends aD{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?ng(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return on.MIN}maxPost(){return new on(Ul,new Y_("[PRIORITY-POST]",Gk))}makePost(e,t){const r=$k(e);return new on(t,new Y_("[PRIORITY-POST]",r))}toString(){return".priority"}},$j=Math.log(2);class Gj{constructor(e){this.count=parseInt(Math.log(e+1)/$j,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const cD=function(n,e,t,r){n.sort(e);const i=function(m,v){const D=v-m;let S,N;if(0===D)return null;if(1===D)return S=n[m],N=t?t(S):S,new Pu(N,S.node,Pu.BLACK,null,null);{const V=parseInt(D/2,10)+m,W=i(m,V),fe=i(V+1,v);return S=n[V],N=t?t(S):S,new Pu(N,S.node,Pu.BLACK,W,fe)}},h=function(m){let v=null,D=null,S=n.length;const N=function(W,fe){const Ae=S-W,at=S;S-=W;const ft=i(Ae+1,at),pt=n[Ae],dt=t?t(pt):pt;V(new Pu(dt,pt.node,fe,null,ft))},V=function(W){v?(v.left=W,v=W):(D=W,v=W)};for(let W=0;W<m.count;++W){const fe=m.nextBitIsOne(),Ae=Math.pow(2,m.count-(W+1));fe?N(Ae,Pu.BLACK):(N(Ae,Pu.BLACK),N(Ae,Pu.RED))}return D}(new Gj(n.length));return new fo(r||e,h)};let OR;const Q_={};class id{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,O.hu)(Q_&&Yn,"ChildrenNode.ts has not been loaded"),OR=OR||new id({".priority":Q_},{".priority":Yn}),OR}get(e){const t=(0,O.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof fo?t:null}hasIndex(e){return(0,O.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,O.hu)(e!==Bl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(on.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?cD(r,e.getCompare()):Q_;const m=e.toString(),v=Object.assign({},this.indexSet_);v[m]=e;const D=Object.assign({},this.indexes_);return D[m]=h,new id(D,v)}addToIndexes(e,t){const r=(0,O.UI)(this.indexes_,(i,a)=>{const l=(0,O.DV)(this.indexSet_,a);if((0,O.hu)(l,"Missing index implementation for "+a),i===Q_){if(l.isDefinedOn(e.node)){const h=[],m=t.getIterator(on.Wrap);let v=m.getNext();for(;v;)v.name!==e.name&&h.push(v),v=m.getNext();return h.push(e),cD(h,l.getCompare())}return Q_}{const h=t.get(e.name);let m=i;return h&&(m=m.remove(new on(e.name,h))),m.insert(e,e.node)}});return new id(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,O.UI)(this.indexes_,i=>{if(i===Q_)return i;{const a=t.get(e.name);return a?i.remove(new on(e.name,a)):i}});return new id(r,this.indexSet_)}}let Tw,Wt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&jk(this.priorityNode_),this.children_.isEmpty()&&(0,O.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Tw||(Tw=new n(new fo(NR),null,id.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Tw}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Tw:r}}getChild(t){const r=en(t);return null===r?this:this.getImmediateChild(r).getChild($n(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,O.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new on(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?Tw:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=en(t);if(null===i)return r;{(0,O.hu)(".priority"!==en(t)||1===Qh(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild($n(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(Yn,(h,m)=>{r[h]=m.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const m in r)h[m]=r[m];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Bk(this.getPriority().val())+":"),this.forEachChild(Yn,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":tk(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new on(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new on(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new on(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,on.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,on.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Sw?-1:0}withIndex(t){if(t===Bl||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Bl||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Yn),a=r.getIterator(Yn);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===Bl?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Sw=new class qj extends Wt{constructor(){super(new fo(NR),Wt.EMPTY_NODE,id.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Wt.EMPTY_NODE}isEmpty(){return!1}};function Dr(n,e=null){if(null===n)return Wt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,O.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Y_(n,Dr(e));if(n instanceof Array){let t=Wt.EMPTY_NODE;return Ri(n,(r,i)=>{if((0,O.r3)(n,r)&&"."!==r.substring(0,1)){const a=Dr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Dr(e))}{const t=[];let r=!1;if(Ri(n,(l,h)=>{if("."!==l.substring(0,1)){const m=Dr(h);m.isEmpty()||(r=r||!m.getPriority().isEmpty(),t.push(new on(l,m)))}}),0===t.length)return Wt.EMPTY_NODE;const a=cD(t,Vj,l=>l.name,NR);if(r){const l=cD(t,Yn.getCompare());return new Wt(a,Dr(e),new id({".priority":l},{".priority":Yn}))}return new Wt(a,Dr(e),id.Default)}}Object.defineProperties(on,{MIN:{value:new on(rd,Wt.EMPTY_NODE)},MAX:{value:new on(Ul,Sw)}}),Uk.__EMPTY_NODE=Wt.EMPTY_NODE,Y_.__childrenNodeConstructor=Wt,function Uj(n){PR=n}(Sw),function jj(n){Gk=n}(Sw),function Bj(n){$k=n}(Dr);class kR extends aD{constructor(e){super(),this.indexPath_=e,(0,O.hu)(!tn(e)&&".priority"!==en(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?ng(e.name,t.name):a}makePost(e,t){const r=Dr(e),i=Wt.EMPTY_NODE.updateChild(this.indexPath_,r);return new on(t,i)}maxPost(){const e=Wt.EMPTY_NODE.updateChild(this.indexPath_,Sw);return new on(Ul,e)}toString(){return bw(this.indexPath_,0).join("/")}}const FR=new class zj extends aD{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?ng(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return on.MIN}maxPost(){return on.MAX}makePost(e,t){const r=Dr(e);return new on(t,r)}toString(){return".value"}},J_="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Zj=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=J_.charAt(t%64),t=Math.floor(t/64);(0,O.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=J_.charAt(e[i]);return(0,O.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),zk=function(n){if(n===""+ER)return"-";const e=rD(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Ul;const a=J_.charAt(J_.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},Zk=function(n){if(n===""+ok)return rd;const e=rD(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+ER:(delete t[t.length-1],t.join("")):(t[t.length-1]=J_.charAt(J_.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function Kk(n){return{type:"value",snapshotNode:n}}function X_(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Aw(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function xw(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class VR{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,O.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(Aw(t,h)):(0,O.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?l.trackChildChange(X_(t,r)):l.trackChildChange(xw(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Yn,(i,a)=>{t.hasChild(i)||r.trackChildChange(Aw(i,a))}),t.isLeafNode()||t.forEachChild(Yn,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(xw(i,a,l))}else r.trackChildChange(X_(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Wt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Rw{constructor(e){this.indexedFilter_=new VR(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Rw.getStartPost_(e),this.endPost_=Rw.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new on(t,r))||(r=Wt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Wt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Wt.EMPTY_NODE);const a=this;return t.forEachChild(Yn,(l,h)=>{a.matches(new on(l,h))||(i=i.updateImmediateChild(l,Wt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Yj{constructor(e){this.rangedFilter_=new Rw(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new on(t,r))||(r=Wt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Wt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=Wt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const h=a.getNext();let m;if(m=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),h)<=0:this.index_.compare(h,this.rangedFilter_.getEndPost())<=0,!m)break;i=i.updateImmediateChild(h.name,h.node),l++}}else{let a,l,h,m;if(i=t.withIndex(this.index_),i=i.updatePriority(Wt.EMPTY_NODE),this.reverse_){m=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const S=this.index_.getCompare();h=(N,V)=>S(V,N)}else m=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();let v=0,D=!1;for(;m.hasNext();){const S=m.getNext();!D&&h(a,S)<=0&&(D=!0),D&&v<this.limit_&&h(S,l)<=0?v++:i=i.updateImmediateChild(S.name,Wt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const S=this.index_.getCompare();l=(N,V)=>S(V,N)}else l=this.index_.getCompare();const h=e;(0,O.hu)(h.numChildren()===this.limit_,"");const m=new on(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),D=this.rangedFilter_.matches(m);if(h.hasChild(t)){const S=h.getImmediateChild(t);let N=i.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=N&&(N.name===t||h.hasChild(N.name));)N=i.getChildAfterChild(this.index_,N,this.reverse_);const V=null==N?1:l(N,m);if(D&&!r.isEmpty()&&V>=0)return null!=a&&a.trackChildChange(xw(t,r,S)),h.updateImmediateChild(t,r);{null!=a&&a.trackChildChange(Aw(t,S));const fe=h.updateImmediateChild(t,Wt.EMPTY_NODE);return null!=N&&this.rangedFilter_.matches(N)?(null!=a&&a.trackChildChange(X_(N.name,N.node)),fe.updateImmediateChild(N.name,N.node)):fe}}return r.isEmpty()?e:D&&l(v,m)>=0?(null!=a&&(a.trackChildChange(Aw(v.name,v.node)),a.trackChildChange(X_(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,Wt.EMPTY_NODE)):e}}class dD{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Yn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,O.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,O.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:rd}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,O.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,O.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ul}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,O.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Yn}copy(){const e=new dD;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function UR(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function BR(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function hD(n,e){const t=n.copy();return t.index_=e,t}function Yk(n){const e={};if(n.isDefault())return e;let t;return n.index_===Yn?t="$priority":n.index_===FR?t="$value":n.index_===Bl?t="$key":((0,O.hu)(n.index_ instanceof kR,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,O.Pz)(t),n.startSet_&&(e.startAt=(0,O.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,O.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,O.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,O.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Qk(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Yn&&(e.i=n.index_.toString()),e}class fD extends Mk{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=ww("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,O.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=fD.getListenId_(e,r),h={};this.listens_[l]=h;const m=Yk(e._queryParams);this.restRequest_(a+".json",m,(v,D)=>{let S=D;if(404===v&&(S=null,v=null),null===v&&this.onDataUpdate_(a,S,!1,r),(0,O.DV)(this.listens_,l)===h){let N;N=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(N,null)}})}unlisten(e,t){const r=fD.getListenId_(e,t);delete this.listens_[r]}get(e){const t=Yk(e._queryParams),r=e._path.toString(),i=new O.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,O.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let m=null;if(h.status>=200&&h.status<300){try{m=(0,O.cI)(h.responseText)}catch(v){us("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,m)}else 401!==h.status&&404!==h.status&&us("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class nH{constructor(){this.rootNode_=Wt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function pD(){return{value:null,children:new Map}}function ey(n,e,t){if(tn(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=en(e);n.children.has(r)||n.children.set(r,pD()),ey(n.children.get(r),e=$n(e),t)}}function jR(n,e){if(tn(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Yn,(r,i)=>{ey(n,new xn(r),i)}),jR(n,e)}}if(n.children.size>0){const t=en(e);return e=$n(e),n.children.has(t)&&jR(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function HR(n,e,t){null!==n.value?t(e,n.value):function rH(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{HR(i,new xn(e.toString()+"/"+r),t)})}class iH{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ri(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class aH{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new iH(e);const r=1e4+2e4*Math.random();Iw(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Ri(e,(i,a)=>{a>0&&(0,O.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),Iw(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Pa=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Pa||(Pa={})),Pa))();function qR(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class gD{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Pa.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(tn(this.path)){if(null!=this.affectedTree.value)return(0,O.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new xn(e));return new gD(In(),t,this.revert)}}return(0,O.hu)(en(this.path)===e,"operationForChild called for unrelated child."),new gD($n(this.path),this.affectedTree,this.revert)}}class Mw{constructor(e,t){this.source=e,this.path=t,this.type=Pa.LISTEN_COMPLETE}operationForChild(e){return tn(this.path)?new Mw(this.source,In()):new Mw(this.source,$n(this.path))}}class sg{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Pa.OVERWRITE}operationForChild(e){return tn(this.path)?new sg(this.source,In(),this.snap.getImmediateChild(e)):new sg(this.source,$n(this.path),this.snap)}}class ty{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Pa.MERGE}operationForChild(e){if(tn(this.path)){const t=this.children.subtree(new xn(e));return t.isEmpty()?null:t.value?new sg(this.source,In(),t.value):new ty(this.source,In(),t)}return(0,O.hu)(en(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ty(this.source,$n(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Jh{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(tn(e))return this.isFullyInitialized()&&!this.filtered_;const t=en(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class uH{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Nw(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,m)=>function dH(n,e,t){if(null==e.childName||null==t.childName)throw(0,O.g5)("Should only compare child_ events.");const r=new on(e.childName,e.snapshotNode),i=new on(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,m)),l.forEach(h=>{const m=function cH(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(m,n.query_))})})}function mD(n,e){return{eventCache:n,serverCache:e}}function Pw(n,e,t,r){return mD(new Jh(e,t,r),n.serverCache)}function Xk(n,e,t,r){return mD(n.eventCache,new Jh(e,t,r))}function _D(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function og(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let WR;class Qn{constructor(e,t=(()=>(WR||(WR=new fo(Y2)),WR))()){this.value=e,this.children=t}static fromObject(e){let t=new Qn(null);return Ri(e,(r,i)=>{t=t.set(new xn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:In(),value:this.value};if(tn(e))return null;{const r=en(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue($n(e),t);return null!=a?{path:mr(new xn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(tn(e))return this;{const t=en(e),r=this.children.get(t);return null!==r?r.subtree($n(e)):new Qn(null)}}set(e,t){if(tn(e))return new Qn(t,this.children);{const r=en(e),a=(this.children.get(r)||new Qn(null)).set($n(e),t),l=this.children.insert(r,a);return new Qn(this.value,l)}}remove(e){if(tn(e))return this.children.isEmpty()?new Qn(null):new Qn(null,this.children);{const t=en(e),r=this.children.get(t);if(r){const i=r.remove($n(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new Qn(null):new Qn(this.value,a)}return this}}get(e){if(tn(e))return this.value;{const t=en(e),r=this.children.get(t);return r?r.get($n(e)):null}}setTree(e,t){if(tn(e))return t;{const r=en(e),a=(this.children.get(r)||new Qn(null)).setTree($n(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new Qn(this.value,l)}}fold(e){return this.fold_(In(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(mr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,In(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(tn(e))return null;{const a=en(e),l=this.children.get(a);return l?l.findOnPath_($n(e),mr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,In(),t)}foreachOnPath_(e,t,r){if(tn(e))return this;{this.value&&r(t,this.value);const i=en(e),a=this.children.get(i);return a?a.foreachOnPath_($n(e),mr(t,i),r):new Qn(null)}}foreach(e){this.foreach_(In(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(mr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Ou{constructor(e){this.writeTree_=e}static empty(){return new Ou(new Qn(null))}}function Ow(n,e,t){if(tn(e))return new Ou(new Qn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=js(i,e);return a=a.updateChild(l,t),new Ou(n.writeTree_.set(i,a))}{const i=new Qn(t),a=n.writeTree_.setTree(e,i);return new Ou(a)}}}function zR(n,e,t){let r=n;return Ri(t,(i,a)=>{r=Ow(r,mr(e,i),a)}),r}function e1(n,e){if(tn(e))return Ou.empty();{const t=n.writeTree_.setTree(e,new Qn(null));return new Ou(t)}}function ZR(n,e){return null!=ag(n,e)}function ag(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(js(t.path,e)):null}function t1(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Yn,(r,i)=>{e.push(new on(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new on(r,i.value))}),e}function Xh(n,e){if(tn(e))return n;{const t=ag(n,e);return new Ou(null!=t?new Qn(t):n.writeTree_.subtree(e))}}function KR(n){return n.writeTree_.isEmpty()}function ny(n,e){return n1(In(),n.writeTree_,e)}function n1(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,O.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=n1(mr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(mr(n,".priority"),r)),t}}function yD(n,e){return a1(e,n)}function _H(n,e){if(n.snap)return Na(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Na(mr(n.path,t),e))return!0;return!1}function vH(n){return n.visible}function r1(n,e,t){let r=Ou.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)Na(t,l)?(h=js(t,l),r=Ow(r,h,a.snap)):Na(l,t)&&(h=js(l,t),r=Ow(r,In(),a.snap.getChild(h)));else{if(!a.children)throw(0,O.g5)("WriteRecord should have .snap or .children");if(Na(t,l))h=js(t,l),r=zR(r,h,a.children);else if(Na(l,t))if(h=js(l,t),tn(h))r=zR(r,In(),a.children);else{const m=(0,O.DV)(a.children,en(h));if(m){const v=m.getChild($n(h));r=Ow(r,In(),v)}}}}}return r}function i1(n,e,t,r,i){if(r||i){const a=Xh(n.visibleWrites,e);return!i&&KR(a)?t:i||null!=t||ZR(a,In())?ny(r1(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(Na(v.path,e)||Na(e,v.path))},e),t||Wt.EMPTY_NODE):null}{const a=ag(n.visibleWrites,e);if(null!=a)return a;{const l=Xh(n.visibleWrites,e);return KR(l)?t:null!=t||ZR(l,In())?ny(l,t||Wt.EMPTY_NODE):null}}}function vD(n,e,t,r){return i1(n.writeTree,n.treePath,e,t,r)}function YR(n,e){return function wH(n,e,t){let r=Wt.EMPTY_NODE;const i=ag(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Yn,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=Xh(n.visibleWrites,e);return t.forEachChild(Yn,(l,h)=>{const m=ny(Xh(a,new xn(l)),h);r=r.updateImmediateChild(l,m)}),t1(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return t1(Xh(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function s1(n,e,t,r){return function EH(n,e,t,r,i){(0,O.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=mr(e,t);if(ZR(n.visibleWrites,a))return null;{const l=Xh(n.visibleWrites,a);return KR(l)?i.getChild(t):ny(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function wD(n,e){return function CH(n,e){return ag(n.visibleWrites,e)}(n.writeTree,mr(n.treePath,e))}function QR(n,e,t){return function IH(n,e,t,r){const i=mr(e,t),a=ag(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?ny(Xh(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function o1(n,e){return a1(mr(n.treePath,e),n.writeTree)}function a1(n,e){return{treePath:n,writeTree:e}}class SH{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,O.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,O.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,xw(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,Aw(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,X_(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,O.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,xw(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const u1=new class AH{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class JR{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Jh(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return QR(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:og(this.viewCache_),a=function TH(n,e,t,r,i,a){return function bH(n,e,t,r,i,a,l){let h;const m=Xh(n.visibleWrites,e),v=ag(m,In());if(null!=v)h=v;else{if(null==t)return[];h=ny(m,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const D=[],S=l.getCompare(),N=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let V=N.getNext();for(;V&&D.length<i;)0!==S(V,r)&&D.push(V),V=N.getNext();return D}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function l1(n,e,t,r,i,a){const l=e.eventCache;if(null!=wD(r,t))return e;{let h,m;if(tn(t))if((0,O.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=og(e),S=YR(r,v instanceof Wt?v:Wt.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),S,a)}else{const v=vD(r,og(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=en(t);if(".priority"===v){(0,O.hu)(1===Qh(t),"Can't have a priority with additional path components");const D=l.getNode();m=e.serverCache.getNode();const S=s1(r,t,D,m);h=null!=S?n.filter.updatePriority(D,S):l.getNode()}else{const D=$n(t);let S;if(l.isCompleteForChild(v)){m=e.serverCache.getNode();const N=s1(r,t,l.getNode(),m);S=null!=N?l.getNode().getImmediateChild(v).updateChild(D,N):l.getNode().getImmediateChild(v)}else S=QR(r,v,e.serverCache);h=null!=S?n.filter.updateChild(l.getNode(),v,S,D,i,a):l.getNode()}}return Pw(e,h,l.isFullyInitialized()||tn(t),n.filter.filtersNodes())}}function ED(n,e,t,r,i,a,l,h){const m=e.serverCache;let v;const D=l?n.filter:n.filter.getIndexedFilter();if(tn(t))v=D.updateFullNode(m.getNode(),r,null);else if(D.filtersNodes()&&!m.isFiltered()){const V=m.getNode().updateChild(t,r);v=D.updateFullNode(m.getNode(),V,null)}else{const V=en(t);if(!m.isCompleteForPath(t)&&Qh(t)>1)return e;const W=$n(t),Ae=m.getNode().getImmediateChild(V).updateChild(W,r);v=".priority"===V?D.updatePriority(m.getNode(),Ae):D.updateChild(m.getNode(),V,Ae,W,u1,null)}const S=Xk(e,v,m.isFullyInitialized()||tn(t),D.filtersNodes());return l1(n,S,t,i,new JR(i,S,a),h)}function XR(n,e,t,r,i,a,l){const h=e.eventCache;let m,v;const D=new JR(i,e,a);if(tn(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,l),m=Pw(e,v,!0,n.filter.filtersNodes());else{const S=en(t);if(".priority"===S)v=n.filter.updatePriority(e.eventCache.getNode(),r),m=Pw(e,v,h.isFullyInitialized(),h.isFiltered());else{const N=$n(t),V=h.getNode().getImmediateChild(S);let W;if(tn(N))W=r;else{const fe=D.getCompleteChild(S);W=null!=fe?".priority"===xR(N)&&fe.getChild(kk(N)).isEmpty()?fe:fe.updateChild(N,r):Wt.EMPTY_NODE}m=V.equals(W)?e:Pw(e,n.filter.updateChild(h.getNode(),S,W,N,D,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return m}function c1(n,e){return n.eventCache.isCompleteForChild(e)}function d1(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function eM(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,m=e;v=tn(t)?r:new Qn(null).setTree(t,r);const D=e.serverCache.getNode();return v.children.inorderTraversal((S,N)=>{if(D.hasChild(S)){const W=d1(0,e.serverCache.getNode().getImmediateChild(S),N);m=ED(n,m,new xn(S),W,i,a,l,h)}}),v.children.inorderTraversal((S,N)=>{const V=!e.serverCache.isCompleteForChild(S)&&null===N.value;if(!D.hasChild(S)&&!V){const fe=d1(0,e.serverCache.getNode().getImmediateChild(S),N);m=ED(n,m,new xn(S),fe,i,a,l,h)}}),m}class LH{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new VR(r.getIndex()),a=function Qj(n){return n.loadsAllData()?new VR(n.getIndex()):n.hasLimit()?new Yj(n):new Rw(n)}(r);this.processor_=function xH(n){return{filter:n}}(a);const l=t.serverCache,h=t.eventCache,m=i.updateFullNode(Wt.EMPTY_NODE,l.getNode(),null),v=a.updateFullNode(Wt.EMPTY_NODE,h.getNode(),null),D=new Jh(m,l.isFullyInitialized(),i.filtersNodes()),S=new Jh(v,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=mD(S,D),this.eventGenerator_=new uH(this.query_)}get query(){return this.query_}}function BH(n,e){const t=og(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!tn(e)&&!t.getImmediateChild(en(e)).isEmpty())?t.getChild(e):null}function h1(n){return 0===n.eventRegistrations_.length}function f1(n,e,t){const r=[];if(t){(0,O.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function p1(n,e,t,r){e.type===Pa.MERGE&&null!==e.source.queryId&&((0,O.hu)(og(n.viewCache_),"We should always have a full cache before handling merges"),(0,O.hu)(_D(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function MH(n,e,t,r,i){const a=new SH;let l,h;if(t.type===Pa.OVERWRITE){const v=t;v.source.fromUser?l=XR(n,e,v.path,v.snap,r,i,a):((0,O.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!tn(v.path),l=ED(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===Pa.MERGE){const v=t;v.source.fromUser?l=function PH(n,e,t,r,i,a,l){let h=e;return r.foreach((m,v)=>{const D=mr(t,m);c1(e,en(D))&&(h=XR(n,h,D,v,i,a,l))}),r.foreach((m,v)=>{const D=mr(t,m);c1(e,en(D))||(h=XR(n,h,D,v,i,a,l))}),h}(n,e,v.path,v.children,r,i,a):((0,O.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),l=eM(n,e,v.path,v.children,r,i,h,a))}else if(t.type===Pa.ACK_USER_WRITE){const v=t;l=v.revert?function FH(n,e,t,r,i,a){let l;if(null!=wD(r,t))return e;{const h=new JR(r,e,i),m=e.eventCache.getNode();let v;if(tn(t)||".priority"===en(t)){let D;if(e.serverCache.isFullyInitialized())D=vD(r,og(e));else{const S=e.serverCache.getNode();(0,O.hu)(S instanceof Wt,"serverChildren would be complete if leaf node"),D=YR(r,S)}v=n.filter.updateFullNode(m,D,a)}else{const D=en(t);let S=QR(r,D,e.serverCache);null==S&&e.serverCache.isCompleteForChild(D)&&(S=m.getImmediateChild(D)),v=null!=S?n.filter.updateChild(m,D,S,$n(t),h,a):e.eventCache.getNode().hasChild(D)?n.filter.updateChild(m,D,Wt.EMPTY_NODE,$n(t),h,a):m,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=vD(r,og(e)),l.isLeafNode()&&(v=n.filter.updateFullNode(v,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=wD(r,In()),Pw(e,v,l,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function OH(n,e,t,r,i,a,l){if(null!=wD(i,t))return e;const h=e.serverCache.isFiltered(),m=e.serverCache;if(null!=r.value){if(tn(t)&&m.isFullyInitialized()||m.isCompleteForPath(t))return ED(n,e,t,m.getNode().getChild(t),i,a,h,l);if(tn(t)){let v=new Qn(null);return m.getNode().forEachChild(Bl,(D,S)=>{v=v.set(new xn(D),S)}),eM(n,e,t,v,i,a,h,l)}return e}{let v=new Qn(null);return r.foreach((D,S)=>{const N=mr(t,D);m.isCompleteForPath(N)&&(v=v.set(D,m.getNode().getChild(N)))}),eM(n,e,t,v,i,a,h,l)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==Pa.LISTEN_COMPLETE)throw(0,O.g5)("Unknown operation type: "+t.type);l=function kH(n,e,t,r,i){const a=e.serverCache;return l1(n,Xk(e,a.getNode(),a.isFullyInitialized()||tn(t),a.isFiltered()),t,r,u1,i)}(n,e,t.path,r,a)}const m=a.getChanges();return function NH(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=_D(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(Kk(_D(e)))}}(e,l,m),{viewCache:l,changes:m}}(n.processor_,i,e,t,r);return function RH(n,e){(0,O.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,O.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,O.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,g1(n,a.changes,a.viewCache.eventCache.getNode(),null)}function g1(n,e,t,r){return function lH(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function Kj(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),Nw(n,i,"child_removed",e,r,t),Nw(n,i,"child_added",e,r,t),Nw(n,i,"child_moved",a,r,t),Nw(n,i,"child_changed",e,r,t),Nw(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let ID,bD;class m1{constructor(){this.views=new Map}}function tM(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,O.hu)(null!=a,"SyncTree gave us an op for an invalid query."),p1(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(p1(l,e,t,r));return a}}function _1(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let h=vD(t,i?r:null),m=!1;h?m=!0:r instanceof Wt?(h=YR(t,r),m=!1):(h=Wt.EMPTY_NODE,m=!1);const v=mD(new Jh(h,m,!1),new Jh(r,i,!1));return new LH(e,v)}return l}function y1(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ef(n,e){let t=null;for(const r of n.views.values())t=t||BH(r,e);return t}function v1(n,e){return e._queryParams.loadsAllData()?CD(n):n.views.get(e._queryIdentifier)}function w1(n,e){return null!=v1(n,e)}function tf(n){return null!=CD(n)}function CD(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let YH=1;class E1{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qn(null),this.pendingWriteTree_=function DH(){return{visibleWrites:Ou.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function nM(n,e,t,r,i){return function fH(n,e,t,r,i){(0,O.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Ow(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?ry(n,new sg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function nf(n,e,t=!1){const r=function gH(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function mH(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,O.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&_H(h,r.path)?i=!1:Na(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function yH(n){n.visibleWrites=r1(n.allWrites,vH,In()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=e1(n.visibleWrites,r.path):Ri(r.children,m=>{n.visibleWrites=e1(n.visibleWrites,mr(r.path,m))}),!0))}(n.pendingWriteTree_,e)){let a=new Qn(null);return null!=r.snap?a=a.set(In(),!0):Ri(r.children,l=>{a=a.set(new xn(l),!0)}),ry(n,new gD(r.path,a,t))}return[]}function kw(n,e,t){return ry(n,new sg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function DD(n,e,t,r,i=!1){const a=e._path,l=n.syncPointTree_.get(a);let h=[];if(l&&("default"===e._queryIdentifier||w1(l,e))){const m=function zH(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const h=tf(n);if("default"===i)for(const[m,v]of n.views.entries())l=l.concat(f1(v,t,r)),h1(v)&&(n.views.delete(m),v.query._queryParams.loadsAllData()||a.push(v.query));else{const m=n.views.get(i);m&&(l=l.concat(f1(m,t,r)),h1(m)&&(n.views.delete(i),m.query._queryParams.loadsAllData()||a.push(m.query)))}return h&&!tf(n)&&a.push(new(function GH(){return(0,O.hu)(ID,"Reference.ts has not been loaded"),ID}())(e._repo,e._path)),{removed:a,events:l}}(l,e,t,r);(function qH(n){return 0===n.views.size})(l)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const v=m.removed;if(h=m.events,!i){const D=-1!==v.findIndex(N=>N._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(a,(N,V)=>tf(V));if(D&&!S){const N=n.syncPointTree_.subtree(a);if(!N.isEmpty()){const V=function r$(n){return n.fold((e,t,r)=>{if(t&&tf(t))return[CD(t)];{let i=[];return t&&(i=y1(t)),Ri(r,(a,l)=>{i=i.concat(l)}),i}})}(N);for(let W=0;W<V.length;++W){const fe=V[W],Ae=fe.query,at=D1(n,fe);n.listenProvider_.startListening(Lw(Ae),Fw(n,Ae),at.hashFn,at.onComplete)}}}!S&&v.length>0&&!r&&(D?n.listenProvider_.stopListening(Lw(e),null):v.forEach(N=>{const V=n.queryToTagMap.get(SD(N));n.listenProvider_.stopListening(Lw(N),V)}))}!function i$(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=SD(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,v)}return h}function I1(n,e,t,r){const i=iM(n,r);if(null!=i){const a=sM(i),l=a.path,h=a.queryId,m=js(l,e);return oM(n,l,new sg(qR(h),m,t))}return[]}function rM(n,e,t,r=!1){const i=e._path;let a=null,l=!1;n.syncPointTree_.foreachOnPath(i,(N,V)=>{const W=js(N,i);a=a||ef(V,W),l=l||tf(V)});let m,h=n.syncPointTree_.get(i);h?(l=l||tf(h),a=a||ef(h,In())):(h=new m1,n.syncPointTree_=n.syncPointTree_.set(i,h)),null!=a?m=!0:(m=!1,a=Wt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((V,W)=>{const fe=ef(W,In());fe&&(a=a.updateImmediateChild(V,fe))}));const v=w1(h,e);if(!v&&!e._queryParams.loadsAllData()){const N=SD(e);(0,O.hu)(!n.queryToTagMap.has(N),"View does not exist, but we have a tag");const V=function s$(){return YH++}();n.queryToTagMap.set(N,V),n.tagToQueryMap.set(V,N)}let S=function WH(n,e,t,r,i,a){const l=_1(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function jH(n,e){n.eventRegistrations_.push(e)}(l,t),function HH(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Yn,(a,l)=>{r.push(X_(a,l))}),t.isFullyInitialized()&&r.push(Kk(t.getNode())),g1(n,r,t.getNode(),e)}(l,t)}(h,e,t,yD(n.pendingWriteTree_,i),a,m);if(!v&&!l&&!r){const N=v1(h,e);S=S.concat(function o$(n,e,t){const r=e._path,i=Fw(n,e),a=D1(n,t),l=n.listenProvider_.startListening(Lw(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,O.hu)(!tf(h.value),"If we're adding a query, it shouldn't be shadowed");else{const m=h.fold((v,D,S)=>{if(!tn(v)&&D&&tf(D))return[CD(D).query];{let N=[];return D&&(N=N.concat(y1(D).map(V=>V.query))),Ri(S,(V,W)=>{N=N.concat(W)}),N}});for(let v=0;v<m.length;++v){const D=m[v];n.listenProvider_.stopListening(Lw(D),Fw(n,D))}}return l}(n,e,N))}return S}function TD(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const v=ef(h,js(l,e));if(v)return v});return i1(i,e,a,t,!0)}function ry(n,e){return C1(e,n.syncPointTree_,null,yD(n.pendingWriteTree_,In()))}function C1(n,e,t,r){if(tn(n.path))return b1(n,e,t,r);{const i=e.get(In());null==t&&null!=i&&(t=ef(i,In()));let a=[];const l=en(n.path),h=n.operationForChild(l),m=e.children.get(l);if(m&&h){const v=t?t.getImmediateChild(l):null,D=o1(r,l);a=a.concat(C1(h,m,v,D))}return i&&(a=a.concat(tM(i,n,r,t))),a}}function b1(n,e,t,r){const i=e.get(In());null==t&&null!=i&&(t=ef(i,In()));let a=[];return e.children.inorderTraversal((l,h)=>{const m=t?t.getImmediateChild(l):null,v=o1(r,l),D=n.operationForChild(l);D&&(a=a.concat(b1(D,h,m,v)))}),i&&(a=a.concat(tM(i,n,r,t))),a}function D1(n,e){const t=e.query,r=Fw(n,t);return{hashFn:()=>(function VH(n){return n.viewCache_.serverCache.getNode()}(e)||Wt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function e$(n,e,t){const r=iM(n,t);if(r){const i=sM(r),a=i.path,l=i.queryId,h=js(a,e);return oM(n,a,new Mw(qR(l),h))}return[]}(n,t._path,r):function XH(n,e){return ry(n,new Mw({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function X2(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return DD(n,t,null,a)}}}}function Fw(n,e){const t=SD(e);return n.queryToTagMap.get(t)}function SD(n){return n._path.toString()+"$"+n._queryIdentifier}function iM(n,e){return n.tagToQueryMap.get(e)}function sM(n){const e=n.indexOf("$");return(0,O.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new xn(n.substr(0,e))}}function oM(n,e,t){const r=n.syncPointTree_.get(e);return(0,O.hu)(r,"Missing sync point for query tag that we're tracking"),tM(r,t,yD(n.pendingWriteTree_,e),null)}function Lw(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function KH(){return(0,O.hu)(bD,"Reference.ts has not been loaded"),bD}())(n._repo,n._path):n}class aM{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new aM(t)}node(){return this.node_}}class uM{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=mr(this.path_,e);return new uM(this.syncTree_,t)}node(){return TD(this.syncTree_,this.path_)}}const T1=function(n,e,t){return n&&"object"==typeof n?((0,O.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?u$(n[".sv"],e,t):"object"==typeof n[".sv"]?l$(n[".sv"],e):void(0,O.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},u$=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,O.hu)(!1,"Unexpected server value: "+n)},l$=function(n,e,t){n.hasOwnProperty("increment")||(0,O.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,O.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,O.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},S1=function(n,e,t,r){return cM(e,new uM(t,n),r)},lM=function(n,e,t){return cM(n,new aM(e),t)};function cM(n,e,t){const r=n.getPriority().val(),i=T1(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=T1(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new Y_(h,Dr(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new Y_(i))),l.forEachChild(Yn,(h,m)=>{const v=cM(m,e.getImmediateChild(h),t);v!==m&&(a=a.updateImmediateChild(h,v))}),a}}class dM{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function AD(n,e){let t=e instanceof xn?e:new xn(e),r=n,i=en(t);for(;null!==i;){const a=(0,O.DV)(r.node.children,i)||{children:{},childCount:0};r=new dM(i,r,a),t=$n(t),i=en(t)}return r}function ug(n){return n.node.value}function hM(n,e){n.node.value=e,fM(n)}function A1(n){return n.node.childCount>0}function xD(n,e){Ri(n.node.children,(t,r)=>{e(new dM(t,n,r))})}function x1(n,e,t,r){t&&!r&&e(n),xD(n,i=>{x1(i,e,!0,r)}),t&&r&&e(n)}function Vw(n){return new xn(null===n.parent?n.name:Vw(n.parent)+"/"+n.name)}function fM(n){null!==n.parent&&function h$(n,e,t){const r=function c$(n){return void 0===ug(n)&&!A1(n)}(t),i=(0,O.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,fM(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,fM(n))}(n.parent,n.name,n)}const f$=/[\[\].#$\/\u0000-\u001F\u007F]/,p$=/[\[\].#$\u0000-\u001F\u007F]/,pM=10485760,RD=function(n){return"string"==typeof n&&0!==n.length&&!f$.test(n)},R1=function(n){return"string"==typeof n&&0!==n.length&&!p$.test(n)},Uw=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!nD(n)||n&&"object"==typeof n&&(0,O.r3)(n,".sv")},jl=function(n,e,t,r){r&&void 0===e||Bw((0,O.gK)(n,"value"),e,t)},Bw=function(n,e,t){const r=t instanceof xn?new Rj(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+rg(r));if("function"==typeof e)throw new Error(n+"contains a function "+rg(r)+" with contents = "+e.toString());if(nD(e))throw new Error(n+"contains "+e.toString()+" "+rg(r));if("string"==typeof e&&e.length>pM/3&&(0,O.ug)(e)>pM)throw new Error(n+"contains a string greater than "+pM+" utf8 bytes "+rg(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Ri(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!RD(l)))throw new Error(n+" contains an invalid key ("+l+") "+rg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Mj(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,O.ug)(e),Fk(n)})(r,l),Bw(n,h,r),function Nj(n){const e=n.parts_.pop();n.byteLength_-=(0,O.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+rg(r)+" in addition to actual children.")}},M1=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,O.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Ri(e,(l,h)=>{const m=new xn(l);if(Bw(i,h,mr(t,m)),".priority"===xR(m)&&!Uw(h))throw new Error(i+"contains an invalid value for '"+m.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(m)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=bw(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!RD(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(xj);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Na(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},gM=function(n,e,t){if(!t||void 0!==e){if(nD(e))throw new Error((0,O.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Uw(e))throw new Error((0,O.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jw=function(n,e,t,r){if(!(r&&void 0===t||RD(t)))throw new Error((0,O.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Hw=function(n,e,t,r){if(!(r&&void 0===t||R1(t)))throw new Error((0,O.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Oa=function(n,e){if(".info"===en(e))throw new Error(n+" failed = Can't modify data under /.info/")},N1=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!RD(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),R1(n)}(t))throw new Error((0,O.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class y${constructor(){this.eventLists_=[],this.recursionDepth_=0}}function MD(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!RR(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function P1(n,e,t){MD(n,t),O1(n,r=>RR(r,e))}function Go(n,e,t){MD(n,t),O1(n,r=>Na(r,e)||Na(e,r))}function O1(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(v$(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function v$(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();tg&&xi("event: "+t.toString()),Z_(r)}}}const k1="repo_interrupt";class E${constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new y$,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pD(),this.transactionQueueTree_=new dM,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function F1(n){const t=n.infoData_.getNode(new xn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function $w(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:F1(n)})}function L1(n,e,t,r,i){n.dataUpdateCount++;const a=new xn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const m=(0,O.UI)(t,v=>Dr(v));l=function t$(n,e,t,r){const i=iM(n,r);if(i){const a=sM(i),l=a.path,h=a.queryId,m=js(l,e),v=Qn.fromObject(t);return oM(n,l,new ty(qR(h),m,v))}return[]}(n.serverSyncTree_,a,m,i)}else{const m=Dr(t);l=I1(n.serverSyncTree_,a,m,i)}else if(r){const m=(0,O.UI)(t,v=>Dr(v));l=function JH(n,e,t){const r=Qn.fromObject(t);return ry(n,new ty({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,m)}else{const m=Dr(t);l=kw(n.serverSyncTree_,a,m)}let h=a;l.length>0&&(h=sy(n,a)),Go(n.eventQueue_,h,l)}function V1(n,e){mM(n,"connected",e),!1===e&&function T$(n){iy(n,"onDisconnectEvents");const e=$w(n),t=pD();HR(n.onDisconnect_,In(),(i,a)=>{const l=S1(i,a,n.serverSyncTree_,e);ey(t,i,l)});let r=[];HR(t,In(),(i,a)=>{r=r.concat(kw(n.serverSyncTree_,i,a));const l=wM(n,i);sy(n,l)}),n.onDisconnect_=pD(),Go(n.eventQueue_,In(),r)}(n)}function mM(n,e,t){const r=new xn("/.info/"+e),i=Dr(t);n.infoData_.updateSnapshot(r,i);const a=kw(n.infoSyncTree_,r,i);Go(n.eventQueue_,r,a)}function ND(n){return n.nextWriteId_++}function _M(n,e,t,r,i){iy(n,"set",{path:e.toString(),value:t,priority:r});const a=$w(n),l=Dr(t,r),h=TD(n.serverSyncTree_,e),m=lM(l,h,a),v=ND(n),D=nM(n.serverSyncTree_,e,m,v,!0);MD(n.eventQueue_,D),n.server_.put(e.toString(),l.val(!0),(N,V)=>{const W="ok"===N;W||us("set at "+e+" failed: "+N);const fe=nf(n.serverSyncTree_,v,!W);Go(n.eventQueue_,e,fe),rf(0,i,N,V)});const S=wM(n,e);sy(n,S),Go(n.eventQueue_,S,[])}function S$(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&jR(n.onDisconnect_,e),rf(0,t,r,i)})}function U1(n,e,t,r){const i=Dr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&ey(n.onDisconnect_,e,i),rf(0,r,a,l)})}function yM(n,e,t){let r;r=".info"===en(e._path)?DD(n.infoSyncTree_,e,t):DD(n.serverSyncTree_,e,t),P1(n.eventQueue_,e._path,r)}function B1(n){n.persistentConnection_&&n.persistentConnection_.interrupt(k1)}function iy(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),xi(t,...e)}function rf(n,e,t,r){e&&Z_(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function vM(n,e,t){return TD(n.serverSyncTree_,e,t)||Wt.EMPTY_NODE}function PD(n,e=n.transactionQueueTree_){if(e||OD(n,e),ug(e)){const t=H1(n,e);(0,O.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function P$(n,e,t){const r=t.map(v=>v.currentWriteId),i=vM(n,e,r);let a=i;const l=i.hash();for(let v=0;v<t.length;v++){const D=t[v];(0,O.hu)(0===D.status,"tryToSendTransactionQueue_: items in queue should all be run."),D.status=1,D.retryCount++;const S=js(e,D.path);a=a.updateChild(S,D.currentOutputSnapshotRaw)}const h=a.val(!0),m=e;n.server_.put(m.toString(),h,v=>{iy(n,"transaction put response",{path:m.toString(),status:v});let D=[];if("ok"===v){const S=[];for(let N=0;N<t.length;N++)t[N].status=2,D=D.concat(nf(n.serverSyncTree_,t[N].currentWriteId)),t[N].onComplete&&S.push(()=>t[N].onComplete(null,!0,t[N].currentOutputSnapshotResolved)),t[N].unwatcher();OD(n,AD(n.transactionQueueTree_,e)),PD(n,n.transactionQueueTree_),Go(n.eventQueue_,e,D);for(let N=0;N<S.length;N++)Z_(S[N])}else{if("datastale"===v)for(let S=0;S<t.length;S++)t[S].status=3===t[S].status?4:0;else{us("transaction at "+m.toString()+" failed: "+v);for(let S=0;S<t.length;S++)t[S].status=4,t[S].abortReason=v}sy(n,e)}},l)}(n,Vw(e),t)}else A1(e)&&xD(e,t=>{PD(n,t)})}function sy(n,e){const t=j1(n,e),r=Vw(t);return function O$(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const m=e[h],v=js(t,m.path);let S,D=!1;if((0,O.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===m.status)D=!0,S=m.abortReason,i=i.concat(nf(n.serverSyncTree_,m.currentWriteId,!0));else if(0===m.status)if(m.retryCount>=25)D=!0,S="maxretry",i=i.concat(nf(n.serverSyncTree_,m.currentWriteId,!0));else{const N=vM(n,m.path,l);m.currentInputSnapshot=N;const V=e[h].update(N.val());if(void 0!==V){Bw("transaction failed: Data returned ",V,m.path);let W=Dr(V);"object"==typeof V&&null!=V&&(0,O.r3)(V,".priority")||(W=W.updatePriority(N.getPriority()));const Ae=m.currentWriteId,at=$w(n),ft=lM(W,N,at);m.currentOutputSnapshotRaw=W,m.currentOutputSnapshotResolved=ft,m.currentWriteId=ND(n),l.splice(l.indexOf(Ae),1),i=i.concat(nM(n.serverSyncTree_,m.path,ft,m.currentWriteId,m.applyLocally)),i=i.concat(nf(n.serverSyncTree_,Ae,!0))}else D=!0,S="nodata",i=i.concat(nf(n.serverSyncTree_,m.currentWriteId,!0))}Go(n.eventQueue_,t,i),i=[],D&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===S?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(S),!1,null)))}OD(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)Z_(r[h]);PD(n,n.transactionQueueTree_)}(n,H1(n,t),r),r}function j1(n,e){let t,r=n.transactionQueueTree_;for(t=en(e);null!==t&&void 0===ug(r);)r=AD(r,t),t=en(e=$n(e));return r}function H1(n,e){const t=[];return $1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function $1(n,e,t){const r=ug(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);xD(e,i=>{$1(n,i,t)})}function OD(n,e){const t=ug(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,hM(e,t.length>0?t:void 0)}xD(e,r=>{OD(n,r)})}function wM(n,e){const t=Vw(j1(n,e)),r=AD(n.transactionQueueTree_,e);return function d$(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{EM(n,i)}),EM(n,r),x1(r,i=>{EM(n,i)}),t}function EM(n,e){const t=ug(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,O.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,O.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(nf(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?hM(e,void 0):t.length=a+1,Go(n.eventQueue_,Vw(e),i);for(let l=0;l<r.length;l++)Z_(r[l])}}const IM=function(n,e){const t=L$(n),r=t.namespace;return"firebase.com"===t.domain&&Vl(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Vl("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&us("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new CR(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new xn(t.pathString)}},L$=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",m=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let D=n.indexOf("/");-1===D&&(D=n.length);let S=n.indexOf("?");-1===S&&(S=n.length),e=n.substring(0,Math.min(D,S)),D<S&&(i=function k$(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}e+="/"+i}return e}(n.substring(D,S)));const N=function F$(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):us(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,S)));v=e.indexOf(":"),v>=0?(l="https"===h||"wss"===h,m=parseInt(e.substring(v+1),10)):v=e.length;const V=e.slice(0,v);if("localhost"===V.toLowerCase())t="localhost";else if(V.split(".").length<=2)t=V;else{const W=e.indexOf(".");r=e.substring(0,W).toLowerCase(),t=e.substring(W+1),a=r}"ns"in N&&(a=N.ns)}return{host:e,port:m,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}};class G1{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,O.Pz)(this.snapshot.exportVal())}}class q1{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class CM{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,O.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class W1{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new O.BH;return S$(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Oa("OnDisconnect.remove",this._path);const e=new O.BH;return U1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Oa("OnDisconnect.set",this._path),jl("OnDisconnect.set",e,this._path,!1);const t=new O.BH;return U1(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Oa("OnDisconnect.setWithPriority",this._path),jl("OnDisconnect.setWithPriority",e,this._path,!1),gM("OnDisconnect.setWithPriority",t,!1);const r=new O.BH;return function A$(n,e,t,r,i){const a=Dr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,h)=>{"ok"===l&&ey(n.onDisconnect_,e,a),rf(0,i,l,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Oa("OnDisconnect.update",this._path),M1("OnDisconnect.update",e,this._path,!1);const t=new O.BH;return function x$(n,e,t,r){if((0,O.xb)(t))return xi("onDisconnect().update() called with empty data.  Don't do anything."),void rf(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Ri(t,(l,h)=>{const m=Dr(h);ey(n.onDisconnect_,mr(e,l),m)}),rf(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class po{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return tn(this._path)?null:xR(this._path)}get ref(){return new ka(this._repo,this._path)}get _queryIdentifier(){const e=Qk(this._queryParams),t=wR(e);return"{}"===t?"default":t}get _queryObject(){return Qk(this._queryParams)}isEqual(e){if(!((e=(0,O.m9)(e))instanceof po))return!1;const t=this._repo===e._repo,r=RR(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Aj(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function kD(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function sf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Bl){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==rd)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Ul)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===Yn){if(null!=e&&!Uw(e)||null!=t&&!Uw(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,O.hu)(n.getIndex()instanceof kR||n.getIndex()===FR,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function FD(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ka extends po{constructor(e,t){super(e,t,new dD,!1)}get parent(){const e=kk(this._path);return null===e?null:new ka(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class lg{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new xn(e),r=cg(this.ref,e);return new lg(this._node.getChild(t),r,Yn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new lg(i,cg(this.ref,r),Yn)))}hasChild(e){const t=new xn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function z1(n,e){return(n=(0,O.m9)(n))._checkNotDeleted("ref"),void 0!==e?cg(n._root,e):n._root}function Z1(n,e){(n=(0,O.m9)(n))._checkNotDeleted("refFromURL");const t=IM(e,n._repo.repoInfo_.nodeAdmin);N1("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Vl("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),z1(n,t.path.toString())}function cg(n,e){return null===en((n=(0,O.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Hw("child","path",t,!1)):Hw("child","path",e,!1),new ka(n._repo,mr(n._path,e));var t}function bM(n,e){n=(0,O.m9)(n),Oa("set",n._path),jl("set",e,n._path,!1);const t=new O.BH;return _M(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function H$(n,e){M1("update",e,n._path,!1);const t=new O.BH;return function D$(n,e,t,r){iy(n,"update",{path:e.toString(),value:t});let i=!0;const a=$w(n),l={};if(Ri(t,(h,m)=>{i=!1,l[h]=S1(mr(e,h),Dr(m),n.serverSyncTree_,a)}),i)xi("update() called with empty data.  Don't do anything."),rf(0,r,"ok",void 0);else{const h=ND(n),m=function QH(n,e,t,r){!function pH(n,e,t,r){(0,O.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=zR(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=Qn.fromObject(t);return ry(n,new ty({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,h);MD(n.eventQueue_,m),n.server_.merge(e.toString(),t,(v,D)=>{const S="ok"===v;S||us("update at "+e+" failed: "+v);const N=nf(n.serverSyncTree_,h,!S),V=N.length>0?sy(n,e):e;Go(n.eventQueue_,V,N),rf(0,r,v,D)}),Ri(t,v=>{const D=wM(n,mr(e,v));sy(n,D)}),Go(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function $$(n){n=(0,O.m9)(n);const e=new CM(()=>{}),t=new Gw(e);return function b$(n,e,t){const r=function n$(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,D)=>{const S=js(v,t);r=r||ef(D,S)});let i=n.syncPointTree_.get(t);i?r=r||ef(i,In()):(i=new m1,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new Jh(r,!0,!1):null;return function UH(n){return _D(n.viewCache_)}(_1(i,e,yD(n.pendingWriteTree_,e._path),a?l.getNode():Wt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=Dr(i).withIndex(e._queryParams.getIndex());let l;if(rM(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())l=kw(n.serverSyncTree_,e._path,a);else{const h=Fw(n.serverSyncTree_,e);l=I1(n.serverSyncTree_,e._path,a,h)}return Go(n.eventQueue_,e._path,l),DD(n.serverSyncTree_,e,t,null,!0),a},i=>(iy(n,"get for query "+(0,O.Pz)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new lg(r,new ka(n._repo,n._path),n._queryParams.getIndex()))}class Gw{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new G1("value",this,new lg(e.snapshotNode,new ka(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new q1(this,e,t):null}matches(e){return e instanceof Gw&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class LD{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new q1(this,e,t):null}createEvent(e,t){(0,O.hu)(null!=e.childName,"Child events should have a childName.");const r=cg(new ka(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new G1(e.type,this,new lg(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof LD&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function qw(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const m=t,v=(D,S)=>{yM(n._repo,n,h),m(D,S)};v.userCallback=t.userCallback,v.context=t.context,t=v}const l=new CM(t,a||void 0),h="value"===e?new Gw(l):new LD(e,l);return function R$(n,e,t){let r;r=".info"===en(e._path)?rM(n.infoSyncTree_,e,t):rM(n.serverSyncTree_,e,t),P1(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>yM(n._repo,n,h)}function DM(n,e,t,r){return qw(n,"value",e,t,r)}function K1(n,e,t,r){return qw(n,"child_added",e,t,r)}function Y1(n,e,t,r){return qw(n,"child_changed",e,t,r)}function Q1(n,e,t,r){return qw(n,"child_moved",e,t,r)}function J1(n,e,t,r){return qw(n,"child_removed",e,t,r)}function X1(n,e,t){let r=null;const i=t?new CM(t):null;"value"===e?r=new Gw(i):e&&(r=new LD(e,i)),yM(n._repo,n,r)}class ku{}class eF extends ku{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){jl("endAt",this._value,e._path,!0);const t=BR(e._queryParams,this._value,this._key);if(FD(t),sf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new po(e._repo,e._path,t,e._orderByCalled)}}class q$ extends ku{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){jl("endBefore",this._value,e._path,!1);const t=function tH(n,e,t){let r,i;return n.index_===Bl?("string"==typeof e&&(e=Zk(e)),i=BR(n,e,t)):(r=null==t?rd:Zk(t),i=BR(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(FD(t),sf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new po(e._repo,e._path,t,e._orderByCalled)}}class tF extends ku{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){jl("startAt",this._value,e._path,!0);const t=UR(e._queryParams,this._value,this._key);if(FD(t),sf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new po(e._repo,e._path,t,e._orderByCalled)}}class Z$ extends ku{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){jl("startAfter",this._value,e._path,!1);const t=function eH(n,e,t){let r;if(n.index_===Bl)"string"==typeof e&&(e=zk(e)),r=UR(n,e,t);else{let i;i=null==t?Ul:zk(t),r=UR(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(FD(t),sf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new po(e._repo,e._path,t,e._orderByCalled)}}class Y$ extends ku{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new po(e._repo,e._path,function Jj(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class J$ extends ku{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new po(e._repo,e._path,function Xj(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class eG extends ku{constructor(e){super(),this._path=e}_apply(e){kD(e,"orderByChild");const t=new xn(this._path);if(tn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new kR(t),i=hD(e._queryParams,r);return sf(i),new po(e._repo,e._path,i,!0)}}class nG extends ku{_apply(e){kD(e,"orderByKey");const t=hD(e._queryParams,Bl);return sf(t),new po(e._repo,e._path,t,!0)}}class iG extends ku{_apply(e){kD(e,"orderByPriority");const t=hD(e._queryParams,Yn);return sf(t),new po(e._repo,e._path,t,!0)}}class oG extends ku{_apply(e){kD(e,"orderByValue");const t=hD(e._queryParams,FR);return sf(t),new po(e._repo,e._path,t,!0)}}class uG extends ku{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(jl("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new eF(this._value,this._key)._apply(new tF(this._value,this._key)._apply(e))}}function Fu(n,...e){let t=(0,O.m9)(n);for(const r of e)t=r._apply(t);return t}(function $H(n){(0,O.hu)(!ID,"__referenceConstructor has already been defined"),ID=n})(ka),function ZH(n){(0,O.hu)(!bD,"__referenceConstructor has already been defined"),bD=n}(ka);const TM={};function rF(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Vl("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xi("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let m,v,l=IM(a,i),h=l.repoInfo;"undefined"!=typeof process&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(m=!0,a=`http://${v}?ns=${h.namespace}`,l=IM(a,i),h=l.repoInfo):m=!l.repoInfo.secure;const D=i&&m?new Cw(Cw.OWNER):new rj(n.name,n.options,e);N1("Invalid Firebase Database URL",l),tn(l.path)||Vl("Database URL must point to the root of a Firebase Database (not including a child path).");const S=function fG(n,e,t,r){let i=TM[e.name];i||(i={},TM[e.name]=i);let a=i[n.toURLString()];return a&&Vl("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new E$(n,false,t,r),i[n.toURLString()]=a,a}(h,n,D,new nj(n.name,t));return new gG(S,n)}class gG{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function I$(n,e,t){if(n.stats_=TR(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new fD(n.repoInfo_,(r,i,a,l)=>{L1(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>V1(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,O.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new ig(n.repoInfo_,e,(r,i,a,l)=>{L1(n,r,i,a,l)},r=>{V1(n,r)},r=>{!function C$(n,e){Ri(e,(t,r)=>{mM(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function oj(n,e){const t=n.toString();return DR[t]||(DR[t]=e()),DR[t]}(n.repoInfo_,()=>new aH(n.stats_,n.server_)),n.infoData_=new nH,n.infoSyncTree_=new E1({startListening:(r,i,a,l)=>{let h=[];const m=n.infoData_.getNode(r._path);return m.isEmpty()||(h=kw(n.infoSyncTree_,r._path,m),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),mM(n,"connected",!1),n.serverSyncTree_=new E1({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,m)=>{const v=l(h,m);Go(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ka(this._repo,In())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function hG(n,e){const t=TM[e];(!t||t[n.key]!==n)&&Vl(`Database ${e}(${n.repoInfo_}) has already been deleted.`),B1(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Vl("Cannot call "+e+" on a deleted database.")}}function iF(){Ck.IS_TRANSPORT_INITIALIZED&&us("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function mG(){iF(),Yh.forceDisallow()}function _G(){iF(),K_.forceDisallow(),Yh.forceAllow()}function EG(n,e){rk(n,e)}const CG={".sv":"timestamp"};class TG{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}ig.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},ig.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function IG(n){JO(ns.SDK_VERSION),(0,ns._registerComponent)(new lo.wA("database",(e,{instanceIdentifier:t})=>rF(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,ns.registerVersion)(YO,"0.13.6",n),(0,ns.registerVersion)(YO,"0.13.6","esm2017")}();const RG=new ko.Yd("@firebase/database-compat"),sF=function(n){RG.warn("FIREBASE WARNING: "+n)};class PG{constructor(e){this._delegate=e}cancel(e){(0,O.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,O.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,O.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,O.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,O.Dv)("OnDisconnect.set",1,2,arguments.length),(0,O.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,O.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,O.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,O.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,sF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,O.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class OG{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,O.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class af{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,O.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,O.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,O.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,O.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,O.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Hw("DataSnapshot.child","path",e,!1),new af(this._database,this._delegate.child(e))}hasChild(e){return(0,O.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Hw("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,O.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,O.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,O.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new af(this._database,t)))}hasChildren(){return(0,O.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,O.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,O.Dv)("DataSnapshot.ref",0,0,arguments.length),new qo(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class $i{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,O.Dv)("Query.on",2,4,arguments.length),(0,O.Wj)("Query.on","callback",t,!1);const l=$i.getCancelAndContextArgs_("Query.on",r,i),h=(v,D)=>{t.call(l.context,new af(this.database,v),D)};h.userCallback=t,h.context=l.context;const m=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return DM(this._delegate,h,m),t;case"child_added":return K1(this._delegate,h,m),t;case"child_removed":return J1(this._delegate,h,m),t;case"child_changed":return Y1(this._delegate,h,m),t;case"child_moved":return Q1(this._delegate,h,m),t;default:throw new Error((0,O.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,O.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,O.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,O.Wj)("Query.off","callback",t,!0),(0,O.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,X1(this._delegate,e,i)}else X1(this._delegate,e)}get(){return $$(this._delegate).then(e=>new af(this.database,e))}once(e,t,r,i){(0,O.Dv)("Query.once",1,4,arguments.length),(0,O.Wj)("Query.once","callback",t,!0);const a=$i.getCancelAndContextArgs_("Query.once",r,i),l=new O.BH,h=(v,D)=>{const S=new af(this.database,v);t&&t.call(a.context,S,D),l.resolve(S)};h.userCallback=t,h.context=a.context;const m=v=>{a.cancel&&a.cancel.call(a.context,v),l.reject(v)};switch(e){case"value":DM(this._delegate,h,m,{onlyOnce:!0});break;case"child_added":K1(this._delegate,h,m,{onlyOnce:!0});break;case"child_removed":J1(this._delegate,h,m,{onlyOnce:!0});break;case"child_changed":Y1(this._delegate,h,m,{onlyOnce:!0});break;case"child_moved":Q1(this._delegate,h,m,{onlyOnce:!0});break;default:throw new Error((0,O.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,O.Dv)("Query.limitToFirst",1,1,arguments.length),new $i(this.database,Fu(this._delegate,function Q$(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Y$(n)}(e)))}limitToLast(e){return(0,O.Dv)("Query.limitToLast",1,1,arguments.length),new $i(this.database,Fu(this._delegate,function X$(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new J$(n)}(e)))}orderByChild(e){return(0,O.Dv)("Query.orderByChild",1,1,arguments.length),new $i(this.database,Fu(this._delegate,function tG(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Hw("orderByChild","path",n,!1),new eG(n)}(e)))}orderByKey(){return(0,O.Dv)("Query.orderByKey",0,0,arguments.length),new $i(this.database,Fu(this._delegate,function rG(){return new nG}()))}orderByPriority(){return(0,O.Dv)("Query.orderByPriority",0,0,arguments.length),new $i(this.database,Fu(this._delegate,function sG(){return new iG}()))}orderByValue(){return(0,O.Dv)("Query.orderByValue",0,0,arguments.length),new $i(this.database,Fu(this._delegate,function aG(){return new oG}()))}startAt(e=null,t){return(0,O.Dv)("Query.startAt",0,2,arguments.length),new $i(this.database,Fu(this._delegate,function z$(n=null,e){return jw("startAt","key",e,!0),new tF(n,e)}(e,t)))}startAfter(e=null,t){return(0,O.Dv)("Query.startAfter",0,2,arguments.length),new $i(this.database,Fu(this._delegate,function K$(n,e){return jw("startAfter","key",e,!0),new Z$(n,e)}(e,t)))}endAt(e=null,t){return(0,O.Dv)("Query.endAt",0,2,arguments.length),new $i(this.database,Fu(this._delegate,function G$(n,e){return jw("endAt","key",e,!0),new eF(n,e)}(e,t)))}endBefore(e=null,t){return(0,O.Dv)("Query.endBefore",0,2,arguments.length),new $i(this.database,Fu(this._delegate,function W$(n,e){return jw("endBefore","key",e,!0),new q$(n,e)}(e,t)))}equalTo(e,t){return(0,O.Dv)("Query.equalTo",1,2,arguments.length),new $i(this.database,Fu(this._delegate,function lG(n,e){return jw("equalTo","key",e,!0),new uG(n,e)}(e,t)))}toString(){return(0,O.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,O.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,O.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof $i))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,O.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,O.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,O.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new qo(this.database,new ka(this._delegate._repo,this._delegate._path))}}class qo extends $i{constructor(e,t){super(e,new po(t._repo,t._path,new dD,!1)),this.database=e,this._delegate=t}getKey(){return(0,O.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,O.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new qo(this.database,cg(this._delegate,e))}getParent(){(0,O.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new qo(this.database,e):null}getRoot(){return(0,O.Dv)("Reference.root",0,0,arguments.length),new qo(this.database,this._delegate.root)}set(e,t){(0,O.Dv)("Reference.set",1,2,arguments.length),(0,O.Wj)("Reference.set","onComplete",t,!0);const r=bM(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,O.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,sF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Oa("Reference.update",this._delegate._path),(0,O.Wj)("Reference.update","onComplete",t,!0);const r=H$(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,O.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,O.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function j$(n,e,t){if(Oa("setWithPriority",n._path),jl("setWithPriority",e,n._path,!1),gM("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new O.BH;return _M(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,O.Dv)("Reference.remove",0,1,arguments.length),(0,O.Wj)("Reference.remove","onComplete",e,!0);const t=function U$(n){return Oa("remove",n._path),bM(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,O.Dv)("Reference.transaction",1,3,arguments.length),(0,O.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,O.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,O.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function SG(n,e,t){var r;if(n=(0,O.m9)(n),Oa("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=null==t?void 0:t.applyLocally)||void 0===r||r,a=new O.BH,h=DM(n,()=>{});return function N$(n,e,t,r,i,a){iy(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:ek(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=vM(n,e,void 0);l.currentInputSnapshot=h;const m=l.update(h.val());if(void 0===m)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{Bw("transaction failed: Data returned ",m,l.path),l.status=0;const v=AD(n.transactionQueueTree_,e),D=ug(v)||[];let S;D.push(l),hM(v,D),"object"==typeof m&&null!==m&&(0,O.r3)(m,".priority")?(S=(0,O.DV)(m,".priority"),(0,O.hu)(Uw(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(TD(n.serverSyncTree_,e)||Wt.EMPTY_NODE).getPriority().val();const N=$w(n),V=Dr(m,S),W=lM(V,h,N);l.currentOutputSnapshotRaw=V,l.currentOutputSnapshotResolved=W,l.currentWriteId=ND(n);const fe=nM(n.serverSyncTree_,e,W,l.currentWriteId,l.applyLocally);Go(n.eventQueue_,e,fe),PD(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(m,v,D)=>{let S=null;m?a.reject(m):(S=new lg(D,new ka(n._repo,n._path),Yn),a.resolve(new TG(v,S)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new OG(a.committed,new af(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,O.Dv)("Reference.setPriority",1,2,arguments.length),(0,O.Wj)("Reference.setPriority","onComplete",t,!0);const r=function B$(n,e){n=(0,O.m9)(n),Oa("setPriority",n._path),gM("setPriority",e,!1);const t=new O.BH;return _M(n._repo,mr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,O.Dv)("Reference.push",0,2,arguments.length),(0,O.Wj)("Reference.push","onComplete",t,!0);const r=function V$(n,e){n=(0,O.m9)(n),Oa("push",n._path),jl("push",e,n._path,!0);const t=F1(n._repo),r=Zj(t),i=cg(n,r),a=cg(n,r);let l;return l=null!=e?bM(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new qo(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new qo(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Oa("Reference.onDisconnect",this._delegate._path),new PG(new W1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Ww{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:mG,forceLongPolling:_G}}useEmulator(e,t,r={}){!function yG(n,e,t,r={}){(n=(0,O.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Vl("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Vl('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Cw(Cw.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,O.Sg)(r.mockUserToken,n.app.options.projectId);a=new Cw(l)}!function dG(n,e,t,r){n.repoInfo_=new CR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,O.Dv)("database.ref",0,1,arguments.length),e instanceof qo){const t=Z1(this._delegate,e.toString());return new qo(this,t)}{const t=z1(this._delegate,e);return new qo(this,t)}}refFromURL(e){(0,O.Dv)("database.refFromURL",1,1,arguments.length);const r=Z1(this._delegate,e);return new qo(this,r)}goOffline(){return(0,O.Dv)("database.goOffline",0,0,arguments.length),function vG(n){(n=(0,O.m9)(n))._checkNotDeleted("goOffline"),B1(n._repo)}(this._delegate)}goOnline(){return(0,O.Dv)("database.goOnline",0,0,arguments.length),function wG(n){(n=(0,O.m9)(n))._checkNotDeleted("goOnline"),function M$(n){n.persistentConnection_&&n.persistentConnection_.resume(k1)}(n._repo)}(this._delegate)}}Ww.ServerValue={TIMESTAMP:function bG(){return CG}(),increment:n=>function DG(n){return{".sv":{increment:n}}}(n)};var FG=Object.freeze({__proto__:null,initStandalone:function kG({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){JO(t);const l=new lo.zt("auth-internal",new lo.H0("database-standalone"));return l.setComponent(new lo.wA("auth-internal",()=>r,"PRIVATE")),{instance:new Ww(rF(n,l,void 0,e,a),n),namespace:i}}});const LG=Ww.ServerValue;function oF(n){return null==n}function aF(n){return"function"==typeof n.set}function uF(n,e){return aF(e)?e:n.ref(e)}function lF(n,e){if(function UG(n){return"string"==typeof n}(n))return e.stringCase();if(aF(n))return e.firebaseCase();if(function BG(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function zw(n,e,t="on",r=cm.z){return new Es.y(i=>{let a=null;return a=n[t](e,(l,h)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,wt.U)(i=>{const{snapshot:a,prevKey:l}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:l,key:h}}),(0,xP.B)())}function cF(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function $G(n,e){const{payload:t,prevKey:r,key:i}=e,a=cF(n,i),l=function HG(n,e){if(oF(e))return 0;{const t=cF(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(m=>{const v={payload:m,type:"value",prevKey:h,key:m.key};return h=m.key,n=[...n,v],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(m=>m.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,h),n}return n;default:return n}}function dF(n){return(oF(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function hF(n,e,t){return function jG(n,e,t){return zw(n,"value","once",t).pipe(Xr(r=>{const i=[ut(r)];return e.forEach(a=>i.push(zw(n,a,"on",t))),(0,Mx.T)(...i).pipe(dc($G,[]))}),dv())}(n,e=dF(e),t)}function fF(n,e,t){const r=(e=dF(e)).map(i=>zw(n,i,"on",t));return(0,Mx.T)(...r)}function pF(n,e){return function(r,i){return lF(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function zG(n){return function(t){return t?lF(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function gF(n,e){return function(){return zw(n,"value","on",e)}}!function VG(n){n.INTERNAL.registerComponent(new lo.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Ww(i,r)},"PUBLIC").setServiceProps({Reference:qo,Query:$i,Database:Ww,DataSnapshot:af,enableLogging:EG,INTERNAL:FG,ServerValue:LG}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.6")}(hv.Z);const YG=new f.OlP("angularfire2.realtimeDatabaseURL"),QG=new f.OlP("angularfire2.database.use-emulator");let JG=(()=>{class n{constructor(t,r,i,a,l,h,m,v,D,S,N,V,W,fe,Ae){this.schedulers=h;const at=m,ft=(0,$r.on)(t,l,r);v&&nR(ft,l,D,N,V,W,S,fe),this.database=(0,$r.cc)(`${ft.name}.database.${i}`,"AngularFireDatabase",ft.name,()=>{const pt=l.runOutsideAngular(()=>ft.database(i||void 0));return at&&pt.useEmulator(...at),pt},[at])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>uF(this.database,t));let a=i;return r&&(a=r(i)),function ZG(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:pF(r,"update"),set:pF(r,"set"),push:i=>r.push(i),remove:zG(r),snapshotChanges:i=>hF(n,i,t).pipe(hn.iC),stateChanges:i=>fF(n,i,t).pipe(hn.iC),auditTrail:i=>function GG(n,e,t){return function WG(n,e,t){return function qG(n,e){return zw(n,"value","on",e).pipe((0,wt.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function G2(...n){const e=(0,sn.jO)(n);return(0,xr.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),h=!1;for(let m=0;m<i;m++)(0,aa.Xf)(n[m]).subscribe((0,er.x)(r,v=>{a[m]=v,!h&&!l[m]&&(l[m]=!0,(h=l.every(Gd.y))&&(l=null))},$2.Z));t.subscribe((0,er.x)(r,m=>{if(h){const v=[m,...a];r.next(e?e(...v):v)}}))})}(e),(0,wt.U)(([i,a])=>{const l=i.lastKeyToLoad,h=a.map(m=>m.key);return{actions:a,lastKeyToLoad:l,loadedKeys:h}}),function q2(n){return(0,xr.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,er.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,wt.U)(i=>i.actions))}(n,fF(n,e).pipe(dc((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(hn.iC),valueChanges:(i,a)=>hF(n,i,t).pipe((0,wt.U)(h=>h.map(m=>a&&a.idField?Object.assign(Object.assign({},m.payload.val()),{[a.idField]:m.key}):m.payload.val())),hn.iC)}}(a,this)}object(t){return function KG(n,e){return{query:n,snapshotChanges:()=>gF(n,e.schedulers.outsideAngular)().pipe(hn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>gF(n,e.schedulers.outsideAngular)().pipe(hn.iC,(0,wt.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>uF(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(f.LFG($r.Dh),f.LFG($r.xv,8),f.LFG(YG,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(hn.HU),f.LFG(QG,8),f.LFG(fw,8),f.LFG(Yx,8),f.LFG(Qx,8),f.LFG(Jx,8),f.LFG(Xx,8),f.LFG(eR,8),f.LFG(tR,8),f.LFG(hw,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),XG=(()=>{class n{constructor(){zb.Z.registerVersion("angularfire",hn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[JG]}),n})();var eq=F(8554);let tq=(()=>{class n{constructor(t,r,i,a){this.afs=t,this.afAuth=r,this.router=i,this.ngZone=a,this.afAuth.authState.subscribe(l=>{l?(this.userData=l,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}SignIn(t,r){return this.afAuth.signInWithEmailAndPassword(t,r).then(i=>{this.SetUserData(i.user),this.afAuth.authState.subscribe(a=>{a&&this.router.navigate(["dashboard"])})}).catch(i=>{window.alert(i.message)})}SignUp(t,r){return this.afAuth.createUserWithEmailAndPassword(t,r).then(i=>{this.SendVerificationMail(),this.SetUserData(i.user)}).catch(i=>{window.alert(i.message)})}SendVerificationMail(){return this.afAuth.currentUser.then(t=>t.sendEmailVerification()).then(()=>{this.router.navigate(["verify-email-address"])})}ForgotPassword(t){return this.afAuth.sendPasswordResetEmail(t).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(r=>{window.alert(r)})}get isLoggedIn(){const t=JSON.parse(localStorage.getItem("user"));return null!==t&&!1!==t.emailVerified}GoogleAuth(){return this.AuthLogin(new eq.Q).then(t=>{this.router.navigate(["dashboard"])})}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{this.router.navigate(["dashboard"]),this.SetUserData(r.user)}).catch(r=>{window.alert(r)})}SetUserData(t){return this.afs.doc(`users/${t.uid}`).set({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,emailVerified:t.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["sign-in"])})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pw),f.LFG(fw),f.LFG(Vi),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nq=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n,bootstrap:[JU]}),n.\u0275inj=f.cJS({providers:[tq],imports:[[Wl,YU,jD,tE,$r.hO.initializeApp(hO_firebaseConfig),IU,RU,H2,XG]]}),n})();(0,f.G48)(),Ed().bootstrapModule(nq).catch(n=>console.error(n))},5867:(nt,be,F)=>{F.d(be,{C6:()=>f.getApps,Mq:()=>f.getApp});var f=F(9681);(0,f.registerVersion)("firebase","9.9.4","app")},127:(nt,be,F)=>{F.d(be,{Z:()=>f.Z});var f=F(3942);f.Z.registerVersion("firebase","9.9.4","app-compat")},5881:(nt,be,F)=>{F.r(be);var f=F(5861),j=F(3942),P=F(8554),ae=F(2090),me=(F(9681),F(1877),F(4859));function le(){return window}function q(){return(q=(0,f.Z)(function*(ee,Q,Y){var Se;const{BuildInfo:Je}=le();(0,P.aq)(Q.sessionId,"AuthEvent did not contain a session ID");const ht=yield Te(Q.sessionId),Tt={};return(0,P.ar)()?Tt.ibi=Je.packageName:(0,P.as)()?Tt.apn=Je.packageName:(0,P.at)(ee,"operation-not-supported-in-this-environment"),Je.displayName&&(Tt.appDisplayName=Je.displayName),Tt.sessionId=ht,(0,P.au)(ee,Y,Q.type,void 0,null!==(Se=Q.eventId)&&void 0!==Se?Se:void 0,Tt)})).apply(this,arguments)}function qe(){return(qe=(0,f.Z)(function*(ee){const{BuildInfo:Q}=le(),Y={};(0,P.ar)()?Y.iosBundleId=Q.packageName:(0,P.as)()?Y.androidPackageName=Q.packageName:(0,P.at)(ee,"operation-not-supported-in-this-environment"),yield(0,P.av)(ee,Y)})).apply(this,arguments)}function Ge(){return(Ge=(0,f.Z)(function*(ee,Q,Y){const{cordova:Se}=le();let Je=()=>{};try{yield new Promise((ht,Tt)=>{let zt=null;function Ut(){var Bt;ht();const Ur=null===(Bt=Se.plugins.browsertab)||void 0===Bt?void 0:Bt.close;"function"==typeof Ur&&Ur(),"function"==typeof(null==Y?void 0:Y.close)&&Y.close()}function Gn(){zt||(zt=window.setTimeout(()=>{Tt((0,P.aw)(ee,"redirect-cancelled-by-user"))},2e3))}function oi(){"visible"===(null==document?void 0:document.visibilityState)&&Gn()}Q.addPassiveListener(Ut),document.addEventListener("resume",Gn,!1),(0,P.as)()&&document.addEventListener("visibilitychange",oi,!1),Je=()=>{Q.removePassiveListener(Ut),document.removeEventListener("resume",Gn,!1),document.removeEventListener("visibilitychange",oi,!1),zt&&window.clearTimeout(zt)}})}finally{Je()}})).apply(this,arguments)}function Te(ee){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,f.Z)(function*(ee){const Q=We(ee),Y=yield crypto.subtle.digest("SHA-256",Q);return Array.from(new Uint8Array(Y)).map(Je=>Je.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function We(ee){if((0,P.aq)(/[0-9a-zA-Z]+/.test(ee),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(ee);const Q=new ArrayBuffer(ee.length),Y=new Uint8Array(Q);for(let Se=0;Se<ee.length;Se++)Y[Se]=ee.charCodeAt(Se);return Y}class Me extends P.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(Q=>{this.resolveInialized=Q})}addPassiveListener(Q){this.passiveListeners.add(Q)}removePassiveListener(Q){this.passiveListeners.delete(Q)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(Q){return this.resolveInialized(),this.passiveListeners.forEach(Y=>Y(Q)),super.onEvent(Q)}initialized(){var Q=this;return(0,f.Z)(function*(){yield Q.initPromise})()}}function re(ee){return ge.apply(this,arguments)}function ge(){return(ge=(0,f.Z)(function*(ee){const Q=yield ie()._get(oe(ee));return Q&&(yield ie()._remove(oe(ee))),Q})).apply(this,arguments)}function J(){const ee=[],Q="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let Y=0;Y<20;Y++){const Se=Math.floor(Math.random()*Q.length);ee.push(Q.charAt(Se))}return ee.join("")}function ie(){return(0,P.ay)(P.b)}function oe(ee){return(0,P.az)("authEvent",ee.config.apiKey,ee.name)}function Ue(ee){if(!(null==ee?void 0:ee.includes("?")))return{};const[Q,...Y]=ee.split("?");return(0,ae.zd)(Y.join("?"))}function Ye(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,P.aw)("no-auth-event")}}function Vt(){var ee;return(null===(ee=null==self?void 0:self.location)||void 0===ee?void 0:ee.protocol)||null}function Dn(ee=(0,ae.z$)()){return!("file:"!==Vt()&&"ionic:"!==Vt()&&"capacitor:"!==Vt()||!ee.toLowerCase().match(/iphone|ipad|ipod|android/))}function yi(){try{const ee=self.localStorage,Q=P.aI();if(ee)return ee.setItem(Q,"1"),ee.removeItem(Q),!function ls(ee=(0,ae.z$)()){return function Fr(){return(0,ae.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Rn(ee=(0,ae.z$)()){return/Edge\/\d+/.test(ee)}(ee)}()||(0,ae.hl)()}catch(ee){return Ni()&&(0,ae.hl)()}return!1}function Ni(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function kn(){return(function Jt(){return"http:"===Vt()||"https:"===Vt()}()||(0,ae.ru)()||Dn())&&!function Mi(){return(0,ae.b$)()||(0,ae.UG)()}()&&yi()&&!Ni()}function Gi(){return Dn()&&"undefined"!=typeof document}function Lr(){return(Lr=(0,f.Z)(function*(){return!!Gi()&&new Promise(ee=>{const Q=setTimeout(()=>{ee(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(Q),ee(!0)})})})).apply(this,arguments)}const un={LOCAL:"local",NONE:"none",SESSION:"session"},ir=P.ax,Vr="persistence";function Sn(ee){return or.apply(this,arguments)}function or(){return(or=(0,f.Z)(function*(ee){yield ee._initializationPromise;const Q=Ht(),Y=P.az(Vr,ee.config.apiKey,ee.name);Q&&Q.setItem(Y,ee._getPersistence())})).apply(this,arguments)}function Ht(){var ee;try{return(null===(ee=function Tn(){return"undefined"!=typeof window?window:null}())||void 0===ee?void 0:ee.sessionStorage)||null}catch(Q){return null}}const gt=P.ax;class rt{constructor(){this.browserResolver=P.ay(P.k),this.cordovaResolver=P.ay(class Qt{constructor(){this._redirectPersistence=P.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=P.aB,this._overrideRedirectResult=P.aC}_initialize(Q){var Y=this;return(0,f.Z)(function*(){const Se=Q._key();let Je=Y.eventManagers.get(Se);return Je||(Je=new Me(Q),Y.eventManagers.set(Se,Je),Y.attachCallbackListeners(Q,Je)),Je})()}_openPopup(Q){(0,P.at)(Q,"operation-not-supported-in-this-environment")}_openRedirect(Q,Y,Se,Je){var ht=this;return(0,f.Z)(function*(){!function _e(ee){var Q,Y,Se,Je,ht,Tt,zt,Ut,Gn,oi;const Bt=le();(0,P.ax)("function"==typeof(null===(Q=null==Bt?void 0:Bt.universalLinks)||void 0===Q?void 0:Q.subscribe),ee,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,P.ax)(void 0!==(null===(Y=null==Bt?void 0:Bt.BuildInfo)||void 0===Y?void 0:Y.packageName),ee,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,P.ax)("function"==typeof(null===(ht=null===(Je=null===(Se=null==Bt?void 0:Bt.cordova)||void 0===Se?void 0:Se.plugins)||void 0===Je?void 0:Je.browsertab)||void 0===ht?void 0:ht.openUrl),ee,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,P.ax)("function"==typeof(null===(Ut=null===(zt=null===(Tt=null==Bt?void 0:Bt.cordova)||void 0===Tt?void 0:Tt.plugins)||void 0===zt?void 0:zt.browsertab)||void 0===Ut?void 0:Ut.isAvailable),ee,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,P.ax)("function"==typeof(null===(oi=null===(Gn=null==Bt?void 0:Bt.cordova)||void 0===Gn?void 0:Gn.InAppBrowser)||void 0===oi?void 0:oi.open),ee,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(Q);const Tt=yield ht._initialize(Q);yield Tt.initialized(),Tt.resetRedirect(),(0,P.aD)(),yield ht._originValidation(Q);const zt=function De(ee,Q,Y=null){return{type:Q,eventId:Y,urlResponse:null,sessionId:J(),postBody:null,tenantId:ee.tenantId,error:(0,P.aw)(ee,"no-auth-event")}}(Q,Se,Je);yield function ze(ee,Q){return ie()._set(oe(ee),Q)}(Q,zt);const Ut=yield function G(ee,Q,Y){return q.apply(this,arguments)}(Q,zt,Y),Gn=yield function Pe(ee){const{cordova:Q}=le();return new Promise(Y=>{Q.plugins.browsertab.isAvailable(Se=>{let Je=null;Se?Q.plugins.browsertab.openUrl(ee):Je=Q.InAppBrowser.open(ee,(0,P.ap)()?"_blank":"_system","location=yes"),Y(Je)})})}(Ut);return function Ve(ee,Q,Y){return Ge.apply(this,arguments)}(Q,Tt,Gn)})()}_isIframeWebStorageSupported(Q,Y){throw new Error("Method not implemented.")}_originValidation(Q){const Y=Q._key();return this.originValidationPromises[Y]||(this.originValidationPromises[Y]=function se(ee){return qe.apply(this,arguments)}(Q)),this.originValidationPromises[Y]}attachCallbackListeners(Q,Y){const{universalLinks:Se,handleOpenURL:Je,BuildInfo:ht}=le(),Tt=setTimeout((0,f.Z)(function*(){yield re(Q),Y.onEvent(Ye())}),500),zt=function(){var oi=(0,f.Z)(function*(Bt){clearTimeout(Tt);const Ur=yield re(Q);let qi=null;Ur&&(null==Bt?void 0:Bt.url)&&(qi=function Ce(ee,Q){var Y,Se;const Je=function de(ee){const Q=Ue(ee),Y=Q.link?decodeURIComponent(Q.link):void 0,Se=Ue(Y).link,Je=Q.deep_link_id?decodeURIComponent(Q.deep_link_id):void 0;return Ue(Je).link||Je||Se||Y||ee}(Q);if(Je.includes("/__/auth/callback")){const ht=Ue(Je),Tt=ht.firebaseError?function ve(ee){try{return JSON.parse(ee)}catch(Q){return null}}(decodeURIComponent(ht.firebaseError)):null,zt=null===(Se=null===(Y=null==Tt?void 0:Tt.code)||void 0===Y?void 0:Y.split("auth/"))||void 0===Se?void 0:Se[1],Ut=zt?(0,P.aw)(zt):null;return Ut?{type:ee.type,eventId:ee.eventId,tenantId:ee.tenantId,error:Ut,urlResponse:null,sessionId:null,postBody:null}:{type:ee.type,eventId:ee.eventId,tenantId:ee.tenantId,sessionId:ee.sessionId,urlResponse:Je,postBody:null}}return null}(Ur,Bt.url)),Y.onEvent(qi||Ye())});return function(Ur){return oi.apply(this,arguments)}}();void 0!==Se&&"function"==typeof Se.subscribe&&Se.subscribe(null,zt);const Ut=Je,Gn=`${ht.packageName.toLowerCase()}://`;le().handleOpenURL=function(){var oi=(0,f.Z)(function*(Bt){if(Bt.toLowerCase().startsWith(Gn)&&zt({url:Bt}),"function"==typeof Ut)try{Ut(Bt)}catch(Ur){console.error(Ur)}});return function(Bt){return oi.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=P.a,this._completeRedirectFn=P.aB,this._overrideRedirectResult=P.aC}_initialize(Q){var Y=this;return(0,f.Z)(function*(){return yield Y.selectUnderlyingResolver(),Y.assertedUnderlyingResolver._initialize(Q)})()}_openPopup(Q,Y,Se,Je){var ht=this;return(0,f.Z)(function*(){return yield ht.selectUnderlyingResolver(),ht.assertedUnderlyingResolver._openPopup(Q,Y,Se,Je)})()}_openRedirect(Q,Y,Se,Je){var ht=this;return(0,f.Z)(function*(){return yield ht.selectUnderlyingResolver(),ht.assertedUnderlyingResolver._openRedirect(Q,Y,Se,Je)})()}_isIframeWebStorageSupported(Q,Y){this.assertedUnderlyingResolver._isIframeWebStorageSupported(Q,Y)}_originValidation(Q){return this.assertedUnderlyingResolver._originValidation(Q)}get _shouldInitProactively(){return Gi()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return gt(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var Q=this;return(0,f.Z)(function*(){if(Q.underlyingResolver)return;const Y=yield function vt(){return Lr.apply(this,arguments)}();Q.underlyingResolver=Y?Q.cordovaResolver:Q.browserResolver})()}}function vi(ee){return ee.unwrap()}function $t(ee){return Fn(ee)}function Fn(ee){const{_tokenResponse:Q}=ee instanceof ae.ZR?ee.customData:ee;if(!Q)return null;if(!(ee instanceof ae.ZR)&&"temporaryProof"in Q&&"phoneNumber"in Q)return P.P.credentialFromResult(ee);const Y=Q.providerId;if(!Y||Y===P.o.PASSWORD)return null;let Se;switch(Y){case P.o.GOOGLE:Se=P.Q;break;case P.o.FACEBOOK:Se=P.N;break;case P.o.GITHUB:Se=P.T;break;case P.o.TWITTER:Se=P.W;break;default:const{oauthIdToken:Je,oauthAccessToken:ht,oauthTokenSecret:Tt,pendingToken:zt,nonce:Ut}=Q;return ht||Tt||Je||zt?zt?Y.startsWith("saml.")?P.aL._create(Y,zt):P.J._fromParams({providerId:Y,signInMethod:Y,pendingToken:zt,idToken:Je,accessToken:ht}):new P.U(Y).credential({idToken:Je,accessToken:ht,rawNonce:Ut}):null}return ee instanceof ae.ZR?Se.credentialFromError(ee):Se.credentialFromResult(ee)}function yn(ee,Q){return Q.catch(Y=>{throw Y instanceof ae.ZR&&function Pi(ee,Q){var Y,Se;const Je=null===(Y=Q.customData)||void 0===Y?void 0:Y._tokenResponse;if("auth/multi-factor-auth-required"===(null===(Se=Q)||void 0===Se?void 0:Se.code))Q.resolver=new z(ee,P.an(ee,Q));else if(Je){const ht=Fn(Q),Tt=Q;ht&&(Tt.credential=ht,Tt.tenantId=Je.tenantId||void 0,Tt.email=Je.email||void 0,Tt.phoneNumber=Je.phoneNumber||void 0)}}(ee,Y),Y}).then(Y=>{const Je=Y.user;return{operationType:Y.operationType,credential:$t(Y),additionalUserInfo:P.al(Y),user:H.getOrCreate(Je)}})}function mt(ee,Q){return zr.apply(this,arguments)}function zr(){return(zr=(0,f.Z)(function*(ee,Q){const Y=yield Q;return{verificationId:Y.verificationId,confirm:Se=>yn(ee,Y.confirm(Se))}})).apply(this,arguments)}class z{constructor(Q,Y){this.resolver=Y,this.auth=function wi(ee){return ee.wrapped()}(Q)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(Q){return yn(vi(this.auth),this.resolver.resolveSignIn(Q))}}class H{constructor(Q){this._delegate=Q,this.multiFactor=P.ao(Q)}static getOrCreate(Q){return H.USER_MAP.has(Q)||H.USER_MAP.set(Q,new H(Q)),H.USER_MAP.get(Q)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(Q){return this._delegate.getIdTokenResult(Q)}getIdToken(Q){return this._delegate.getIdToken(Q)}linkAndRetrieveDataWithCredential(Q){return this.linkWithCredential(Q)}linkWithCredential(Q){var Y=this;return(0,f.Z)(function*(){return yn(Y.auth,P.Z(Y._delegate,Q))})()}linkWithPhoneNumber(Q,Y){var Se=this;return(0,f.Z)(function*(){return mt(Se.auth,P.l(Se._delegate,Q,Y))})()}linkWithPopup(Q){var Y=this;return(0,f.Z)(function*(){return yn(Y.auth,P.d(Y._delegate,Q,rt))})()}linkWithRedirect(Q){var Y=this;return(0,f.Z)(function*(){return yield Sn(P.aE(Y.auth)),P.g(Y._delegate,Q,rt)})()}reauthenticateAndRetrieveDataWithCredential(Q){return this.reauthenticateWithCredential(Q)}reauthenticateWithCredential(Q){var Y=this;return(0,f.Z)(function*(){return yn(Y.auth,P._(Y._delegate,Q))})()}reauthenticateWithPhoneNumber(Q,Y){return mt(this.auth,P.r(this._delegate,Q,Y))}reauthenticateWithPopup(Q){return yn(this.auth,P.e(this._delegate,Q,rt))}reauthenticateWithRedirect(Q){var Y=this;return(0,f.Z)(function*(){return yield Sn(P.aE(Y.auth)),P.h(Y._delegate,Q,rt)})()}sendEmailVerification(Q){return P.ab(this._delegate,Q)}unlink(Q){var Y=this;return(0,f.Z)(function*(){return yield P.ak(Y._delegate,Q),Y})()}updateEmail(Q){return P.ag(this._delegate,Q)}updatePassword(Q){return P.ah(this._delegate,Q)}updatePhoneNumber(Q){return P.u(this._delegate,Q)}updateProfile(Q){return P.af(this._delegate,Q)}verifyBeforeUpdateEmail(Q,Y){return P.ac(this._delegate,Q,Y)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}H.USER_MAP=new WeakMap;const B=P.ax;let $=(()=>{class ee{constructor(Y,Se){if(this.app=Y,Se.isInitialized())return this._delegate=Se.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Je}=Y.options;B(Je,"invalid-api-key",{appName:Y.name}),B(Je,"invalid-api-key",{appName:Y.name});const ht="undefined"!=typeof window?rt:void 0;this._delegate=Se.initialize({options:{persistence:Re(Je,Y.name),popupRedirectResolver:ht}}),this._delegate._updateErrorMap(P.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?H.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(Y){this._delegate.languageCode=Y}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(Y){this._delegate.tenantId=Y}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(Y,Se){P.G(this._delegate,Y,Se)}applyActionCode(Y){return P.a2(this._delegate,Y)}checkActionCode(Y){return P.a3(this._delegate,Y)}confirmPasswordReset(Y,Se){return P.a1(this._delegate,Y,Se)}createUserWithEmailAndPassword(Y,Se){var Je=this;return(0,f.Z)(function*(){return yn(Je._delegate,P.a5(Je._delegate,Y,Se))})()}fetchProvidersForEmail(Y){return this.fetchSignInMethodsForEmail(Y)}fetchSignInMethodsForEmail(Y){return P.aa(this._delegate,Y)}isSignInWithEmailLink(Y){return P.a8(this._delegate,Y)}getRedirectResult(){var Y=this;return(0,f.Z)(function*(){B(kn(),Y._delegate,"operation-not-supported-in-this-environment");const Se=yield P.j(Y._delegate,rt);return Se?yn(Y._delegate,Promise.resolve(Se)):{credential:null,user:null}})()}addFrameworkForLogging(Y){!function pn(ee,Q){(0,P.aE)(ee)._logFramework(Q)}(this._delegate,Y)}onAuthStateChanged(Y,Se,Je){const{next:ht,error:Tt,complete:zt}=Z(Y,Se,Je);return this._delegate.onAuthStateChanged(ht,Tt,zt)}onIdTokenChanged(Y,Se,Je){const{next:ht,error:Tt,complete:zt}=Z(Y,Se,Je);return this._delegate.onIdTokenChanged(ht,Tt,zt)}sendSignInLinkToEmail(Y,Se){return P.a7(this._delegate,Y,Se)}sendPasswordResetEmail(Y,Se){return P.a0(this._delegate,Y,Se||void 0)}setPersistence(Y){var Se=this;return(0,f.Z)(function*(){let Je;switch(function sr(ee,Q){ir(Object.values(un).includes(Q),ee,"invalid-persistence-type"),(0,ae.b$)()?ir(Q!==un.SESSION,ee,"unsupported-persistence-type"):(0,ae.UG)()?ir(Q===un.NONE,ee,"unsupported-persistence-type"):Ni()?ir(Q===un.NONE||Q===un.LOCAL&&(0,ae.hl)(),ee,"unsupported-persistence-type"):ir(Q===un.NONE||yi(),ee,"unsupported-persistence-type")}(Se._delegate,Y),Y){case un.SESSION:Je=P.a;break;case un.LOCAL:Je=(yield P.ay(P.i)._isAvailable())?P.i:P.b;break;case un.NONE:Je=P.L;break;default:return P.at("argument-error",{appName:Se._delegate.name})}return Se._delegate.setPersistence(Je)})()}signInAndRetrieveDataWithCredential(Y){return this.signInWithCredential(Y)}signInAnonymously(){return yn(this._delegate,P.X(this._delegate))}signInWithCredential(Y){return yn(this._delegate,P.Y(this._delegate,Y))}signInWithCustomToken(Y){return yn(this._delegate,P.$(this._delegate,Y))}signInWithEmailAndPassword(Y,Se){return yn(this._delegate,P.a6(this._delegate,Y,Se))}signInWithEmailLink(Y,Se){return yn(this._delegate,P.a9(this._delegate,Y,Se))}signInWithPhoneNumber(Y,Se){return mt(this._delegate,P.s(this._delegate,Y,Se))}signInWithPopup(Y){var Se=this;return(0,f.Z)(function*(){return B(kn(),Se._delegate,"operation-not-supported-in-this-environment"),yn(Se._delegate,P.c(Se._delegate,Y,rt))})()}signInWithRedirect(Y){var Se=this;return(0,f.Z)(function*(){return B(kn(),Se._delegate,"operation-not-supported-in-this-environment"),yield Sn(Se._delegate),P.f(Se._delegate,Y,rt)})()}updateCurrentUser(Y){return this._delegate.updateCurrentUser(Y)}verifyPasswordResetCode(Y){return P.a4(this._delegate,Y)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return ee.Persistence=un,ee})();function Z(ee,Q,Y){let Se=ee;"function"!=typeof ee&&({next:Se,error:Q,complete:Y}=ee);const Je=Se;return{next:Tt=>Je(Tt&&H.getOrCreate(Tt)),error:Q,complete:Y}}function Re(ee,Q){const Y=function cs(ee,Q){const Y=Ht();if(!Y)return[];const Se=P.az(Vr,ee,Q);switch(Y.getItem(Se)){case un.NONE:return[P.L];case un.LOCAL:return[P.i,P.a];case un.SESSION:return[P.a];default:return[]}}(ee,Q);if("undefined"!=typeof self&&!Y.includes(P.i)&&Y.push(P.i),"undefined"!=typeof window)for(const Se of[P.b,P.a])Y.includes(Se)||Y.push(Se);return Y.includes(P.L)||Y.push(P.L),Y}class $e{constructor(){this.providerId="phone",this._delegate=new P.P(vi(j.Z.auth()))}static credential(Q,Y){return P.P.credential(Q,Y)}verifyPhoneNumber(Q,Y){return this._delegate.verifyPhoneNumber(Q,Y)}unwrap(){return this._delegate}}$e.PHONE_SIGN_IN_METHOD=P.P.PHONE_SIGN_IN_METHOD,$e.PROVIDER_ID=P.P.PROVIDER_ID;const bt=P.ax;class rn{constructor(Q,Y,Se=j.Z.app()){var Je;bt(null===(Je=Se.options)||void 0===Je?void 0:Je.apiKey,"invalid-api-key",{appName:Se.name}),this._delegate=new P.R(Q,Y,Se.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function ar(ee){ee.INTERNAL.registerComponent(new me.wA("auth-compat",Q=>{const Y=Q.getProvider("app-compat").getImmediate(),Se=Q.getProvider("auth");return new $(Y,Se)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:P.A.EMAIL_SIGNIN,PASSWORD_RESET:P.A.PASSWORD_RESET,RECOVER_EMAIL:P.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:P.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:P.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:P.A.VERIFY_EMAIL}},EmailAuthProvider:P.M,FacebookAuthProvider:P.N,GithubAuthProvider:P.T,GoogleAuthProvider:P.Q,OAuthProvider:P.U,SAMLAuthProvider:P.V,PhoneAuthProvider:$e,PhoneMultiFactorGenerator:P.m,RecaptchaVerifier:rn,TwitterAuthProvider:P.W,Auth:$,AuthCredential:P.H,Error:ae.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),ee.registerVersion("@firebase/auth-compat","0.2.19")}(j.Z)},8306:(nt,be,F)=>{F.d(be,{y:()=>G});var f=F(930),j=F(727),P=F(8822),ae=F(4671);var me=F(2416),le=F(576),we=F(2806);let G=(()=>{class Pe{constructor(Ge){Ge&&(this._subscribe=Ge)}lift(Ge){const _e=new Pe;return _e.source=this,_e.operator=Ge,_e}subscribe(Ge,_e,Te){const Ze=function qe(Pe){return Pe&&Pe instanceof f.Lv||function se(Pe){return Pe&&(0,le.m)(Pe.next)&&(0,le.m)(Pe.error)&&(0,le.m)(Pe.complete)}(Pe)&&(0,j.Nn)(Pe)}(Ge)?Ge:new f.Hp(Ge,_e,Te);return(0,we.x)(()=>{const{operator:We,source:Fe}=this;Ze.add(We?We.call(Ze,Fe):Fe?this._subscribe(Ze):this._trySubscribe(Ze))}),Ze}_trySubscribe(Ge){try{return this._subscribe(Ge)}catch(_e){Ge.error(_e)}}forEach(Ge,_e){return new(_e=q(_e))((Te,Ze)=>{const We=new f.Hp({next:Fe=>{try{Ge(Fe)}catch(Me){Ze(Me),We.unsubscribe()}},error:Ze,complete:Te});this.subscribe(We)})}_subscribe(Ge){var _e;return null===(_e=this.source)||void 0===_e?void 0:_e.subscribe(Ge)}[P.L](){return this}pipe(...Ge){return function ye(Pe){return 0===Pe.length?ae.y:1===Pe.length?Pe[0]:function(Ge){return Pe.reduce((_e,Te)=>Te(_e),Ge)}}(Ge)(this)}toPromise(Ge){return new(Ge=q(Ge))((_e,Te)=>{let Ze;this.subscribe(We=>Ze=We,We=>Te(We),()=>_e(Ze))})}}return Pe.create=Ve=>new Pe(Ve),Pe})();function q(Pe){var Ve;return null!==(Ve=null!=Pe?Pe:me.v.Promise)&&void 0!==Ve?Ve:Promise}},7579:(nt,be,F)=>{F.d(be,{x:()=>me});var f=F(8306),j=F(727);const ae=(0,F(3888).d)(we=>function(){we(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ce=F(8737),ye=F(2806);let me=(()=>{class we extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(q){const se=new le(this,this);return se.operator=q,se}_throwIfClosed(){if(this.closed)throw new ae}next(q){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const se of this.currentObservers)se.next(q)}})}error(q){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=q;const{observers:se}=this;for(;se.length;)se.shift().error(q)}})}complete(){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:q}=this;for(;q.length;)q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var q;return(null===(q=this.observers)||void 0===q?void 0:q.length)>0}_trySubscribe(q){return this._throwIfClosed(),super._trySubscribe(q)}_subscribe(q){return this._throwIfClosed(),this._checkFinalizedStatuses(q),this._innerSubscribe(q)}_innerSubscribe(q){const{hasError:se,isStopped:qe,observers:Pe}=this;return se||qe?j.Lc:(this.currentObservers=null,Pe.push(q),new j.w0(()=>{this.currentObservers=null,(0,ce.P)(Pe,q)}))}_checkFinalizedStatuses(q){const{hasError:se,thrownError:qe,isStopped:Pe}=this;se?q.error(qe):Pe&&q.complete()}asObservable(){const q=new f.y;return q.source=this,q}}return we.create=(G,q)=>new le(G,q),we})();class le extends me{constructor(G,q){super(),this.destination=G,this.source=q}next(G){var q,se;null===(se=null===(q=this.destination)||void 0===q?void 0:q.next)||void 0===se||se.call(q,G)}error(G){var q,se;null===(se=null===(q=this.destination)||void 0===q?void 0:q.error)||void 0===se||se.call(q,G)}complete(){var G,q;null===(q=null===(G=this.destination)||void 0===G?void 0:G.complete)||void 0===q||q.call(G)}_subscribe(G){var q,se;return null!==(se=null===(q=this.source)||void 0===q?void 0:q.subscribe(G))&&void 0!==se?se:j.Lc}}},930:(nt,be,F)=>{F.d(be,{Hp:()=>Ge,Lv:()=>se});var f=F(576),j=F(727),P=F(2416),ae=F(7849),ce=F(5032);const ye=we("C",void 0,void 0);function we(Fe,Me,De){return{kind:Fe,value:Me,error:De}}var G=F(3410),q=F(2806);class se extends j.w0{constructor(Me){super(),this.isStopped=!1,Me?(this.destination=Me,(0,j.Nn)(Me)&&Me.add(this)):this.destination=We}static create(Me,De,ze){return new Ge(Me,De,ze)}next(Me){this.isStopped?Ze(function le(Fe){return we("N",Fe,void 0)}(Me),this):this._next(Me)}error(Me){this.isStopped?Ze(function me(Fe){return we("E",void 0,Fe)}(Me),this):(this.isStopped=!0,this._error(Me))}complete(){this.isStopped?Ze(ye,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Me){this.destination.next(Me)}_error(Me){try{this.destination.error(Me)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const qe=Function.prototype.bind;function Pe(Fe,Me){return qe.call(Fe,Me)}class Ve{constructor(Me){this.partialObserver=Me}next(Me){const{partialObserver:De}=this;if(De.next)try{De.next(Me)}catch(ze){_e(ze)}}error(Me){const{partialObserver:De}=this;if(De.error)try{De.error(Me)}catch(ze){_e(ze)}else _e(Me)}complete(){const{partialObserver:Me}=this;if(Me.complete)try{Me.complete()}catch(De){_e(De)}}}class Ge extends se{constructor(Me,De,ze){let re;if(super(),(0,f.m)(Me)||!Me)re={next:null!=Me?Me:void 0,error:null!=De?De:void 0,complete:null!=ze?ze:void 0};else{let ge;this&&P.v.useDeprecatedNextContext?(ge=Object.create(Me),ge.unsubscribe=()=>this.unsubscribe(),re={next:Me.next&&Pe(Me.next,ge),error:Me.error&&Pe(Me.error,ge),complete:Me.complete&&Pe(Me.complete,ge)}):re=Me}this.destination=new Ve(re)}}function _e(Fe){P.v.useDeprecatedSynchronousErrorHandling?(0,q.O)(Fe):(0,ae.h)(Fe)}function Ze(Fe,Me){const{onStoppedNotification:De}=P.v;De&&G.z.setTimeout(()=>De(Fe,Me))}const We={closed:!0,next:ce.Z,error:function Te(Fe){throw Fe},complete:ce.Z}},727:(nt,be,F)=>{F.d(be,{Lc:()=>ye,w0:()=>ce,Nn:()=>me});var f=F(576);const P=(0,F(3888).d)(we=>function(q){we(this),this.message=q?`${q.length} errors occurred during unsubscription:\n${q.map((se,qe)=>`${qe+1}) ${se.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=q});var ae=F(8737);class ce{constructor(G){this.initialTeardown=G,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let G;if(!this.closed){this.closed=!0;const{_parentage:q}=this;if(q)if(this._parentage=null,Array.isArray(q))for(const Pe of q)Pe.remove(this);else q.remove(this);const{initialTeardown:se}=this;if((0,f.m)(se))try{se()}catch(Pe){G=Pe instanceof P?Pe.errors:[Pe]}const{_finalizers:qe}=this;if(qe){this._finalizers=null;for(const Pe of qe)try{le(Pe)}catch(Ve){G=null!=G?G:[],Ve instanceof P?G=[...G,...Ve.errors]:G.push(Ve)}}if(G)throw new P(G)}}add(G){var q;if(G&&G!==this)if(this.closed)le(G);else{if(G instanceof ce){if(G.closed||G._hasParent(this))return;G._addParent(this)}(this._finalizers=null!==(q=this._finalizers)&&void 0!==q?q:[]).push(G)}}_hasParent(G){const{_parentage:q}=this;return q===G||Array.isArray(q)&&q.includes(G)}_addParent(G){const{_parentage:q}=this;this._parentage=Array.isArray(q)?(q.push(G),q):q?[q,G]:G}_removeParent(G){const{_parentage:q}=this;q===G?this._parentage=null:Array.isArray(q)&&(0,ae.P)(q,G)}remove(G){const{_finalizers:q}=this;q&&(0,ae.P)(q,G),G instanceof ce&&G._removeParent(this)}}ce.EMPTY=(()=>{const we=new ce;return we.closed=!0,we})();const ye=ce.EMPTY;function me(we){return we instanceof ce||we&&"closed"in we&&(0,f.m)(we.remove)&&(0,f.m)(we.add)&&(0,f.m)(we.unsubscribe)}function le(we){(0,f.m)(we)?we():we.unsubscribe()}},2416:(nt,be,F)=>{F.d(be,{v:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(nt,be,F)=>{F.d(be,{E:()=>j});const j=new(F(8306).y)(ce=>ce.complete())},8996:(nt,be,F)=>{F.d(be,{D:()=>Me});var f=F(8421),j=F(5363),P=F(9468),ye=F(8306),le=F(2202),we=F(576),G=F(9672);function se(De,ze){if(!De)throw new Error("Iterable cannot be null");return new ye.y(re=>{(0,G.f)(re,ze,()=>{const ge=De[Symbol.asyncIterator]();(0,G.f)(re,ze,()=>{ge.next().then(Ce=>{Ce.done?re.complete():re.next(Ce.value)})},0,!0)})})}var qe=F(3670),Pe=F(8239),Ve=F(1144),Ge=F(6495),_e=F(2206),Te=F(4532),Ze=F(3260);function Me(De,ze){return ze?function Fe(De,ze){if(null!=De){if((0,qe.c)(De))return function ae(De,ze){return(0,f.Xf)(De).pipe((0,P.R)(ze),(0,j.Q)(ze))}(De,ze);if((0,Ve.z)(De))return function me(De,ze){return new ye.y(re=>{let ge=0;return ze.schedule(function(){ge===De.length?re.complete():(re.next(De[ge++]),re.closed||this.schedule())})})}(De,ze);if((0,Pe.t)(De))return function ce(De,ze){return(0,f.Xf)(De).pipe((0,P.R)(ze),(0,j.Q)(ze))}(De,ze);if((0,_e.D)(De))return se(De,ze);if((0,Ge.T)(De))return function q(De,ze){return new ye.y(re=>{let ge;return(0,G.f)(re,ze,()=>{ge=De[le.h](),(0,G.f)(re,ze,()=>{let Ce,J;try{({value:Ce,done:J}=ge.next())}catch(ie){return void re.error(ie)}J?re.complete():re.next(Ce)},0,!0)}),()=>(0,we.m)(null==ge?void 0:ge.return)&&ge.return()})}(De,ze);if((0,Ze.L)(De))return function We(De,ze){return se((0,Ze.Q)(De),ze)}(De,ze)}throw(0,Te.z)(De)}(De,ze):(0,f.Xf)(De)}},8421:(nt,be,F)=>{F.d(be,{Xf:()=>qe});var f=F(655),j=F(1144),P=F(8239),ae=F(8306),ce=F(3670),ye=F(2206),me=F(4532),le=F(6495),we=F(3260),G=F(576),q=F(7849),se=F(8822);function qe(Fe){if(Fe instanceof ae.y)return Fe;if(null!=Fe){if((0,ce.c)(Fe))return function Pe(Fe){return new ae.y(Me=>{const De=Fe[se.L]();if((0,G.m)(De.subscribe))return De.subscribe(Me);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Fe);if((0,j.z)(Fe))return function Ve(Fe){return new ae.y(Me=>{for(let De=0;De<Fe.length&&!Me.closed;De++)Me.next(Fe[De]);Me.complete()})}(Fe);if((0,P.t)(Fe))return function Ge(Fe){return new ae.y(Me=>{Fe.then(De=>{Me.closed||(Me.next(De),Me.complete())},De=>Me.error(De)).then(null,q.h)})}(Fe);if((0,ye.D)(Fe))return Te(Fe);if((0,le.T)(Fe))return function _e(Fe){return new ae.y(Me=>{for(const De of Fe)if(Me.next(De),Me.closed)return;Me.complete()})}(Fe);if((0,we.L)(Fe))return function Ze(Fe){return Te((0,we.Q)(Fe))}(Fe)}throw(0,me.z)(Fe)}function Te(Fe){return new ae.y(Me=>{(function We(Fe,Me){var De,ze,re,ge;return(0,f.mG)(this,void 0,void 0,function*(){try{for(De=(0,f.KL)(Fe);!(ze=yield De.next()).done;)if(Me.next(ze.value),Me.closed)return}catch(Ce){re={error:Ce}}finally{try{ze&&!ze.done&&(ge=De.return)&&(yield ge.call(De))}finally{if(re)throw re.error}}Me.complete()})})(Fe,Me).catch(De=>Me.error(De))})}},6451:(nt,be,F)=>{F.d(be,{T:()=>ye});var f=F(8189),j=F(8421),P=F(515),ae=F(7669),ce=F(8996);function ye(...me){const le=(0,ae.yG)(me),we=(0,ae._6)(me,1/0),G=me;return G.length?1===G.length?(0,j.Xf)(G[0]):(0,f.J)(we)((0,ce.D)(G,le)):P.E}},5403:(nt,be,F)=>{F.d(be,{x:()=>j});var f=F(930);function j(ae,ce,ye,me,le){return new P(ae,ce,ye,me,le)}class P extends f.Lv{constructor(ce,ye,me,le,we,G){super(ce),this.onFinalize=we,this.shouldUnsubscribe=G,this._next=ye?function(q){try{ye(q)}catch(se){ce.error(se)}}:super._next,this._error=le?function(q){try{le(q)}catch(se){ce.error(se)}finally{this.unsubscribe()}}:super._error,this._complete=me?function(){try{me()}catch(q){ce.error(q)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ye}=this;super.unsubscribe(),!ye&&(null===(ce=this.onFinalize)||void 0===ce||ce.call(this))}}}},4004:(nt,be,F)=>{F.d(be,{U:()=>P});var f=F(4482),j=F(5403);function P(ae,ce){return(0,f.e)((ye,me)=>{let le=0;ye.subscribe((0,j.x)(me,we=>{me.next(ae.call(ce,we,le++))}))})}},8189:(nt,be,F)=>{F.d(be,{J:()=>P});var f=F(5577),j=F(4671);function P(ae=1/0){return(0,f.z)(j.y,ae)}},5577:(nt,be,F)=>{F.d(be,{z:()=>le});var f=F(4004),j=F(8421),P=F(4482),ae=F(9672),ce=F(5403),me=F(576);function le(we,G,q=1/0){return(0,me.m)(G)?le((se,qe)=>(0,f.U)((Pe,Ve)=>G(se,Pe,qe,Ve))((0,j.Xf)(we(se,qe))),q):("number"==typeof G&&(q=G),(0,P.e)((se,qe)=>function ye(we,G,q,se,qe,Pe,Ve,Ge){const _e=[];let Te=0,Ze=0,We=!1;const Fe=()=>{We&&!_e.length&&!Te&&G.complete()},Me=ze=>Te<se?De(ze):_e.push(ze),De=ze=>{Pe&&G.next(ze),Te++;let re=!1;(0,j.Xf)(q(ze,Ze++)).subscribe((0,ce.x)(G,ge=>{null==qe||qe(ge),Pe?Me(ge):G.next(ge)},()=>{re=!0},void 0,()=>{if(re)try{for(Te--;_e.length&&Te<se;){const ge=_e.shift();Ve?(0,ae.f)(G,Ve,()=>De(ge)):De(ge)}Fe()}catch(ge){G.error(ge)}}))};return we.subscribe((0,ce.x)(G,Me,()=>{We=!0,Fe()})),()=>{null==Ge||Ge()}}(se,qe,we,q)))}},5363:(nt,be,F)=>{F.d(be,{Q:()=>ae});var f=F(9672),j=F(4482),P=F(5403);function ae(ce,ye=0){return(0,j.e)((me,le)=>{me.subscribe((0,P.x)(le,we=>(0,f.f)(le,ce,()=>le.next(we),ye),()=>(0,f.f)(le,ce,()=>le.complete(),ye),we=>(0,f.f)(le,ce,()=>le.error(we),ye)))})}},3099:(nt,be,F)=>{F.d(be,{B:()=>ce});var f=F(8421),j=F(7579),P=F(930),ae=F(4482);function ce(me={}){const{connector:le=(()=>new j.x),resetOnError:we=!0,resetOnComplete:G=!0,resetOnRefCountZero:q=!0}=me;return se=>{let qe,Pe,Ve,Ge=0,_e=!1,Te=!1;const Ze=()=>{null==Pe||Pe.unsubscribe(),Pe=void 0},We=()=>{Ze(),qe=Ve=void 0,_e=Te=!1},Fe=()=>{const Me=qe;We(),null==Me||Me.unsubscribe()};return(0,ae.e)((Me,De)=>{Ge++,!Te&&!_e&&Ze();const ze=Ve=null!=Ve?Ve:le();De.add(()=>{Ge--,0===Ge&&!Te&&!_e&&(Pe=ye(Fe,q))}),ze.subscribe(De),!qe&&Ge>0&&(qe=new P.Hp({next:re=>ze.next(re),error:re=>{Te=!0,Ze(),Pe=ye(We,we,re),ze.error(re)},complete:()=>{_e=!0,Ze(),Pe=ye(We,G),ze.complete()}}),(0,f.Xf)(Me).subscribe(qe))})(se)}}function ye(me,le,...we){if(!0===le)return void me();if(!1===le)return;const G=new P.Hp({next:()=>{G.unsubscribe(),me()}});return le(...we).subscribe(G)}},9468:(nt,be,F)=>{F.d(be,{R:()=>j});var f=F(4482);function j(P,ae=0){return(0,f.e)((ce,ye)=>{ye.add(P.schedule(()=>ce.subscribe(ye),ae))})}},8505:(nt,be,F)=>{F.d(be,{b:()=>ce});var f=F(576),j=F(4482),P=F(5403),ae=F(4671);function ce(ye,me,le){const we=(0,f.m)(ye)||me||le?{next:ye,error:me,complete:le}:ye;return we?(0,j.e)((G,q)=>{var se;null===(se=we.subscribe)||void 0===se||se.call(we);let qe=!0;G.subscribe((0,P.x)(q,Pe=>{var Ve;null===(Ve=we.next)||void 0===Ve||Ve.call(we,Pe),q.next(Pe)},()=>{var Pe;qe=!1,null===(Pe=we.complete)||void 0===Pe||Pe.call(we),q.complete()},Pe=>{var Ve;qe=!1,null===(Ve=we.error)||void 0===Ve||Ve.call(we,Pe),q.error(Pe)},()=>{var Pe,Ve;qe&&(null===(Pe=we.unsubscribe)||void 0===Pe||Pe.call(we)),null===(Ve=we.finalize)||void 0===Ve||Ve.call(we)}))}):ae.y}},4408:(nt,be,F)=>{F.d(be,{o:()=>ce});var f=F(727);class j extends f.w0{constructor(me,le){super()}schedule(me,le=0){return this}}const P={setInterval(ye,me,...le){const{delegate:we}=P;return(null==we?void 0:we.setInterval)?we.setInterval(ye,me,...le):setInterval(ye,me,...le)},clearInterval(ye){const{delegate:me}=P;return((null==me?void 0:me.clearInterval)||clearInterval)(ye)},delegate:void 0};var ae=F(8737);class ce extends j{constructor(me,le){super(me,le),this.scheduler=me,this.work=le,this.pending=!1}schedule(me,le=0){if(this.closed)return this;this.state=me;const we=this.id,G=this.scheduler;return null!=we&&(this.id=this.recycleAsyncId(G,we,le)),this.pending=!0,this.delay=le,this.id=this.id||this.requestAsyncId(G,this.id,le),this}requestAsyncId(me,le,we=0){return P.setInterval(me.flush.bind(me,this),we)}recycleAsyncId(me,le,we=0){if(null!=we&&this.delay===we&&!1===this.pending)return le;P.clearInterval(le)}execute(me,le){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const we=this._execute(me,le);if(we)return we;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(me,le){let G,we=!1;try{this.work(me)}catch(q){we=!0,G=q||new Error("Scheduled action threw falsy error")}if(we)return this.unsubscribe(),G}unsubscribe(){if(!this.closed){const{id:me,scheduler:le}=this,{actions:we}=le;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ae.P)(we,this),null!=me&&(this.id=this.recycleAsyncId(le,me,null)),this.delay=null,super.unsubscribe()}}}},7565:(nt,be,F)=>{F.d(be,{v:()=>P});var f=F(6063);class j{constructor(ce,ye=j.now){this.schedulerActionCtor=ce,this.now=ye}schedule(ce,ye=0,me){return new this.schedulerActionCtor(this,ce).schedule(me,ye)}}j.now=f.l.now;class P extends j{constructor(ce,ye=j.now){super(ce,ye),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ce){const{actions:ye}=this;if(this._active)return void ye.push(ce);let me;this._active=!0;do{if(me=ce.execute(ce.state,ce.delay))break}while(ce=ye.shift());if(this._active=!1,me){for(;ce=ye.shift();)ce.unsubscribe();throw me}}}},4986:(nt,be,F)=>{F.d(be,{z:()=>P});var f=F(4408);const P=new(F(7565).v)(f.o)},6063:(nt,be,F)=>{F.d(be,{l:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},3410:(nt,be,F)=>{F.d(be,{z:()=>f});const f={setTimeout(j,P,...ae){const{delegate:ce}=f;return(null==ce?void 0:ce.setTimeout)?ce.setTimeout(j,P,...ae):setTimeout(j,P,...ae)},clearTimeout(j){const{delegate:P}=f;return((null==P?void 0:P.clearTimeout)||clearTimeout)(j)},delegate:void 0}},2202:(nt,be,F)=>{F.d(be,{h:()=>j});const j=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(nt,be,F)=>{F.d(be,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(nt,be,F)=>{F.d(be,{_6:()=>ye,jO:()=>ae,yG:()=>ce});var f=F(576);function P(me){return me[me.length-1]}function ae(me){return(0,f.m)(P(me))?me.pop():void 0}function ce(me){return function j(me){return me&&(0,f.m)(me.schedule)}(P(me))?me.pop():void 0}function ye(me,le){return"number"==typeof P(me)?me.pop():le}},8737:(nt,be,F)=>{function f(j,P){if(j){const ae=j.indexOf(P);0<=ae&&j.splice(ae,1)}}F.d(be,{P:()=>f})},3888:(nt,be,F)=>{function f(j){const ae=j(ce=>{Error.call(ce),ce.stack=(new Error).stack});return ae.prototype=Object.create(Error.prototype),ae.prototype.constructor=ae,ae}F.d(be,{d:()=>f})},2806:(nt,be,F)=>{F.d(be,{O:()=>ae,x:()=>P});var f=F(2416);let j=null;function P(ce){if(f.v.useDeprecatedSynchronousErrorHandling){const ye=!j;if(ye&&(j={errorThrown:!1,error:null}),ce(),ye){const{errorThrown:me,error:le}=j;if(j=null,me)throw le}}else ce()}function ae(ce){f.v.useDeprecatedSynchronousErrorHandling&&j&&(j.errorThrown=!0,j.error=ce)}},9672:(nt,be,F)=>{function f(j,P,ae,ce=0,ye=!1){const me=P.schedule(function(){ae(),ye?j.add(this.schedule(null,ce)):this.unsubscribe()},ce);if(j.add(me),!ye)return me}F.d(be,{f:()=>f})},4671:(nt,be,F)=>{function f(j){return j}F.d(be,{y:()=>f})},1144:(nt,be,F)=>{F.d(be,{z:()=>f});const f=j=>j&&"number"==typeof j.length&&"function"!=typeof j},2206:(nt,be,F)=>{F.d(be,{D:()=>j});var f=F(576);function j(P){return Symbol.asyncIterator&&(0,f.m)(null==P?void 0:P[Symbol.asyncIterator])}},576:(nt,be,F)=>{function f(j){return"function"==typeof j}F.d(be,{m:()=>f})},3670:(nt,be,F)=>{F.d(be,{c:()=>P});var f=F(8822),j=F(576);function P(ae){return(0,j.m)(ae[f.L])}},6495:(nt,be,F)=>{F.d(be,{T:()=>P});var f=F(2202),j=F(576);function P(ae){return(0,j.m)(null==ae?void 0:ae[f.h])}},8239:(nt,be,F)=>{F.d(be,{t:()=>j});var f=F(576);function j(P){return(0,f.m)(null==P?void 0:P.then)}},3260:(nt,be,F)=>{F.d(be,{L:()=>ae,Q:()=>P});var f=F(655),j=F(576);function P(ce){return(0,f.FC)(this,arguments,function*(){const me=ce.getReader();try{for(;;){const{value:le,done:we}=yield(0,f.qq)(me.read());if(we)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(le)}}finally{me.releaseLock()}})}function ae(ce){return(0,j.m)(null==ce?void 0:ce.getReader)}},4482:(nt,be,F)=>{F.d(be,{A:()=>j,e:()=>P});var f=F(576);function j(ae){return(0,f.m)(null==ae?void 0:ae.lift)}function P(ae){return ce=>{if(j(ce))return ce.lift(function(ye){try{return ae(ye,this)}catch(me){this.error(me)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(nt,be,F)=>{function f(){}F.d(be,{Z:()=>f})},7849:(nt,be,F)=>{F.d(be,{h:()=>P});var f=F(2416),j=F(3410);function P(ae){j.z.setTimeout(()=>{const{onUnhandledError:ce}=f.v;if(!ce)throw ae;ce(ae)})}},4532:(nt,be,F)=>{function f(j){return new TypeError(`You provided ${null!==j&&"object"==typeof j?"an invalid object":`'${j}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}F.d(be,{z:()=>f})},655:(nt,be,F)=>{function ae(J,ie){var oe={};for(var ve in J)Object.prototype.hasOwnProperty.call(J,ve)&&ie.indexOf(ve)<0&&(oe[ve]=J[ve]);if(null!=J&&"function"==typeof Object.getOwnPropertySymbols){var de=0;for(ve=Object.getOwnPropertySymbols(J);de<ve.length;de++)ie.indexOf(ve[de])<0&&Object.prototype.propertyIsEnumerable.call(J,ve[de])&&(oe[ve[de]]=J[ve[de]])}return oe}function le(J,ie,oe,ve){return new(oe||(oe=Promise))(function(Ue,_t){function Qt(pn){try{Ye(ve.next(pn))}catch(On){_t(On)}}function Lt(pn){try{Ye(ve.throw(pn))}catch(On){_t(On)}}function Ye(pn){pn.done?Ue(pn.value):function de(Ue){return Ue instanceof oe?Ue:new oe(function(_t){_t(Ue)})}(pn.value).then(Qt,Lt)}Ye((ve=ve.apply(J,ie||[])).next())})}function _e(J){return this instanceof _e?(this.v=J,this):new _e(J)}function Te(J,ie,oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var de,ve=oe.apply(J,ie||[]),Ue=[];return de={},_t("next"),_t("throw"),_t("return"),de[Symbol.asyncIterator]=function(){return this},de;function _t(gn){ve[gn]&&(de[gn]=function(nn){return new Promise(function(Vt,Jt){Ue.push([gn,nn,Vt,Jt])>1||Qt(gn,nn)})})}function Qt(gn,nn){try{!function Lt(gn){gn.value instanceof _e?Promise.resolve(gn.value.v).then(Ye,pn):On(Ue[0][2],gn)}(ve[gn](nn))}catch(Vt){On(Ue[0][3],Vt)}}function Ye(gn){Qt("next",gn)}function pn(gn){Qt("throw",gn)}function On(gn,nn){gn(nn),Ue.shift(),Ue.length&&Qt(Ue[0][0],Ue[0][1])}}function We(J){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var oe,ie=J[Symbol.asyncIterator];return ie?ie.call(J):(J=function se(J){var ie="function"==typeof Symbol&&Symbol.iterator,oe=ie&&J[ie],ve=0;if(oe)return oe.call(J);if(J&&"number"==typeof J.length)return{next:function(){return J&&ve>=J.length&&(J=void 0),{value:J&&J[ve++],done:!J}}};throw new TypeError(ie?"Object is not iterable.":"Symbol.iterator is not defined.")}(J),oe={},ve("next"),ve("throw"),ve("return"),oe[Symbol.asyncIterator]=function(){return this},oe);function ve(Ue){oe[Ue]=J[Ue]&&function(_t){return new Promise(function(Qt,Lt){!function de(Ue,_t,Qt,Lt){Promise.resolve(Lt).then(function(Ye){Ue({value:Ye,done:Qt})},_t)}(Qt,Lt,(_t=J[Ue](_t)).done,_t.value)})}}}F.d(be,{FC:()=>Te,KL:()=>We,_T:()=>ae,mG:()=>le,qq:()=>_e})},5e3:(nt,be,F)=>{F.d(be,{$8M:()=>Js,$Z:()=>Dc,AFp:()=>kp,AaK:()=>le,CHM:()=>Wu,CRH:()=>v0,CZH:()=>v_,CqO:()=>Mv,EJc:()=>qS,EpF:()=>np,F4k:()=>Sm,FYo:()=>Oh,FiY:()=>ot,G48:()=>eA,GfV:()=>l0,Gpc:()=>q,JOm:()=>oo,LFG:()=>R,LSH:()=>Iy,Lbi:()=>HS,NdJ:()=>Am,OlP:()=>An,Oqu:()=>$v,PXZ:()=>ib,Q6J:()=>xv,QGY:()=>Tm,Qsj:()=>mC,R0b:()=>Os,RDi:()=>Hl,Rgc:()=>Sa,SBq:()=>Fc,Sil:()=>zS,Suo:()=>an,TTD:()=>Ua,TgZ:()=>tp,VLi:()=>zc,X6Q:()=>D_,XFs:()=>vt,Xpm:()=>$e,Y36:()=>ep,YKP:()=>h0,YNc:()=>wI,Yjl:()=>Je,Yz7:()=>nn,ZZ4:()=>Or,_Bn:()=>Ph,_UZ:()=>Cm,_Vd:()=>Bo,_c5:()=>cA,_uU:()=>jI,aQg:()=>q0,c2e:()=>$S,cJS:()=>Jt,cg1:()=>$m,dDg:()=>Lp,deG:()=>Nd,dqk:()=>$t,eFA:()=>Vp,ekj:()=>Uv,g9A:()=>QC,h0i:()=>Vc,hGG:()=>yb,hij:()=>Fm,iGM:()=>BC,ifc:()=>Ht,ip1:()=>Ho,kL8:()=>Qv,lG2:()=>Se,lnq:()=>Ac,n5z:()=>Ju,oAB:()=>ee,oxw:()=>gh,q4F:()=>yC,qLn:()=>xr,qOj:()=>Ca,qZA:()=>Sc,sBO:()=>jp,sIi:()=>Gr,s_b:()=>bu,soG:()=>N0,tBr:()=>xt,tb:()=>JC,tp0:()=>cr,uIk:()=>gl,vHH:()=>Ve,vpe:()=>Ta,wAp:()=>ct,xp6:()=>jy,z2F:()=>Su,zSh:()=>ov,zs3:()=>Ia});var f=F(7579),j=F(727),P=F(8306),ae=F(6451),ce=F(3099);function ye(s){for(let o in s)if(s[o]===ye)return o;throw Error("Could not find renamed property on target object.")}function me(s,o){for(const u in o)o.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&(s[u]=o[u])}function le(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(le).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function we(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const G=ye({__forward_ref__:ye});function q(s){return s.__forward_ref__=q,s.toString=function(){return le(this())},s}function se(s){return qe(s)?s():s}function qe(s){return"function"==typeof s&&s.hasOwnProperty(G)&&s.__forward_ref__===q}class Ve extends Error{constructor(o,u){super(function Ge(s,o){return`NG0${Math.abs(s)}${o?": "+o:""}`}(o,u)),this.code=o}}function _e(s){return"string"==typeof s?s:null==s?"":String(s)}function Te(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():_e(s)}function Me(s,o){const u=o?` in ${o}`:"";throw new Ve(-201,`No provider for ${Te(s)} found${u}`)}function Lt(s,o){null==s&&function Ye(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function nn(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Jt(s){return{providers:s.providers||[],imports:s.imports||[]}}function Dn(s){return Mi(s,yi)||Mi(s,kn)}function Mi(s,o){return s.hasOwnProperty(o)?s[o]:null}function ls(s){return s&&(s.hasOwnProperty(Ni)||s.hasOwnProperty(Gi))?s[Ni]:null}const yi=ye({\u0275prov:ye}),Ni=ye({\u0275inj:ye}),kn=ye({ngInjectableDef:ye}),Gi=ye({ngInjectorDef:ye});var vt=(()=>((vt=vt||{})[vt.Default=0]="Default",vt[vt.Host=1]="Host",vt[vt.Self=2]="Self",vt[vt.SkipSelf=4]="SkipSelf",vt[vt.Optional=8]="Optional",vt))();let Lr;function un(s){const o=Lr;return Lr=s,o}function ir(s,o,u){const c=Dn(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&vt.Optional?null:void 0!==o?o:void Me(le(s),"Injector")}function sr(s){return{toString:s}.toString()}var Sn=(()=>((Sn=Sn||{})[Sn.OnPush=0]="OnPush",Sn[Sn.Default=1]="Default",Sn))(),Ht=(()=>{return(s=Ht||(Ht={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",Ht;var s})();const gt="undefined"!=typeof globalThis&&globalThis,rt="undefined"!=typeof window&&window,vi="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,$t=gt||"undefined"!=typeof global&&global||rt||vi,yn={},mt=[],zr=ye({\u0275cmp:ye}),z=ye({\u0275dir:ye}),H=ye({\u0275pipe:ye}),B=ye({\u0275mod:ye}),$=ye({\u0275fac:ye}),Z=ye({__NG_ELEMENT_ID__:ye});let Re=0;function $e(s){return sr(()=>{const u={},c={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:u,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===Sn.OnPush,directiveDefs:null,pipeDefs:null,selectors:s.selectors||mt,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||Ht.Emulated,id:"c",styles:s.styles||mt,_:null,setInput:null,schemas:s.schemas||null,tView:null},d=s.directives,p=s.features,y=s.pipes;return c.id+=Re++,c.inputs=Y(s.inputs,u),c.outputs=Y(s.outputs),p&&p.forEach(E=>E(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(rn):null,c.pipeDefs=y?()=>("function"==typeof y?y():y).map(Xt):null,c})}function rn(s){return ht(s)||function Tt(s){return s[z]||null}(s)}function Xt(s){return function zt(s){return s[H]||null}(s)}const ar={};function ee(s){return sr(()=>{const o={type:s.type,bootstrap:s.bootstrap||mt,declarations:s.declarations||mt,imports:s.imports||mt,exports:s.exports||mt,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null};return null!=s.id&&(ar[s.id]=s.type),o})}function Y(s,o){if(null==s)return yn;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],p=d;Array.isArray(d)&&(p=d[1],d=d[0]),u[d]=c,o&&(o[d]=p)}return u}const Se=$e;function Je(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,onDestroy:s.type.prototype.ngOnDestroy||null}}function ht(s){return s[zr]||null}function Ut(s,o){const u=s[B]||null;if(!u&&!0===o)throw new Error(`Type ${le(s)} does not have '\u0275mod' property.`);return u}function Oi(s){return Array.isArray(s)&&"object"==typeof s[1]}function Ei(s){return Array.isArray(s)&&!0===s[1]}function od(s){return 0!=(8&s.flags)}function Vu(s){return 2==(2&s.flags)}function $s(s){return 1==(1&s.flags)}function Ii(s){return null!==s.template}function uf(s){return 0!=(512&s[2])}function Ci(s,o){return s.hasOwnProperty($)?s[$]:null}class Qo{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function Ua(){return Ba}function Ba(s){return s.type.prototype.ngOnChanges&&(s.setInput=_g),cf}function cf(){const s=hd(this),o=null==s?void 0:s.current;if(o){const u=s.previous;if(u===yn)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function _g(s,o,u,c){const d=hd(s)||function gs(s,o){return s[qs]=o}(s,{previous:yn,current:null}),p=d.current||(d.current={}),y=d.previous,E=this.declaredInputs[u],C=y[E];p[E]=new Qo(C&&C.currentValue,o,y===yn),s[c]=o}Ua.ngInherit=!0;const qs="__ngSimpleChanges__";function hd(s){return s[qs]||null}let Hu;function Hl(s){Hu=s}function wn(s){return!!s.listen}const ja={createRenderer:(s,o)=>function ms(){return void 0!==Hu?Hu:"undefined"!=typeof document?document:void 0}()};function _n(s){for(;Array.isArray(s);)s=s[0];return s}function vo(s,o){return _n(o[s])}function yr(s,o){return _n(o[s.index])}function Vn(s,o){return s.data[o]}function vr(s,o){const u=o[s];return Oi(u)?u:u[0]}function Jo(s){return 4==(4&s[2])}function Wi(s){return 128==(128&s[2])}function ui(s,o){return null==o?null:s[o]}function zs(s){s[18]=0}function Zs(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const Ct={lFrame:bd(null),bindingsEnabled:!0};function Xo(){return Ct.bindingsEnabled}function ke(){return Ct.lFrame.lView}function Gt(){return Ct.lFrame.tView}function Wu(s){return Ct.lFrame.contextLView=s,s[8]}function Cn(){let s=yd();for(;null!==s&&64===s.type;)s=s.parent;return s}function yd(){return Ct.lFrame.currentTNode}function zi(s,o){const u=Ct.lFrame;u.currentTNode=s,u.isParent=o}function ql(){return Ct.lFrame.isParent}function ta(){return Ct.lFrame.bindingIndex++}function li(s){const o=Ct.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}function Ed(s,o){const u=Ct.lFrame;u.bindingIndex=u.bindingRootIndex=s,Wl(o)}function Wl(s){Ct.lFrame.currentDirectiveIndex=s}function Id(){return Ct.lFrame.currentQueryIndex}function Cd(s){Ct.lFrame.currentQueryIndex=s}function zl(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function Wa(s,o,u){if(u&vt.SkipSelf){let d=o,p=s;for(;!(d=d.parent,null!==d||u&vt.Host||(d=zl(p),null===d||(p=p[15],10&d.type))););if(null===d)return!1;o=d,s=p}const c=Ct.lFrame=Io();return c.currentTNode=o,c.lView=s,!0}function za(s){const o=Io(),u=s[1];Ct.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Io(){const s=Ct.lFrame,o=null===s?null:s.child;return null===o?bd(s):o}function bd(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function pf(){const s=Ct.lFrame;return Ct.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const zu=pf;function ci(){const s=pf();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function Sr(){return Ct.lFrame.selectedIndex}function Co(s){Ct.lFrame.selectedIndex=s}function Xn(){const s=Ct.lFrame;return Vn(s.tView,s.selectedIndex)}function vs(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const p=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:E,ngAfterViewInit:C,ngAfterViewChecked:A,ngOnDestroy:M}=p;y&&(s.contentHooks||(s.contentHooks=[])).push(-u,y),E&&((s.contentHooks||(s.contentHooks=[])).push(u,E),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,E)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),A&&((s.viewHooks||(s.viewHooks=[])).push(u,A),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,A)),null!=M&&(s.destroyHooks||(s.destroyHooks=[])).push(u,M)}}function Za(s,o,u){Sd(s,o,3,u)}function Ka(s,o,u,c){(3&s[2])===u&&Sd(s,o,u,c)}function ur(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function Sd(s,o,u,c){const p=null!=c?c:-1,y=o.length-1;let E=0;for(let C=void 0!==c?65535&s[18]:0;C<y;C++)if("number"==typeof o[C+1]){if(E=o[C],null!=c&&E>=c)break}else o[C]<0&&(s[18]+=65536),(E<p||-1==p)&&(vg(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function vg(s,o,u,c){const d=u[c]<0,p=u[c+1],E=s[d?-u[c]:u[c]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{p.call(E)}finally{}}}else try{p.call(E)}finally{}}class ia{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function Ql(s,o,u){const c=wn(s);let d=0;for(;d<u.length;){const p=u[d];if("number"==typeof p){if(0!==p)break;d++;const y=u[d++],E=u[d++],C=u[d++];c?s.setAttribute(o,E,C,y):o.setAttributeNS(y,E,C)}else{const y=p,E=u[++d];Jl(y)?c&&s.setProperty(o,y,E):c?s.setAttribute(o,y,E):o.setAttribute(y,E),d++}}return d}function Zu(s){return 3===s||4===s||6===s}function Jl(s){return 64===s.charCodeAt(0)}function sa(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||oa(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function oa(s,o,u,c,d){let p=0,y=s.length;if(-1===o)y=-1;else for(;p<s.length;){const E=s[p++];if("number"==typeof E){if(E===o){y=-1;break}if(E>o){y=p-1;break}}}for(;p<s.length;){const E=s[p];if("number"==typeof E)break;if(E===u){if(null===c)return void(null!==d&&(s[p+1]=d));if(c===s[p+1])return void(s[p+2]=d)}p++,null!==c&&p++,null!==d&&p++}-1!==y&&(s.splice(y,0,o),p=y+1),s.splice(p++,0,u),null!==c&&s.splice(p++,0,c),null!==d&&s.splice(p++,0,d)}function aa(s){return-1!==s}function sn(s){return 32767&s}function wt(s,o){let u=function er(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let Ku=!0;function Ys(s){const o=Ku;return Ku=s,o}let Yu=0;function Er(s,o){const u=Is(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,Do(c.data,s),Do(o,null),Do(c.blueprint,null));const d=Qu(s,o),p=s.injectorIndex;if(aa(d)){const y=sn(d),E=wt(d,o),C=E[1].data;for(let A=0;A<8;A++)o[p+A]=E[y+A]|C[y+A]}return o[p+8]=d,p}function Do(s,o){s.push(0,0,0,0,0,0,0,0,o)}function Is(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function Qu(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){const p=d[1],y=p.type;if(c=2===y?p.declTNode:1===y?d[6]:null,null===c)return-1;if(u++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function Qs(s,o,u){!function Ki(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(Z)&&(c=u[Z]),null==c&&(c=u[Z]=Yu++);const d=255&c;o.data[s+(d>>5)]|=1<<d}(s,o,u)}function Yi(s,o,u){if(u&vt.Optional)return s;Me(o,"NodeInjector")}function Cs(s,o,u,c){if(u&vt.Optional&&void 0===c&&(c=null),0==(u&(vt.Self|vt.Host))){const d=s[9],p=un(void 0);try{return d?d.get(o,c,u&vt.Optional):ir(o,c,u&vt.Optional)}finally{un(p)}}return Yi(c,o,u)}function To(s,o,u,c=vt.Default,d){if(null!==s){const p=function Md(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(Z)?s[Z]:void 0;return"number"==typeof o?o>=0?255&o:bs:o}(u);if("function"==typeof p){if(!Wa(o,s,c))return c&vt.Host?Yi(d,u,c):Cs(o,u,c,d);try{const y=p(c);if(null!=y||c&vt.Optional)return y;Me(u)}finally{zu()}}else if("number"==typeof p){let y=null,E=Is(s,o),C=-1,A=c&vt.Host?o[16][6]:null;for((-1===E||c&vt.SkipSelf)&&(C=-1===E?Qu(s,o):o[E+8],-1!==C&&tc(c,!1)?(y=o[1],E=sn(C),o=wt(C,o)):E=-1);-1!==E;){const M=o[1];if(Ya(p,E,M.data)){const L=Rd(E,o,u,y,c,A);if(L!==Wn)return L}C=o[E+8],-1!==C&&tc(c,o[1].data[E+8]===A)&&Ya(p,E,o)?(y=M,E=sn(C),o=wt(C,o)):E=-1}}}return Cs(o,u,c,d)}const Wn={};function bs(){return new Ir(Cn(),ke())}function Rd(s,o,u,c,d,p){const y=o[1],E=y.data[s+8],M=ua(E,y,u,null==c?Vu(E)&&Ku:c!=y&&0!=(3&E.type),d&vt.Host&&p===E);return null!==M?Ds(o,y,M,E):Wn}function ua(s,o,u,c,d){const p=s.providerIndexes,y=o.data,E=1048575&p,C=s.directiveStart,M=p>>20,K=d?E+M:s.directiveEnd;for(let te=c?E:E+M;te<K;te++){const Ie=y[te];if(te<C&&u===Ie||te>=C&&Ie.type===u)return te}if(d){const te=y[C];if(te&&Ii(te)&&te.type===u)return C}return null}function Ds(s,o,u,c){let d=s[u];const p=o.data;if(function Ad(s){return s instanceof ia}(d)){const y=d;y.resolving&&function Ze(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new Ve(-200,`Circular dependency in DI detected for ${s}${u}`)}(Te(p[u]));const E=Ys(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?un(y.injectImpl):null;Wa(s,c,vt.Default);try{d=s[u]=y.factory(void 0,p,s,c),o.firstCreatePass&&u>=c.directiveStart&&function Td(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:p}=o.type.prototype;if(c){const y=Ba(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),p&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,p),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,p))}(u,p[u],o)}finally{null!==C&&un(C),Ys(E),y.resolving=!1,zu()}}return d}function Ya(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function tc(s,o){return!(s&vt.Self||s&vt.Host&&o)}class Ir{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return To(this._tNode,this._lView,o,c,u)}}function Ju(s){return sr(()=>{const o=s.prototype.constructor,u=o[$]||la(o),c=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==c;){const p=d[$]||la(d);if(p&&p!==u)return p;d=Object.getPrototypeOf(d)}return p=>new p})}function la(s){return qe(s)?()=>{const o=la(se(s));return o&&o()}:Ci(s)}function Js(s){return function xd(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const p=u[d];if(Zu(p))break;if(0===p)d+=2;else if("number"==typeof p)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(p===o)return u[d+1];d+=2}}}return null}(Cn(),s)}const Xs="__parameters__";function ca(s,o,u){return sr(()=>{const c=function nc(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...p){if(this instanceof d)return c.apply(this,p),this;const y=new d(...p);return E.annotation=y,E;function E(C,A,M){const L=C.hasOwnProperty(Xs)?C[Xs]:Object.defineProperty(C,Xs,{value:[]})[Xs];for(;L.length<=M;)L.push(null);return(L[M]=L[M]||[]).push(y),C}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class An{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=nn({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Nd=new An("AnalyzeForEntryComponents");function Yr(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),Yr(c,o)):o!==s&&o.push(c)}return o}function Qr(s,o){s.forEach(u=>Array.isArray(u)?Qr(u,o):o(u))}function Ja(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function So(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function Hr(s,o,u){let c=Ao(s,o);return c>=0?s[1|c]=u:(c=~c,function If(s,o,u,c){let d=s.length;if(d==o)s.push(u,c);else if(1===d)s.push(c,s[0]),s[0]=u;else{for(d--,s.push(s[d-1],s[d]);d>o;)s[d]=s[d-2],d--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function el(s,o){const u=Ao(s,o);if(u>=0)return s[1|u]}function Ao(s,o){return function eu(s,o,u){let c=0,d=s.length>>u;for(;d!==c;){const p=c+(d-c>>1),y=s[p<<u];if(o===y)return p<<u;y>o?d=p:c=p+1}return~(d<<u)}(s,o,1)}const Ar={},nu="__NG_DI_FLAG__",Ji="ngTempTokenPath",bf=/\n/gm,Ld="__source",Dg=ye({provide:String,useValue:ye});let fa;function b(s){const o=fa;return fa=s,o}function T(s,o=vt.Default){if(void 0===fa)throw new Ve(203,"");return null===fa?ir(s,void 0,o):fa.get(s,o&vt.Optional?null:void 0,o)}function R(s,o=vt.Default){return(function Tn(){return Lr}()||T)(se(s),o)}const X=R;function ue(s){const o=[];for(let u=0;u<s.length;u++){const c=se(s[u]);if(Array.isArray(c)){if(0===c.length)throw new Ve(900,"");let d,p=vt.Default;for(let y=0;y<c.length;y++){const E=c[y],C=Xe(E);"number"==typeof C?-1===C?d=E.token:p|=C:d=E}o.push(R(d,p))}else o.push(R(c))}return o}function Ne(s,o){return s[nu]=o,s.prototype[nu]=o,s}function Xe(s){return s[nu]}const xt=Ne(ca("Inject",s=>({token:s})),-1),ot=Ne(ca("Optional"),8),cr=Ne(ca("SkipSelf"),4);class sl{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function ma(s){return s instanceof sl?s.changingThisBreaksApplicationSecurity:s}const Ng=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,g=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Cr=(()=>((Cr=Cr||{})[Cr.NONE=0]="NONE",Cr[Cr.HTML=1]="HTML",Cr[Cr.STYLE=2]="STYLE",Cr[Cr.SCRIPT=3]="SCRIPT",Cr[Cr.URL=4]="URL",Cr[Cr.RESOURCE_URL=5]="RESOURCE_URL",Cr))();function Iy(s){const o=function Rf(){const s=ke();return s&&s[12]}();return o?o.sanitize(Cr.URL,s)||"":function _a(s,o){const u=function gy(s){return s instanceof sl&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?ma(s):function _(s){return(s=String(s)).match(Ng)||s.match(g)?s:"unsafe:"+s}(_e(s))}const tE="__ngContext__";function ut(s,o){s[tE]=o}function Rs(s){const o=function io(s){return s[tE]||null}(s);return o?Array.isArray(o)?o:o.lView:null}function Fg(s){return s.ngOriginalError}function rE(s,...o){s.error(...o)}class xr{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o),c=function cc(s){return s&&s.ngErrorLogger||rE}(o);c(this._console,"ERROR",o),u&&c(this._console,"ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&Fg(o);for(;u&&Fg(u);)u=Fg(u);return u||null}}const Nf=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind($t))();function ya(s){return s instanceof Function?s():s}var oo=(()=>((oo=oo||{})[oo.Important=1]="Important",oo[oo.DashCase=2]="DashCase",oo))();function Vg(s,o){return undefined(s,o)}function Pf(s){const o=s[3];return Ei(o)?o[3]:o}function xy(s){return Ry(s[13])}function Ug(s){return Ry(s[4])}function Ry(s){for(;null!==s&&!Ei(s);)s=s[4];return s}function zd(s,o,u,c,d){if(null!=c){let p,y=!1;Ei(c)?p=c:Oi(c)&&(y=!0,c=c[0]);const E=_n(c);0===s&&null!==u?null==d?mE(o,u,E):pc(o,u,E,d||null,!0):1===s&&null!==u?pc(o,u,E,d||null,!0):2===s?function EE(s,o,u){const c=jg(s,o);c&&function _E(s,o,u,c){wn(s)?s.removeChild(o,u,c):o.removeChild(u)}(s,c,o,u)}(o,E,y):3===s&&o.destroyNode(E),null!=p&&function kf(s,o,u,c,d){const p=u[7];p!==_n(u)&&zd(o,s,c,p,d);for(let E=10;E<u.length;E++){const C=u[E];Yd(C[1],C,s,o,c,p)}}(o,s,p,u,d)}}function Zt(s,o,u){if(wn(s))return s.createElement(o,u);{const c=null!==u?function ju(s){const o=s.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(u):null;return null===c?s.createElement(o):s.createElementNS(c,o)}}function pE(s,o){const u=s[9],c=u.indexOf(o),d=o[3];1024&o[2]&&(o[2]&=-1025,Zs(d,-1)),u.splice(c,1)}function ao(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const d=c[17];null!==d&&d!==s&&pE(d,c),o>0&&(s[u-1][4]=c[4]);const p=So(s,10+o);!function YD(s,o){Yd(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const y=p[19];null!==y&&y.detachView(p[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function Py(s,o){if(!(256&o[2])){const u=o[11];wn(u)&&u.destroyNode&&Yd(s,o,u,3,null,null),function Ny(s){let o=s[13];if(!o)return Bg(s[1],s);for(;o;){let u=null;if(Oi(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)Oi(o)&&Bg(o[1],o),o=o[3];null===o&&(o=s),Oi(o)&&Bg(o[1],o),u=o&&o[4]}o=u}}(o)}}function Bg(s,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function NM(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof ia)){const p=u[c+1];if(Array.isArray(p))for(let y=0;y<p.length;y+=2){const E=d[p[y]],C=p[y+1];try{C.call(E)}finally{}}else try{p.call(d)}finally{}}}}(s,o),function gE(s,o){const u=s.cleanup,c=o[7];let d=-1;if(null!==u)for(let p=0;p<u.length-1;p+=2)if("string"==typeof u[p]){const y=u[p+1],E="function"==typeof y?y(o):_n(o[y]),C=c[d=u[p+2]],A=u[p+3];"boolean"==typeof A?E.removeEventListener(u[p],C,A):A>=0?c[d=A]():c[d=-A].unsubscribe(),p+=2}else{const y=c[d=u[p+1]];u[p].call(y)}if(null!==c){for(let p=d+1;p<c.length;p++)c[p]();o[7]=null}}(s,o),1===o[1].type&&wn(o[11])&&o[11].destroy();const u=o[17];if(null!==u&&Ei(o[3])){u!==o[3]&&pE(u,o);const c=o[19];null!==c&&c.detachView(s)}}}function ei(s,o,u){return function Po(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const d=s.data[c.directiveStart].encapsulation;if(d===Ht.None||d===Ht.Emulated)return null}return yr(c,u)}(s,o.parent,u)}function pc(s,o,u,c,d){wn(s)?s.insertBefore(o,u,c,d):o.insertBefore(u,c,d)}function mE(s,o,u){wn(s)?s.appendChild(o,u):o.appendChild(u)}function Oy(s,o,u,c,d){null!==c?pc(s,o,u,c,d):mE(s,o,u)}function jg(s,o){return wn(s)?s.parentNode(o):o.parentNode}let Fy=function ky(s,o,u){return 40&s.type?yr(s,u):null};function Yt(s,o,u,c){const d=ei(s,c,o),p=o[11],E=function vE(s,o,u){return Fy(s,o,u)}(c.parent||o[6],c,o);if(null!=d)if(Array.isArray(u))for(let C=0;C<u.length;C++)Oy(p,d,u[C],E,!1);else Oy(p,d,u,E,!1)}function cl(s,o){if(null!==o){const u=o.type;if(3&u)return yr(o,s);if(4&u)return uu(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return cl(s,c);{const d=s[o.index];return Ei(d)?uu(-1,d):_n(d)}}if(32&u)return Vg(o,s)()||_n(s[o.index]);{const c=wE(s,o);return null!==c?Array.isArray(c)?c[0]:cl(Pf(s[16]),c):cl(s,o.next)}}return null}function wE(s,o){return null!==o?s[16][6].projection[o.projection]:null}function uu(s,o){const u=10+s+1;if(u<o.length){const c=o[u],d=c[1].firstChild;if(null!==d)return cl(c,d)}return o[7]}function Hg(s,o,u,c,d,p,y){for(;null!=u;){const E=c[u.index],C=u.type;if(y&&0===o&&(E&&ut(_n(E),c),u.flags|=4),64!=(64&u.flags))if(8&C)Hg(s,o,u.child,c,d,p,!1),zd(o,s,d,E,p);else if(32&C){const A=Vg(u,c);let M;for(;M=A();)zd(o,s,d,M,p);zd(o,s,d,E,p)}else 16&C?Of(s,o,c,u,d,p):zd(o,s,d,E,p);u=y?u.projectionNext:u.next}}function Yd(s,o,u,c,d,p){Hg(u,c,s.firstChild,o,d,p,!1)}function Of(s,o,u,c,d,p){const y=u[16],C=y[6].projection[c.projection];if(Array.isArray(C))for(let A=0;A<C.length;A++)zd(o,s,d,C[A],p);else Hg(s,o,C,y[3],d,p,!0)}function Ff(s,o,u){wn(s)?s.setAttribute(o,"style",u):o.style.cssText=u}function Ly(s,o,u){wn(s)?""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u):o.className=u}function $g(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const p=o.length;if(d+p===c||s.charCodeAt(d+p)<=32)return d}u=d+1}}const Uy="ng-template";function CE(s,o,u){let c=0;for(;c<s.length;){let d=s[c++];if(u&&"class"===d){if(d=s[c],-1!==$g(d.toLowerCase(),o,0))return!0}else if(1===d){for(;c<s.length&&"string"==typeof(d=s[c++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function bE(s){return 4===s.type&&s.value!==Uy}function eT(s,o,u){return o===(4!==s.type||u?s.value:Uy)}function tT(s,o,u){let c=4;const d=s.attrs||[],p=function iT(s){for(let o=0;o<s.length;o++)if(Zu(s[o]))return o;return s.length}(d);let y=!1;for(let E=0;E<o.length;E++){const C=o[E];if("number"!=typeof C){if(!y)if(4&c){if(c=2|1&c,""!==C&&!eT(s,C,u)||""===C&&1===o.length){if(ts(c))return!1;y=!0}}else{const A=8&c?C:o[++E];if(8&c&&null!==s.attrs){if(!CE(s.attrs,A,u)){if(ts(c))return!1;y=!0}continue}const L=nT(8&c?"class":C,d,bE(s),u);if(-1===L){if(ts(c))return!1;y=!0;continue}if(""!==A){let K;K=L>p?"":d[L+1].toLowerCase();const te=8&c?K:null;if(te&&-1!==$g(te,A,0)||2&c&&A!==K){if(ts(c))return!1;y=!0}}}}else{if(!y&&!ts(c)&&!ts(C))return!1;if(y&&ts(C))continue;y=!1,c=C|1&c}}return ts(c)||y}function ts(s){return 0==(1&s)}function nT(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let p=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)p=!0;else{if(1===y||2===y){let E=o[++d];for(;"string"==typeof E;)E=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=p?1:2}return-1}return function sT(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function DE(s,o,u=!1){for(let c=0;c<o.length;c++)if(tT(s,o[c],u))return!0;return!1}function Gg(s,o){return s?":not("+o.trim()+")":o}function By(s){let o=s[0],u=1,c=2,d="",p=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const E=s[++u];d+="["+y+(E.length>0?'="'+E+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!ts(y)&&(o+=Gg(p,d),d=""),c=y,p=p||!ts(c);u++}return""!==d&&(o+=Gg(p,d)),o}const Pt={};function jy(s){SE(Gt(),ke(),Sr()+s,!1)}function SE(s,o,u,c){if(!c)if(3==(3&o[2])){const p=s.preOrderCheckHooks;null!==p&&Za(o,p,u)}else{const p=s.preOrderHooks;null!==p&&Ka(o,p,0,u)}Co(u)}function Lf(s,o){return s<<17|o<<2}function Oo(s){return s>>17&32767}function Uf(s){return 2|s}function va(s){return(131068&s)>>2}function Bf(s,o){return-131069&s|o<<2}function Hy(s){return 1|s}function qy(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const d=u[c],p=u[c+1];if(-1!==p){const y=s.data[p];Cd(d),y.contentQueries(2,o[p],p)}}}function hl(s,o,u,c,d,p,y,E,C,A){const M=o.blueprint.slice();return M[0]=d,M[2]=140|c,zs(M),M[3]=M[15]=s,M[8]=u,M[10]=y||s&&s[10],M[11]=E||s&&s[11],M[12]=C||s&&s[12]||null,M[9]=A||s&&s[9]||null,M[6]=p,M[16]=2==o.type?s[16]:M,M}function Xd(s,o,u,c,d){let p=s.data[o];if(null===p)p=function Wy(s,o,u,c,d){const p=yd(),y=ql(),C=s.data[o]=function fT(s,o,u,c,d,p){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:p,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?p:p&&p.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=C),null!==p&&(y?null==p.child&&null!==C.parent&&(p.child=C):null===p.next&&(p.next=C)),C}(s,o,u,c,d),function ff(){return Ct.lFrame.inI18n}()&&(p.flags|=64);else if(64&p.type){p.type=u,p.value=c,p.attrs=d;const y=function ys(){const s=Ct.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();p.injectorIndex=null===y?-1:y.injectorIndex}return zi(p,!0),p}function eh(s,o,u,c){if(0===u)return-1;const d=o.length;for(let p=0;p<u;p++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function Gf(s,o,u){za(o);try{const c=s.viewQuery;null!==c&&tv(1,c,u);const d=s.template;null!==d&&zy(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&qy(s,o),s.staticViewQueries&&tv(2,s.viewQuery,u);const p=s.components;null!==p&&function Xg(s,o){for(let u=0;u<o.length;u++)TT(s,o[u])}(o,p)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,ci()}}function du(s,o,u,c){const d=o[2];if(256!=(256&d)){za(o);try{zs(o),function ea(s){return Ct.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&zy(s,o,u,2,c);const y=3==(3&d);if(y){const A=s.preOrderCheckHooks;null!==A&&Za(o,A,null)}else{const A=s.preOrderHooks;null!==A&&Ka(o,A,0,null),ur(o,0)}if(function bT(s){for(let o=xy(s);null!==o;o=Ug(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const d=u[c],p=d[3];0==(1024&d[2])&&Zs(p,1),d[2]|=1024}}}(o),function KE(s){for(let o=xy(s);null!==o;o=Ug(o))for(let u=10;u<o.length;u++){const c=o[u],d=c[1];Wi(c)&&du(d,c,d.template,c[8])}}(o),null!==s.contentQueries&&qy(s,o),y){const A=s.contentCheckHooks;null!==A&&Za(o,A)}else{const A=s.contentHooks;null!==A&&Ka(o,A,1),ur(o,1)}!function uo(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const d=u[c];if(d<0)Co(~d);else{const p=d,y=u[++c],E=u[++c];Ed(y,p),E(2,o[p])}}}finally{Co(-1)}}(s,o);const E=s.components;null!==E&&function LE(s,o){for(let u=0;u<o.length;u++)DT(s,o[u])}(o,E);const C=s.viewQuery;if(null!==C&&tv(2,C,c),y){const A=s.viewCheckHooks;null!==A&&Za(o,A)}else{const A=s.viewHooks;null!==A&&Ka(o,A,2),ur(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-73,1024&o[2]&&(o[2]&=-1025,Zs(o[3],-1))}finally{ci()}}}function VE(s,o,u,c){const d=o[10],y=Jo(o);try{!y&&d.begin&&d.begin(),y&&Gf(s,o,c),du(s,o,u,c)}finally{!y&&d.end&&d.end()}}function zy(s,o,u,c,d){const p=Sr(),y=2&c;try{Co(-1),y&&o.length>20&&SE(s,o,20,!1),u(c,d)}finally{Co(p)}}function em(s,o,u){!Xo()||(function yT(s,o,u,c){const d=u.directiveStart,p=u.directiveEnd;s.firstCreatePass||Er(u,o),ut(c,o);const y=u.initialInputs;for(let E=d;E<p;E++){const C=s.data[E],A=Ii(C);A&&IT(o,u,C);const M=Ds(o,s,E,u);ut(M,o),null!==y&&GM(0,E-d,M,C,0,y),A&&(vr(u.index,o)[8]=M)}}(s,o,u,yr(u,o)),128==(128&u.flags)&&function vT(s,o,u){const c=u.directiveStart,d=u.directiveEnd,y=u.index,E=function qa(){return Ct.lFrame.currentDirectiveIndex}();try{Co(y);for(let C=c;C<d;C++){const A=s.data[C],M=o[C];Wl(C),(null!==A.hostBindings||0!==A.hostVars||null!==A.hostAttrs)&&$E(A,M)}}finally{Co(-1),Wl(E)}}(s,o,u))}function Ec(s,o,u=yr){const c=o.localNames;if(null!==c){let d=o.index+1;for(let p=0;p<c.length;p+=2){const y=c[p+1],E=-1===y?u(o,s):s[y];s[d++]=E}}}function Zy(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=tm(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function tm(s,o,u,c,d,p,y,E,C,A){const M=20+c,L=M+d,K=function hT(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Pt);return u}(M,L),te="function"==typeof A?A():A;return K[1]={type:s,blueprint:K,template:u,queries:null,viewQuery:E,declTNode:o,data:K.slice().fill(null,M),bindingStartIndex:M,expandoStartIndex:L,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof p?p():p,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:te,incompleteFirstPass:!1}}function nm(s,o,u,c){const d=nv(o);null===u?d.push(c):(d.push(u),s.firstCreatePass&&QE(s).push(c,d.length-1))}function Ky(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const d=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,d):u[c]=[o,d]}return u}function Yy(s,o,u,c){let d=!1;if(Xo()){const p=function wT(s,o,u){const c=s.directiveRegistry;let d=null;if(c)for(let p=0;p<c.length;p++){const y=c[p];DE(u,y.selectors,!1)&&(d||(d=[]),Qs(Er(u,o),s,y.type),Ii(y)?(GE(s,u),d.unshift(y)):d.push(y))}return d}(s,o,u),y=null===c?null:{"":-1};if(null!==p){d=!0,WE(u,s.data.length,p.length);for(let M=0;M<p.length;M++){const L=p[M];L.providersResolver&&L.providersResolver(L)}let E=!1,C=!1,A=eh(s,o,p.length,null);for(let M=0;M<p.length;M++){const L=p[M];u.mergedAttrs=sa(u.mergedAttrs,L.hostAttrs),zE(s,u,o,A,L),ET(A,L,y),null!==L.contentQueries&&(u.flags|=8),(null!==L.hostBindings||null!==L.hostAttrs||0!==L.hostVars)&&(u.flags|=128);const K=L.type.prototype;!E&&(K.ngOnChanges||K.ngOnInit||K.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),E=!0),!C&&(K.ngOnChanges||K.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),A++}!function rm(s,o){const c=o.directiveEnd,d=s.data,p=o.attrs,y=[];let E=null,C=null;for(let A=o.directiveStart;A<c;A++){const M=d[A],L=M.inputs,K=null===p||bE(o)?null:ZE(L,p);y.push(K),E=Ky(L,A,E),C=Ky(M.outputs,A,C)}null!==E&&(E.hasOwnProperty("class")&&(o.flags|=16),E.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=y,o.inputs=E,o.outputs=C}(s,u)}y&&function qE(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const p=u[o[d+1]];if(null==p)throw new Ve(-301,!1);c.push(o[d],p)}}}(u,c,y)}return u.mergedAttrs=sa(u.mergedAttrs,u.attrs),d}function HE(s,o,u,c,d,p){const y=p.hostBindings;if(y){let E=s.hostBindingOpCodes;null===E&&(E=s.hostBindingOpCodes=[]);const C=~o.index;(function _T(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(E)!=C&&E.push(C),E.push(c,d,y)}}function $E(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function GE(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function ET(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Ii(o)&&(u[""]=s)}}function WE(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function zE(s,o,u,c,d){s.data[c]=d;const p=d.factory||(d.factory=Ci(d.type)),y=new ia(p,Ii(d),null);s.blueprint[c]=y,u[c]=y,HE(s,o,0,c,eh(s,u,d.hostVars,Pt),d)}function IT(s,o,u){const c=yr(o,s),d=Zy(u),p=s[10],y=um(s,hl(s,d,null,u.onPush?64:16,c,o,p,p.createRenderer(c,u),null,null));s[o.index]=y}function wa(s,o,u,c,d,p){const y=yr(s,o);!function am(s,o,u,c,d,p,y){if(null==p)wn(s)?s.removeAttribute(o,d,u):o.removeAttribute(d);else{const E=null==y?_e(p):y(p,c||"",d);wn(s)?s.setAttribute(o,d,E,u):u?o.setAttributeNS(u,d,E):o.setAttribute(d,E)}}(o[11],y,p,s.value,u,c,d)}function GM(s,o,u,c,d,p){const y=p[o];if(null!==y){const E=c.setInput;for(let C=0;C<y.length;){const A=y[C++],M=y[C++],L=y[C++];null!==E?c.setInput(u,L,A,M):u[M]=L}}}function ZE(s,o){let u=null,c=0;for(;c<o.length;){const d=o[c];if(0!==d)if(5!==d){if("number"==typeof d)break;s.hasOwnProperty(d)&&(null===u&&(u=[]),u.push(d,s[d],o[c+1])),c+=2}else c+=2;else c+=4}return u}function Qy(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function DT(s,o){const u=vr(o,s);if(Wi(u)){const c=u[1];80&u[2]?du(c,u,c.template,u[8]):u[5]>0&&Jy(u)}}function Jy(s){for(let c=xy(s);null!==c;c=Ug(c))for(let d=10;d<c.length;d++){const p=c[d];if(1024&p[2]){const y=p[1];du(y,p,y.template,p[8])}else p[5]>0&&Jy(p)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const d=vr(u[c],s);Wi(d)&&d[5]>0&&Jy(d)}}function TT(s,o){const u=vr(o,s),c=u[1];(function YE(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),Gf(c,u,u[8])}function um(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function Wf(s){for(;s;){s[2]|=64;const o=Pf(s);if(uf(s)&&!o)return s;s=o}return null}function lm(s){!function Xy(s){for(let o=0;o<s.components.length;o++){const u=s.components[o],c=Rs(u),d=c[1];VE(d,c,d.template,u)}}(s[8])}function tv(s,o,u){Cd(0),o(s,u)}const xT=(()=>Promise.resolve(null))();function nv(s){return s[7]||(s[7]=[])}function QE(s){return s.cleanup||(s.cleanup=[])}function Vi(s,o){const u=s[9],c=u?u.get(xr,null):null;c&&c.handleError(o)}function XE(s,o,u,c,d){for(let p=0;p<u.length;){const y=u[p++],E=u[p++],C=o[y],A=s.data[y];null!==A.setInput?A.setInput(C,d,c,E):C[E]=d}}function Ea(s,o,u){const c=vo(o,s);!function dE(s,o,u){wn(s)?s.setValue(o,u):o.textContent=u}(s[11],c,u)}function th(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,p=0;if(null!==o)for(let y=0;y<o.length;y++){const E=o[y];"number"==typeof E?p=E:1==p?d=we(d,E):2==p&&(c=we(c,E+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}const iv=new An("INJECTOR",-1);class sv{get(o,u=Ar){if(u===Ar){const c=new Error(`NullInjectorError: No provider for ${le(o)}!`);throw c.name="NullInjectorError",c}return u}}const ov=new An("Set Injector scope."),rh={},eI={};let zf;function RT(){return void 0===zf&&(zf=new sv),zf}function fl(s,o=null,u=null,c){const d=av(s,o,u,c);return d._resolveInjectorDefTypes(),d}function av(s,o=null,u=null,c){return new MT(s,u,o||RT(),c)}class MT{constructor(o,u,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const p=[];u&&Qr(u,E=>this.processProvider(E,o,u)),Qr([o],E=>this.processInjectorType(E,[],p)),this.records.set(iv,ih(void 0,this));const y=this.records.get(ov);this.scope=null!=y?y.value:null,this.source=d||("object"==typeof o?null:le(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,u=Ar,c=vt.Default){this.assertNotDestroyed();const d=b(this),p=un(void 0);try{if(!(c&vt.SkipSelf)){let E=this.records.get(o);if(void 0===E){const C=function rI(s){return"function"==typeof s||"object"==typeof s&&s instanceof An}(o)&&Dn(o);E=C&&this.injectableDefInScope(C)?ih(uv(o),rh):null,this.records.set(o,E)}if(null!=E)return this.hydrate(o,E)}return(c&vt.Self?RT():this.parent).get(o,u=c&vt.Optional&&u===Ar?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[Ji]=y[Ji]||[]).unshift(le(o)),d)throw y;return function yt(s,o,u,c){const d=s[Ji];throw o[Ld]&&d.unshift(o[Ld]),s.message=function Dt(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.substr(2):s;let d=le(o);if(Array.isArray(o))d=o.map(le).join(" -> ");else if("object"==typeof o){let p=[];for(let y in o)if(o.hasOwnProperty(y)){let E=o[y];p.push(y+":"+("string"==typeof E?JSON.stringify(E):le(E)))}d=`{${p.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(bf,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[Ji]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{un(p),b(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((c,d)=>o.push(le(d))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ve(205,!1)}processInjectorType(o,u,c){if(!(o=se(o)))return!1;let d=ls(o);const p=null==d&&o.ngModule||void 0,y=void 0===p?o:p,E=-1!==c.indexOf(y);if(void 0!==p&&(d=ls(p)),null==d)return!1;if(null!=d.imports&&!E){let M;c.push(y);try{Qr(d.imports,L=>{this.processInjectorType(L,u,c)&&(void 0===M&&(M=[]),M.push(L))})}finally{}if(void 0!==M)for(let L=0;L<M.length;L++){const{ngModule:K,providers:te}=M[L];Qr(te,Ie=>this.processProvider(Ie,K,te||mt))}}this.injectorDefTypes.add(y);const C=Ci(y)||(()=>new y);this.records.set(y,ih(C,rh));const A=d.providers;if(null!=A&&!E){const M=o;Qr(A,L=>this.processProvider(L,M,A))}return void 0!==p&&void 0!==o.providers}processProvider(o,u,c){let d=sh(o=se(o))?o:se(o&&o.provide);const p=function NT(s,o,u){return lv(s)?ih(void 0,s.useValue):ih(nI(s),rh)}(o);if(sh(o)||!0!==o.multi)this.records.get(d);else{let y=this.records.get(d);y||(y=ih(void 0,rh,!0),y.factory=()=>ue(y.multi),this.records.set(d,y)),d=o,y.multi.push(o)}this.records.set(d,p)}hydrate(o,u){return u.value===rh&&(u.value=eI,u.value=u.factory()),"object"==typeof u.value&&u.value&&function FT(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this.onDestroy.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=se(o.providedIn);return"string"==typeof u?"any"===u||u===this.scope:this.injectorDefTypes.has(u)}}function uv(s){const o=Dn(s),u=null!==o?o.factory:Ci(s);if(null!==u)return u;if(s instanceof An)throw new Ve(204,!1);if(s instanceof Function)return function tI(s){const o=s.length;if(o>0)throw function to(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new Ve(204,!1);const u=function Fr(s){const o=s&&(s[yi]||s[kn]);if(o){const u=function Rn(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new Ve(204,!1)}function nI(s,o,u){let c;if(sh(s)){const d=se(s);return Ci(d)||uv(d)}if(lv(s))c=()=>se(s.useValue);else if(function OT(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...ue(s.deps||[]));else if(function PT(s){return!(!s||!s.useExisting)}(s))c=()=>R(se(s.useExisting));else{const d=se(s&&(s.useClass||s.provide));if(!function kT(s){return!!s.deps}(s))return Ci(d)||uv(d);c=()=>new d(...ue(s.deps))}return c}function ih(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function lv(s){return null!==s&&"object"==typeof s&&Dg in s}function sh(s){return"function"==typeof s}let Ia=(()=>{class s{static create(u,c){var d;if(Array.isArray(u))return fl({name:""},c,u,"");{const p=null!==(d=u.name)&&void 0!==d?d:"";return fl({name:p},u.parent,u.providers,p)}}}return s.THROW_IF_NOT_FOUND=Ar,s.NULL=new sv,s.\u0275prov=nn({token:s,providedIn:"any",factory:()=>R(iv)}),s.__NG_ELEMENT_ID__=-1,s})();function hi(s,o){vs(Rs(s)[1],Cn())}function Ca(s){let o=function ti(s){return Object.getPrototypeOf(s.prototype).constructor}(s.type),u=!0;const c=[s];for(;o;){let d;if(Ii(s))d=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Ve(903,"");d=o.\u0275dir}if(d){if(u){c.push(d);const y=s;y.inputs=gv(s.inputs),y.declaredInputs=gv(s.declaredInputs),y.outputs=gv(s.outputs);const E=d.hostBindings;E&&UT(s,E);const C=d.viewQuery,A=d.contentQueries;if(C&&cI(s,C),A&&dI(s,A),me(s.inputs,d.inputs),me(s.declaredInputs,d.declaredInputs),me(s.outputs,d.outputs),Ii(d)&&d.data.animation){const M=s.data;M.animation=(M.animation||[]).concat(d.data.animation)}}const p=d.features;if(p)for(let y=0;y<p.length;y++){const E=p[y];E&&E.ngInherit&&E(s),E===Ca&&(u=!1)}}o=Object.getPrototypeOf(o)}!function VT(s){let o=0,u=null;for(let c=s.length-1;c>=0;c--){const d=s[c];d.hostVars=o+=d.hostVars,d.hostAttrs=sa(d.hostAttrs,u=sa(u,d.hostAttrs))}}(c)}function gv(s){return s===yn?{}:s===mt?[]:s}function cI(s,o){const u=s.viewQuery;s.viewQuery=u?(c,d)=>{o(c,d),u(c,d)}:o}function dI(s,o){const u=s.contentQueries;s.contentQueries=u?(c,d,p)=>{o(c,d,p),u(c,d,p)}:o}function UT(s,o){const u=s.hostBindings;s.hostBindings=u?(c,d)=>{o(c,d),u(c,d)}:o}let Kf=null;function Rr(){if(!Kf){const s=$t.Symbol;if(s&&s.iterator)Kf=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Kf=c)}}}return Kf}function Gr(s){return!!Yf(s)&&(Array.isArray(s)||!(s instanceof Map)&&Rr()in s)}function Yf(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function fi(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function fm(s,o,u,c,d){const p=function hu(s,o,u,c){const d=fi(s,o,u);return fi(s,o+1,c)||d}(s,o,u,c);return fi(s,o+2,d)||p}function gl(s,o,u,c){const d=ke();return fi(d,ta(),o)&&(Gt(),wa(Xn(),d,s,o,u,c)),gl}function ah(s,o,u,c,d,p,y,E){const A=fm(s,function Zi(){return Ct.lFrame.bindingIndex}(),u,d,y);return li(3),A?o+_e(u)+c+_e(d)+p+_e(y)+E:Pt}function wI(s,o,u,c,d,p,y,E){const C=ke(),A=Gt(),M=s+20,L=A.firstCreatePass?function Qf(s,o,u,c,d,p,y,E,C){const A=o.consts,M=Xd(o,s,4,y||null,ui(A,E));Yy(o,u,M,ui(A,C)),vs(o,M);const L=M.tViews=tm(2,M,c,d,p,o.directiveRegistry,o.pipeRegistry,null,o.schemas,A);return null!==o.queries&&(o.queries.template(o,M),L.queries=o.queries.embeddedTView(M)),M}(M,A,C,o,u,c,d,p,y):A.data[M];zi(L,!1);const K=C[11].createComment("");Yt(A,C,K,L),ut(K,C),um(C,C[M]=Qy(K,C,K,L)),$s(L)&&em(A,C,L),null!=y&&Ec(C,L,E)}function ep(s,o=vt.Default){const u=ke();return null===u?R(s,o):To(Cn(),u,se(s),o)}function Dc(){throw new Error("invalid")}function xv(s,o,u){const c=ke();return fi(c,ta(),o)&&function Ms(s,o,u,c,d,p,y,E){const C=yr(o,u);let M,A=o.inputs;!E&&null!=A&&(M=A[c])?(XE(s,u,M,c,d),Vu(o)&&function im(s,o){const u=vr(o,s);16&u[2]||(u[2]|=64)}(u,o.index)):3&o.type&&(c=function pT(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,wn(p)?p.setProperty(C,c,d):Jl(c)||(C.setProperty?C.setProperty(c,d):C[c]=d))}(Gt(),Xn(),c,s,o,c[11],u,!1),xv}function Rv(s,o,u,c,d){const y=d?"class":"style";XE(s,u,o.inputs[y],y,c)}function tp(s,o,u,c){const d=ke(),p=Gt(),y=20+s,E=d[11],C=d[y]=Zt(E,o,function yg(){return Ct.lFrame.currentNamespace}()),A=p.firstCreatePass?function Tc(s,o,u,c,d,p,y){const E=o.consts,A=Xd(o,s,2,d,ui(E,p));return Yy(o,u,A,ui(E,y)),null!==A.attrs&&th(A,A.attrs,!1),null!==A.mergedAttrs&&th(A,A.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,A),A}(y,p,d,0,o,u,c):p.data[y];zi(A,!0);const M=A.mergedAttrs;null!==M&&Ql(E,C,M);const L=A.classes;null!==L&&Ly(E,C,L);const K=A.styles;return null!==K&&Ff(E,C,K),64!=(64&A.flags)&&Yt(p,d,C,A),0===function md(){return Ct.lFrame.elementDepthCount}()&&ut(C,d),function $a(){Ct.lFrame.elementDepthCount++}(),$s(A)&&(em(p,d,A),function qf(s,o,u){if(od(o)){const d=o.directiveEnd;for(let p=o.directiveStart;p<d;p++){const y=s.data[p];y.contentQueries&&y.contentQueries(1,u[p],p)}}}(p,A,d)),null!==c&&Ec(d,A),tp}function Sc(){let s=Cn();ql()?function Ga(){Ct.lFrame.isParent=!1}():(s=s.parent,zi(s,!1));const o=s;!function _d(){Ct.lFrame.elementDepthCount--}();const u=Gt();return u.firstCreatePass&&(vs(u,s),od(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function wg(s){return 0!=(16&s.flags)}(o)&&Rv(u,o,ke(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function En(s){return 0!=(32&s.flags)}(o)&&Rv(u,o,ke(),o.stylesWithoutHost,!1),Sc}function Cm(s,o,u,c){return tp(s,o,u,c),Sc(),Cm}function np(){return ke()}function Tm(s){return!!s&&"function"==typeof s.then}function Sm(s){return!!s&&"function"==typeof s.subscribe}const Mv=Sm;function Am(s,o,u,c){const d=ke(),p=Gt(),y=Cn();return function xm(s,o,u,c,d,p,y,E){const C=$s(c),M=s.firstCreatePass&&QE(s),L=o[8],K=nv(o);let te=!0;if(3&c.type||E){const Qe=yr(c,o),st=E?E(Qe):Qe,Oe=K.length,It=E?Kt=>E(_n(Kt[c.index])):c.index;if(wn(u)){let Kt=null;if(!E&&C&&(Kt=function Nv(s,o,u,c){const d=s.cleanup;if(null!=d)for(let p=0;p<d.length-1;p+=2){const y=d[p];if(y===u&&d[p+1]===c){const E=o[7],C=d[p+2];return E.length>C?E[C]:null}"string"==typeof y&&(p+=2)}return null}(s,o,d,c.index)),null!==Kt)(Kt.__ngLastListenerFn__||Kt).__ngNextListenerFn__=p,Kt.__ngLastListenerFn__=p,te=!1;else{p=ph(c,o,L,p,!1);const cn=u.listen(st,d,p);K.push(p,cn),M&&M.push(d,It,Oe,Oe+1)}}else p=ph(c,o,L,p,!0),st.addEventListener(d,p,y),K.push(p),M&&M.push(d,It,Oe,y)}else p=ph(c,o,L,p,!1);const Ie=c.outputs;let He;if(te&&null!==Ie&&(He=Ie[d])){const Qe=He.length;if(Qe)for(let st=0;st<Qe;st+=2){const Si=o[He[st]][He[st+1]].subscribe(p),Ru=K.length;K.push(p,Si),M&&M.push(d,c.index,Ru,-(Ru+1))}}}(p,d,d[11],y,s,o,!!u,c),Am}function Rm(s,o,u,c){try{return!1!==u(c)}catch(d){return Vi(s,d),!1}}function ph(s,o,u,c,d){return function p(y){if(y===Function)return c;const E=2&s.flags?vr(s.index,o):o;0==(32&o[2])&&Wf(E);let C=Rm(o,0,c,y),A=p.__ngNextListenerFn__;for(;A;)C=Rm(o,0,A,y)&&C,A=A.__ngNextListenerFn__;return d&&!1===C&&(y.preventDefault(),y.returnValue=!1),C}}function gh(s=1){return function gf(s){return(Ct.lFrame.contextLView=function Zl(s,o){for(;s>0;)o=o[15],s--;return o}(s,Ct.lFrame.contextLView))[8]}(s)}function Mm(s,o,u,c,d){const p=s[u+1],y=null===o;let E=c?Oo(p):va(p),C=!1;for(;0!==E&&(!1===C||y);){const M=s[E+1];vh(s[E],o)&&(C=!0,s[E+1]=c?Hy(M):Uf(M)),E=c?Oo(M):va(M)}C&&(s[u+1]=c?Uf(p):Hy(p))}function vh(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&Ao(s,o)>=0}function Uv(s,o){return function Vo(s,o,u,c){const d=ke(),p=Gt(),y=li(2);p.firstUpdatePass&&function Bv(s,o,u,c){const d=s.data;if(null===d[u+1]){const p=d[Sr()],y=function mu(s,o){return o>=s.expandoStartIndex}(s,u);(function km(s,o){return 0!=(s.flags&(o?16:32))})(p,c)&&null===o&&!y&&(o=!1),o=function LI(s,o,u,c){const d=function ra(s){const o=Ct.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let p=c?o.residualClasses:o.residualStyles;if(null===d)0===(c?o.classBindings:o.styleBindings)&&(u=Ih(u=jv(null,s,o,u,c),o.attrs,c),p=null);else{const y=o.directiveStylingLast;if(-1===y||s[y]!==d)if(u=jv(d,s,o,u,c),null===p){let C=function VI(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==va(c))return s[Oo(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=jv(null,s,o,C[1],c),C=Ih(C,o.attrs,c),function Eh(s,o,u,c){s[Oo(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else p=function eS(s,o,u){let c;const d=o.directiveEnd;for(let p=1+o.directiveStylingLast;p<d;p++)c=Ih(c,s[p].hostAttrs,u);return Ih(c,o.attrs,u)}(s,o,c)}return void 0!==p&&(c?o.residualClasses=p:o.residualStyles=p),u}(d,p,o,c),function Vv(s,o,u,c,d,p){let y=p?o.classBindings:o.styleBindings,E=Oo(y),C=va(y);s[c]=u;let M,A=!1;if(Array.isArray(u)){const L=u;M=L[1],(null===M||Ao(L,M)>0)&&(A=!0)}else M=u;if(d)if(0!==C){const K=Oo(s[E+1]);s[c+1]=Lf(K,E),0!==K&&(s[K+1]=Bf(s[K+1],c)),s[E+1]=function AE(s,o){return 131071&s|o<<17}(s[E+1],c)}else s[c+1]=Lf(E,0),0!==E&&(s[E+1]=Bf(s[E+1],c)),E=c;else s[c+1]=Lf(C,0),0===E?E=c:s[C+1]=Bf(s[C+1],c),C=c;A&&(s[c+1]=Uf(s[c+1])),Mm(s,M,c,!0),Mm(s,M,c,!1),function KT(s,o,u,c,d){const p=d?s.residualClasses:s.residualStyles;null!=p&&"string"==typeof o&&Ao(p,o)>=0&&(u[c+1]=Hy(u[c+1]))}(o,M,s,c,p),y=Lf(E,C),p?o.classBindings=y:o.styleBindings=y}(d,p,o,u,y,c)}}(p,s,y,c),o!==Pt&&fi(d,y,o)&&function Pm(s,o,u,c,d,p,y,E){if(!(3&o.type))return;const C=s.data,A=C[E+1];lp(function qg(s){return 1==(1&s)}(A)?Om(C,o,u,d,va(A),y):void 0)||(lp(p)||function Vf(s){return 2==(2&s)}(A)&&(p=Om(C,null,u,d,E,y)),function IE(s,o,u,c,d){const p=wn(s);if(o)d?p?s.addClass(u,c):u.classList.add(c):p?s.removeClass(u,c):u.classList.remove(c);else{let y=-1===c.indexOf("-")?void 0:oo.DashCase;if(null==d)p?s.removeStyle(u,c,y):u.style.removeProperty(c);else{const E="string"==typeof d&&d.endsWith("!important");E&&(d=d.slice(0,-10),y|=oo.Important),p?s.setStyle(u,c,d,y):u.style.setProperty(c,d,E?"important":"")}}}(c,y,vo(Sr(),u),d,p))}(p,p.data[Sr()],d,d[11],s,d[y+1]=function BI(s,o){return null==s||("string"==typeof o?s+=o:"object"==typeof s&&(s=le(ma(s)))),s}(o,u),c,y)}(s,o,null,!0),Uv}function jv(s,o,u,c,d){let p=null;const y=u.directiveEnd;let E=u.directiveStylingLast;for(-1===E?E=u.directiveStart:E++;E<y&&(p=o[E],c=Ih(c,p.hostAttrs,d),p!==s);)E++;return null!==s&&(u.directiveStylingLast=E),c}function Ih(s,o,u){const c=u?1:2;let d=-1;if(null!==o)for(let p=0;p<o.length;p++){const y=o[p];"number"==typeof y?d=y:d===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),Hr(s,y,!!u||o[++p]))}return void 0===s?null:s}function Om(s,o,u,c,d,p){const y=null===o;let E;for(;d>0;){const C=s[d],A=Array.isArray(C),M=A?C[1]:C,L=null===M;let K=u[d+1];K===Pt&&(K=L?mt:void 0);let te=L?el(K,c):M===c?K:void 0;if(A&&!lp(te)&&(te=el(C,c)),lp(te)&&(E=te,y))return E;const Ie=s[d+1];d=y?Oo(Ie):va(Ie)}if(null!==o){let C=p?o.residualClasses:o.residualStyles;null!=C&&(E=el(C,c))}return E}function lp(s){return void 0!==s}function jI(s,o=""){const u=ke(),c=Gt(),d=s+20,p=c.firstCreatePass?Xd(c,d,1,o,null):c.data[d],y=u[d]=function My(s,o){return wn(s)?s.createText(o):s.createTextNode(o)}(u[11],o);Yt(c,u,y,p),zi(p,!1)}function $v(s){return Fm("",s,""),$v}function Fm(s,o,u){const c=ke(),d=function ml(s,o,u,c){return fi(s,ta(),u)?o+_e(u)+c:Pt}(c,s,o,u);return d!==Pt&&Ea(c,Sr(),d),Fm}function Ac(s,o,u,c,d,p,y){const E=ke(),C=ah(E,s,o,u,c,d,p,y);return C!==Pt&&Ea(E,Sr(),C),Ac}const Il=void 0;var QI=["en",[["a","p"],["AM","PM"],Il],[["AM","PM"],Il,Il],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Il,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Il,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Il,"{1} 'at' {0}",Il],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Hm(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let xc={};function $m(s){const o=function JI(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=Jv(o);if(u)return u;const c=o.split("-")[0];if(u=Jv(c),u)return u;if("en"===c)return QI;throw new Error(`Missing locale data for the locale "${s}".`)}function Qv(s){return $m(s)[ct.PluralCase]}function Jv(s){return s in xc||(xc[s]=$t.ng&&$t.ng.common&&$t.ng.common.locales&&$t.ng.common.locales[s]),xc[s]}var ct=(()=>((ct=ct||{})[ct.LocaleId=0]="LocaleId",ct[ct.DayPeriodsFormat=1]="DayPeriodsFormat",ct[ct.DayPeriodsStandalone=2]="DayPeriodsStandalone",ct[ct.DaysFormat=3]="DaysFormat",ct[ct.DaysStandalone=4]="DaysStandalone",ct[ct.MonthsFormat=5]="MonthsFormat",ct[ct.MonthsStandalone=6]="MonthsStandalone",ct[ct.Eras=7]="Eras",ct[ct.FirstDayOfWeek=8]="FirstDayOfWeek",ct[ct.WeekendRange=9]="WeekendRange",ct[ct.DateFormat=10]="DateFormat",ct[ct.TimeFormat=11]="TimeFormat",ct[ct.DateTimeFormat=12]="DateTimeFormat",ct[ct.NumberSymbols=13]="NumberSymbols",ct[ct.NumberFormats=14]="NumberFormats",ct[ct.CurrencyCode=15]="CurrencyCode",ct[ct.CurrencySymbol=16]="CurrencySymbol",ct[ct.CurrencyName=17]="CurrencyName",ct[ct.Currencies=18]="Currencies",ct[ct.Directionality=19]="Directionality",ct[ct.PluralCase=20]="PluralCase",ct[ct.ExtraData=21]="ExtraData",ct))();const Gm="en-US";let eC=Gm;function Kn(s,o,u,c,d){if(s=se(s),Array.isArray(s))for(let p=0;p<s.length;p++)Kn(s[p],o,u,c,d);else{const p=Gt(),y=ke();let E=sh(s)?s:se(s.provide),C=nI(s);const A=Cn(),M=1048575&A.providerIndexes,L=A.directiveStart,K=A.providerIndexes>>20;if(sh(s)||!s.multi){const te=new ia(C,d,ep),Ie=e_(E,o,d?M:M+K,L);-1===Ie?(Qs(Er(A,y),p,E),vu(p,s,o.length),o.push(E),A.directiveStart++,A.directiveEnd++,d&&(A.providerIndexes+=1048576),u.push(te),y.push(te)):(u[Ie]=te,y[Ie]=te)}else{const te=e_(E,o,M+K,L),Ie=e_(E,o,M,M+K),He=te>=0&&u[te],Qe=Ie>=0&&u[Ie];if(d&&!Qe||!d&&!He){Qs(Er(A,y),p,E);const st=function yp(s,o,u,c,d){const p=new ia(s,u,ep);return p.multi=[],p.index=o,p.componentProviders=0,Xm(p,d,c&&!u),p}(d?bS:_p,u.length,d,c,C);!d&&Qe&&(u[Ie].providerFactory=st),vu(p,s,o.length,0),o.push(E),A.directiveStart++,A.directiveEnd++,d&&(A.providerIndexes+=1048576),u.push(st),y.push(st)}else vu(p,s,te>-1?te:Ie,Xm(u[d?Ie:te],C,!d&&c));!d&&c&&Qe&&u[Ie].componentProviders++}}}function vu(s,o,u,c){const d=sh(o),p=function cv(s){return!!s.useClass}(o);if(d||p){const C=(p?se(o.useClass):o).prototype.ngOnDestroy;if(C){const A=s.destroyHooks||(s.destroyHooks=[]);if(!d&&o.multi){const M=A.indexOf(u);-1===M?A.push(u,[c,C]):A[M+1].push(c,C)}else A.push(u,C)}}}function Xm(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function e_(s,o,u,c){for(let d=u;d<c;d++)if(o[d]===s)return d;return-1}function _p(s,o,u,c){return Da(this.multi,[])}function bS(s,o,u,c){const d=this.multi;let p;if(this.providerFactory){const y=this.providerFactory.componentProviders,E=Ds(u,u[1],this.providerFactory.index,c);p=E.slice(0,y),Da(d,p);for(let C=y;C<E.length;C++)p.push(E[C])}else p=[],Da(d,p);return p}function Da(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function Ph(s,o=[]){return u=>{u.providersResolver=(c,d)=>function Tl(s,o,u){const c=Gt();if(c.firstCreatePass){const d=Ii(s);Kn(u,c.data,c.blueprint,d,!0),Kn(o,c.data,c.blueprint,d,!1)}}(c,d?d(s):s,o)}}class wu{}class vp{resolveComponentFactory(o){throw function t_(s){const o=Error(`No component factory found for ${le(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Bo=(()=>{class s{}return s.NULL=new vp,s})();function pC(){return jo(Cn(),ke())}function jo(s,o){return new Fc(yr(s,o))}let Fc=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=pC,s})();function Lc(s){return s instanceof Fc?s.nativeElement:s}class Oh{}let mC=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function n_(){const s=ke(),u=vr(Cn().index,s);return function _C(s){return s[11]}(Oi(u)?u:s)}(),s})(),wp=(()=>{class s{}return s.\u0275prov=nn({token:s,providedIn:"root",factory:()=>null}),s})();class l0{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const yC=new l0("13.3.11"),c0={};function Ep(s,o,u,c,d=!1){for(;null!==u;){const p=o[u.index];if(null!==p&&c.push(_n(p)),Ei(p))for(let E=10;E<p.length;E++){const C=p[E],A=C[1].firstChild;null!==A&&Ep(C[1],C,A,c)}const y=u.type;if(8&y)Ep(s,o,u.child,c);else if(32&y){const E=Vg(u,o);let C;for(;C=E();)c.push(C)}else if(16&y){const E=wE(o,u);if(Array.isArray(E))c.push(...E);else{const C=Pf(o[16]);Ep(C[1],C,E,c,!0)}}u=d?u.projectionNext:u.next}return c}class kh{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Ep(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Ei(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(ao(o,c),So(u,c))}this._attachedToViewContainer=!1}Py(this._lView[1],this._lView)}onDestroy(o){nm(this._lView[1],this._lView,null,o)}markForCheck(){Wf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function ev(s,o,u){const c=o[10];c.begin&&c.begin();try{du(s,o,s.template,u)}catch(d){throw Vi(o,d),d}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ve(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fE(s,o){Yd(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Ve(902,"");this._appRef=o}}class _i extends kh{constructor(o){super(o),this._view=o}detectChanges(){lm(this._view)}checkNoChanges(){}get context(){return null}}class d0 extends Bo{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=ht(o);return new Iu(u,this.ngModule)}}function Nn(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class Iu extends wu{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function lu(s){return s.map(By).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return Nn(this.componentDef.inputs)}get outputs(){return Nn(this.componentDef.outputs)}create(o,u,c,d){const p=(d=d||this.ngModule)?function vC(s,o){return{get:(u,c,d)=>{const p=s.get(u,c0,d);return p!==c0||c===c0?p:o.get(u,c,d)}}}(o,d.injector):o,y=p.get(Oh,ja),E=p.get(wp,null),C=y.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",M=c?function BE(s,o,u){if(wn(s))return s.selectRootElement(o,u===Ht.ShadowDom);let c="string"==typeof o?s.querySelector(o):o;return c.textContent="",c}(C,c,this.componentDef.encapsulation):Zt(y.createRenderer(null,this.componentDef),A,function DS(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(A)),L=this.componentDef.onPush?576:528,K=function lI(s,o){return{components:[],scheduler:s||Nf,clean:xT,playerHandler:o||null,flags:0}}(),te=tm(0,null,null,1,0,null,null,null,null,null),Ie=hl(null,te,K,L,null,null,y,C,E,p);let He,Qe;za(Ie);try{const st=function aI(s,o,u,c,d,p){const y=u[1];u[20]=s;const C=Xd(y,20,2,"#host",null),A=C.mergedAttrs=o.hostAttrs;null!==A&&(th(C,A,!0),null!==s&&(Ql(d,s,A),null!==C.classes&&Ly(d,s,C.classes),null!==C.styles&&Ff(d,s,C.styles)));const M=c.createRenderer(s,o),L=hl(u,Zy(o),null,o.onPush?64:16,u[20],C,c,M,p||null,null);return y.firstCreatePass&&(Qs(Er(C,u),y,o.type),GE(y,C),WE(C,u.length,1)),um(u,L),u[20]=L}(M,this.componentDef,Ie,y,C);if(M)if(c)Ql(C,M,["ng-version",yC.full]);else{const{attrs:Oe,classes:It}=function Qd(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let p=s[c];if("string"==typeof p)2===d?""!==p&&o.push(p,s[++c]):8===d&&u.push(p);else{if(!ts(d))break;d=p}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);Oe&&Ql(C,M,Oe),It&&It.length>0&&Ly(C,M,It.join(" "))}if(Qe=Vn(te,20),void 0!==u){const Oe=Qe.projection=[];for(let It=0;It<this.ngContentSelectors.length;It++){const Kt=u[It];Oe.push(null!=Kt?Array.from(Kt):null)}}He=function uI(s,o,u,c,d){const p=u[1],y=function mT(s,o,u){const c=Cn();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),zE(s,c,o,eh(s,o,1,null),u));const d=Ds(o,s,c.directiveStart,c);ut(d,o);const p=yr(c,o);return p&&ut(p,o),d}(p,u,o);if(c.components.push(y),s[8]=y,d&&d.forEach(C=>C(y,o)),o.contentQueries){const C=Cn();o.contentQueries(1,y,C.directiveStart)}const E=Cn();return!p.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Co(E.index),HE(u[1],E,0,E.directiveStart,E.directiveEnd,o),$E(o,y)),y}(st,this.componentDef,Ie,K,[hi]),Gf(te,Ie,null)}finally{ci()}return new i_(this.componentType,He,jo(Qe,Ie),Ie,Qe)}}class i_ extends class fC{}{constructor(o,u,c,d,p){super(),this.location=c,this._rootLView=d,this._tNode=p,this.instance=u,this.hostView=this.changeDetectorRef=new _i(d),this.componentType=o}get injector(){return new Ir(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class Vc{}class h0{}const pr=new Map;class IC extends Vc{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new d0(this);const c=Ut(o);this._bootstrapComponents=ya(c.bootstrap),this._r3Injector=av(o,u,[{provide:Vc,useValue:this},{provide:Bo,useValue:this.componentFactoryResolver}],le(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,u=Ia.THROW_IF_NOT_FOUND,c=vt.Default){return o===Ia||o===Vc||o===iv?this:this._r3Injector.get(o,u,c)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class f0 extends h0{constructor(o){super(),this.moduleType=o,null!==Ut(o)&&function SS(s){const o=new Set;!function u(c){const d=Ut(c,!0),p=d.id;null!==p&&(function wC(s,o,u){if(o&&o!==u)throw new Error(`Duplicate module registered for ${s} - ${le(o)} vs ${le(o.name)}`)}(p,pr.get(p),c),pr.set(p,c));const y=ya(d.imports);for(const E of y)o.has(E)||(o.add(E),u(E))}(s)}(o)}create(o){return new IC(this.moduleType,o)}}function Bh(s){return o=>{setTimeout(s,void 0,o)}}const Ta=class MC extends f.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){var d,p,y;let E=o,C=u||(()=>null),A=c;if(o&&"object"==typeof o){const L=o;E=null===(d=L.next)||void 0===d?void 0:d.bind(L),C=null===(p=L.error)||void 0===p?void 0:p.bind(L),A=null===(y=L.complete)||void 0===y?void 0:y.bind(L)}this.__isAsync&&(C=Bh(C),E&&(E=Bh(E)),A&&(A=Bh(A)));const M=super.subscribe({next:E,error:C,complete:A});return o instanceof j.w0&&o.add(M),M}};function MS(){return this._results[Rr()]()}class a_{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=Rr(),c=a_.prototype;c[u]||(c[u]=MS)}get changes(){return this._changes||(this._changes=new Ta)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=Yr(o);(this._changesDetected=!function Od(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],p=o[c];if(u&&(d=u(d),p=u(p)),p!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Sa=(()=>{class s{}return s.__NG_ELEMENT_ID__=Hc,s})();const jc=Sa,NC=class extends jc{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o){const u=this._declarationTContainer.tViews,c=hl(this._declarationLView,u,o,16,null,u.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const p=this._declarationLView[19];return null!==p&&(c[19]=p.createEmbeddedView(u)),Gf(u,c,o),new kh(c)}};function Hc(){return Cp(Cn(),ke())}function Cp(s,o){return 4&s.type?new NC(o,s,jo(s,o)):null}let bu=(()=>{class s{}return s.__NG_ELEMENT_ID__=PC,s})();function PC(){return Hn(Cn(),ke())}const OC=bu,jh=class extends OC{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return jo(this._hostTNode,this._hostLView)}get injector(){return new Ir(this._hostTNode,this._hostLView)}get parentInjector(){const o=Qu(this._hostTNode,this._hostLView);if(aa(o)){const u=wt(o,this._hostLView),c=sn(o);return new Ir(u[1].data[c+8],u)}return new Ir(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=kC(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){const d=o.createEmbeddedView(u||{});return this.insert(d,c),d}createComponent(o,u,c,d,p){const y=o&&!function Un(s){return"function"==typeof s}(o);let E;if(y)E=u;else{const L=u||{};E=L.index,c=L.injector,d=L.projectableNodes,p=L.ngModuleRef}const C=y?o:new Iu(ht(o)),A=c||this.parentInjector;if(!p&&null==C.ngModule){const K=(y?A:this.parentInjector).get(Vc,null);K&&(p=K)}const M=C.create(A,d,void 0,p);return this.insert(M.hostView,E),M}insert(o,u){const c=o._lView,d=c[1];if(function Gl(s){return Ei(s[3])}(c)){const M=this.indexOf(o);if(-1!==M)this.detach(M);else{const L=c[3],K=new jh(L,L[6],L[3]);K.detach(K.indexOf(o))}}const p=this._adjustIndex(u),y=this._lContainer;!function QD(s,o,u,c){const d=10+c,p=u.length;c>0&&(u[d-1][4]=o),c<p-10?(o[4]=u[d],Ja(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const y=o[17];null!==y&&u!==y&&function JD(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(y,o);const E=o[19];null!==E&&E.insertView(s),o[2]|=128}(d,c,y,p);const E=uu(p,y),C=c[11],A=jg(C,y[7]);return null!==A&&function Zd(s,o,u,c,d,p){c[0]=d,c[6]=o,Yd(s,c,u,1,d,p)}(d,y[6],C,c,A,E),o.attachToViewContainerRef(),Ja(_0(y),p,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=kC(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=ao(this._lContainer,u);c&&(So(_0(this._lContainer),u),Py(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=ao(this._lContainer,u);return c&&null!=So(_0(this._lContainer),u)?new kh(c):null}_adjustIndex(o,u=0){return null==o?this.length+u:o}};function kC(s){return s[8]}function _0(s){return s[8]||(s[8]=[])}function Hn(s,o){let u;const c=o[s.index];if(Ei(c))u=c;else{let d;if(8&s.type)d=_n(c);else{const p=o[11];d=p.createComment("");const y=yr(s,o);pc(p,jg(p,y),d,function yE(s,o){return wn(s)?s.nextSibling(o):o.nextSibling}(p,y),!1)}o[s.index]=u=Qy(c,o,d,s),um(o,u)}return new jh(u,s,o)}class y0{constructor(o){this.queryList=o,this.matches=null}clone(){return new y0(this.queryList)}setDirty(){this.queryList.setDirty()}}class $c{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let p=0;p<c;p++){const y=u.getByIndex(p);d.push(this.queries[y.indexInDeclarationView].clone())}return new $c(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==w0(o,u).matches&&this.queries[u].setDirty()}}class FC{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class c_{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,p=this.getByIndex(c).embeddedTView(o,d);p&&(p.indexInDeclarationView=c,null!==u?u.push(p):u=[p])}return null!==u?new c_(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class xl{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new xl(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const p=c[d];this.matchTNodeWithReadOption(o,u,Du(u,p)),this.matchTNodeWithReadOption(o,u,ua(u,o,p,!1,!1))}else c===Sa?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,ua(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Fc||d===bu||d===Sa&&4&u.type)this.addMatch(u.index,-2);else{const p=ua(u,o,d,!1,!1);null!==p&&this.addMatch(u.index,p)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function Du(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function VC(s,o,u,c){return-1===u?function LC(s,o){return 11&s.type?jo(s,o):4&s.type?Cp(s,o):null}(o,s):-2===u?function UC(s,o,u){return u===Fc?jo(o,s):u===Sa?Cp(o,s):u===bu?Hn(o,s):void 0}(s,o,c):Ds(s,s[1],u,o)}function Gc(s,o,u,c){const d=o[19].queries[c];if(null===d.matches){const p=s.data,y=u.matches,E=[];for(let C=0;C<y.length;C+=2){const A=y[C];E.push(A<0?null:VC(o,p[A],y[C+1],u.metadata.read))}d.matches=E}return d.matches}function bp(s,o,u,c){const d=s.queries.getByIndex(u),p=d.matches;if(null!==p){const y=Gc(s,o,d,u);for(let E=0;E<p.length;E+=2){const C=p[E];if(C>0)c.push(y[E/2]);else{const A=p[E+1],M=o[-C];for(let L=10;L<M.length;L++){const K=M[L];K[17]===K[3]&&bp(K[1],K,A,c)}if(null!==M[9]){const L=M[9];for(let K=0;K<L.length;K++){const te=L[K];bp(te[1],te,A,c)}}}}}return c}function BC(s){const o=ke(),u=Gt(),c=Id();Cd(c+1);const d=w0(u,c);if(s.dirty&&Jo(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const p=d.crossesNgTemplate?bp(u,o,c,[]):Gc(u,o,d,c);s.reset(p,Lc),s.notifyOnChanges()}return!0}return!1}function an(s,o,u,c){const d=Gt();if(d.firstCreatePass){const p=Cn();(function HC(s,o,u){null===s.queries&&(s.queries=new c_),s.queries.track(new xl(o,u))})(d,new FC(o,u,c),p.index),function is(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function Tu(s,o,u){const c=new a_(4==(4&u));nm(s,o,c,c.destroy),null===o[19]&&(o[19]=new $c),o[19].queries.push(new y0(c))}(d,ke(),u)}function v0(){return function jC(s,o){return s[19].queries[o].queryList}(ke(),Id())}function w0(s,o){return s.queries.getByIndex(o)}function y_(...s){}const Ho=new An("Application Initializer");let v_=(()=>{class s{constructor(u){this.appInits=u,this.resolve=y_,this.reject=y_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const p=this.appInits[d]();if(Tm(p))u.push(p);else if(Mv(p)){const y=new Promise((E,C)=>{p.subscribe({complete:E,error:C})});u.push(y)}}Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(R(Ho,8))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const kp=new An("AppId",{providedIn:"root",factory:function R0(){return`${M0()}${M0()}${M0()}`}});function M0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const QC=new An("Platform Initializer"),HS=new An("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),JC=new An("appBootstrapListener");let $S=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const N0=new An("LocaleId",{providedIn:"root",factory:()=>X(N0,vt.Optional|vt.SkipSelf)||function GS(){return"undefined"!=typeof $localize&&$localize.locale||Gm}()}),qS=new An("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class WS{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let zS=(()=>{class s{compileModuleSync(u){return new f0(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),p=ya(Ut(u).declarations).reduce((y,E)=>{const C=ht(E);return C&&y.push(new Iu(C)),y},[]);return new WS(c,p)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const eb=(()=>Promise.resolve(0))();function w_(s){"undefined"==typeof Zone?eb.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Os{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ta(!1),this.onMicrotaskEmpty=new Ta(!1),this.onStable=new Ta(!1),this.onError=new Ta(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function ZS(){let s=$t.requestAnimationFrame,o=$t.cancelAnimationFrame;if("undefined"!=typeof Zone&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function O0(s){const o=()=>{!function P0(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call($t,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,xa(s),s.isCheckStableRunning=!0,Fp(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),xa(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,p,y,E)=>{try{return k0(s),u.invokeTask(d,p,y,E)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===p.type||s.shouldCoalesceRunChangeDetection)&&o(),tb(s)}},onInvoke:(u,c,d,p,y,E,C)=>{try{return k0(s),u.invoke(d,p,y,E,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),tb(s)}},onHasTask:(u,c,d,p)=>{u.hasTask(d,p),c===d&&("microTask"==p.change?(s._hasPendingMicrotasks=p.microTask,xa(s),Fp(s)):"macroTask"==p.change&&(s.hasPendingMacrotasks=p.macroTask))},onHandleError:(u,c,d,p)=>(u.handleError(d,p),s.runOutsideAngular(()=>s.onError.emit(p)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Os.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Os.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const p=this._inner,y=p.scheduleEventTask("NgZoneEvent: "+d,o,ii,y_,y_);try{return p.runTask(y,u,c)}finally{p.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const ii={};function Fp(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function xa(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function k0(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function tb(s){s._nesting--,Fp(s)}class nb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ta,this.onMicrotaskEmpty=new Ta,this.onStable=new Ta,this.onError=new Ta}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}let Lp=(()=>{class s{constructor(u){this._ngZone=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Os.assertNotInAngularZone(),w_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())w_(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let p=-1;c&&c>0&&(p=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==p),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:p,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(R(Os))},s.\u0275prov=nn({token:s,factory:s.\u0275fac}),s})(),qc=(()=>{class s{constructor(){this._applications=new Map,Zc.addToWindow(this)}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return Zc.findTestabilityInTree(this,u,c)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();class Wc{addToWindow(o){}findTestabilityInTree(o,u,c){return null}}function zc(s){Zc=s}let Zc=new Wc,Ml=null;const E_=new An("AllowMultipleToken"),I_=new An("PlatformOnDestroy");class ib{constructor(o,u){this.name=o,this.token=u}}function Vp(s,o,u=[]){const c=`Platform: ${o}`,d=new An(c);return(p=[])=>{let y=C_();if(!y||y.injector.get(E_,!1)){const E=[...u,...p,{provide:d,useValue:!0}];s?s(E):function sb(s){if(Ml&&!Ml.get(E_,!1))throw new Ve(400,"");Ml=s;const o=s.get(ob),u=s.get(QC,null);u&&u.forEach(c=>c())}(function Kc(s=[],o){return Ia.create({name:o,providers:[{provide:ov,useValue:"platform"},{provide:I_,useValue:()=>Ml=null},...s]})}(E,c))}return function Up(s){const o=C_();if(!o)throw new Ve(401,"");return o}()}}function C_(){var s;return null!==(s=null==Ml?void 0:Ml.get(ob))&&void 0!==s?s:null}let ob=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const E=function QS(s,o){let u;return u="noop"===s?new nb:("zone.js"===s?void 0:s)||new Os({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),u}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),C=[{provide:Os,useValue:E}];return E.run(()=>{const A=Ia.create({providers:C,parent:this.injector,name:u.moduleType.name}),M=u.create(A),L=M.injector.get(xr,null);if(!L)throw new Ve(402,"");return E.runOutsideAngular(()=>{const K=E.onError.subscribe({next:te=>{L.handleError(te)}});M.onDestroy(()=>{Au(this._modules,M),K.unsubscribe()})}),function JS(s,o,u){try{const c=u();return Tm(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(L,E,()=>{const K=M.injector.get(v_);return K.runInitializers(),K.donePromise.then(()=>(function Wm(s){Lt(s,"Expected localeId to be defined"),"string"==typeof s&&(eC=s.toLowerCase().replace(/_/g,"-"))}(M.injector.get(N0,Gm)||Gm),this._moduleDoBootstrap(M),M))})})}bootstrapModule(u,c=[]){const d=$h({},c);return function rb(s,o,u){const c=new f0(u);return Promise.resolve(c)}(0,0,u).then(p=>this.bootstrapModuleFactory(p,d))}_moduleDoBootstrap(u){const c=u.injector.get(Su);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new Ve(403,"");u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ve(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(I_,null);null==u||u(),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(R(Ia))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function $h(s,o){return Array.isArray(o)?o.reduce($h,s):Object.assign(Object.assign({},s),o)}let Su=(()=>{class s{constructor(u,c,d,p){this._zone=u,this._injector=c,this._exceptionHandler=d,this._initStatus=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const y=new P.y(C=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{C.next(this._stable),C.complete()})}),E=new P.y(C=>{let A;this._zone.runOutsideAngular(()=>{A=this._zone.onStable.subscribe(()=>{Os.assertNotInAngularZone(),w_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,C.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{Os.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{C.next(!1)}))});return()=>{A.unsubscribe(),M.unsubscribe()}});this.isStable=(0,ae.T)(y,E.pipe((0,ce.B)()))}bootstrap(u,c){if(!this._initStatus.done)throw new Ve(405,"");let d;d=u instanceof wu?u:this._injector.get(Bo).resolveComponentFactory(u),this.componentTypes.push(d.componentType);const p=function YS(s){return s.isBoundToModule}(d)?void 0:this._injector.get(Vc),E=d.create(Ia.NULL,[],c||d.selector,p),C=E.location.nativeElement,A=E.injector.get(Lp,null),M=A&&E.injector.get(qc);return A&&M&&M.registerApplication(C,A),E.onDestroy(()=>{this.detachView(E.hostView),Au(this.components,E),M&&M.unregisterApplication(C)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new Ve(101,"");try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;Au(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(JC,[]).concat(this._bootstrapListeners).forEach(d=>d(u))}ngOnDestroy(){this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return s.\u0275fac=function(u){return new(u||s)(R(Os),R(Ia),R(xr),R(v_))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Au(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let ab=!0,b_=!1;function D_(){return b_=!0,ab}function eA(){if(b_)throw new Error("Cannot enable prod mode after platform setup.");ab=!1}let jp=(()=>{class s{}return s.__NG_ELEMENT_ID__=ub,s})();function ub(s){return function lb(s,o,u){if(Vu(s)&&!u){const c=vr(s.index,o);return new kh(c,c)}return 47&s.type?new kh(o[16],o):null}(Cn(),ke(),16==(16&s))}class hb{constructor(){}supports(o){return Gr(o)}create(o){return new Qc(o)}}const fb=(s,o)=>o;class Qc{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||fb}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,p=null;for(;u||c;){const y=!c||u&&u.currentIndex<gb(c,d,p)?u:c,E=gb(y,d,p),C=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{p||(p=[]);const A=E-d,M=C-d;if(A!=M){for(let K=0;K<A;K++){const te=K<p.length?p[K]:p[K]=0,Ie=te+K;M<=Ie&&Ie<A&&(p[K]=te+1)}p[y.previousIndex]=M-A}}E!==C&&o(y,E,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Gr(o))throw new Ve(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,p,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let E=0;E<this.length;E++)p=o[E],y=this._trackByFn(E,p),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,p,y,E)),Object.is(u.item,p)||this._addIdentityChange(u,p)):(u=this._mismatch(u,p,y,E),c=!0),u=u._next}else d=0,function pI(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[Rr()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,E=>{y=this._trackByFn(d,E),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,E,y,d)),Object.is(u.item,E)||this._addIdentityChange(u,E)):(u=this._mismatch(u,E,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let p;return null===o?p=this._itTail:(p=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,p,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,p,d)):o=this._addAfter(new Hp(u,c),p,d),o}_verifyReinsertion(o,u,c,d){let p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==p?o=this._reinsertAfter(p,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,p=o._nextRemoved;return null===d?this._removalsHead=p:d._nextRemoved=p,null===p?this._removalsTail=d:p._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new $0),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Hp{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pb{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class $0{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new pb,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function gb(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class G0{constructor(){}supports(o){return o instanceof Map||Yf(o)}create(){return new aA}}class aA{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Yf(o)))throw new Ve(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const p=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,p)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const p=d._prev,y=d._next;return p&&(p._next=y),y&&(y._prev=p),d._next=null,d._prev=null,d}const c=new uA(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class uA{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function x_(){return new Or([new hb])}let Or=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||x_()),deps:[[s,new cr,new ot]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new Ve(901,"")}}return s.\u0275prov=nn({token:s,providedIn:"root",factory:x_}),s})();function mb(){return new q0([new G0])}let q0=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||mb()),deps:[[s,new cr,new ot]]}}find(u){const c=this.factories.find(p=>p.supports(u));if(c)return c;throw new Ve(901,"")}}return s.\u0275prov=nn({token:s,providedIn:"root",factory:mb}),s})();const cA=Vp(null,"core",[]);let yb=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(R(Su))},s.\u0275mod=ee({type:s}),s.\u0275inj=Jt({}),s})()},3942:(nt,be,F)=>{F.d(be,{Z:()=>Ve});var f=F(2090),j=F(4859),P=F(9681),ae=F(1877);class ce{constructor(_e,Te){this._delegate=_e,this.firebase=Te,(0,P._addComponent)(_e,new j.wA("app-compat",()=>this,"PUBLIC")),this.container=_e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(_e){this._delegate.automaticDataCollectionEnabled=_e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(_e=>{this._delegate.checkDestroyed(),_e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,P.deleteApp)(this._delegate)))}_getService(_e,Te=P._DEFAULT_ENTRY_NAME){var Ze;this._delegate.checkDestroyed();const We=this._delegate.container.getProvider(_e);return!We.isInitialized()&&"EXPLICIT"===(null===(Ze=We.getComponent())||void 0===Ze?void 0:Ze.instantiationMode)&&We.initialize(),We.getImmediate({identifier:Te})}_removeServiceInstance(_e,Te=P._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(_e).clearInstance(Te)}_addComponent(_e){(0,P._addComponent)(this._delegate,_e)}_addOrOverwriteComponent(_e){(0,P._addOrOverwriteComponent)(this._delegate,_e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const me=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),G=function we(){const Ge=function le(Ge){const _e={},Te={__esModule:!0,initializeApp:function Fe(re,ge={}){const Ce=P.initializeApp(re,ge);if((0,f.r3)(_e,Ce.name))return _e[Ce.name];const J=new Ge(Ce,Te);return _e[Ce.name]=J,J},app:We,registerVersion:P.registerVersion,setLogLevel:P.setLogLevel,onLog:P.onLog,apps:null,SDK_VERSION:P.SDK_VERSION,INTERNAL:{registerComponent:function De(re){const ge=re.name,Ce=ge.replace("-compat","");if(P._registerComponent(re)&&"PUBLIC"===re.type){const J=(ie=We())=>{if("function"!=typeof ie[Ce])throw me.create("invalid-app-argument",{appName:ge});return ie[Ce]()};void 0!==re.serviceProps&&(0,f.ZB)(J,re.serviceProps),Te[Ce]=J,Ge.prototype[Ce]=function(...ie){return this._getService.bind(this,ge).apply(this,re.multipleInstances?ie:[])}}return"PUBLIC"===re.type?Te[Ce]:null},removeApp:function Ze(re){delete _e[re]},useAsService:function ze(re,ge){return"serverAuth"===ge?null:ge},modularAPIs:P}};function We(re){if(!(0,f.r3)(_e,re=re||P._DEFAULT_ENTRY_NAME))throw me.create("no-app",{appName:re});return _e[re]}return Te.default=Te,Object.defineProperty(Te,"apps",{get:function Me(){return Object.keys(_e).map(re=>_e[re])}}),We.App=Ge,Te}(ce);return Ge.INTERNAL=Object.assign(Object.assign({},Ge.INTERNAL),{createFirebaseNamespace:we,extendNamespace:function _e(Te){(0,f.ZB)(Ge,Te)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),Ge}(),q=new ae.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){q.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ge=self.firebase.SDK_VERSION;Ge&&Ge.indexOf("LITE")>=0&&q.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ve=G;!function Pe(Ge){(0,P.registerVersion)("@firebase/app-compat","0.1.33",Ge)}()},9681:(nt,be,F)=>{F.r(be),F.d(be,{FirebaseError:()=>ae.ZR,SDK_VERSION:()=>yi,_DEFAULT_ENTRY_NAME:()=>Lt,_addComponent:()=>gn,_addOrOverwriteComponent:()=>nn,_apps:()=>pn,_clearComponents:()=>Mi,_components:()=>On,_getProvider:()=>Jt,_registerComponent:()=>Vt,_removeServiceInstance:()=>Dn,deleteApp:()=>vt,getApp:()=>kn,getApps:()=>Gi,initializeApp:()=>Ni,onLog:()=>un,registerVersion:()=>Tn,setLogLevel:()=>ir});var f=F(5861),j=F(4859),P=F(1877),ae=F(2090),ce=F(8766);class ye{constructor($){this.container=$}getPlatformInfoString(){return this.container.getProviders().map(Z=>{if(function me(B){const $=B.getComponent();return"VERSION"===(null==$?void 0:$.type)}(Z)){const Re=Z.getImmediate();return`${Re.library}/${Re.version}`}return null}).filter(Z=>Z).join(" ")}}const le="@firebase/app",G=new P.Yd("@firebase/app"),Lt="[DEFAULT]",Ye={[le]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},pn=new Map,On=new Map;function gn(B,$){try{B.container.addComponent($)}catch(Z){G.debug(`Component ${$.name} failed to register with FirebaseApp ${B.name}`,Z)}}function nn(B,$){B.container.addOrOverwriteComponent($)}function Vt(B){const $=B.name;if(On.has($))return G.debug(`There were multiple attempts to register component ${$}.`),!1;On.set($,B);for(const Z of pn.values())gn(Z,B);return!0}function Jt(B,$){const Z=B.container.getProvider("heartbeat").getImmediate({optional:!0});return Z&&Z.triggerHeartbeat(),B.container.getProvider($)}function Dn(B,$,Z=Lt){Jt(B,$).clearInstance(Z)}function Mi(){On.clear()}const Rn=new ae.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ls{constructor($,Z,Re){this._isDeleted=!1,this._options=Object.assign({},$),this._config=Object.assign({},Z),this._name=Z.name,this._automaticDataCollectionEnabled=Z.automaticDataCollectionEnabled,this._container=Re,this.container.addComponent(new j.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled($){this.checkDestroyed(),this._automaticDataCollectionEnabled=$}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted($){this._isDeleted=$}checkDestroyed(){if(this.isDeleted)throw Rn.create("app-deleted",{appName:this._name})}}const yi="9.9.4";function Ni(B,$={}){"object"!=typeof $&&($={name:$});const Z=Object.assign({name:Lt,automaticDataCollectionEnabled:!1},$),Re=Z.name;if("string"!=typeof Re||!Re)throw Rn.create("bad-app-name",{appName:String(Re)});const $e=pn.get(Re);if($e){if((0,ae.vZ)(B,$e.options)&&(0,ae.vZ)(Z,$e.config))return $e;throw Rn.create("duplicate-app",{appName:Re})}const bt=new j.H0(Re);for(const Xt of On.values())bt.addComponent(Xt);const rn=new ls(B,Z,bt);return pn.set(Re,rn),rn}function kn(B=Lt){const $=pn.get(B);if(!$)throw Rn.create("no-app",{appName:B});return $}function Gi(){return Array.from(pn.values())}function vt(B){return Lr.apply(this,arguments)}function Lr(){return(Lr=(0,f.Z)(function*(B){const $=B.name;pn.has($)&&(pn.delete($),yield Promise.all(B.container.getProviders().map(Z=>Z.delete())),B.isDeleted=!0)})).apply(this,arguments)}function Tn(B,$,Z){var Re;let $e=null!==(Re=Ye[B])&&void 0!==Re?Re:B;Z&&($e+=`-${Z}`);const bt=$e.match(/\s|\//),rn=$.match(/\s|\//);if(bt||rn){const Xt=[`Unable to register library "${$e}" with version "${$}":`];return bt&&Xt.push(`library name "${$e}" contains illegal characters (whitespace or "/")`),bt&&rn&&Xt.push("and"),rn&&Xt.push(`version name "${$}" contains illegal characters (whitespace or "/")`),void G.warn(Xt.join(" "))}Vt(new j.wA(`${$e}-version`,()=>({library:$e,version:$}),"VERSION"))}function un(B,$){if(null!==B&&"function"!=typeof B)throw Rn.create("invalid-log-argument");(0,P.Am)(B,$)}function ir(B){(0,P.Ub)(B)}const Sn="firebase-heartbeat-store";let or=null;function cs(){return or||(or=(0,ce.X3)("firebase-heartbeat-database",1,{upgrade:(B,$)=>{0===$&&B.createObjectStore(Sn)}}).catch(B=>{throw Rn.create("idb-open",{originalErrorMessage:B.message})})),or}function gt(){return(gt=(0,f.Z)(function*(B){var $;try{return(yield cs()).transaction(Sn).objectStore(Sn).get(wi(B))}catch(Z){if(Z instanceof ae.ZR)G.warn(Z.message);else{const Re=Rn.create("idb-get",{originalErrorMessage:null===($=Z)||void 0===$?void 0:$.message});G.warn(Re.message)}}})).apply(this,arguments)}function rt(B,$){return vi.apply(this,arguments)}function vi(){return(vi=(0,f.Z)(function*(B,$){var Z;try{const $e=(yield cs()).transaction(Sn,"readwrite");return yield $e.objectStore(Sn).put($,wi(B)),$e.done}catch(Re){if(Re instanceof ae.ZR)G.warn(Re.message);else{const $e=Rn.create("idb-set",{originalErrorMessage:null===(Z=Re)||void 0===Z?void 0:Z.message});G.warn($e.message)}}})).apply(this,arguments)}function wi(B){return`${B.name}!${B.options.appId}`}class Fn{constructor($){this.container=$,this._heartbeatsCache=null;const Z=this.container.getProvider("app").getImmediate();this._storage=new zr(Z),this._heartbeatsCachePromise=this._storage.read().then(Re=>(this._heartbeatsCache=Re,Re))}triggerHeartbeat(){var $=this;return(0,f.Z)(function*(){const Re=$.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),$e=yn();if(null===$._heartbeatsCache&&($._heartbeatsCache=yield $._heartbeatsCachePromise),$._heartbeatsCache.lastSentHeartbeatDate!==$e&&!$._heartbeatsCache.heartbeats.some(bt=>bt.date===$e))return $._heartbeatsCache.heartbeats.push({date:$e,agent:Re}),$._heartbeatsCache.heartbeats=$._heartbeatsCache.heartbeats.filter(bt=>{const rn=new Date(bt.date).valueOf();return Date.now()-rn<=2592e6}),$._storage.overwrite($._heartbeatsCache)})()}getHeartbeatsHeader(){var $=this;return(0,f.Z)(function*(){if(null===$._heartbeatsCache&&(yield $._heartbeatsCachePromise),null===$._heartbeatsCache||0===$._heartbeatsCache.heartbeats.length)return"";const Z=yn(),{heartbeatsToSend:Re,unsentEntries:$e}=function mt(B,$=1024){const Z=[];let Re=B.slice();for(const $e of B){const bt=Z.find(rn=>rn.agent===$e.agent);if(bt){if(bt.dates.push($e.date),z(Z)>$){bt.dates.pop();break}}else if(Z.push({agent:$e.agent,dates:[$e.date]}),z(Z)>$){Z.pop();break}Re=Re.slice(1)}return{heartbeatsToSend:Z,unsentEntries:Re}}($._heartbeatsCache.heartbeats),bt=(0,ae.L)(JSON.stringify({version:2,heartbeats:Re}));return $._heartbeatsCache.lastSentHeartbeatDate=Z,$e.length>0?($._heartbeatsCache.heartbeats=$e,yield $._storage.overwrite($._heartbeatsCache)):($._heartbeatsCache.heartbeats=[],$._storage.overwrite($._heartbeatsCache)),bt})()}}function yn(){return(new Date).toISOString().substring(0,10)}class zr{constructor($){this.app=$,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,f.Z)(function*(){return!!(0,ae.hl)()&&(0,ae.eu)().then(()=>!0).catch(()=>!1)})()}read(){var $=this;return(0,f.Z)(function*(){return(yield $._canUseIndexedDBPromise)&&(yield function Ht(B){return gt.apply(this,arguments)}($.app))||{heartbeats:[]}})()}overwrite($){var Z=this;return(0,f.Z)(function*(){var Re;if(yield Z._canUseIndexedDBPromise){const bt=yield Z.read();return rt(Z.app,{lastSentHeartbeatDate:null!==(Re=$.lastSentHeartbeatDate)&&void 0!==Re?Re:bt.lastSentHeartbeatDate,heartbeats:$.heartbeats})}})()}add($){var Z=this;return(0,f.Z)(function*(){var Re;if(yield Z._canUseIndexedDBPromise){const bt=yield Z.read();return rt(Z.app,{lastSentHeartbeatDate:null!==(Re=$.lastSentHeartbeatDate)&&void 0!==Re?Re:bt.lastSentHeartbeatDate,heartbeats:[...bt.heartbeats,...$.heartbeats]})}})()}}function z(B){return(0,ae.L)(JSON.stringify({version:2,heartbeats:B})).length}!function H(B){Vt(new j.wA("platform-logger",$=>new ye($),"PRIVATE")),Vt(new j.wA("heartbeat",$=>new Fn($),"PRIVATE")),Tn(le,"0.7.32",B),Tn(le,"0.7.32","esm2017"),Tn("fire-js","")}("")},4859:(nt,be,F)=>{F.d(be,{H0:()=>le,wA:()=>P,zt:()=>ce});var f=F(5861),j=F(2090);class P{constructor(G,q,se){this.name=G,this.instanceFactory=q,this.type=se,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(G){return this.instantiationMode=G,this}setMultipleInstances(G){return this.multipleInstances=G,this}setServiceProps(G){return this.serviceProps=G,this}setInstanceCreatedCallback(G){return this.onInstanceCreated=G,this}}const ae="[DEFAULT]";class ce{constructor(G,q){this.name=G,this.container=q,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(G){const q=this.normalizeInstanceIdentifier(G);if(!this.instancesDeferred.has(q)){const se=new j.BH;if(this.instancesDeferred.set(q,se),this.isInitialized(q)||this.shouldAutoInitialize())try{const qe=this.getOrInitializeService({instanceIdentifier:q});qe&&se.resolve(qe)}catch(qe){}}return this.instancesDeferred.get(q).promise}getImmediate(G){var q;const se=this.normalizeInstanceIdentifier(null==G?void 0:G.identifier),qe=null!==(q=null==G?void 0:G.optional)&&void 0!==q&&q;if(!this.isInitialized(se)&&!this.shouldAutoInitialize()){if(qe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:se})}catch(Pe){if(qe)return null;throw Pe}}getComponent(){return this.component}setComponent(G){if(G.name!==this.name)throw Error(`Mismatching Component ${G.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=G,this.shouldAutoInitialize()){if(function me(we){return"EAGER"===we.instantiationMode}(G))try{this.getOrInitializeService({instanceIdentifier:ae})}catch(q){}for(const[q,se]of this.instancesDeferred.entries()){const qe=this.normalizeInstanceIdentifier(q);try{const Pe=this.getOrInitializeService({instanceIdentifier:qe});se.resolve(Pe)}catch(Pe){}}}}clearInstance(G=ae){this.instancesDeferred.delete(G),this.instancesOptions.delete(G),this.instances.delete(G)}delete(){var G=this;return(0,f.Z)(function*(){const q=Array.from(G.instances.values());yield Promise.all([...q.filter(se=>"INTERNAL"in se).map(se=>se.INTERNAL.delete()),...q.filter(se=>"_delete"in se).map(se=>se._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(G=ae){return this.instances.has(G)}getOptions(G=ae){return this.instancesOptions.get(G)||{}}initialize(G={}){const{options:q={}}=G,se=this.normalizeInstanceIdentifier(G.instanceIdentifier);if(this.isInitialized(se))throw Error(`${this.name}(${se}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const qe=this.getOrInitializeService({instanceIdentifier:se,options:q});for(const[Pe,Ve]of this.instancesDeferred.entries())se===this.normalizeInstanceIdentifier(Pe)&&Ve.resolve(qe);return qe}onInit(G,q){var se;const qe=this.normalizeInstanceIdentifier(q),Pe=null!==(se=this.onInitCallbacks.get(qe))&&void 0!==se?se:new Set;Pe.add(G),this.onInitCallbacks.set(qe,Pe);const Ve=this.instances.get(qe);return Ve&&G(Ve,qe),()=>{Pe.delete(G)}}invokeOnInitCallbacks(G,q){const se=this.onInitCallbacks.get(q);if(se)for(const qe of se)try{qe(G,q)}catch(Pe){}}getOrInitializeService({instanceIdentifier:G,options:q={}}){let se=this.instances.get(G);if(!se&&this.component&&(se=this.component.instanceFactory(this.container,{instanceIdentifier:(we=G,we===ae?void 0:we),options:q}),this.instances.set(G,se),this.instancesOptions.set(G,q),this.invokeOnInitCallbacks(se,G),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,G,se)}catch(qe){}var we;return se||null}normalizeInstanceIdentifier(G=ae){return this.component?this.component.multipleInstances?G:ae:G}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class le{constructor(G){this.name=G,this.providers=new Map}addComponent(G){const q=this.getProvider(G.name);if(q.isComponentSet())throw new Error(`Component ${G.name} has already been registered with ${this.name}`);q.setComponent(G)}addOrOverwriteComponent(G){this.getProvider(G.name).isComponentSet()&&this.providers.delete(G.name),this.addComponent(G)}getProvider(G){if(this.providers.has(G))return this.providers.get(G);const q=new ce(G,this);return this.providers.set(G,q),q}getProviders(){return Array.from(this.providers.values())}}},1877:(nt,be,F)=>{F.d(be,{Am:()=>we,Ub:()=>le,Yd:()=>me,in:()=>j});const f=[];var j=(()=>{return(G=j||(j={}))[G.DEBUG=0]="DEBUG",G[G.VERBOSE=1]="VERBOSE",G[G.INFO=2]="INFO",G[G.WARN=3]="WARN",G[G.ERROR=4]="ERROR",G[G.SILENT=5]="SILENT",j;var G})();const P={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},ae=j.INFO,ce={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},ye=(G,q,...se)=>{if(q<G.logLevel)return;const qe=(new Date).toISOString(),Pe=ce[q];if(!Pe)throw new Error(`Attempted to log a message with an invalid logType (value: ${q})`);console[Pe](`[${qe}]  ${G.name}:`,...se)};class me{constructor(q){this.name=q,this._logLevel=ae,this._logHandler=ye,this._userLogHandler=null,f.push(this)}get logLevel(){return this._logLevel}set logLevel(q){if(!(q in j))throw new TypeError(`Invalid value "${q}" assigned to \`logLevel\``);this._logLevel=q}setLogLevel(q){this._logLevel="string"==typeof q?P[q]:q}get logHandler(){return this._logHandler}set logHandler(q){if("function"!=typeof q)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=q}get userLogHandler(){return this._userLogHandler}set userLogHandler(q){this._userLogHandler=q}debug(...q){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...q),this._logHandler(this,j.DEBUG,...q)}log(...q){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...q),this._logHandler(this,j.VERBOSE,...q)}info(...q){this._userLogHandler&&this._userLogHandler(this,j.INFO,...q),this._logHandler(this,j.INFO,...q)}warn(...q){this._userLogHandler&&this._userLogHandler(this,j.WARN,...q),this._logHandler(this,j.WARN,...q)}error(...q){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...q),this._logHandler(this,j.ERROR,...q)}}function le(G){f.forEach(q=>{q.setLogLevel(G)})}function we(G,q){for(const se of f){let qe=null;q&&q.level&&(qe=P[q.level]),se.userLogHandler=null===G?null:(Pe,Ve,...Ge)=>{const _e=Ge.map(Te=>{if(null==Te)return null;if("string"==typeof Te)return Te;if("number"==typeof Te||"boolean"==typeof Te)return Te.toString();if(Te instanceof Error)return Te.message;try{return JSON.stringify(Te)}catch(Ze){return null}}).filter(Te=>Te).join(" ");Ve>=(null!=qe?qe:Pe.logLevel)&&G({level:j[Ve].toLowerCase(),message:_e,args:Ge,type:Pe.name})}}}},8766:(nt,be,F)=>{F.d(be,{Lj:()=>Fe,X3:()=>We});var f=F(5861);let P,ae;const me=new WeakMap,le=new WeakMap,we=new WeakMap,G=new WeakMap,q=new WeakMap;let Pe={get(ge,Ce,J){if(ge instanceof IDBTransaction){if("done"===Ce)return le.get(ge);if("objectStoreNames"===Ce)return ge.objectStoreNames||we.get(ge);if("store"===Ce)return J.objectStoreNames[1]?void 0:J.objectStore(J.objectStoreNames[0])}return Te(ge[Ce])},set:(ge,Ce,J)=>(ge[Ce]=J,!0),has:(ge,Ce)=>ge instanceof IDBTransaction&&("done"===Ce||"store"===Ce)||Ce in ge};function _e(ge){return"function"==typeof ge?function Ge(ge){return ge!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ye(){return ae||(ae=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ge)?function(...Ce){return ge.apply(Ze(this),Ce),Te(me.get(this))}:function(...Ce){return Te(ge.apply(Ze(this),Ce))}:function(Ce,...J){const ie=ge.call(Ze(this),Ce,...J);return we.set(ie,Ce.sort?Ce.sort():[Ce]),Te(ie)}}(ge):(ge instanceof IDBTransaction&&function qe(ge){if(le.has(ge))return;const Ce=new Promise((J,ie)=>{const oe=()=>{ge.removeEventListener("complete",ve),ge.removeEventListener("error",de),ge.removeEventListener("abort",de)},ve=()=>{J(),oe()},de=()=>{ie(ge.error||new DOMException("AbortError","AbortError")),oe()};ge.addEventListener("complete",ve),ge.addEventListener("error",de),ge.addEventListener("abort",de)});le.set(ge,Ce)}(ge),((ge,Ce)=>Ce.some(J=>ge instanceof J))(ge,function ce(){return P||(P=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ge,Pe):ge)}function Te(ge){if(ge instanceof IDBRequest)return function se(ge){const Ce=new Promise((J,ie)=>{const oe=()=>{ge.removeEventListener("success",ve),ge.removeEventListener("error",de)},ve=()=>{J(Te(ge.result)),oe()},de=()=>{ie(ge.error),oe()};ge.addEventListener("success",ve),ge.addEventListener("error",de)});return Ce.then(J=>{J instanceof IDBCursor&&me.set(J,ge)}).catch(()=>{}),q.set(Ce,ge),Ce}(ge);if(G.has(ge))return G.get(ge);const Ce=_e(ge);return Ce!==ge&&(G.set(ge,Ce),q.set(Ce,ge)),Ce}const Ze=ge=>q.get(ge);function We(ge,Ce,{blocked:J,upgrade:ie,blocking:oe,terminated:ve}={}){const de=indexedDB.open(ge,Ce),Ue=Te(de);return ie&&de.addEventListener("upgradeneeded",_t=>{ie(Te(de.result),_t.oldVersion,_t.newVersion,Te(de.transaction))}),J&&de.addEventListener("blocked",()=>J()),Ue.then(_t=>{ve&&_t.addEventListener("close",()=>ve()),oe&&_t.addEventListener("versionchange",()=>oe())}).catch(()=>{}),Ue}function Fe(ge,{blocked:Ce}={}){const J=indexedDB.deleteDatabase(ge);return Ce&&J.addEventListener("blocked",()=>Ce()),Te(J).then(()=>{})}const Me=["get","getKey","getAll","getAllKeys","count"],De=["put","add","delete","clear"],ze=new Map;function re(ge,Ce){if(!(ge instanceof IDBDatabase)||Ce in ge||"string"!=typeof Ce)return;if(ze.get(Ce))return ze.get(Ce);const J=Ce.replace(/FromIndex$/,""),ie=Ce!==J,oe=De.includes(J);if(!(J in(ie?IDBIndex:IDBObjectStore).prototype)||!oe&&!Me.includes(J))return;const ve=function(){var de=(0,f.Z)(function*(Ue,..._t){const Qt=this.transaction(Ue,oe?"readwrite":"readonly");let Lt=Qt.store;return ie&&(Lt=Lt.index(_t.shift())),(yield Promise.all([Lt[J](..._t),oe&&Qt.done]))[0]});return function(_t){return de.apply(this,arguments)}}();return ze.set(Ce,ve),ve}!function Ve(ge){Pe=ge(Pe)}(ge=>vF(yF({},ge),{get:(Ce,J,ie)=>re(Ce,J)||ge.get(Ce,J,ie),has:(Ce,J)=>!!re(Ce,J)||ge.has(Ce,J)}))},5861:(nt,be,F)=>{function f(P,ae,ce,ye,me,le,we){try{var G=P[le](we),q=G.value}catch(se){return void ce(se)}G.done?ae(q):Promise.resolve(q).then(ye,me)}function j(P){return function(){var ae=this,ce=arguments;return new Promise(function(ye,me){var le=P.apply(ae,ce);function we(q){f(le,ye,me,we,G,"next",q)}function G(q){f(le,ye,me,we,G,"throw",q)}we(void 0)})}}F.d(be,{Z:()=>j})}},nt=>{nt(nt.s=6988)}]);